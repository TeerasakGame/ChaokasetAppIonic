function X2JS(a,b,c){function d(a){var b=a.localName;return null==b&&(b=a.baseName),null!=b&&""!=b||(b=a.nodeName),b}function e(a){return a.prefix}function f(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):a}function g(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function h(f){if(f.nodeType==u.DOCUMENT_NODE){var i,j,k,l=f.firstChild;for(j=0,k=f.childNodes.length;j<k;j+=1)if(f.childNodes[j].nodeType!==u.COMMENT_NODE){l=f.childNodes[j];break}if(c)i=h(l);else{i={};var m=d(l);i[m]=h(l)}return i}if(f.nodeType==u.ELEMENT_NODE){var i=new Object;i.__cnt=0;for(var n=f.childNodes,o=0;o<n.length;o++){var l=n.item(o),m=d(l);if(i.__cnt++,null==i[m])i[m]=h(l),i[m+"_asArray"]=new Array(1),i[m+"_asArray"][0]=i[m];else{if(null!=i[m]&&!(i[m]instanceof Array)){var p=i[m];i[m]=new Array,i[m][0]=p,i[m+"_asArray"]=i[m]}for(var q=0;null!=i[m][q];)q++;i[m][q]=h(l)}}for(var r=0;r<f.attributes.length;r++){var s=f.attributes.item(r);i.__cnt++;for(var v=s.value,w=0,x=a.length;w<x;w++){var y=a[w];y.test.call(this,s)&&(v=y.converter.call(this,s.value))}i[b+s.name]=v}var z=e(f);return null!=z&&""!=z&&(i.__cnt++,i.__prefix=z),1==i.__cnt&&null!=i["#text"]&&(i=i["#text"]),null!=i["#text"]&&(i.__text=i["#text"],t&&(i.__text=g(i.__text)),delete i["#text"],delete i["#text_asArray"]),null!=i["#cdata-section"]&&(i.__cdata=i["#cdata-section"],delete i["#cdata-section"],delete i["#cdata-section_asArray"]),null==i.__text&&null==i.__cdata||(i.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),i}return f.nodeType==u.TEXT_NODE||f.nodeType==u.CDATA_SECTION_NODE?f.nodeValue:f.nodeType==u.COMMENT_NODE?null:void 0}function i(a,b,c,d){var e="<"+(null!=a&&null!=a.__prefix?a.__prefix+":":"")+b;if(null!=c)for(var f=0;f<c.length;f++){var g=c[f],h=a[g];e+=" "+g.substr(1)+"='"+h+"'"}return e+=d?"/>":">"}function j(a,b){return"</"+(null!=a.__prefix?a.__prefix+":":"")+b+">"}function k(a,b){return a.indexOf(b,a.length-b.length)!==-1}function l(a,b){return!!(k(b.toString(),"_asArray")||0==b.toString().indexOf("_")||a[b]instanceof Function)}function m(a){var b=0;if(a instanceof Object)for(var c in a)l(a,c)||b++;return b}function n(a){var b=[];if(a instanceof Object)for(var c in a)c.toString().indexOf("__")==-1&&0==c.toString().indexOf("_")&&b.push(c);return b}function o(a){var b="";return null!=a.__cdata&&(b+="<![CDATA["+a.__cdata+"]]>"),null!=a.__text&&(b+=t?f(a.__text):a.__text),b}function p(a){var b="";return a instanceof Object?b+=o(a):null!=a&&(b+=t?f(a):a),b}function q(a,b,c){var d="";if(0==a.length)d+=i(a,b,c,!0);else for(var e=0;e<a.length;e++)d+=i(a[e],b,n(a[e]),!1),d+=r(a[e]),d+=j(a[e],b);return d}function r(a){var b="",c=m(a);if(c>0)for(var d in a)if(!l(a,d)){var e=a[d],f=n(e);if(null==e||void 0==e)b+=i(e,d,f,!0);else if(e instanceof Object)if(e instanceof Array)b+=q(e,d,f);else{var g=m(e);g>0||null!=e.__text||null!=e.__cdata?(b+=i(e,d,f,!1),b+=r(e),b+=j(e,d)):b+=i(e,d,f,!0)}else b+=i(e,d,f,!1),b+=p(e),b+=j(e,d)}return b+=p(a)}null!==b&&void 0!==b||(b="_"),null!==c&&void 0!==c||(c=!1);var s="1.0.11",t=!1,u={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(a){var b;if(window.DOMParser){var c=new window.DOMParser;b=c.parseFromString(a,"text/xml")}else 0==a.indexOf("<?")&&(a=a.substr(a.indexOf("?>")+2)),b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);return b},this.xml2json=function(a){return h(a)},this.xml_str2json=function(a){var b=this.parseXmlString(a);return this.xml2json(b)},this.json2xml_str=function(a){return r(a)},this.json2xml=function(a){var b=this.json2xml_str(a);return this.parseXmlString(b)},this.getVersion=function(){return s},this.escapeMode=function(a){t=a}}function ObjectIron(a){var b;for(b=[],i=0,len=a.length;i<len;i+=1)a[i].isRoot?b.push("root"):b.push(a[i].name);var c=function(a,b){var c;if(null!==a&&null!==b)for(c in a)a.hasOwnProperty(c)&&(b.hasOwnProperty(c)||(b[c]=a[c]))},d=function(a,b,d){var e,f,g,h,i;if(null!==a&&0!==a.length)for(e=0,f=a.length;e<f;e+=1)g=a[e],b.hasOwnProperty(g.name)&&(d.hasOwnProperty(g.name)?g.merge&&(h=b[g.name],i=d[g.name],"object"==typeof h&&"object"==typeof i?c(h,i):null!=g.mergeFunction?d[g.name]=g.mergeFunction(h,i):d[g.name]=h+i):d[g.name]=b[g.name])},e=function(a,b){var c,f,g,h,i,j,k,l=a;if(null!==l.children&&0!==l.children.length)for(c=0,f=l.children.length;c<f;c+=1)if(j=l.children[c],b.hasOwnProperty(j.name))if(j.isArray)for(i=b[j.name+"_asArray"],g=0,h=i.length;g<h;g+=1)k=i[g],d(l.properties,b,k),e(j,k);else k=b[j.name],d(l.properties,b,k),e(j,k)},f=function(c){var d,g,h,i,j,k,l;if(null===c)return c;if("object"!=typeof c)return c;for(d=0,g=b.length;d<g;d+=1)"root"===b[d]&&(j=a[d],k=c,e(j,k));for(i in c)if(c.hasOwnProperty(i)){if(h=b.indexOf(i),h!==-1)if(j=a[h],j.isArray)for(l=c[i+"_asArray"],d=0,g=l.length;d<g;d+=1)k=l[d],e(j,k);else k=c[i],e(j,k);f(c[i])}return c};return{run:f}}function intTobitArray(a,b){for(var c=[],d=0;d<b;d++)c.push((a&Math.pow(2,d))>0);return c}!function(a,b){"function"==typeof define&&define.amd&&define(b),a.vimond||(a.vimond={}),a.vimond.followme=b()}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[];if(f=f||a,"function"==typeof c){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c.apply(q[a],u),a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){return"string"==typeof a?p[a]?p[a](b):j(o(a,b).f):(a.splice||(s=a,b.splice?(a=b,b=c,c=null):a=d),b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("../../build/almond",function(){}),function(a){"use strict";if("function"==typeof bootstrap)bootstrap("promise",a);else if("object"==typeof exports&&"object"==typeof module)module.exports=a();else if("function"==typeof c&&c.amd)c("lib/q",a);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=a}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var b="undefined"!=typeof window?window:self,d=b.Q;b.Q=a(),b.Q.noConflict=function(){return b.Q=d,this}}}(function(){"use strict";function a(a){return function(){return V.apply(a,arguments)}}function b(a){return a===Object(a)}function c(a){return"[object StopIteration]"===ba(a)||a instanceof R}function d(a,b){if(P&&b.stack&&"object"==typeof a&&null!==a&&a.stack&&a.stack.indexOf(ca)===-1){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);var f=c.join("\n"+ca+"\n");a.stack=e(f)}}function e(a){for(var b=a.split("\n"),c=[],d=0;d<b.length;++d){var e=b[d];h(e)||f(e)||!e||c.push(e)}return c.join("\n")}function f(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function g(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);return d?[d[1],Number(d[2])]:void 0}function h(a){var b=g(a);if(!b)return!1;var c=b[0],d=b[1];return c===Q&&d>=S&&d<=ha}function i(){if(P)try{throw new Error}catch(d){var a=d.stack.split("\n"),b=a[0].indexOf("@")>0?a[1]:a[2],c=g(b);if(!c)return;return Q=c[0],c[1]}}function j(a,b,c){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",new Error("").stack),a.apply(a,arguments)}}function k(a){return a instanceof o?a:s(a)?B(a):A(a)}function l(){function a(a){b=a,k.longStackSupport&&P&&(f.source=a),X(c,function(b,c){k.nextTick(function(){a.promiseDispatch.apply(a,c)})},void 0),c=void 0,d=void 0}var b,c=[],d=[],e=$(l.prototype),f=$(o.prototype);if(f.promiseDispatch=function(a,e,f){var g=W(arguments);c?(c.push(g),"when"===e&&f[1]&&d.push(f[1])):k.nextTick(function(){b.promiseDispatch.apply(b,g)})},f.valueOf=function(){if(c)return f;var a=q(b);return r(a)&&(b=a),a},f.inspect=function(){return b?b.inspect():{state:"pending"}},k.longStackSupport&&P)try{throw new Error}catch(a){f.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return e.promise=f,e.resolve=function(c){b||a(k(c))},e.fulfill=function(c){b||a(A(c))},e.reject=function(c){b||a(z(c))},e.notify=function(a){b||X(d,function(b,c){k.nextTick(function(){c(a)})},void 0)},e}function m(a){if("function"!=typeof a)throw new TypeError("resolver must be a function.");var b=l();try{a(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}return b.promise}function n(a){return m(function(b,c){for(var d=0,e=a.length;d<e;d++)k(a[d]).then(b,c)})}function o(a,b,c){void 0===b&&(b=function(a){return z(new Error("Promise does not support operation: "+a))}),void 0===c&&(c=function(){return{state:"unknown"}});var d=$(o.prototype);if(d.promiseDispatch=function(c,e,f){var g;try{g=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(a){g=z(a)}c&&c(g)},d.inspect=c,c){var e=c();"rejected"===e.state&&(d.exception=e.reason),d.valueOf=function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value}}return d}function p(a,b,c,d){return k(a).then(b,c,d)}function q(a){if(r(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function r(a){return a instanceof o}function s(a){return b(a)&&"function"==typeof a.then}function t(a){return r(a)&&"pending"===a.inspect().state}function u(a){return!r(a)||"fulfilled"===a.inspect().state}function v(a){return r(a)&&"rejected"===a.inspect().state}function w(){da.length=0,ea.length=0,ga||(ga=!0)}function x(a,b){ga&&("object"==typeof process&&"function"==typeof process.emit&&k.nextTick.runAfter(function(){Y(ea,a)!==-1&&(process.emit("unhandledRejection",b,a),fa.push(a))}),ea.push(a),b&&"undefined"!=typeof b.stack?da.push(b.stack):da.push("(no stack) "+b))}function y(a){if(ga){var b=Y(ea,a);b!==-1&&("object"==typeof process&&"function"==typeof process.emit&&k.nextTick.runAfter(function(){var c=Y(fa,a);c!==-1&&(process.emit("rejectionHandled",da[b],a),fa.splice(c,1))}),ea.splice(b,1),da.splice(b,1))}}function z(a){var b=o({when:function(b){return b&&y(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return x(b,a),b}function A(a){return o({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},delete:function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return aa(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function B(a){var b=l();return k.nextTick(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}}),b.promise}function C(a){return o({isDef:function(){}},function(b,c){return I(a,b,c)},function(){return k(a).inspect()})}function D(a,b,c){return k(a).spread(b,c)}function E(a){return function(){function b(a,b){var g;if("undefined"==typeof StopIteration){try{g=d[a](b)}catch(a){return z(a)}return g.done?k(g.value):p(g.value,e,f)}try{g=d[a](b)}catch(a){return c(a)?k(a.value):z(a)}return p(g,e,f)}var d=a.apply(this,arguments),e=b.bind(b,"next"),f=b.bind(b,"throw");return e()}}function F(a){k.done(k.async(a)())}function G(a){throw new R(a)}function H(a){return function(){return D([this,J(arguments)],function(b,c){return a.apply(b,c)})}}function I(a,b,c){return k(a).dispatch(b,c)}function J(a){return p(a,function(a){var b=0,c=l();return X(a,function(d,e,f){var g;r(e)&&"fulfilled"===(g=e.inspect()).state?a[f]=g.value:(++b,p(e,function(d){a[f]=d,0===--b&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),0===b&&c.resolve(a),c.promise})}function K(a){if(0===a.length)return k.resolve();var b=k.defer(),c=0;return X(a,function(d,e,f){function g(a){b.resolve(a)}function h(a){c--,0===c&&(a.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+a.message,b.reject(a))}function i(a){b.notify({index:f,value:a})}var j=a[f];c++,p(j,g,h,i)},void 0),b.promise}function L(a){return p(a,function(a){return a=Z(a,k),p(J(Z(a,function(a){return p(a,T,T)})),function(){return a})})}function M(a){return k(a).allSettled()}function N(a,b){return k(a).then(void 0,void 0,b)}function O(a,b){return k(a).nodeify(b)}var P=!1;try{throw new Error}catch(a){P=!!a.stack}var Q,R,S=i(),T=function(){},U=function(){function a(){for(var a,d;c.next;)c=c.next,a=c.task,c.task=void 0,d=c.domain,d&&(c.domain=void 0,d.enter()),b(a,d);for(;h.length;)a=h.pop(),b(a);e=!1}function b(b,c){try{b()}catch(b){if(g)throw c&&c.exit(),setTimeout(a,0),c&&c.enter(),b;setTimeout(function(){throw b},0)}c&&c.exit()}var c={task:void 0,next:null},d=c,e=!1,f=void 0,g=!1,h=[];if(U=function(a){d=d.next={task:a,domain:g&&process.domain,next:null},e||(e=!0,f())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)g=!0,f=function(){process.nextTick(a)};else if("function"==typeof setImmediate)f="undefined"!=typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!=typeof MessageChannel){var i=new MessageChannel;i.port1.onmessage=function(){f=j,i.port1.onmessage=a,a()};var j=function(){i.port2.postMessage(0)};f=function(){setTimeout(a,0),j()}}else f=function(){setTimeout(a,0)};return U.runAfter=function(a){h.push(a),e||(e=!0,f())},U}(),V=Function.call,W=a(Array.prototype.slice),X=a(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length)for(;;){if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),Y=a(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),Z=a(Array.prototype.map||function(a,b){var c=this,d=[];return X(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),$=Object.create||function(a){function b(){}return b.prototype=a,new b},_=a(Object.prototype.hasOwnProperty),aa=Object.keys||function(a){var b=[];for(var c in a)_(a,c)&&b.push(c);return b},ba=a(Object.prototype.toString);R="undefined"!=typeof ReturnValue?ReturnValue:function(a){this.value=a};var ca="From previous event:";k.resolve=k,k.nextTick=U,k.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(k.longStackSupport=!0),k.defer=l,l.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(W(arguments,1)):a.resolve(c)}},k.Promise=m,k.promise=m,m.race=n,m.all=J,m.reject=z,m.resolve=k,k.passByCopy=function(a){return a},o.prototype.passByCopy=function(){return this},k.join=function(a,b){return k(a).join(b)},o.prototype.join=function(a){return k([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Q can't join: not the same: "+a+" "+b)})},k.race=n,o.prototype.race=function(){return this.then(k.race)},k.makePromise=o,o.prototype.toString=function(){return"[object Promise]"},o.prototype.then=function(a,b,c){function e(b){try{return"function"==typeof a?a(b):b}catch(a){return z(a)}}function f(a){if("function"==typeof b){d(a,h);try{return b(a)}catch(a){return z(a)}}return z(a)}function g(a){return"function"==typeof c?c(a):a}var h=this,i=l(),j=!1;return k.nextTick(function(){h.promiseDispatch(function(a){j||(j=!0,i.resolve(e(a)))},"when",[function(a){j||(j=!0,i.resolve(f(a)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=g(a)}catch(a){if(c=!0,!k.onerror)throw a;k.onerror(a)}c||i.notify(b)}]),i.promise},k.tap=function(a,b){return k(a).tap(b)},o.prototype.tap=function(a){return a=k(a),this.then(function(b){return a.fcall(b).thenResolve(b)})},k.when=p,o.prototype.thenResolve=function(a){return this.then(function(){return a})},k.thenResolve=function(a,b){return k(a).thenResolve(b)},o.prototype.thenReject=function(a){return this.then(function(){throw a})},k.thenReject=function(a,b){return k(a).thenReject(b)},k.nearer=q,k.isPromise=r,k.isPromiseAlike=s,k.isPending=t,o.prototype.isPending=function(){return"pending"===this.inspect().state},k.isFulfilled=u,o.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},k.isRejected=v,o.prototype.isRejected=function(){return"rejected"===this.inspect().state};var da=[],ea=[],fa=[],ga=!0;k.resetUnhandledRejections=w,k.getUnhandledReasons=function(){return da.slice()},k.stopUnhandledRejectionTracking=function(){w(),ga=!1},w(),k.reject=z,k.fulfill=A,k.master=C,k.spread=D,o.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},k.async=E,k.spawn=F,k.return=G,k.promised=H,k.dispatch=I,o.prototype.dispatch=function(a,b){var c=this,d=l();return k.nextTick(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},k.get=function(a,b){return k(a).dispatch("get",[b])},o.prototype.get=function(a){return this.dispatch("get",[a])},k.set=function(a,b,c){return k(a).dispatch("set",[b,c])},o.prototype.set=function(a,b){return this.dispatch("set",[a,b])},k.del=k.delete=function(a,b){return k(a).dispatch("delete",[b])},o.prototype.del=o.prototype.delete=function(a){return this.dispatch("delete",[a])},k.mapply=k.post=function(a,b,c){return k(a).dispatch("post",[b,c])},o.prototype.mapply=o.prototype.post=function(a,b){return this.dispatch("post",[a,b])},k.send=k.mcall=k.invoke=function(a,b){return k(a).dispatch("post",[b,W(arguments,2)])},o.prototype.send=o.prototype.mcall=o.prototype.invoke=function(a){return this.dispatch("post",[a,W(arguments,1)])},k.fapply=function(a,b){return k(a).dispatch("apply",[void 0,b])},o.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},k.try=k.fcall=function(a){return k(a).dispatch("apply",[void 0,W(arguments,1)])},o.prototype.fcall=function(){return this.dispatch("apply",[void 0,W(arguments)])},k.fbind=function(a){var b=k(a),c=W(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(W(arguments))])}},o.prototype.fbind=function(){var a=this,b=W(arguments);return function(){return a.dispatch("apply",[this,b.concat(W(arguments))])}},k.keys=function(a){return k(a).dispatch("keys",[])},o.prototype.keys=function(){return this.dispatch("keys",[])},k.all=J,o.prototype.all=function(){return J(this)},k.any=K,o.prototype.any=function(){return K(this)},k.allResolved=j(L,"allResolved","allSettled"),o.prototype.allResolved=function(){return L(this)},k.allSettled=M,o.prototype.allSettled=function(){return this.then(function(a){return J(Z(a,function(a){function b(){return a.inspect()}return a=k(a),a.then(b,b)}))})},k.fail=k.catch=function(a,b){return k(a).then(void 0,b)},o.prototype.fail=o.prototype.catch=function(a){return this.then(void 0,a)},k.progress=N,o.prototype.progress=function(a){return this.then(void 0,void 0,a)},k.fin=k.finally=function(a,b){return k(a).finally(b)},o.prototype.fin=o.prototype.finally=function(a){if(!a||"function"!=typeof a.apply)throw new Error("Q can't apply finally callback");return a=k(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},k.done=function(a,b,c,d){return k(a).done(b,c,d)},o.prototype.done=function(a,b,c){var e=function(a){k.nextTick(function(){if(d(a,f),!k.onerror)throw a;k.onerror(a)})},f=a||b||c?this.then(a,b,c):this;"object"==typeof process&&process&&process.domain&&(e=process.domain.bind(e)),f.then(void 0,e)},k.timeout=function(a,b,c){return k(a).timeout(b,c)},o.prototype.timeout=function(a,b){var c=l(),d=setTimeout(function(){b&&"string"!=typeof b||(b=new Error(b||"Timed out after "+a+" ms"),b.code="ETIMEDOUT"),c.reject(b)},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},k.delay=function(a,b){return void 0===b&&(b=a,a=void 0),k(a).delay(b)},o.prototype.delay=function(a){return this.then(function(b){var c=l();return setTimeout(function(){c.resolve(b)},a),c.promise})},k.nfapply=function(a,b){return k(a).nfapply(b)},o.prototype.nfapply=function(a){var b=l(),c=W(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},k.nfcall=function(a){var b=W(arguments,1);return k(a).nfapply(b)},o.prototype.nfcall=function(){var a=W(arguments),b=l();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},k.nfbind=k.denodeify=function(a){if(void 0===a)throw new Error("Q can't wrap an undefined function");var b=W(arguments,1);return function(){var c=b.concat(W(arguments)),d=l();return c.push(d.makeNodeResolver()),k(a).fapply(c).fail(d.reject),d.promise}},o.prototype.nfbind=o.prototype.denodeify=function(){var a=W(arguments);return a.unshift(this),k.denodeify.apply(void 0,a)},k.nbind=function(a,b){var c=W(arguments,2);return function(){function d(){return a.apply(b,arguments)}var e=c.concat(W(arguments)),f=l();return e.push(f.makeNodeResolver()),k(d).fapply(e).fail(f.reject),f.promise}},o.prototype.nbind=function(){var a=W(arguments,0);return a.unshift(this),k.nbind.apply(void 0,a)},k.nmapply=k.npost=function(a,b,c){return k(a).npost(b,c)},o.prototype.nmapply=o.prototype.npost=function(a,b){var c=W(b||[]),d=l();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},k.nsend=k.nmcall=k.ninvoke=function(a,b){var c=W(arguments,2),d=l();return c.push(d.makeNodeResolver()),k(a).dispatch("post",[b,c]).fail(d.reject),d.promise},o.prototype.nsend=o.prototype.nmcall=o.prototype.ninvoke=function(a){var b=W(arguments,1),c=l();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},k.nodeify=O,o.prototype.nodeify=function(a){return a?void this.then(function(b){k.nextTick(function(){a(null,b)})},function(b){k.nextTick(function(){a(b)})}):this},k.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ha=i();return k}),function(){function a(a){return!!a&&"object"==typeof a}function b(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]=ka,f[++e]=c);return f}function d(){}function e(){}function f(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ib,this.__views__=[]}function g(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function h(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function i(a,b,c){c||(c={});for(var d=-1,e=b.length;++d<e;){var f=b[d];c[f]=a[f]}return c}function j(a,b){return pb(a,b,U)}function k(b,c,d,e,f){if(!N(b))return b;var g=B(c)&&(wb(c)||R(c)),i=g?Y:yb(c);return h(i||c,function(h,j){if(i&&(j=h,h=c[j]),a(h))e||(e=[]),f||(f=[]),l(b,c,j,k,d,e,f);else{var m=b[j],n=d?d(m,h,j,b,c):Y,o=n===Y;o&&(n=h),n===Y&&(!g||j in b)||!o&&(n===n?n===m:m!==m)||(b[j]=n)}}),b}function l(a,b,c,d,e,f,h){for(var i=f.length,j=b[c];i--;)if(f[i]==j)return void(a[c]=h[i]);var k=a[c],l=e?e(k,j,c,a,b):Y,m=l===Y;m&&(l=j,B(j)&&(wb(j)||R(j))?l=wb(k)?k:B(k)?g(k):[]:P(j)||L(j)?l=L(k)?T(k):P(k)?k:{}:m=!1),f.push(j),h.push(l),m?a[c]=d(l,j,e,f,h):(l===l?l!==k:k===k)&&(a[c]=l)}function m(a){return function(b){return null==b?Y:J(b)[a]}}function n(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}function o(a,b,c){if("function"!=typeof a)return W;if(b===Y)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){for(var d=c.length,e=-1,f=fb(a.length-d,0),g=-1,h=b.length,i=Array(h+f);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function q(a,b,c){for(var d=-1,e=c.length,f=-1,g=fb(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(var k=f;++h<i;)j[k+h]=b[h];for(;++d<e;)j[k+c[d]]=a[f++];return j}function r(a){return K(function(b,c){var d=-1,e=null==b?0:c.length,f=e>2?c[e-2]:Y,g=e>2?c[2]:Y,h=e>1?c[e-1]:Y;for("function"==typeof f?(f=o(f,h,5),e-=2):(f="function"==typeof h?h:Y,e-=f?1:0),g&&D(c[0],c[1],g)&&(f=e<3?Y:f,e=1);++d<e;){var i=c[d];i&&a(b,i,f)}return b})}function s(a){return function(b,c,d){for(var e=J(b),f=d(b),g=f.length,h=a?g:-1;a?h--:++h<g;){var i=f[h];if(c(e[i],i,e)===!1)break}return b}}function t(a,b){function c(){var e=this&&this!==Sa&&this instanceof c?d:a;return e.apply(b,arguments)}var d=u(a);return c}function u(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=ob(a.prototype),d=a.apply(c,b);return N(d)?d:c}}function v(a){var c=K(function(d,e){var f=b(e,c.placeholder);return y(d,a,Y,e,f)});return c}function w(a,c,d,e,f,h,i,j,k,l){function m(){for(var y=arguments.length,z=y,A=Array(y);z--;)A[z]=arguments[z];if(e&&(A=p(A,e,f)),h&&(A=q(A,h,i)),s||v){var B=m.placeholder,C=b(A,B);if(y-=C.length,y<l){var D=j?g(j):Y,F=fb(l-y,0),G=s?C:Y,I=s?Y:C,J=s?A:Y,K=s?Y:A;c|=s?da:ea,c&=~(s?ea:da),t||(c&=~($|_));var L=[a,c,d,J,G,K,I,D,k,F],M=w.apply(Y,L);return E(a)&&tb(M,L),M.placeholder=B,M}}var N=o?d:this,O=r?N[a]:a;return j&&(A=H(A,j)),n&&k<A.length&&(A.length=k),this&&this!==Sa&&this instanceof m&&(O=x||u(a)),O.apply(N,A)}var n=c&fa,o=c&$,r=c&_,s=c&ba,t=c&aa,v=c&ca,x=r?Y:u(a);return m}function x(a,b,c,d){function e(){for(var b=-1,h=arguments.length,i=-1,j=d.length,k=Array(j+h);++i<j;)k[i]=d[i];for(;h--;)k[i++]=arguments[++b];var l=this&&this!==Sa&&this instanceof e?g:a;return l.apply(f?c:this,k)}var f=b&$,g=u(a);return e}function y(a,b,c,d,e,f,g,h){var i=b&_;if(!i&&"function"!=typeof a)throw new TypeError(ja);var j=d?d.length:0;if(j||(b&=~(da|ea),d=e=Y),j-=e?e.length:0,b&ea){var k=d,l=e;d=e=Y}var m=i?Y:rb(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&(G(n,m),b=n[1],h=n[9]),n[9]=null==h?i?0:a.length:fb(h-j,0)||0,b==$)var o=t(n[0],n[2]);else o=b!=da&&b!=($|da)||n[4].length?w.apply(Y,n):x.apply(Y,n);var p=m?qb:tb;return p(o,n)}function z(a){for(var b=a.name+"",c=lb[b],d=c?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function A(a,b){var c=null==a?Y:a[b];return O(c)?c:Y}function B(a){return null!=a&&F(sb(a))}function C(a,b){return a="number"==typeof a||Ja.test(a)?+a:-1,b=null==b?jb:b,a>-1&&a%1==0&&a<b}function D(a,b,c){if(!N(c))return!1;var d=typeof b;if("number"==d?B(c)&&C(b,c.length):"string"==d&&b in c){var e=c[b];return a===a?a===e:e!==e}return!1}function E(a){var b=z(a),c=d[b];if("function"!=typeof c||!(b in f.prototype))return!1;if(a===c)return!0;var e=rb(c);return!!e&&a===e[0]}function F(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=jb}function G(a,c){var d=a[1],e=c[1],f=d|e,h=f<fa,i=e==fa&&d==ba||e==fa&&d==ga&&a[7].length<=c[8]||e==(fa|ga)&&d==ba;if(!h&&!i)return a;e&$&&(a[2]=c[2],f|=d&$?0:aa);var j=c[3];if(j){var k=a[3];a[3]=k?p(k,j,c[4]):g(j),a[4]=k?b(a[3],ka):g(c[4])}return j=c[5],j&&(k=a[5],a[5]=k?q(k,j,c[6]):g(j),a[6]=k?b(a[5],ka):g(c[6])),j=c[7],j&&(a[7]=g(j)),e&fa&&(a[8]=null==a[8]?c[8]:gb(a[8],c[8])),null==a[9]&&(a[9]=c[9]),a[0]=c[0],a[1]=f,a}function H(a,b){for(var c=a.length,d=gb(b.length,c),e=g(a);d--;){var f=b[d];a[d]=C(f,c)?e[f]:Y}return a}function I(a){for(var b=U(a),c=b.length,d=c&&a.length,e=!!d&&F(d)&&(wb(a)||L(a)||Q(a)),f=-1,g=[];++f<c;){var h=b[f];(e&&C(h,d)||Za.call(a,h))&&g.push(h)}return g}function J(a){if(d.support.unindexedChars&&Q(a)){for(var b=-1,c=a.length,e=Object(a);++b<c;)e[b]=a.charAt(b);return e}return N(a)?a:Object(a)}function K(a,b){if("function"!=typeof a)throw new TypeError(ja);return b=fb(b===Y?a.length-1:+b||0,0),function(){for(var c=arguments,d=-1,e=fb(c.length-b,0),f=Array(e);++d<e;)f[d]=c[b+d];switch(b){case 0:return a.call(this,f);case 1:return a.call(this,c[0],f);case 2:return a.call(this,c[0],c[1],f)}var g=Array(b+1);for(d=-1;++d<b;)g[d]=c[d];return g[b]=f,a.apply(this,g)}}function L(b){return a(b)&&B(b)&&Za.call(b,"callee")&&!ab.call(b,"callee")}function M(a){return N(a)&&$a.call(a)==qa}function N(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function O(b){return null!=b&&(M(b)?_a.test(Ya.call(b)):a(b)&&(Ta(b)?_a:Ia).test(b))}function P(b){var c;if(!a(b)||$a.call(b)!=ta||Ta(b)||L(b)||!Za.call(b,"constructor")&&(c=b.constructor,"function"==typeof c&&!(c instanceof c)))return!1;var e;return d.support.ownLast?(j(b,function(a,b,c){return e=Za.call(c,b),!1}),e!==!1):(j(b,function(a,b){e=b}),e===Y||Za.call(b,e))}function Q(b){return"string"==typeof b||a(b)&&$a.call(b)==wa}function R(b){return a(b)&&F(b.length)&&!!La[$a.call(b)]}function S(a){var b=a?sb(a):0;return F(b)?b?d.support.unindexedChars&&Q(a)?a.split(""):g(a):[]:V(a)}function T(a){return i(a,U(a))}function U(a){if(null==a)return[];N(a)||(a=Object(a));var b=a.length,c=d.support;b=b&&F(b)&&(wb(a)||L(a)||Q(a))&&b||0;for(var e=a.constructor,f=-1,g=M(e)&&e.prototype||Wa,h=g===a,i=Array(b),j=b>0,k=c.enumErrorProps&&(a===Va||a instanceof Error),l=c.enumPrototypes&&M(a);++f<b;)i[f]=f+"";for(var m in a)l&&"prototype"==m||k&&("message"==m||"name"==m)||j&&C(m,b)||"constructor"==m&&(h||!Za.call(a,m))||i.push(m);if(c.nonEnumShadows&&a!==Wa){var n=a===Xa?wa:a===Va?pa:$a.call(a),o=mb[n]||mb[ta];for(n==ta&&(g=Wa),b=Ka.length;b--;){m=Ka[b];var p=o[m];h&&p||(p?!Za.call(a,m):a[m]===g[m])||i.push(m)}}return i}function V(a){return n(a,yb(a))}function W(a){return a}function X(){}var Y,Z="3.10.1",$=1,_=2,aa=4,ba=8,ca=16,da=32,ea=64,fa=128,ga=256,ha=150,ia=16,ja="Expected a function",ka="__lodash_placeholder__",la="[object Arguments]",ma="[object Array]",na="[object Boolean]",oa="[object Date]",pa="[object Error]",qa="[object Function]",ra="[object Map]",sa="[object Number]",ta="[object Object]",ua="[object RegExp]",va="[object Set]",wa="[object String]",xa="[object WeakMap]",ya="[object ArrayBuffer]",za="[object Float32Array]",Aa="[object Float64Array]",Ba="[object Int8Array]",Ca="[object Int16Array]",Da="[object Int32Array]",Ea="[object Uint8Array]",Fa="[object Uint8ClampedArray]",Ga="[object Uint16Array]",Ha="[object Uint32Array]",Ia=/^\[object .+?Constructor\]$/,Ja=/^\d+$/,Ka=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],La={};
La[za]=La[Aa]=La[Ba]=La[Ca]=La[Da]=La[Ea]=La[Fa]=La[Ga]=La[Ha]=!0,La[la]=La[ma]=La[ya]=La[na]=La[oa]=La[pa]=La[qa]=La[ra]=La[sa]=La[ta]=La[ua]=La[va]=La[wa]=La[xa]=!1;var Ma={function:!0,object:!0},Na=Ma[typeof exports]&&exports&&!exports.nodeType&&exports,Oa=Ma[typeof module]&&module&&!module.nodeType&&module,Pa=Na&&Oa&&"object"==typeof global&&global&&global.Object&&global,Qa=Ma[typeof self]&&self&&self.Object&&self,Ra=Ma[typeof window]&&window&&window.Object&&window,Sa=Pa||Ra!==(this&&this.window)&&Ra||Qa||this,Ta=function(){try{Object({toString:0}+"")}catch(a){return function(){return!1}}return function(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}}(),Ua=Array.prototype,Va=Error.prototype,Wa=Object.prototype,Xa=String.prototype,Ya=Function.prototype.toString,Za=Wa.hasOwnProperty,$a=Wa.toString,_a=RegExp("^"+Ya.call(Za).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ab=Wa.propertyIsEnumerable,bb=Ua.splice,cb=A(Sa,"WeakMap"),db=A(Array,"isArray"),eb=A(Object,"keys"),fb=Math.max,gb=Math.min,hb=A(Date,"now"),ib=Number.POSITIVE_INFINITY,jb=9007199254740991,kb=cb&&new cb,lb={},mb={};mb[ma]=mb[oa]=mb[sa]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},mb[na]=mb[wa]={constructor:!0,toString:!0,valueOf:!0},mb[pa]=mb[qa]=mb[ua]={constructor:!0,toString:!0},mb[ta]={constructor:!0},h(Ka,function(a){for(var b in mb)if(Za.call(mb,b)){var c=mb[b];c[a]=Za.call(c,a)}});var nb=d.support={};!function(a){var b=function(){this.x=a},c={0:a,length:a},d=[];b.prototype={valueOf:a,y:a};for(var e in new b)d.push(e);nb.enumErrorProps=ab.call(Va,"message")||ab.call(Va,"name"),nb.enumPrototypes=ab.call(b,"prototype"),nb.nonEnumShadows=!/valueOf/.test(d),nb.ownLast="x"!=d[0],nb.spliceObjects=(bb.call(c,0,1),!c[0]),nb.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1,0);var ob=function(){function a(){}return function(b){if(N(b)){a.prototype=b;var c=new a;a.prototype=Y}return c||{}}}(),pb=s(),qb=kb?function(a,b){return kb.set(a,b),a}:W,rb=kb?function(a){return kb.get(a)}:X,sb=m("length"),tb=function(){var a=0,b=0;return function(c,d){var e=ub(),f=ia-(e-b);if(b=e,f>0){if(++a>=ha)return c}else a=0;return qb(c,d)}}(),ub=hb||function(){return(new Date).getTime()},vb=v(da),wb=db||function(b){return a(b)&&F(b.length)&&$a.call(b)==ma},xb=r(k),yb=eb?function(a){var b=null==a?Y:a.constructor;return"function"==typeof b&&b.prototype===a||("function"==typeof a?d.support.enumPrototypes:B(a))?I(a):N(a)?eb(a):[]}:I;f.prototype=ob(e.prototype),f.prototype.constructor=f,d.keys=yb,d.keysIn=U,d.merge=xb,d.partial=vb,d.restParam=K,d.toArray=S,d.toPlainObject=T,d.values=V,d.identity=W,d.isArguments=L,d.isArray=wb,d.isFunction=M,d.isNative=O,d.isObject=N,d.isPlainObject=P,d.isString=Q,d.isTypedArray=R,d.noop=X,d.now=ub,d.VERSION=Z,vb.placeholder=d,"function"==typeof c&&"object"==typeof c.amd&&c.amd&&c("lib/lodash",[],function(){return d})}.call(this),c("model/jsonRequester",["lib/q","lib/lodash"],function(a,b){function c(a,b,c,d){this.code=a,this.message=b||"Rest client error",this.url=c,this.response=d,this.requester=!0}function d(b,e,g,h,i){var j=!1,k=a.defer(),l=new XMLHttpRequest,m=function(a){j||k.reject(new c("xhr","Request failed.",b))},n=function(a){k.reject(new c("xhr","Request aborted.",b))},o=function(a){k.reject(new c("xhr","Request aborted.",b))};if(l.onreadystatechange=function(){try{if(4==l.readyState)if(0===l.responseText.indexOf("<?xml"))k.reject(new c("xml","The server returned an unknown error.",b,l.responseText));else if(l.responseText.length>0)if(l.getResponseHeader("content-type")&&l.getResponseHeader("content-type").indexOf(f)>=0){var a=JSON.parse(l.responseText);k.resolve({data:a})}else k.resolve({data:l.responseText});else{if("GET"==e&&0===l.status&&navigator&&navigator.userAgent.indexOf("irefox")>0){var m=i||0;return j=!0,void(m>3?k.reject(new c("xhr","Aborted request with no content.",b)):d(b,e,g,h,++m).then(function(a){k.resolve(a)}))}k.resolve({data:null})}}catch(a){k.reject(a)}},l.onerror=m,l.onabort=n,l.ontimeout=o,l.open(e,b),l.setRequestHeader("Accept",f+", text/plain"),l.setRequestHeader("Content-Type",f),g)for(var p in g)g.hasOwnProperty(p)&&l.setRequestHeader(p,g[p]);return l.send(JSON.stringify(h)),k.promise}function e(a,b,c){var e=this&&this.headers;return d(a,b,e,c).then(function(a){return a.data},function(a){return a})}var f="application/json";return c.prototype=new Error,c.prototype.constructor=c,{createContext:function(a){return{performRequest:function(){return e.apply(a,b.toArray(arguments))}}},performRequest:e,RequestError:c,GET:"GET",POST:"POST"}}),c("model/serviceContext",["./jsonRequester"],function(a){function b(b){var c={headers:{Authorization:b}};return a.createContext(c)}return{getAuthorizedService:function(a){return new b(a)}}}),c("util",[],function(){return{format:function(a,b){var c=a||"";for(var d in b)if(b.hasOwnProperty(d)){var e=new RegExp("{"+d+"}","ig");c=c.replace(e,b[d])}return c},generateGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},dateToIsoString:function(a){function b(a){var b=String(a);return 1===b.length&&(b="0"+b),b}return a=a||new Date,a.toISOString?a.toISOString():a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+String((a.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},getPageUrl:function(a){var b=a.top!==a.self;return b&&a.document.referrer?a.document.referrer:a.document.location.href},curry:function(){var a=[].slice,b=a.apply(arguments);return this.bind.apply(this,b.concat(a.call(arguments)))}}}),c("historyService",["lib/q","model/serviceContext","util"],function(a,b,c){var d="{baseUrl}/viewinghistory/{assetId}";return{getHistory:function(a,e){var f=b.getAuthorizedService(a.authorization),g=c.format(d,{baseUrl:a.baseUrl,assetId:e||""});return f.performRequest(g,"GET")}}}),c("eventService",["util","model/serviceContext"],function(a,b){function c(a,b){var c=b,d="pk-"+Math.floor(1e5*Math.random());a.kinesis&&a.kinesis.originatorId&&(c.originatorId=a.kinesis.originatorId.toString(),c.client.userId=a.kinesis.originatorId.toString()),c.client.playbackMethod="online";var e=new AWS.Kinesis({apiVersion:"2013-12-02",endpoint:a.kinesis.endpoint,credentials:AWS.config.credentials,region:a.kinesis.region}),f={Data:JSON.stringify(b),PartitionKey:d,StreamName:a.kinesis.streamName};e.putRecord(f,function(a,b){a&&console.log(a,a.stack)})}var d="{baseUrl}/external/{topic}";return{postEvent:function(e,f,g){var h=b.getAuthorizedService(e.authorization),i=a.format(e.eventPostUrl||d,{baseUrl:e.baseUrl,topic:f});return window.AWS&&c(e,g),h.performRequest(i,"POST",g)}}}),c("clientSessionService",["util"],function(a){"use strict";function b(b){function d(){return m.get(k)}function e(){return m.get(k)||g()}function f(){throw new Error("Not implemented.")}function g(){var b=a.generateGuid();return m.set(k,b),b}function h(){return n.get(l)}function i(a){n.set(l,a)}var j=b.clientIdentification,k=j.storageKeyPrefix+"viewingsession",l=j.storageKeyPrefix+"deviceid",m=new c[j.persistence.viewingSession],n=new c[j.persistence.deviceId];return{getCurrentViewingSessionId:d,registerNewPlayback:e,registerNewInstance:f,getDeviceId:h,registerCollectedDeviceId:i,resetViewingSession:g}}var c={local:function(){return{get:function(a){return window.localStorage.getItem(a)},set:function(a,b){window.localStorage.setItem(a,b)}}},session:function(){return{get:function(a){return window.sessionStorage.getItem(a)},set:function(a,b){window.sessionStorage.setItem(a,b)}}},memory:function(){return window.vimond=window.vimond||{},window.vimond.followme=window.vimond.followme||{},window.vimond.followme.memoryStorage=window.vimond.followme.memoryStorage||{},{get:function(a){return window.vimond.followme.memoryStorage[a]},set:function(a,b){window.vimond.followme.memoryStorage[a]=b}}}};return b}),c("model/serviceConfiguration",{eventPostUrl:"",baseUrl:"",progressUpdaterInterval:1e4,clientIdentification:{storageKeyPrefix:"vimond-",persistence:{viewingSession:"memory",deviceId:"local"}},version:"1.2.10"}),c("followme",["historyService","eventService","clientSessionService","model/serviceConfiguration","lib/lodash"],function(a,b,c,d,e){var f={};return{getService:function(c){var f=e.merge(d,c),g=e.partial(b.postEvent,f);return{getHistory:e.partial(a.getHistory,f),postEvent:g,version:d.version}},getSession:function(a){var b=e.merge(d,a),g=b.clientIdentification.storageKeyPrefix;return f[g]||(f[g]=new c(b)),f[g]}}}),c("model/constants",{playerEventTypes:{play:"play",pause:"pause",stop:"stop",end:"end",period:"period",skip:"skip",strStart:"str-start",shutdown:"shutdown",streamfailure:"streamfailure",buffering:"buffering"},playerStates:{play:"play",pause:"pause",stop:"stop",slow:"slow",ffwd:"ffwd"},playbackTypes:{vod:"vod",liveUnnavigable:"live-unnavigable",liveSliding:"live-sliding",liveExpanding:"live-expanding"}}),c("model/adapters/rockeryAdapter",["lib/q","lib/lodash","util","model/constants"],function(a,b,c,d){function e(a,b,e,f,g,h){function i(b){try{b=b||d.playerEventTypes.period;var f=g.getPlaybackInfo(),i=g.getApplicationInfo(),l=f.stream.uri+"",m=i.currentDeviceId;return m&&e.registerCollectedDeviceId(m),{eventName:"player_log_event",originator:"player",versions:["1.0"],originatorId:a.originatorId,tenant:a.tenant,ssoToken:s,client:{isLive:"true",clientDate:c.dateToIsoString(),playerEvent:b,playerState:g.isPaused()?d.playerStates.pause:g.isPlaying()?d.playerStates.play:d.playerStates.stop,userAgent:h.navigator.userAgent,"env.platform":"silverlight","env.version":i.pluginVersion,buildVersion:i.version,buildName:i.rockeryName,platform:i.currentPlatform||"web",pageurl:c.getPageUrl(h),"video.format":f.stream.format,"video.protocol":l.substring(0,l.indexOf(":")),streamUrl:l,subtitle:g.getSelectedSubtitleName&&g.getSelectedSubtitleName(),drm:f.stream.isDrmProtected?"playready":"none",deviceId:m,viewingSession:e.getCurrentViewingSessionId()},progress:{playbackType:d.playbackTypes.vod,liveResumePossible:!1,title:f.asset.title,assetId:f.asset.id.toString(),category:{name:f.category.title,id:f.category.id.toString()},offset:j(),enc:k()}}}catch(a){throw h.console.error("collectLogData",a),a}}function j(){return{duration:Math.round(1e3*g.getDuration()),pos:Math.round(Math.max(1e3*l(),0))}}function k(){return{unit:"date",start:c.dateToIsoString(g.getAbsoluteStartPosition()),end:c.dateToIsoString(new Date(g.getAbsoluteStartPosition().getTime()+1e3*g.getDuration())),pos:m()}}function l(){return null!==u?u.RelativePositionSeconds:g.getPosition()}function m(){return null!==u?u.AbsolutePosition:g.getAbsolutePosition()}function n(a){if(!g.isLive()){var c=i(a);if(o(a,c))return;try{}catch(a){}return b("player-events",c)}}function o(a,c){try{if(a==d.playerEventTypes.strStart&&g.registerHistoryService&&g.isPaused()&&l()<=0)return t=c,!0;t&&(t.progress.offset=j(),t.progress.enc=k(),b("player-events",t),t=null)}catch(a){}return!1}function p(){q(),e.registerNewPlayback(),r=h.setInterval(n,a.progressUpdaterInterval)}function q(){r&&h.clearInterval(r),r=null}if(!g||!g.addEventListener||!g.getPosition)throw new Error("Rockery API missing");var r,s=a.authorization&&a.authorization.substring(a.authorization.indexOf(" ")+1),t=null,u=null;return g.addEventListener("streamStarted",function(){n(d.playerEventTypes.strStart),p()}),g.addEventListener("streamEnded",function(a){a.RelativePositionSeconds>0&&(u=a,n(d.playerEventTypes.end),u=null),q()}),g.addEventListener("streamStopped",function(a){a.RelativePositionSeconds>0&&(u=a,n(d.playerEventTypes.stop),u=null),q()}),g.addEventListener("playerInstanceChanged",function(){q(),n(d.playerEventTypes.strStart),p()}),g.registerHistoryService&&g.registerHistoryService(f),g.registerEventPoster&&g.registerEventPoster(b),{shutdown:function(){q()}}}return{getTracker:function(a,b,c,d,f){return new e(a,b,c,d,f,window)}}}),c("followme-rockery",["followme","model/adapters/rockeryAdapter","model/serviceConfiguration","lib/lodash"],function(a,b,c,d){return{getService:function(e){var f=a.getService(e),g=a.getSession(e),h=d.merge(c,e);return f.getRockeryTracker=d.partial(b.getTracker,h,f.postEvent,g,f.getHistory),f},getSession:a.getSession}}),b("followme-rockery")});var Vimond=Vimond||{};if(Vimond.Rockery=Vimond.Rockery||function(){function a(a,b,c,e){var f='<object id="'+e.pluginId+'" class="'+e.className+'" data="data:application/x-silverlight-2," type="application/x-silverlight-2" style="width: 100%; height: 100%;">';f+='<param name="source" value="'+e.xapUrl+'"/>',f+='<param name="initParams" value="'+d.toInitParamsString(b)+'"/>',f+='<param name="onload" value="'+a+'"/>',f+='<param name="minRuntimeVersion" value="'+e.minVersion+'" />',f+='<param name="autoUpgrade" value="true" />',f+='<param name="enableGPUAcceleration" value="true" />',f+='<param name="enableHTMLAccess" value="true" />',f+='<param name="allowHtmlPopupWindow" value="true"/>',e.culture&&(f+='<param name="UICulture" value="'+e.culture+'"/>',f+='<param name="Culture" value="'+e.culture+'"/>'),f+='<param name="background" value="transparent"/>';var g=window.location.search.toLowerCase().indexOf("enablecachevisualization=true")>0;f+='<param name="enableCacheVisualization" value="'+g+'" />';var h=e.windowless&&!0;return f+='<param name="windowless" value="'+h+'"/>',f+=c,f+="</object>"}function b(a){function b(a){for(var b=["fatal","error","warn","info","debug","trace"],c=[],d=a.level||"off",j=0;j<b.length&&(c.push(b[j]),b[j]!=d);j++)j==b.length-1&&(c=[]);e=c.join("-"),f=a.modules&&(a.modules.join?a.modules.join("-"):a.modules),g=a.matchmodules&&new RegExp(a.matchmodules),h=!(f||g),c.length>0&&window.console&&window.console.log("Vimond Rockery logging set up with level "+d+(f?" and these modules included: "+f:".")),i=a.detailsEnabled}function c(a){return e.indexOf(a.level)>=0&&(h||f&&f.indexOf(a.loggerName)>=0||g&&g.test(a.loggerName))}function d(a,b){var d=window.console,e=b.Data;if(d&&c(e)){for(var f="["+e.loggerName+"] "+e.message,g={timeStamp:e.timeStamp,exception:e.exceptionMessage,parameters:[],level:e.level};e.parameters.length>0;)g.parameters.push(e.parameters.shift());if(window.console.log&&window.console.log.apply){var h=d.log;switch(e.level){case"debug":h=d.debug||d.log;break;case"error":case"fatal":h=d.error||d.log;break;case"warn":h=d.warn||d.log;break;case"info":h=d.info||d.log}var j=[f];i&&j.push(g),h.apply(d,j)}else window.console.log(f)}}a=a||{};var e,f,g,h,i=!1;return b(a),{logHandler:d,configure:b}}var c={xapUrl:"ClientBin/Vimond.Rockery.xap",minVersion:"4.0.60831.0",pluginId:"",className:"",windowless:!1,configUrl:null,baseRock:null,skin:null,apiServer:null,platform:null,language:null,culture:null,userId:null,audioLanguage:null,subtitleLanguage:null,logging:{}},d={toInitParamsString:function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+"="+this.escapeInitParamValue(a[c])+",");return b},escapeInitParamValue:function(a){return null==a?"":a.toString().replace(/,/gi,"%2C").replace(/=/gi,"%3D")},escapeInitParamDictValue:function(a){return null==a?"":encodeURIComponent(a.toString().replace(/=/gi,"%3D"))},toInitParamsDictString:function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+"="+this.escapeInitParamDictValue(a[c])+";");return b},startToString:function(a,b){if("[object Array]"===Object.prototype.toString.call(a)){for(var c=[],d=0;d<a.length;d++)c[d]=this.startToString(a[d]);return"["+c.join(";")+"]"}if(parseInt(a).toString()==a)return parseInt(a);var e=[];b>0&&(a.startPos?a.startPos=b:a.position?a.position=b:a.pos?a.pos=b:a.startPosition=b);for(var f in a)a.hasOwnProperty(f)&&"undefined"!=typeof a[f]&&(e[e.length]=f+":"+a[f]);return e.join("-")}},e={extend:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},processArguments:function(a){return a},initParamHelpers:d,extractInitParams:function(a,b){var c={},e=0;if(null!=b){b.subtitleLanguage&&(c.subtitleLanguage=b.subtitleLanguage),delete b.subtitleLanguage;var f=d.startToString(b,e);c.start=f}return c.baseRock=a.baseRock,c.configUri=a.configUrl,c.skin=a.skin,a.apiServer&&(c.apiServer=a.apiServer),a.platform&&(c.platform=a.platform),a.language&&(c.language=a.language),a.userId&&(c.userId=a.userId),a.audioLanguage&&(c.audioLanguage=a.audioLanguage),a.subtitleLanguage&&(c.subtitleLanguage=a.subtitleLanguage),a.convivaParams&&(c.convivaParams=d.toInitParamsDictString(a.convivaParams)),a.comscoreParams&&(c.comscoreParams=d.toInitParamsDictString(a.comscoreParams)),a.comscorePixelUri&&(c.comscorePixelUri=a.comscorePixelUri),c},getPlayerApi:function(a,b){var c=b.MainPlayer,d={streamStarted:[],streamEnded:[],streamStopped:[],streamFailed:[],navigating:[],fullscreenChanged:[],playbackSessionStarted:[],playbackSessionCompleted:[],playbackUnavailable:[],playerInstanceChanged:[]};return c.StreamStarted=function(){for(var a=0;a<d.streamStarted.length;a++)try{d.streamStarted[a]()}catch(a){}},c.StreamEnded=function(a,b){for(var c=0;c<d.streamEnded.length;c++)try{d.streamEnded[c](b.Data)}catch(a){}},c.StreamStopped=function(a,b){for(var c=0;c<d.streamStopped.length;c++)try{d.streamStopped[c](b.Data)}catch(a){}},c.PlaybackSessionStarted=function(){for(var a=0;a<d.playbackSessionStarted.length;a++)try{d.playbackSessionStarted[a]()}catch(a){}},c.PlaybackSessionCompleted=function(){for(var a=0;a<d.playbackSessionCompleted.length;a++)try{d.playbackSessionCompleted[a]()}catch(a){}},c.StreamFailed=function(){for(var a=0;a<d.streamFailed.length;a++)try{d.streamFailed[a](c.PlaybackError)}catch(a){}},c.PlaybackUnavailable=function(){for(var a=0;a<d.playbackUnavailable.length;a++)try{d.playbackUnavailable[a](c.PlaybackStatus)}catch(a){}},c.Navigating=function(a,b){for(var c=0;c<d.navigating.length;c++)try{d.navigating[c](b.Data)}catch(a){}},c.FullscreenChanged=function(){for(var a=0;a<d.fullscreenChanged.length;a++)try{d.fullscreenChanged[a]()}catch(a){}},c.PlayerInstanceChanged=function(){for(var a=0;a<d.playerInstanceChanged.length;a++)try{d.playerInstanceChanged[a]()}catch(a){}},{start:function(a){c&&c.Start(a)},remove:function(){for(;a.firstChild;)a.removeChild(a.firstChild)},stop:function(){c&&c.Stop()},play:function(){c&&c.Play()},pause:function(){c&&c.Pause()},getPosition:function(){return c?c.RelativePosition:0},setPosition:function(a){c&&(c.RelativePosition=a)},getDuration:function(){return c?c.Duration:0},getAbsolutePosition:function(){return c?c.AbsolutePosition:0},setAbsolutePosition:function(a){c&&(c.AbsolutePosition=a)},getAbsoluteStartPosition:function(){return c?c.AbsoluteStartPosition:new Date},gotoNow:function(){c&&c.GotoNow()},isLive:function(){return c&&c.IsLive},isPlaying:function(){return c&&c.IsPlaying},isPaused:function(){return c&&c.IsPaused},isMuted:function(){return c&&c.IsMuted},mute:function(){c&&(c.IsMuted=!0)},unmute:function(){c&&(c.IsMuted=!1)},getVolume:function(){return c?c.Volume:0},setVolume:function(a){c&&(c.Volume=a)},getSelectedSubtitleName:function(){return c&&c.SelectedSubtitleName||""},getPlaybackInfo:function(){return c?c.CurrentMetadata:null},getPlaybackStatus:function(){return c&&c.PlaybackStatus?c.PlaybackStatus.status:null},getApplicationInfo:function(){return c?c.ApplicationInfo:null},isFullscreen:function(){return c&&c.IsFullscreen},addEventListener:function(a,b){var c=d[a];c[c.length]=b}}},onInstanceReady:null};return{insert:function(a,b,c){return this.start(null,a,b,c)},start:function(d,f,g,h){function i(a){var c;if(a)c=a.getHost().content;else for(var d=f.getElementsByTagName("object"),i=0;i<d.length;i++){var l=d[i];if(l.Source&&l.Source==g.xapUrl){c=l.Content;break}}if(null!=c){j=e.getPlayerApi(f,c,g);var m;try{c.Log&&(m=b(g.logging),c.Log.LogReceived=m.logHandler),j.configureLogging=function(a){m&&m.configure(a)}}catch(a){}k&&j.start(k),e.onInstanceReady&&e.onInstanceReady(j,g,f),Vimond.Rockery.instances=Vimond.Rockery.instances||[],Vimond.Rockery.instances.push(j),h&&h(j)}}g=e.extend(c,g);var j,k,l={start:function(a){j?j.start(a):k=a}};"string"==typeof f&&(f=document.getElementById(f));var m=f.id;m||(m="rockery"+(new Date).getTime()%1e5);var n="_onLoaded_"+m;window[n]=i;var o=e.extractInitParams(g,d),p=a(n,o,f.innerHTML,g);return f.innerHTML=p,l},getPositionInUrl:function(a){var b=a||"start",c=document.location.href.indexOf(b+"=");if(c>0){var d=document.location.href.substring(c+b.length+1).split(/[^a-zA-Z0-9:]/)[0],e=0;if(d.indexOf(":")>0){var f=d.split(":");if(f.length>3)return 0;f.reverse();for(var g=0;g<f.length;g++)e+=f[g]*Math.pow(60,g)}else{var h=d.match(/([0-9]{1,3})(?=s)/)||[0],i=d.match(/([0-9]{1,3})(?=m)/)||[0],j=d.match(/([0-9]{1,3})(?=h)/)||[0];e=3600*j[0]+60*i[0]+1*h[0],0==e&&(e=d)}return e}return 0},getInstance:function(a){throw new Error("This feature is implemented on request.")},_protected:e}}(),!Vimond&&!Vimond.Rockery)throw new Error("Vimond.Rockery missing, is rockery.js included?");if(Vimond.Rockery.SetupGoogleAnalyticsTracking=function(a){function b(a,b,c,d,e){window._gaq.push(["_trackEvent",a,b,c,d,e])}function c(a,b,c){window._gaq.push(["_setCustomVar",a,b,c,d])}var d=3;a.addEventListener("track",function(a){if(!window._gaq){var d=window.console?window.console.log:function(){};return void d("Track event received. ",a.category+"/",a.name+"/",a.actionValue+"/",a.value)}"Mode"==a.name?(c(0,"Player build",a.version),c(1,"Silverlight version",a.silverlightVersion),c(2,"Mode",a.actionValue)):b(a.category,a.name,a.actionValue,a.value)})},Vimond.Rockery=function(a){var b=a._protected,c=b.onInstanceReady;b.onInstanceReady=function(a,b){null!=b.enableGaTracking&&0==b.enableGaTracking||Vimond.Rockery.SetupGoogleAnalyticsTracking(a),c&&c(a,b)};var d=b.extractInitParams;b.extractInitParams=function(a,b){var c=d(a,b);return a.resumeBehavior&&(c.ResumeBehavior=a.resumeBehavior),a.authorization&&(c.Authorization=a.authorization),a.suggestNextEpisodeOffset&&(c.SuggestNextEpisodeOffset=a.suggestNextEpisodeOffset),a.hideNextEpisodeBeforeOffset&&(c.HideNextEpisodeBeforeOffset=a.hideNextEpisodeBeforeOffset),a.assetImageUriPattern&&(c.assetImageUriPattern=a.assetImageUriPattern),a.itemImageUriPattern&&(c.itemImageUriPattern=a.itemImageUriPattern),c};var e=b.getPlayerApi;return b.getPlayerApi=function(a,b,c){var d=[],f=[],g=[],h=[],i=null,j=null,k=e(a,b),l=b.RockBridges;l.RockReady=function(a,b){if("iFlixBridge"==b.RockBridge.ScriptName){var e=b.RockBridge;b.RockBridge.Navigated=function(a,b){for(var c=0;c<f.length;c++)try{f[c](b.Data)}catch(a){}},b.RockBridge.AssetItemClicked=function(a,b){for(var c=0;c<g.length;c++)try{g[c](b.Data)}catch(a){}},b.RockBridge.AssetItemPassed=function(a,b){for(var c=0;c<h.length;c++)try{h[c](b.Data)}catch(a){}},b.RockBridge.TrackPlayerEvent=function(a,b){j&&j("player-events",JSON.parse(b.Data)).then(function(a){e.NotifyTrackPlayerEventResult(a)},function(a){e.NotifyTrackPlayerEventError(b)})}}else if("Analytics"==b.RockBridge.ScriptName)b.RockBridge.AnalyticsEventTracked=function(a,b){for(var c=0;c<d.length;c++)try{d[c](b.AnalyticsEvent)}catch(a){}};else if("Progress"==b.RockBridge.ScriptName){var k=b.RockBridge;b.RockBridge.ProgressRequested=function(a,b){i?i(b.Data).then(function(a){try{var b=c.resumeStartOffset||1e4,d=c.resumeEndOffset||1e4;a&&a.progress&&a.progress.position+d<a.totalTime&&a.progress.position>b?k.NotifyProgress(a.progress.position/1e3,a.progress.updateTime):k.NotifyError(new Error("Improper history service result received."))}catch(a){k.NotifyError(a)}},function(a){k.NotifyError(a)}):k.NotifyError(new Error("History service not registered."))}}else"Cast"==b.RockBridge.ScriptName};var m=k.addEventListener;return k.addEventListener=function(a,b){"track"==a?d[d.length]=b:"navigate"==a?f[f.length]=b:"assetItemClicked"==a?g[g.length]=b:"assetItemPassed"==a?h[h.length]=b:m(a,b)},k.registerHistoryService=function(a){i=a},k.registerEventPoster=function(a){j=a},k},a}(Vimond.Rockery),!function(a){function b(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.src=m.p+""+a+"."+t+".hot-update.js",b.appendChild(c)}function c(a){if("undefined"==typeof XMLHttpRequest)return a(new Error("No browser support"));try{var b=new XMLHttpRequest,c=m.p+""+t+".hot-update.json";b.open("GET",c,!0),b.timeout=1e4,b.send(null)}catch(b){return a(b)}b.onreadystatechange=function(){if(4===b.readyState)if(0===b.status)a(new Error("Manifest request to "+c+" timed out."));else if(404===b.status)a();else if(200!==b.status&&304!==b.status)a(new Error("Manifest request to "+c+" failed."));else{try{var d=JSON.parse(b.responseText)}catch(b){return void a(b)}a(null,d)}}}function d(a){function b(a,b){"ready"===x&&f("prepare"),z++,m.e(a,function(){function c(){z--,"prepare"===x&&(A[a]||j(a),0===z&&0===y&&k())}try{b.call(null,d)}finally{c()}})}var c=D[a];if(!c)return m;var d=function(b){return c.hot.active?D[b]?(D[b].parents.indexOf(a)<0&&D[b].parents.push(a),c.children.indexOf(b)<0&&c.children.push(b)):v=[a]:(console.warn("[HMR] unexpected require("+b+") from disposed module "+a),v=[]),m(b)};for(var e in m)Object.prototype.hasOwnProperty.call(m,e)&&(o?Object.defineProperty(d,e,function(a){return{configurable:!0,enumerable:!0,get:function(){return m[a]},set:function(b){m[a]=b}}}(e)):d[e]=m[e]);return o?Object.defineProperty(d,"e",{enumerable:!0,value:b}):d.e=b,d}function e(a){var b={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],active:!0,accept:function(a,c){if("undefined"==typeof a)b._selfAccepted=!0;else if("function"==typeof a)b._selfAccepted=a;else if("object"==typeof a)for(var d=0;d<a.length;d++)b._acceptedDependencies[a[d]]=c;else b._acceptedDependencies[a]=c},decline:function(a){if("undefined"==typeof a)b._selfDeclined=!0;else if("number"==typeof a)b._declinedDependencies[a]=!0;else for(var c=0;c<a.length;c++)b._declinedDependencies[a[c]]=!0},dispose:function(a){b._disposeHandlers.push(a)},addDisposeHandler:function(a){b._disposeHandlers.push(a)},removeDisposeHandler:function(a){var c=b._disposeHandlers.indexOf(a);c>=0&&b._disposeHandlers.splice(c,1)},check:h,apply:l,status:function(a){return a?void w.push(a):x},addStatusHandler:function(a){w.push(a)},removeStatusHandler:function(a){var b=w.indexOf(a);b>=0&&w.splice(b,1)},data:u[a]};return b}function f(a){x=a;for(var b=0;b<w.length;b++)w[b].call(null,a)}function g(a){var b=+a+""===a;return b?+a:a}function h(a,b){if("idle"!==x)throw new Error("check() is only allowed in idle status");"function"==typeof a?(s=!1,b=a):(s=a,b=b||function(a){if(a)throw a}),f("check"),c(function(a,c){if(a)return b(a);if(!c)return f("idle"),void b(null,null);B={},C={},A={};for(var d=0;d<c.c.length;d++)C[c.c[d]]=!0;r=c.h,f("prepare"),p=b,q={};var e=0;j(e),"prepare"===x&&0===z&&0===y&&k()})}function i(a,b){if(C[a]&&B[a]){B[a]=!1;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(q[c]=b[c]);0===--y&&0===z&&k()}}function j(a){C[a]?(B[a]=!0,y++,b(a)):A[a]=!0}function k(){f("ready");var a=p;if(p=null,a)if(s)l(s,a);else{var b=[];for(var c in q)Object.prototype.hasOwnProperty.call(q,c)&&b.push(g(c));a(null,b)}}function l(b,c){function d(a){for(var b=[a],c={},d=b.slice();d.length>0;){var f=d.pop(),a=D[f];if(a&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return new Error("Aborted because of self decline: "+f);if(0===f)return;for(var g=0;g<a.parents.length;g++){var h=a.parents[g],i=D[h];if(i.hot._declinedDependencies[f])return new Error("Aborted because of declined dependency: "+f+" in "+h);b.indexOf(h)>=0||(i.hot._acceptedDependencies[f]?(c[h]||(c[h]=[]),e(c[h],[f])):(delete c[h],b.push(h),d.push(h)))}}}return[b,c]}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];a.indexOf(d)<0&&a.push(d)}}if("ready"!==x)throw new Error("apply() is only allowed in ready status");"function"==typeof b?(c=b,b={}):b&&"object"==typeof b?c=c||function(a){if(a)throw a}:(b={},c=c||function(a){if(a)throw a});var h={},i=[],j={};for(var k in q)if(Object.prototype.hasOwnProperty.call(q,k)){var l=g(k),n=d(l);if(!n){if(b.ignoreUnaccepted)continue;return f("abort"),c(new Error("Aborted because "+l+" is not accepted"))}if(n instanceof Error)return f("abort"),c(n);j[l]=q[l],e(i,n[0]);for(var l in n[1])Object.prototype.hasOwnProperty.call(n[1],l)&&(h[l]||(h[l]=[]),e(h[l],n[1][l]))}for(var o=[],p=0;p<i.length;p++){var l=i[p];D[l]&&D[l].hot._selfAccepted&&o.push({module:l,errorHandler:D[l].hot._selfAccepted})}f("dispose");for(var s=i.slice();s.length>0;){var l=s.pop(),w=D[l];if(w){for(var y={},z=w.hot._disposeHandlers,A=0;A<z.length;A++){var B=z[A];B(y)}u[l]=y,w.hot.active=!1,delete D[l];for(var A=0;A<w.children.length;A++){var C=D[w.children[A]];if(C){var E=C.parents.indexOf(l);E>=0&&C.parents.splice(E,1)}}}}for(var l in h)if(Object.prototype.hasOwnProperty.call(h,l))for(var w=D[l],F=h[l],A=0;A<F.length;A++){var G=F[A],E=w.children.indexOf(G);E>=0&&w.children.splice(E,1)}f("apply"),t=r;for(var l in j)Object.prototype.hasOwnProperty.call(j,l)&&(a[l]=j[l]);var H=null;for(var l in h)if(Object.prototype.hasOwnProperty.call(h,l)){for(var w=D[l],F=h[l],I=[],p=0;p<F.length;p++){var G=F[p],B=w.hot._acceptedDependencies[G];I.indexOf(B)>=0||I.push(B)}for(var p=0;p<I.length;p++){var B=I[p];try{B(h)}catch(a){H||(H=a)}}}for(var p=0;p<o.length;p++){var J=o[p],l=J.module;v=[l];try{m(l)}catch(a){if("function"==typeof J.errorHandler)try{J.errorHandler(a)}catch(a){H||(H=a)}else H||(H=a)}}return H?(f("fail"),c(H)):(f("idle"),void c(null,i))}function m(b){if(D[b])return D[b].exports;var c=D[b]={exports:{},id:b,loaded:!1,hot:e(b),parents:v,children:[]};return a[b].call(c.exports,c,c.exports,d(b)),c.loaded=!0,c.exports}var n=this.webpackHotUpdate;this.webpackHotUpdate=function(a,b){i(a,b),n&&n(a,b)};var o=!1;try{Object.defineProperty({},"x",{get:function(){}}),o=!0}catch(a){}var p,q,r,s=!0,t="529e54da8ab52016a3f8",u={},v=[],w=[],x="idle",y=0,z=0,A={},B={},C={},D={};return m.m=a,m.c=D,m.p="",m.h=function(){return t},d(0)(0)}(function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))switch(typeof a[b]){case"function":break;case"object":a[b]=function(b){var c=b.slice(1),d=a[b[0]];return function(a,b,e){d.apply(this,[a,b,e].concat(c))}}(a[b]);break;default:a[b]=a[a[b]]}return a}([function(a,b,c){(function(b){b.vimond||(b.vimond={}),a.exports=b.vimond.player=c(1)}).call(b,function(){return this}())},function(a,b,c){(function(b){"use strict";var d=c(3),e=c(5),f=c(17),g=c(81),h=c(178),i=c(148),j=c(183),k=c(185),l=(c(180),c(186)),m=c(7),n=c(187),o=c(188),p=c(4),q=c(23);q.stopUnhandledRejectionTracking();var r={configure:function(a){e.setGlobalConfiguration(a)},getQueryParametersAsObject:function(){return m.queryStringToObject(window.location.search)},getRestClient:function(){},setLogging:function(a){d.configureLogging(a)},insert:function(a,c,n,o){var r;try{var s=m.combine(b,o,!0),t=e.instantiate(s,n);this.configure(t),p.useDefaults(),d.configureLogging(t.getConfiguration().logging),r=p.get("player"),t.buildEmbedContext(navigator.userAgent),r.debug("Player inserted with these arguments:",a,c,n,o),r.debug("Applied configuration after merging:",t.getConfiguration()),r.debug("The following embed context is assembled:",t.getEmbedContext());var u=c;if("string"==typeof c&&(c=document.getElementById(c)),!(c instanceof HTMLElement))return r.error("Couldn't insert player.",u),q.reject("The specified HTML container was not found or valid.",u);var v;n&&n.videoElement&&(v=n.videoElement,"string"==typeof n.videoElement&&(v=document.getElementById(n.videoElement)),v instanceof HTMLElement||(r.error("Cannot find supplied video element.",n.videoElement),v=null));var w=j.instantiate(c,t,v),x=new k(t),y={id:w.id,appContainer:w,model:{configuration:t,trackerManager:new f},wait:w.showWaitingIndicator,finished:w.hideWaitingIndicator,api:x};x.registerSizeClassNamesRefresher(w.refreshClassNamesFromWidthRules);var z=function(a,b,c){h.init(y,a,b,c)};z.types={fatal:"fatal",retryable:"retryable",info:"info",picnic:"picnic"},y.appContainer.showMessage=z;
var A=[],B=function(){if(y.cleanupCurrentState){try{y.cleanupCurrentState(),r.debug("Cleaned up running playback state.")}catch(a){r.error("Attempting to cleanup current state before starting new session, but failed.",a)}y.cleanupCurrentState=null}A.forEach(function(a){a.isCancelled=!0,r.debug("Cancelling session start found in history.",a)})},C=function(a){y.wait(),B();try{var b={number:A.length+1,isCancelled:!1,time:new Date,start:a};return A.push(b),y.appContainer.clear(),q(g.init(y,a,b))}catch(a){return q.reject(a)}},D=function(){B(),w.remove()};x.registerPlaybackChanger(C),x.registerRemover(D),x.registerStarter(function(){i(y)}),y.appContainer.appModel.changePlayback=C,y.appContainer.appModel.exit=x.invokeExitRequest,y.appContainer.appModel.adError=x.handleAdError,y.appContainer.startSession=C;var E=t.getConfiguration().sessionControl;if(E&&E.enabled){var F=function(){B(),z("userKicked",z.types.fatal)};y.model.sessionControlService=new l(t.getConfiguration().rest,F,E.interval)}return y.model.trackerManager.attach(y).then(function(){return C(a)}).then(function(){return x.exposed},function(a){r.error("Player startup failed.",a);try{var b="startupError";z(b,z.types.fatal)}catch(a){c.innerHTML="<p>Player insertion failed.</p>"}throw a})}catch(a){return r&&r.error("Error during player initialization.",a),q.reject(a)}},version:{sdk:n.version,playerbuild:o.version}};a.exports=r}).call(b,c(2))},function(a,b,c){!(a.exports={appName:"iflix HTML Player",rest:{enableFallbackStreams:!0,resourceParameters:{asset:{},category:{}},apiServer:"https://apiproxy-stage-iflix.vimondtv.com"},deviceId:{enabled:!0},streamingProfiles:{mpd:{platform:"my-web",protocol:"DASH",supportsLive:!0,drmTypes:["com.widevine.alpha"]},unknown:{platform:"my-web",supportsLive:!1,drmTypes:[]}},subtitles:{loadSubtitlesForAsset:!0,ttmlParsingRequired:!0,allowTimeCodesWithDotFrameSeparator:!1,defaultFramerate:25},contexts:[{match:"Chrome",canplay:{mpd:"dash"},supportsAutoplay:!0,platform:"my-web"},{match:".*",canplay:{unknown:"html"},supportsAutoplay:!0,platform:"my-web"}],autoAdvance:{countdown:15,enableEndPoster:!1,enableOverlay:!1},loadMetadataForPoster:!0,applyLocalStyleReset:!1,enableCssWaitingIndicator:!0,useRewindFastForwardControls:!1,disableExitFullscreenOnContentEnd:!0,tracking:{enableLiveTracking:!0,resume:{libraryUrl:"vimond-followme-rockery-1.2.10.js",tenant:"vimond",baseUrl:""}},dash:{manifestModifier:{bigIntegersFixPolicy:"default"},dashjs:{libraryUrl:"dash.js/1.4.0-dev-vimond/dash.debug.js",config:{logToBrowserConsole:!1}},shaka:{libraryUrl:"shaka/shaka-player.compiled.js",logLevel:"ERROR",domClassName:"vimond-player",enableWithCredentialsOnHTTPAndMatchedCookie:!1,enableWithCredentialsOnHTTPAndMatchedCookieRegExpString:"(^|;)\\s*userId=",enableWithCredentialsOnHTTPAndMatchedCookieRegExpOption:""},dashImpl:"dashjs"},keyboardShortcuts:{scope:"document",reserveEscapeDuringFullscreen:!0,playback:{playpause:[32],fullscreen:[70],exit:[27]}},html:{playerControls:{enabled:!0},adOverlay:{enabled:!1},userActivityZones:".vimond-player-close-button, .vimond-player-bottom-controls"},settingsStoragePolicy:{audioLanguage:{policy:"persistent"},subtitlesLanguage:{policy:"persistent",defaultValue:"en"},volume:{policy:"session",defaultValue:.8}},logging:{global:"ERROR"}})},function(a,b,c){"use strict";function d(a){return a&&e[a]}var e=c(4);a.exports={configureLogging:function(a){if(a){e.setLevel(d(a.global)||e.OFF);for(var b in a.modules)a.modules.hasOwnProperty(b)&&e.setLevel(d(a.modules[b])||e.INFO)}}}},function(a,b,c){var d,e;!function(f){"use strict";var g={};g.VERSION="1.3.0";var h,i={},j=function(a,b){return function(){return b.apply(a,arguments)}},k=function(){var a,b,c=arguments,d=c[0];for(b=1;b<c.length;b++)for(a in c[b])a in d||!c[b].hasOwnProperty(a)||(d[a]=c[b][a]);return d},l=function(a,b){return{value:a,name:b}};g.DEBUG=l(1,"DEBUG"),g.INFO=l(2,"INFO"),g.TIME=l(3,"TIME"),g.WARN=l(4,"WARN"),g.ERROR=l(8,"ERROR"),g.OFF=l(99,"OFF");var m=function(a){this.context=a,this.setLevel(a.filterLevel),this.log=this.info};m.prototype={setLevel:function(a){a&&"value"in a&&(this.context.filterLevel=a)},enabledFor:function(a){var b=this.context.filterLevel;return a.value>=b.value},debug:function(){this.invoke(g.DEBUG,arguments)},info:function(){this.invoke(g.INFO,arguments)},warn:function(){this.invoke(g.WARN,arguments)},error:function(){this.invoke(g.ERROR,arguments)},time:function(a){"string"==typeof a&&a.length>0&&this.invoke(g.TIME,[a,"start"])},timeEnd:function(a){"string"==typeof a&&a.length>0&&this.invoke(g.TIME,[a,"end"])},invoke:function(a,b){h&&this.enabledFor(a)&&h(b,k({level:a},this.context))}};var n=new m({filterLevel:g.OFF});!function(){var a=g;a.enabledFor=j(n,n.enabledFor),a.debug=j(n,n.debug),a.time=j(n,n.time),a.timeEnd=j(n,n.timeEnd),a.info=j(n,n.info),a.warn=j(n,n.warn),a.error=j(n,n.error),a.log=a.info}(),g.setHandler=function(a){h=a},g.setLevel=function(a){n.setLevel(a);for(var b in i)i.hasOwnProperty(b)&&i[b].setLevel(a)},g.get=function(a){return i[a]||(i[a]=new m(k({name:a},n.context)))},g.createDefaultHandler=function(a){a=a||{},a.formatter=a.formatter||function(a,b){b.name&&a.unshift("["+b.name+"]")};var b={},c=function(a,b){Function.prototype.apply.call(a,console,b)};return"undefined"==typeof console?function(){}:function(d,e){d=Array.prototype.slice.call(d);var f,h=console.log;e.level===g.TIME?(f=(e.name?"["+e.name+"] ":"")+d[0],"start"===d[1]?console.time?console.time(f):b[f]=(new Date).getTime():console.timeEnd?console.timeEnd(f):c(h,[f+": "+((new Date).getTime()-b[f])+"ms"])):(e.level===g.WARN&&console.warn?h=console.warn:e.level===g.ERROR&&console.error?h=console.error:e.level===g.INFO&&console.info&&(h=console.info),a.formatter(d,e),c(h,d))}},g.useDefaults=function(a){g.setLevel(a&&a.defaultLevel||g.DEBUG),g.setHandler(g.createDefaultHandler(a))},d=g,e="function"==typeof d?d.call(b,c,b,a):d,!(void 0!==e&&(a.exports=e))}(this)},function(a,b,c){"use strict";function d(){if(null!==j)throw new Error("Cannot instantiate more than one SingletonWrapper, use SingletonWrapper.getInstance()");this.initialize()}function e(a,b){return Object.getOwnPropertyNames(a).map(function(c){return{name:c,streamSetup:b[c],implementation:a[c]}})}function f(a,b){var c;b=b||{},a=h.combine(g,a||d.getInstance().configuration,!0);var f=b.resourcePath||a.resourcePath,j=b.libraryPath||a.libraryPath;return{getConfiguration:function(){return a},getOptions:function(){return b},mergeOptions:function(a){b=h.combine(b,a)},setOptions:function(a){b=a},get:function(c){return b[c]||a[c]},buildEmbedContext:function(d){if(a.streamingProfiles&&a.contexts){if(b.overrideMapping)throw"Fix overrideMapping";for(var f=a.contexts,g=0;g<f.length;g++){var i=f[g],j=new RegExp(i.match);if(j.test(d)){var k={profiles:e(i.canplay,a.streamingProfiles)};return c=h.combine(i,k)}}}},getEmbedContext:function(){return c},buildResourceUrl:i(h.completeUrl,f),getResourceUrl:function(c){return h.completeUrl(f,b[c]||a[c])},getLibraryUrl:function(a){return h.completeUrl(j,a)},getLibraryUrlFromConfig:function(b){return h.completeUrl(j,h.getPropertyByPath(a,b))},getRecommendationsUrlPattern:function(){return b.recommendationsUrl||a.feedUrlPatterns&&a.feedUrlPatterns.recommendations}}}var g=c(6),h=c(7),i=c(11),j=null;d.prototype={initialize:function(){this.configuration={}}},d.getInstance=function(){return null===j&&(j=new d),j},a.exports={getGlobalConfiguration:function(){return d.getInstance().configuration},setGlobalConfiguration:function(a){d.getInstance().configuration=a},instantiate:function(a,b){return new f(a,b)}}},function(a,b){a.exports={framework:{name:"Vimond.Player.HTML",version:"3.1.3"},logging:{global:"ERROR"},streamingProfiles:{empty:{platform:"web",supportsLive:!0,drmTypes:[]}},contexts:[{match:".*",canplay:{empty:"html"},supportsAutoplay:!0}],resourcePath:"resources/",libraryPath:"lib/",rest:{useSsl:!0,enableCentralTimeOffsetRetrieval:!1,enableFallbackStreams:!1},applyBuiltInStyles:!0,applyLocalStyleReset:!0,containerClassName:"vimond-player",className:"vup",userInactivityInterval:2e3,deviceRegistration:{enabled:!1,storageKey:"vupDeviceInfo"},silverlight:{core:{xapUrl:"silverlight/Vimond.Player.Core.xap"}},html:{startStreamUrl:"black.mp4",playerControls:{enabled:!1,prefix:"widgets",notSupported:{controls:/(iPhone|iPod|MSIE 9)/gi,soundtoggle:/(iPhone|iPod|iPad)/gi,volume:/(iPhone|iPod|iPad)/gi}},adOverlay:{enabled:!1,prefix:"adinfo"},startPoster:{template:"basic"}},subtitles:{contentTypeMappings:{ttml:["xml","ttml"],vtt:["vtt"]}}}},function(a,b,c){"use strict";function d(a){var b=null!=a&&a.constructor==={}.constructor;return b}function e(a,b,c){var f={};if(a)for(var g in a)a.hasOwnProperty(g)&&(f[g]=a[g]);if(b)for(var h in b)b.hasOwnProperty(h)&&(c&&d(a[h])&&d(b[h])?f[h]=e(a[h],b[h],c):f[h]=b[h]);return f}function f(a){return a>9?a:"0"+a.toString()}function g(a,b){var c=a.className.split(" ");return c.indexOf(b)!==-1}function h(a,b){if(b.length>0){var c=a.className.split(" "),d=b.split(" ");d.forEach(function(a){c.indexOf(a)===-1&&c.push(a)}),a.className=c.join(" ")}}function i(a,b){if(b.length>0){var c=a.className.split(" "),d=b.split(" ");d.forEach(function(a){var b=c.indexOf(a);b!==-1&&c.splice(b,1)}),a.className=c.join(" ")}}var j=c(8),k="{([a-zA-Z0-9_]*)}",l=function(a){if(a){var b=navigator&&navigator.userAgent.indexOf("MSIE 8")>0&&navigator.userAgent.indexOf("Trident")>0;if(a.getMonth)return a;if(b){var c=a.lastIndexOf("+");if(c>a.length-7)a=a.substring(0,c);else{var d=a.lastIndexOf("-");d>a.length-7&&(a=a.substring(0,d))}return new Date(Date.parse(a.replace(/\-/gi,"/").replace(/T/gi," ").split(".")[0]))}return new Date(a)}};a.exports={queryStringToObject:function(a){var b={};return a.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(a,c,d,e){b[c]="false"!=e&&("true"==e||e)}),b},enforcePrecision:function(a,b){return+a.toFixed(b)},objectToQueryString:function(a,b){var c=[];if(a)for(var d in a)a.hasOwnProperty(d)&&null!=a[d]&&(a[d].noEscape&&null!=a[d].value?c[c.length]=d+"="+a[d].value:c[c.length]=d+"="+encodeURIComponent(a[d]));var e=c.join("&");return e.length>0&&(e=b+e),e},format:function(a,b){var c=a||"";for(var d in b)if(b.hasOwnProperty(d)){var e=new RegExp("{"+d+"}","ig");c=c.replace(e,b[d])}return c},conditionalFormat:function(a,b,c){for(var d=a||"",e=[],f=new RegExp(k,"g"),g=f.exec(a);null!=g;)e.push(g[1]),g=f.exec(a);e.forEach(function(a){var c=new RegExp("({)(([^}])+?)({"+a+"})(.+?)(})","g");if(null!=b[a]){var e=new RegExp("{"+a+"}","g");d=d.match(c)?d.replace(c,"$2"+b[a]+"$5"):d.replace(e,b[a])}else d=d.replace(c,"")});var h=c?d.indexOf("{"):-1;return h!=-1&&d.indexOf("}")>h?"":d},combine:e,completeUrl:function(a,b){return a&&b&&0!==b.indexOf("http")&&0!==b.indexOf("//")?0===b.indexOf("/")&&0!==b.indexOf("http")&&0!==b.indexOf("//")?b:a+b:b},isJson:d,failsafe:function(a,b){try{return a.apply(this,b)}catch(a){return a}},notifyRejection:function(a){return function(a){}},notifyFulfillment:function(a){return function(a){var b=j.defer();return b.fulfill(a),b.promise}},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},addEventListener:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},wrapIn16by9FillContainer:function(a,b){b&&parseInt(b,10)==b&&(b+="px");var c=document.createElement("div");c.style.position="relative",c.style.height="0",c.style.paddingBottom="56.25%",b&&(c.style.paddingTop=b),c.style.border="0",c.style.margin="0";var d=document.createElement("div");return d.style.position="absolute",d.style.width="100%",d.style.height="100%",d.style.left="0",d.style.top="0",d.style.border="0",d.style.margin="0",d.style.padding="0",c.appendChild(d),a.appendChild(c),d},getFullscreenElement:function(){return document.fullScreenElement||document.fullscreenElement||document.webkitFullscreenElement||document.webkitFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement},enterFullscreen:function(a){return a.requestFullscreen?(a.requestFullscreen(),!0):a.mozRequestFullScreen?(a.mozRequestFullScreen(),!0):a.webkitRequestFullscreen?(a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0):a.webkitRequestFullScreen?(a.webkitRequestFullScreen(),!0):!!a.msRequestFullscreen&&(a.msRequestFullscreen(),!0)},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.webkitExitFullScreen?document.webkitExitFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},notifyFullscreenChange:function(a){var b=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];return b.forEach(function(b){document.addEventListener(b,a)}),function(){b.forEach(function(b){document.removeEventListener(b,a)})}},addClass:h,hasClass:g,removeClass:i,promiseScript:function(a,b,c){function d(){return g.reduce(function(a,b){return a?a[b]:null},window)}var e=j.defer(),f=window.setTimeout(function(){e.reject(new Error("Timed out waiting for promise in script dependency "+a))},9e3),g=a.split("."),h=d();if(h)window.clearTimeout(f),c||e.fulfill(h);else{var i=document.createElement("script");i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,k())}:i.onload=function(){k()},i.onerror=function(a){e.reject(new Error("Script loading failed. "+(a&a.message)))};var k=function(){if(!c){window.clearTimeout(f);var b=d();b?e.fulfill(b):e.reject(new Error("Script loaded, but global property '"+a+"' not resolved."))}};i.setAttribute("type","text/javascript"),i.setAttribute("src",b),document.getElementsByTagName("head")[0].appendChild(i)}return e.promise},loadGlobalScript:function(a,b,c){if(c=c||function(){},window[a])c(window[a]);else{var d=document.createElement("script");d.readyState?d.onreadystatechange=function(){"loaded"!=d.readyState&&"complete"!=d.readyState||(d.onreadystatechange=null,e())}:d.onload=function(){e()};var e=function(){window[a]&&c(window[a])};d.setAttribute("type","text/javascript"),d.setAttribute("src",b),document.getElementsByTagName("head")[0].appendChild(d)}},formatTimeFromSeconds:function(a,b){if(a=isNaN(a)?0:Math.round(a),b&&0===a)return"";var c="";a<0&&(c="-",a=-a);var d=a>=86400?Math.floor(a/86400)+".":"",e=a>3600||d?Math.floor(a%86400/3600)+":":"",f=(e&&a%3600<600?"0":"")+Math.floor(a%3600/60)+":",g=(a%60<10?"0":"")+a%60;return c+d+e+f+g},formatDate:function(a){return a=l(a),a.getDate()+"."+(a.getMonth()+1)+"."+a.getFullYear()},saferToDate:l,formatDateAndTime:function(a){return a=l(a),f(a.getDate())+"."+f(a.getMonth()+1)+"."+a.getFullYear()+" "+f(a.getHours())+":"+f(a.getMinutes())},formatTime:function(a){return a=l(a),a?f(a.getHours())+":"+f(a.getMinutes())+":"+f(a.getSeconds()):"00:00:00"},formatInteger:function(a){var b=Math.round(a);return b.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},getEmbedHost:function(){var a=window.top!==window.self;return a&&document.referrer?document.referrer.match(/:\/\/(.[^\/]+)/)[1]:document.location.hostname},getUnusedId:function(a){for(var b=0;document.getElementById(a+b.toString());)b++;return a+b.toString()},getPageUrl:function(a){var b=a.top!==a.self;return b&&a.document.referrer?a.document.referrer:a.document.location.href},generateGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},dateToIsoString:function(a){function b(a){var b=String(a);return 1===b.length&&(b="0"+b),b}return a=a||new Date,a.toISOString?a.toISOString():a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+String((a.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},getPointerPos:function(a,b){var c,d=b.getBoundingClientRect();return c=a.touches&&a.touches.length>0?a.touches[0]:a.changedTouches&&a.changedTouches.length>0?a.changedTouches[0]:a,{x:c.pageX-(d.left+document.body.scrollLeft),y:c.pageY-(d.top+document.body.scrollTop)}},prefixAllClasses:function(a,b,c){return 0===a.length?"":a.split(" ").map(function(a){var d=a.trim();return c&&0===d.indexOf(b)?d:b+"-"+d}).join(" ")},getPropertyByPath:function(a,b){if(b&&b.split){for(var c=a,d=b.split(".");d.length>0;)c=c[d.shift()];if(c===a)return;return c}},zeroPad:f,noop:function(){}}},function(a,b,c){(function(b,c){!function(b){"use strict";"function"==typeof bootstrap?bootstrap("promise",b):a.exports=b()}(function(){"use strict";function a(a){return function(){return X.apply(a,arguments)}}function d(a){return a===Object(a)}function e(a){return"[object StopIteration]"===da(a)||a instanceof T}function f(a,b){if(R&&b.stack&&"object"==typeof a&&null!==a&&a.stack&&a.stack.indexOf(ea)===-1){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);var e=c.join("\n"+ea+"\n");a.stack=g(e)}}function g(a){for(var b=a.split("\n"),c=[],d=0;d<b.length;++d){var e=b[d];j(e)||h(e)||!e||c.push(e)}return c.join("\n")}function h(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function i(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);return d?[d[1],Number(d[2])]:void 0}function j(a){var b=i(a);if(!b)return!1;var c=b[0],d=b[1];return c===S&&d>=U&&d<=ja}function k(){if(R)try{throw new Error}catch(d){var a=d.stack.split("\n"),b=a[0].indexOf("@")>0?a[1]:a[2],c=i(b);if(!c)return;return S=c[0],c[1]}}function l(a,b,c){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",new Error("").stack),a.apply(a,arguments)}}function m(a){return a instanceof q?a:u(a)?D(a):C(a)}function n(){function a(a){b=a,f.source=a,Z(c,function(b,c){m.nextTick(function(){a.promiseDispatch.apply(a,c)})},void 0),c=void 0,d=void 0}var b,c=[],d=[],e=aa(n.prototype),f=aa(q.prototype);if(f.promiseDispatch=function(a,e,f){var g=Y(arguments);c?(c.push(g),"when"===e&&f[1]&&d.push(f[1])):m.nextTick(function(){b.promiseDispatch.apply(b,g)})},f.valueOf=function(){if(c)return f;var a=s(b);return t(a)&&(b=a),a},f.inspect=function(){return b?b.inspect():{state:"pending"}},m.longStackSupport&&R)try{throw new Error}catch(a){f.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return e.promise=f,e.resolve=function(c){b||a(m(c))},e.fulfill=function(c){b||a(C(c))},e.reject=function(c){b||a(B(c))},e.notify=function(a){b||Z(d,function(b,c){m.nextTick(function(){c(a)})},void 0)},e}function o(a){if("function"!=typeof a)throw new TypeError("resolver must be a function.");var b=n();try{a(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}return b.promise}function p(a){return o(function(b,c){for(var d=0,e=a.length;d<e;d++)m(a[d]).then(b,c)})}function q(a,b,c){void 0===b&&(b=function(a){return B(new Error("Promise does not support operation: "+a))}),void 0===c&&(c=function(){return{state:"unknown"}});var d=aa(q.prototype);if(d.promiseDispatch=function(c,e,f){var g;try{g=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(a){g=B(a)}c&&c(g)},d.inspect=c,c){var e=c();"rejected"===e.state&&(d.exception=e.reason),d.valueOf=function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value}}return d}function r(a,b,c,d){return m(a).then(b,c,d)}function s(a){if(t(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function t(a){return a instanceof q}function u(a){return d(a)&&"function"==typeof a.then}function v(a){return t(a)&&"pending"===a.inspect().state}function w(a){return!t(a)||"fulfilled"===a.inspect().state}function x(a){return t(a)&&"rejected"===a.inspect().state}function y(){fa.length=0,ga.length=0,ia||(ia=!0)}function z(a,c){ia&&("object"==typeof b&&"function"==typeof b.emit&&m.nextTick.runAfter(function(){$(ga,a)!==-1&&(b.emit("unhandledRejection",c,a),ha.push(a))}),ga.push(a),c&&"undefined"!=typeof c.stack?fa.push(c.stack):fa.push("(no stack) "+c))}function A(a){if(ia){var c=$(ga,a);c!==-1&&("object"==typeof b&&"function"==typeof b.emit&&m.nextTick.runAfter(function(){var d=$(ha,a);d!==-1&&(b.emit("rejectionHandled",fa[c],a),ha.splice(d,1))}),ga.splice(c,1),fa.splice(c,1))}}function B(a){var b=q({when:function(b){return b&&A(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return z(b,a),b}function C(a){return q({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},delete:function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return ca(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function D(a){var b=n();return m.nextTick(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}}),b.promise}function E(a){return q({isDef:function(){}},function(b,c){return K(a,b,c)},function(){return m(a).inspect()})}function F(a,b,c){return m(a).spread(b,c)}function G(a){return function(){function b(a,b){var g;if("undefined"==typeof StopIteration){try{g=c[a](b)}catch(a){return B(a)}return g.done?m(g.value):r(g.value,d,f)}try{g=c[a](b)}catch(a){return e(a)?m(a.value):B(a)}return r(g,d,f)}var c=a.apply(this,arguments),d=b.bind(b,"next"),f=b.bind(b,"throw");return d()}}function H(a){m.done(m.async(a)())}function I(a){throw new T(a)}function J(a){return function(){return F([this,L(arguments)],function(b,c){return a.apply(b,c)})}}function K(a,b,c){return m(a).dispatch(b,c)}function L(a){return r(a,function(a){var b=0,c=n();return Z(a,function(d,e,f){var g;t(e)&&"fulfilled"===(g=e.inspect()).state?a[f]=g.value:(++b,r(e,function(d){a[f]=d,0===--b&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),0===b&&c.resolve(a),c.promise})}function M(a){if(0===a.length)return m.resolve();var b=m.defer(),c=0;return Z(a,function(d,e,f){function g(a){b.resolve(a)}function h(){c--,0===c&&b.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function i(a){b.notify({index:f,value:a})}var j=a[f];c++,r(j,g,h,i)},void 0),b.promise}function N(a){return r(a,function(a){return a=_(a,m),r(L(_(a,function(a){return r(a,V,V)})),function(){return a})})}function O(a){return m(a).allSettled()}function P(a,b){return m(a).then(void 0,void 0,b)}function Q(a,b){return m(a).nodeify(b)}var R=!1;try{throw new Error}catch(a){R=!!a.stack}var S,T,U=k(),V=function(){},W=function(){function a(){for(var a,b;e.next;)e=e.next,a=e.task,e.task=void 0,b=e.domain,b&&(e.domain=void 0,b.enter()),d(a,b);for(;j.length;)a=j.pop(),d(a);g=!1}function d(b,c){try{b()}catch(b){if(i)throw c&&c.exit(),setTimeout(a,0),c&&c.enter(),b;setTimeout(function(){throw b},0)}c&&c.exit()}var e={task:void 0,next:null},f=e,g=!1,h=void 0,i=!1,j=[];if(W=function(a){f=f.next={task:a,domain:i&&b.domain,next:null},g||(g=!0,h())},"object"==typeof b&&"[object process]"===b.toString()&&b.nextTick)i=!0,h=function(){b.nextTick(a)};else if("function"==typeof c)h="undefined"!=typeof window?c.bind(window,a):function(){c(a)};else if("undefined"!=typeof MessageChannel){var k=new MessageChannel;k.port1.onmessage=function(){h=l,k.port1.onmessage=a,a()};var l=function(){k.port2.postMessage(0)};h=function(){setTimeout(a,0),l()}}else h=function(){setTimeout(a,0)};return W.runAfter=function(a){j.push(a),g||(g=!0,h())},W}(),X=Function.call,Y=a(Array.prototype.slice),Z=a(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length)for(;;){if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),$=a(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),_=a(Array.prototype.map||function(a,b){var c=this,d=[];return Z(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),aa=Object.create||function(a){function b(){}return b.prototype=a,new b},ba=a(Object.prototype.hasOwnProperty),ca=Object.keys||function(a){var b=[];for(var c in a)ba(a,c)&&b.push(c);return b},da=a(Object.prototype.toString);T="undefined"!=typeof ReturnValue?ReturnValue:function(a){this.value=a};var ea="From previous event:";m.resolve=m,m.nextTick=W,m.longStackSupport=!1,"object"==typeof b&&b&&b.env&&b.env.Q_DEBUG&&(m.longStackSupport=!0),m.defer=n,n.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(Y(arguments,1)):a.resolve(c)}},m.Promise=o,m.promise=o,o.race=p,o.all=L,o.reject=B,o.resolve=m,m.passByCopy=function(a){return a},q.prototype.passByCopy=function(){return this},m.join=function(a,b){return m(a).join(b)},q.prototype.join=function(a){return m([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Can't join: not the same: "+a+" "+b)})},m.race=p,q.prototype.race=function(){return this.then(m.race)},m.makePromise=q,q.prototype.toString=function(){return"[object Promise]"},q.prototype.then=function(a,b,c){function d(b){try{return"function"==typeof a?a(b):b}catch(a){return B(a)}}function e(a){if("function"==typeof b){f(a,h);try{return b(a)}catch(a){return B(a)}}return B(a)}function g(a){return"function"==typeof c?c(a):a}var h=this,i=n(),j=!1;return m.nextTick(function(){h.promiseDispatch(function(a){j||(j=!0,i.resolve(d(a)))},"when",[function(a){j||(j=!0,i.resolve(e(a)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=g(a)}catch(a){if(c=!0,!m.onerror)throw a;m.onerror(a)}c||i.notify(b)}]),i.promise},m.tap=function(a,b){return m(a).tap(b)},q.prototype.tap=function(a){return a=m(a),this.then(function(b){return a.fcall(b).thenResolve(b)})},m.when=r,q.prototype.thenResolve=function(a){return this.then(function(){return a})},m.thenResolve=function(a,b){return m(a).thenResolve(b)},q.prototype.thenReject=function(a){return this.then(function(){throw a})},m.thenReject=function(a,b){return m(a).thenReject(b)},m.nearer=s,m.isPromise=t,m.isPromiseAlike=u,m.isPending=v,q.prototype.isPending=function(){return"pending"===this.inspect().state},m.isFulfilled=w,q.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},m.isRejected=x,q.prototype.isRejected=function(){return"rejected"===this.inspect().state};var fa=[],ga=[],ha=[],ia=!0;m.resetUnhandledRejections=y,m.getUnhandledReasons=function(){return fa.slice()},m.stopUnhandledRejectionTracking=function(){y(),ia=!1},y(),m.reject=B,m.fulfill=C,m.master=E,m.spread=F,q.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},m.async=G,m.spawn=H,m.return=I,m.promised=J,m.dispatch=K,q.prototype.dispatch=function(a,b){var c=this,d=n();return m.nextTick(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},m.get=function(a,b){return m(a).dispatch("get",[b])},q.prototype.get=function(a){return this.dispatch("get",[a])},m.set=function(a,b,c){return m(a).dispatch("set",[b,c])},q.prototype.set=function(a,b){return this.dispatch("set",[a,b])},m.del=m.delete=function(a,b){return m(a).dispatch("delete",[b])},q.prototype.del=q.prototype.delete=function(a){return this.dispatch("delete",[a])},m.mapply=m.post=function(a,b,c){return m(a).dispatch("post",[b,c])},q.prototype.mapply=q.prototype.post=function(a,b){return this.dispatch("post",[a,b])},m.send=m.mcall=m.invoke=function(a,b){return m(a).dispatch("post",[b,Y(arguments,2)])},q.prototype.send=q.prototype.mcall=q.prototype.invoke=function(a){return this.dispatch("post",[a,Y(arguments,1)])},m.fapply=function(a,b){return m(a).dispatch("apply",[void 0,b])},q.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},m.try=m.fcall=function(a){return m(a).dispatch("apply",[void 0,Y(arguments,1)])},q.prototype.fcall=function(){return this.dispatch("apply",[void 0,Y(arguments)])},m.fbind=function(a){var b=m(a),c=Y(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(Y(arguments))])}},q.prototype.fbind=function(){var a=this,b=Y(arguments);return function(){return a.dispatch("apply",[this,b.concat(Y(arguments))])}},m.keys=function(a){return m(a).dispatch("keys",[])},q.prototype.keys=function(){return this.dispatch("keys",[])},m.all=L,q.prototype.all=function(){return L(this)},m.any=M,q.prototype.any=function(){return M(this)},m.allResolved=l(N,"allResolved","allSettled"),q.prototype.allResolved=function(){return N(this)},m.allSettled=O,q.prototype.allSettled=function(){return this.then(function(a){return L(_(a,function(a){function b(){return a.inspect()}return a=m(a),a.then(b,b)}))})},m.fail=m.catch=function(a,b){return m(a).then(void 0,b)},q.prototype.fail=q.prototype.catch=function(a){return this.then(void 0,a)},m.progress=P,q.prototype.progress=function(a){return this.then(void 0,void 0,a)},m.fin=m.finally=function(a,b){return m(a).finally(b)},q.prototype.fin=q.prototype.finally=function(a){return a=m(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},m.done=function(a,b,c,d){return m(a).done(b,c,d)},q.prototype.done=function(a,c,d){var e=function(a){m.nextTick(function(){if(f(a,g),!m.onerror)throw a;m.onerror(a)})},g=a||c||d?this.then(a,c,d):this;"object"==typeof b&&b&&b.domain&&(e=b.domain.bind(e)),g.then(void 0,e)},m.timeout=function(a,b,c){return m(a).timeout(b,c)},q.prototype.timeout=function(a,b){var c=n(),d=setTimeout(function(){b&&"string"!=typeof b||(b=new Error(b||"Timed out after "+a+" ms"),b.code="ETIMEDOUT"),c.reject(b)},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},m.delay=function(a,b){return void 0===b&&(b=a,a=void 0),m(a).delay(b)},q.prototype.delay=function(a){return this.then(function(b){var c=n();return setTimeout(function(){c.resolve(b)},a),c.promise})},m.nfapply=function(a,b){return m(a).nfapply(b)},q.prototype.nfapply=function(a){var b=n(),c=Y(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},m.nfcall=function(a){var b=Y(arguments,1);return m(a).nfapply(b)},q.prototype.nfcall=function(){var a=Y(arguments),b=n();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},m.nfbind=m.denodeify=function(a){var b=Y(arguments,1);return function(){var c=b.concat(Y(arguments)),d=n();return c.push(d.makeNodeResolver()),m(a).fapply(c).fail(d.reject),d.promise}},q.prototype.nfbind=q.prototype.denodeify=function(){var a=Y(arguments);return a.unshift(this),m.denodeify.apply(void 0,a)},m.nbind=function(a,b){var c=Y(arguments,2);return function(){function d(){return a.apply(b,arguments)}var e=c.concat(Y(arguments)),f=n();return e.push(f.makeNodeResolver()),m(d).fapply(e).fail(f.reject),f.promise}},q.prototype.nbind=function(){var a=Y(arguments,0);return a.unshift(this),m.nbind.apply(void 0,a)},m.nmapply=m.npost=function(a,b,c){return m(a).npost(b,c)},q.prototype.nmapply=q.prototype.npost=function(a,b){var c=Y(b||[]),d=n();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},m.nsend=m.nmcall=m.ninvoke=function(a,b){var c=Y(arguments,2),d=n();return c.push(d.makeNodeResolver()),m(a).dispatch("post",[b,c]).fail(d.reject),d.promise},q.prototype.nsend=q.prototype.nmcall=q.prototype.ninvoke=function(a){var b=Y(arguments,1),c=n();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},m.nodeify=Q,q.prototype.nodeify=function(a){return a?void this.then(function(b){m.nextTick(function(){a(null,b)})},function(b){m.nextTick(function(){a(b)})}):this},m.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ja=k();return m})}).call(b,c(9),c(10).setImmediate)},function(a,b){function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}function e(a){if(k===setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(b){try{return k.call(null,a,0)}catch(b){
return k.call(this,a,0)}}}function f(a){if(l===clearTimeout)return clearTimeout(a);if((l===d||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(a);try{return l(a)}catch(b){try{return l.call(null,a)}catch(b){return l.call(this,a)}}}function g(){p&&n&&(p=!1,n.length?o=n.concat(o):q=-1,o.length&&h())}function h(){if(!p){var a=e(g);p=!0;for(var b=o.length;b;){for(n=o,o=[];++q<b;)n&&n[q].run();q=-1,b=o.length}n=null,p=!1,f(a)}}function i(a,b){this.fun=a,this.array=b}function j(){}var k,l,m=a.exports={};!function(){try{k="function"==typeof setTimeout?setTimeout:c}catch(a){k=c}try{l="function"==typeof clearTimeout?clearTimeout:d}catch(a){l=d}}();var n,o=[],p=!1,q=-1;m.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];o.push(new i(a,b)),1!==o.length||p||e(h)},i.prototype.run=function(){this.fun.apply(null,this.array)},m.title="browser",m.browser=!0,m.env={},m.argv=[],m.version="",m.versions={},m.on=j,m.addListener=j,m.once=j,m.off=j,m.removeListener=j,m.removeAllListeners=j,m.emit=j,m.binding=function(a){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(a){throw new Error("process.chdir is not supported")},m.umask=function(){return 0}},function(a,b,c){(function(a,d){function e(a,b){this._id=a,this._clearFn=b}var f=c(9).nextTick,g=Function.prototype.apply,h=Array.prototype.slice,i={},j=0;b.setTimeout=function(){return new e(g.call(setTimeout,window,arguments),clearTimeout)},b.setInterval=function(){return new e(g.call(setInterval,window,arguments),clearInterval)},b.clearTimeout=b.clearInterval=function(a){a.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},b.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},b.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},b._unrefActive=b.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},b.setImmediate="function"==typeof a?a:function(a){var c=j++,d=!(arguments.length<2)&&h.call(arguments,1);return i[c]=!0,f(function(){i[c]&&(d?a.apply(null,d):a.call(null),b.clearImmediate(c))}),c},b.clearImmediate="function"==typeof d?d:function(a){delete i[a]}}).call(b,c(10).setImmediate,c(10).clearImmediate)},function(a,b,c){function d(a){var b=g(function(c,d){var g=f(d,b.placeholder);return e(c,a,void 0,d,g)});return b}var e=c(12),f=c(15),g=c(16),h=32,i=d(h);i.placeholder={},a.exports=i},function(a,b,c){function d(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function e(a,b){return a="number"==typeof a||R.test(a)?+a:-1,b=null==b?H:b,a>-1&&a%1==0&&a<b}function f(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]=K,f[++e]=c);return f}function g(a,b,c){for(var d=c.length,e=-1,f=V(a.length-d,0),g=-1,h=b.length,i=Array(h+f);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function h(a,b,c){for(var d=-1,e=c.length,f=-1,g=V(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(var k=f;++h<i;)j[k+h]=b[h];for(;++d<e;)j[k+c[d]]=a[f++];return j}function i(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function j(a,b,c){function d(){var b=this&&this!==v&&this instanceof d?f:a;return b.apply(e?c:this,arguments)}var e=b&w,f=k(a);return d}function k(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=X(a.prototype),d=a.apply(c,b);return s(d)?d:c}}function l(a,b,c){function e(){for(var h=arguments.length,i=h,j=Array(h),k=this&&this!==v&&this instanceof e?g:a,l=e.placeholder;i--;)j[i]=arguments[i];var n=h<3&&j[0]!==l&&j[h-1]!==l?[]:f(j,l);return h-=n.length,h<c?o(a,b,m,l,void 0,j,n,void 0,void 0,c-h):d(k,this,j)}var g=k(a);return e}function m(a,b,c,d,e,i,j,l,n,p){function r(){for(var w=arguments.length,x=w,z=Array(w);x--;)z[x]=arguments[x];if(d&&(z=g(z,d,e)),i&&(z=h(z,i,j)),y||B){var A=r.placeholder,D=f(z,A);if(w-=D.length,w<p)return o(a,b,m,A,c,z,D,l,n,p-w)}var E=t?c:this,G=u?E[a]:a;return l?z=q(z,l):C&&z.length>1&&z.reverse(),s&&n<z.length&&(z.length=n),this&&this!==v&&this instanceof r&&(G=F||k(G)),G.apply(E,z)}var s=b&D,t=b&w,u=b&x,y=b&z,B=b&A,C=b&E,F=u?void 0:k(a);return r}function n(a,b,c,e){function f(){for(var b=-1,i=arguments.length,j=-1,k=e.length,l=Array(k+i),m=this&&this!==v&&this instanceof f?h:a;++j<k;)l[j]=e[j];for(;i--;)l[j++]=arguments[++b];return d(m,g?c:this,l)}var g=b&w,h=k(a);return f}function o(a,b,c,d,e,f,g,h,j,k){var l=b&z,m=h?i(h):void 0,n=l?g:void 0,o=l?void 0:g,p=l?f:void 0,q=l?void 0:f;b|=l?B:C,b&=~(l?C:B),b&y||(b&=~(w|x));var r=c(a,b,e,p,n,q,o,m,j,k);return r.placeholder=d,r}function p(a,b,c,d,e,f,g,h){var i=b&x;if(!i&&"function"!=typeof a)throw new TypeError(F);var k=d?d.length:0;if(k||(b&=~(B|C),d=e=void 0),g=void 0===g?g:V(t(g),0),h=void 0===h?h:t(h),k-=e?e.length:0,b&C){var o=d,p=e;d=e=void 0}var q=[a,b,c,d,e,o,p,f,g,h];if(a=q[0],b=q[1],c=q[2],d=q[3],e=q[4],h=q[9]=null==q[9]?i?0:a.length:V(q[9]-k,0),!h&&b&(z|A)&&(b&=~(z|A)),b&&b!=w)r=b==z||b==A?l(a,b,h):b!=B&&b!=(w|B)||e.length?m.apply(void 0,q):n(a,b,c,d);else var r=j(a,b,c);return r}function q(a,b){for(var c=a.length,d=W(b.length,c),f=i(a);d--;){var g=b[d];a[d]=e(g,c)?f[g]:void 0}return a}function r(a){var b=s(a)?U.call(a):"";return b==L||b==M}function s(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function t(a){if(!a)return 0===a?a:0;if(a=u(a),a===G||a===-G){var b=a<0?-1:1;return b*I}var c=a%1;return a===a?c?a-c:a:0}function u(a){if(s(a)){var b=r(a.valueOf)?a.valueOf():a;a=s(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(N,"");var c=P.test(a);return c||Q.test(a)?S(a.slice(2),c?2:8):O.test(a)?J:+a}var v=c(13),w=1,x=2,y=4,z=8,A=16,B=32,C=64,D=128,E=512,F="Expected a function",G=1/0,H=9007199254740991,I=1.7976931348623157e308,J=NaN,K="__lodash_placeholder__",L="[object Function]",M="[object GeneratorFunction]",N=/^\s+|\s+$/g,O=/^[-+]0x[0-9a-f]+$/i,P=/^0b[01]+$/i,Q=/^0o[0-7]+$/i,R=/^(?:0|[1-9]\d*)$/,S=parseInt,T=Object.prototype,U=T.toString,V=Math.max,W=Math.min,X=function(){function a(){}return function(b){if(s(b)){a.prototype=b;var c=new a;a.prototype=void 0}return c||{}}}();a.exports=p},function(a,b,c){(function(a,c){function d(a){return a&&a.Object===Object?a:null}var e={function:!0,object:!0},f=e[typeof b]&&b&&!b.nodeType?b:void 0,g=e[typeof a]&&a&&!a.nodeType?a:void 0,h=d(f&&g&&"object"==typeof c&&c),i=d(e[typeof self]&&self),j=d(e[typeof window]&&window),k=d(e[typeof this]&&this),l=h||j!==(k&&k.window)&&j||i||k||Function("return this")();a.exports=l}).call(b,c(14)(a),function(){return this}())},function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b){function c(a,b){for(var c=-1,e=a.length,f=-1,g=[];++c<e;)a[c]===b&&(a[c]=d,g[++f]=c);return g}var d="__lodash_placeholder__";a.exports=c},function(a,b){function c(a,b){if("function"!=typeof a)throw new TypeError(d);return b=e(void 0===b?a.length-1:+b||0,0),function(){for(var c=arguments,d=-1,f=e(c.length-b,0),g=Array(f);++d<f;)g[d]=c[b+d];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,c[0],g);case 2:return a.call(this,c[0],c[1],g)}var h=Array(b+1);for(d=-1;++d<b;)h[d]=c[d];return h[b]=g,a.apply(this,h)}}var d="Expected a function",e=Math.max;a.exports=c},function(a,b,c){(function(b){"use strict";function d(){var a=[],c=[];return{attachForPlayback:function(a,d){c=[];var e=b.getPlaybackTrackers(a,d);return e?g.allSettled(e).then(function(a){a.forEach(function(a){"fulfilled"==a.state?c.push(a.value):h.warn("Playback tracker setup failed.",a.reason)})}):g()},updateMetadata:function(b){h.debug("Updating metadata in trackers:",c),a.forEach(function(a){f.failsafe(a.updateMetadata,[b])}),c.forEach(function(a){f.failsafe(a.updateMetadata,[b])})},notifyProgress:function(b){a.forEach(function(a){f.failsafe(a.notifyProgress,[b])}),c.forEach(function(a){f.failsafe(a.notifyProgress,[b])})},attach:function(c){var d=b.getPlayerTrackers(c);return d?g.allSettled(d).then(function(b){b.forEach(function(b){"fulfilled"==b.state?a.push(b.value):h.warn("Player tracker setup failed.",b.reason)})}):g()},notifySessionStart:function(b){h.debug("Notifying session start",b,a),a.forEach(function(a){f.failsafe(a.notifySessionStart,[b])})},notifyEvent:function(b){a.forEach(function(a){f.failsafe(a.notifyEvent,[b])})},getPluginTrackerHandlers:function(b){var c=[];return a.forEach(function(a){var d=f.failsafe(a.getPluginTrackerHandler,[b]);d instanceof Error||c.push(d)}),c},cleanupAfterPlayback:function(b){h.debug("Cleaning up trackers on interrupted playback.",b),a.forEach(function(a){f.failsafe(a.cleanupAfterPlayback,[b])}),c.forEach(function(a){f.failsafe(a.cleanupAfterPlayback,[b])})}}}var e=c(4),f=c(7),g=c(23),h=e.get("trackerManager");a.exports=d}).call(b,c(18))},function(a,b,c){"use strict";var d=c(19);a.exports={getPlaybackTrackers:function(a,b){switch(a.technologyName){case"html":case"dash":return[new d(a,b)];default:return[]}},getPlayerTrackers:function(a){return[]}}},function(a,b,c){"use strict";function d(a,b){var c=b.getOptions(),d=b.getConfiguration(),i=a.videoModel,j=c.tracking&&c.tracking.resume||{},n=d.tracking&&d.tracking.resume||{},o=d.deviceId&&d.deviceId.enabled,p={authorization:j.authorization||n.authorization,tenant:j.tenant||n.tenant,originatorId:j.originatorId||n.originatorId,baseUrl:j.baseUrl||n.baseUrl,eventPostUrl:j.eventPostUrl||n.eventPostUrl,progressUpdaterInterval:j.progressUpdaterInterval||n.progressUpdaterInterval};if(j.kinesis&&(p.kinesis=j.kinesis),!n.libraryUrl)return l.warn("Resume configuration not found, even if resume tracking is included."),k.fail(new Error("Resume configuration not found, even if resume tracking is included."));var q=o?h.getDeviceInfo(d):k();return q.then(function(c){return f.promiseScript("vimond.followme",b.getLibraryUrl(n.libraryUrl)).then(function(h){function j(a){switch(a.event){case m.bufferingEnded:E=!0;break;case m.mainContentStarted:case m.streamFailover:o();break;case m.playlistEntryEnded:q(!0);break;case m.streamError:q(!1)}}function k(a){if(B&&a&&a.asset&&!a.asset.live||B&&a&&a.asset&&a.asset.live&&d.tracking&&d.tracking.enableLiveTracking){w=a.asset.id+": "+a.asset.title;var b=a.asset.getList("externalAssets"),c=b.length>0&&b[0].externalId,g=f.saferToDate(a.playback.encoderStartTime||a.asset.liveBroadcastTime),h=e.compileStreamUrl(a.streamItem),i=a.streamItem.license&&(a.streamItem.license["@uri"]||a.streamItem.license.uri)||"",j=i.indexOf("wvmodular")>0?"widevine":0===i.length?"none":"playready";u=B.applyMetadataState(a.asset.id,a.asset.title,a.category.id,a.category.title,c,g,a.streamItem.mediaFormat,a.streamItem.scheme,h,j),l.debug("Event service tracking prepared with metadata",a)}else u=null,l.debug("Event service tracking not prepared.",a)}function o(){u?(v&&l.warn("Attempting to start already started event reporting."),v=window.setInterval(function(){t()},C),t("str-start",!1)):l.debug("startEventReporting called too early.")}function q(a){window.clearInterval(v),u&&(a?t("end",!0):t("end",!1),u=null)}function r(a){return function(){l.warn(a+" still called after closedown.",arguments)}}function s(){l.debug("Clearing everything."),q(),j=r("notifyProgress"),k=r("updateMetadata"),t=r("reportEvent"),o=r("startEventReporting"),q=r("stopEventReporting")}function t(a,b){D&&!a?l.debug("Periodic resume tracking paused for asset/time:",w,i.position):i.position>0?(l.debug("Resume tracking for type/asset/time:",a||"period",w,i.position),u.logEvent(a,b?i.duration:i.position,i.duration,F,i.isPaused?"pause":"inactive"===i.playState?"stop":"playing")):l.debug("Blocked resume tracking for position 0 or negative.",a||"period",w),E&&(D!==i.isPaused&&l.debug("Toggling pause state for resume tracking into:",i.isPaused),D=i.isPaused)}var u,v,w,x=a.instance.implementationApi&&a.instance.implementationApi.getVersion&&a.instance.implementationApi.getVersion()||"",y=p.authorization&&p.tenant,z=h.getService(p),A=h.getSession(p),B=y&&new g(p,z,A).applyEnvironment(a.technologyName,x,d.framework.name,d.framework.version,b.getEmbedContext().platform,c?c.udid:void 0),C=n.interval||1e4,D=!1,E=!1;y||l.warn("Event service tracking not enabled. Missing config details or video implementation?",p);var F="",G=[];return i.observe("textTracks",function(a){Array.isArray(a)&&a.forEach(function(a,b){G[b]=a,G[b].observe("isVisible",function(a){F="",a&&(F=G[b].label),l.debug("setting subtitle",F)})})}),{updateMetadata:y?k:f.noop,notifyProgress:y?j:f.noop,cleanupAfterPlayback:s,isActive:function(){return y}}})})}var e=c(20),f=c(7),g=c(21),h=c(22),i=c(4),j=c(24),k=c(23),l=i.get("resumeTracker"),m=j.scheduleEventTypes;a.exports=d},function(a,b,c){var d,e;d=[],e=function(){return{extractFirstId:function(a){if(parseInt(a,10).toString()==a.toString())return a;a.indexOf&&a.indexOf("/api")>0&&(a=a.substring(a.indexOf("/api")));var b=/\/(\d+)/,c=a.match(b);return c.length>1?c[1]:""},compileStreamUrl:function(a){return a?a.url.indexOf("://")<0&&0===a.base.indexOf("rtmp")?a.base+"/"+a.url:a.url:null}}}.apply(b,d),!(void 0!==e&&(a.exports=e))},function(a,b,c){"use strict";function d(a,b,c){function d(d,h,i,j,k,l){function m(m,n,o,p,q,r,s,t,u,v){function w(w,x,y,z,A){try{x=x||0,y=y||0;var B=new Date,C=new Date;B.setTime(r.getTime()+1e3*x),C.setTime(r.getTime()+1e3*y),w=w||"period";var D={eventName:"player_log_event",originator:"player",versions:["1.0"],originatorId:a.originatorId,tenant:a.tenant,ssoToken:f,client:{isLive:"true",clientDate:e.dateToIsoString(),playerEvent:w,playerState:A,userAgent:window.navigator.userAgent,"env.platform":d,"env.version":h,buildVersion:j,buildName:i,platform:k,pageurl:e.getPageUrl(window),"video.format":s,"video.protocol":t,streamUrl:u,subtitle:z,drm:v,viewingSession:c.getCurrentViewingSessionId(),deviceId:l},progress:{playbackType:"vod",liveResumePossible:!1,title:n,assetId:m,externalId:q,category:{name:p,id:o},offset:{duration:Math.round(1e3*y),pos:Math.round(1e3*x)},enc:{unit:"date",start:e.dateToIsoString(r),end:e.dateToIsoString(C),pos:e.dateToIsoString(B)}}};return b.postEvent("player-events",D).then(function(a){g.debug("Event successfully posted",D,a)},function(a){g.error("Event posting failed",D,a)}).fail(function(a){g.error("Event posting failed",D,a)})}catch(a){g.error("Event posting failed",a)}}return c.registerNewPlayback(),{logEvent:w}}return c.registerCollectedDeviceId(l),{applyMetadataState:m}}var f=a.authorization&&a.authorization.substring(a.authorization.indexOf(" ")+1);return{applyEnvironment:d}}var e=c(7),f=c(4),g=f.get("resumeService");a.exports=d},function(a,b,c){"use strict";function d(){for(var a,b=navigator.userAgent,c=0;c<j.length;c++)if(j[c].match.test(b)){a=j[c].name;break}if(!a)return(navigator.vendor||navigator.product)+l+(navigator.oscpu||navigator.platform);for(var d=0;d<k.length;d++)if(k[d].match.test(b))return a+=l+k[d].name}function e(a){var b=a.deviceId&&a.deviceId.storageKey;try{var c=window.localStorage.getItem(b);if(c){var e;try{e=JSON.parse(c)}catch(a){i.warn("Found unparseable data in local storage.")}if(e&&e.udid&&e.label)return i.debug("Using device info found in local storage.",e),h(e)}}catch(a){i.warn("Failed getting device id from local storage.")}var g={udid:f.generateGuid(),label:d()};try{window.localStorage.setItem(b,JSON.stringify(g))}catch(a){i.warn("Failed storing device id to local storage.")}return i.debug("No device info found in storage, generating new one.",g),h(g)}var f=c(7),g=c(4),h=c(23),i=g.get("deviceIdService"),j=[{match:/Android.*Chrome/i,name:"Google Chrome Android"},{match:/Chrome/i,name:"Google Chrome"},{match:/Firefox/i,name:"Firefox"},{match:/Safari/i,name:"Safari"},{match:/MSIE/i,name:"Internet Explorer"}],k=[{match:/Android/i,name:"Android"},{match:/OS X/i,name:"Mac OS X"},{match:/iPad/i,name:"iPad"},{match:/iPhone/i,name:"iPhone"},{match:/iPod/i,name:"iPod"},{match:/Windows/i,name:"Windows"},{match:/Linux/i,name:"Linux"}],l=", ";a.exports={getDeviceInfo:e}},function(a,b,c){(function(b,c){!function(b){"function"==typeof bootstrap?bootstrap("promise",b):a.exports=b()}(function(){"use strict";function a(a){var b=Function.call;return function(){return b.apply(a,arguments)}}function d(a){return a===Object(a)}function e(a){return"[object StopIteration]"===ta(a)||a instanceof ia}function f(a,b){if(ga&&b.stack&&"object"==typeof a&&null!==a&&a.stack&&a.stack.indexOf(va)===-1){for(var c=[],d=b;d;d=d.source)d.stack&&c.unshift(d.stack);c.unshift(a.stack);var e=c.join("\n"+va+"\n");a.stack=g(e)}}function g(a){for(var b=a.split("\n"),c=[],d=0;d<b.length;++d){var e=b[d];j(e)||h(e)||!e||c.push(e)}return c.join("\n")}function h(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function i(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);return d?[d[1],Number(d[2])]:void 0}function j(a){var b=i(a);if(!b)return!1;var c=b[0],d=b[1];return c===ha&&d>=ja&&d<=Ba}function k(){if(ga)try{throw new Error}catch(d){var a=d.stack.split("\n"),b=a[0].indexOf("@")>0?a[1]:a[2],c=i(b);if(!c)return;return ha=c[0],c[1]}}function l(a,b,c){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(b+" is deprecated, use "+c+" instead.",new Error("").stack),a.apply(a,arguments)}}function m(a){return D(a)}function n(){function a(a){b=a,f.source=a,na(c,function(b,c){la(function(){a.promiseDispatch.apply(a,c)})},void 0),c=void 0,d=void 0}var b,c=[],d=[],e=qa(n.prototype),f=qa(p.prototype);if(f.promiseDispatch=function(a,e,f){var g=ma(arguments);c?(c.push(g),"when"===e&&f[1]&&d.push(f[1])):la(function(){b.promiseDispatch.apply(b,g)})},f.valueOf=l(function(){if(c)return f;var a=q(b);return r(a)&&(b=a),a},"valueOf","inspect"),f.inspect=function(){return b?b.inspect():{state:"pending"}},m.longStackSupport&&ga)try{throw new Error}catch(a){f.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return e.promise=f,e.resolve=function(c){b||a(D(c))},e.fulfill=function(c){b||a(C(c))},e.reject=function(c){b||a(B(c))},e.notify=function(a){b||na(d,function(b,c){la(function(){c(a)})},void 0)},e}function o(a){if("function"!=typeof a)throw new TypeError("resolver must be a function.");var b=n();return Q(a,b.resolve,b.reject,b.notify).fail(b.reject),b.promise}function p(a,b,c){void 0===b&&(b=function(a){return B(new Error("Promise does not support operation: "+a))}),void 0===c&&(c=function(){return{state:"unknown"}});var d=qa(p.prototype);if(d.promiseDispatch=function(c,e,f){var g;try{g=a[e]?a[e].apply(d,f):b.call(d,e,f)}catch(a){g=B(a)}c&&c(g)},d.inspect=c,c){var e=c();"rejected"===e.state&&(d.exception=e.reason),d.valueOf=l(function(){var a=c();return"pending"===a.state||"rejected"===a.state?d:a.value})}return d}function q(a){if(r(a)){var b=a.inspect();if("fulfilled"===b.state)return b.value}return a}function r(a){return d(a)&&"function"==typeof a.promiseDispatch&&"function"==typeof a.inspect}function s(a){return d(a)&&"function"==typeof a.then}function t(a){return r(a)&&"pending"===a.inspect().state}function u(a){return!r(a)||"fulfilled"===a.inspect().state}function v(a){return r(a)&&"rejected"===a.inspect().state}function w(){ya||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",wa),ya=!0}function x(){for(var a=0;a<wa.length;a++){var b=wa[a];b&&"undefined"!=typeof b.stack?console.warn("Unhandled rejection reason:",b.stack):console.warn("Unhandled rejection reason (no stack):",b)}}function y(){wa.length=0,xa.length=0,ya=!1,za||(za=!0,"undefined"!=typeof b&&b.on&&b.on("exit",x))}function z(a,b){za&&(xa.push(a),wa.push(b),w())}function A(a){if(za){var b=oa(xa,a);b!==-1&&(xa.splice(b,1),wa.splice(b,1))}}function B(a){var b=p({when:function(b){return b&&A(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return z(b,a),b}function C(a){return p({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},delete:function(b){delete a[b]},post:function(b,c){return null===b||void 0===b?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return sa(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function D(a){return r(a)?a:s(a)?E(a):C(a)}function E(a){var b=n();return la(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}}),b.promise}function F(a){return p({isDef:function(){}},function(b,c){return M(a,b,c)},function(){return D(a).inspect()})}function G(a,b,c,d){return m(a).then(b,c,d)}function H(a,b,c){return G(a,function(a){return S(a).then(function(a){return b.apply(void 0,a)},c)},c)}function I(a){return function(){function b(a,b){var g;if(ua){try{g=c[a](b)}catch(a){return B(a)}return g.done?g.value:G(g.value,d,f)}try{g=c[a](b)}catch(a){return e(a)?a.value:B(a)}return G(g,d,f)}var c=a.apply(this,arguments),d=b.bind(b,"send"),f=b.bind(b,"throw");return d()}}function J(a){m.done(m.async(a)())}function K(a){throw new ia(a)}function L(a){return function(){return H([this,S(arguments)],function(b,c){return a.apply(b,c)})}}function M(a,b,c){var d=n();return la(function(){D(a).promiseDispatch(d.resolve,b,c)}),d.promise}function N(a){return function(b){var c=ma(arguments,1);return M(b,a,c)}}function O(a,b){var c=ma(arguments,2);return Aa(a,b,c)}function P(a,b){return M(a,"apply",[void 0,b])}function Q(a){var b=ma(arguments,1);return P(a,b)}function R(a){var b=ma(arguments,1);return function(){var c=b.concat(ma(arguments));return M(a,"apply",[this,c])}}function S(a){return G(a,function(a){var b=0,c=n();return na(a,function(d,e,f){var g;r(e)&&"fulfilled"===(g=e.inspect()).state?a[f]=g.value:(++b,G(e,function(d){a[f]=d,0===--b&&c.resolve(a)},c.reject))},void 0),0===b&&c.resolve(a),c.promise})}function T(a){return G(a,function(a){return a=pa(a,D),G(S(pa(a,function(a){return G(a,ka,ka)})),function(){return a})})}function U(a){return G(a,function(a){return S(pa(a,function(b,c){return G(b,function(b){return a[c]={state:"fulfilled",value:b},a[c]},function(b){return a[c]={state:"rejected",reason:b},a[c]})})).thenResolve(a)})}function V(a,b){return G(a,void 0,b)}function W(a,b){return G(a,void 0,void 0,b)}function X(a,b){return G(a,function(a){return G(b(),function(){return a})},function(a){return G(b(),function(){return B(a)})})}function Y(a,c,d,e){var g=function(b){la(function(){if(f(b,a),!m.onerror)throw b;m.onerror(b)})},h=c||d||e?G(a,c,d,e):a;"object"==typeof b&&b&&b.domain&&(g=b.domain.bind(g)),V(h,g)}function Z(a,b,c){var d=n(),e=setTimeout(function(){d.reject(new Error(c||"Timed out after "+b+" ms"))},b);return G(a,function(a){clearTimeout(e),d.resolve(a)},function(a){clearTimeout(e),d.reject(a)},d.notify),d.promise}function $(a,b){void 0===b&&(b=a,a=void 0);var c=n();return G(a,void 0,void 0,c.notify),setTimeout(function(){c.resolve(a)},b),c.promise}function _(a,b){var c=ma(b),d=n();return c.push(d.makeNodeResolver()),P(a,c).fail(d.reject),d.promise}function aa(a){var b=ma(arguments,1),c=n();return b.push(c.makeNodeResolver()),P(a,b).fail(c.reject),c.promise}function ba(a){var b=ma(arguments,1);return function(){var c=b.concat(ma(arguments)),d=n();return c.push(d.makeNodeResolver()),P(a,c).fail(d.reject),d.promise}}function ca(a,b){var c=ma(arguments,2);return function(){function d(){return a.apply(b,arguments)}var e=c.concat(ma(arguments)),f=n();return e.push(f.makeNodeResolver()),P(d,e).fail(f.reject),f.promise}}function da(a,b,c){var d=ma(c||[]),e=n();return d.push(e.makeNodeResolver()),Aa(a,b,d).fail(e.reject),e.promise}function ea(a,b){var c=ma(arguments,2),d=n();return c.push(d.makeNodeResolver()),Aa(a,b,c).fail(d.reject),d.promise}function fa(a,b){return b?void a.then(function(a){la(function(){b(null,a)})},function(a){la(function(){b(a)})}):a}var ga=!1;try{throw new Error}catch(a){ga=!!a.stack}var ha,ia,ja=k(),ka=function(){},la=function(){function a(){for(;d.next;){d=d.next;var b=d.task;d.task=void 0;var c=d.domain;c&&(d.domain=void 0,c.enter());try{b()}catch(b){if(h)throw c&&c.exit(),setTimeout(a,0),c&&c.enter(),b;setTimeout(function(){throw b},0)}c&&c.exit()}f=!1}var d={task:void 0,next:null},e=d,f=!1,g=void 0,h=!1;if(la=function(a){e=e.next={task:a,domain:h&&b.domain,next:null},f||(f=!0,g())},"undefined"!=typeof b&&b.nextTick)h=!0,g=function(){b.nextTick(a)};else if("function"==typeof c)g="undefined"!=typeof window?c.bind(window,a):function(){c(a)};else if("undefined"!=typeof MessageChannel&&!navigator.userAgent.indexOf("afari")>=0){var i=new MessageChannel;i.port1.onmessage=a,g=function(){i.port2.postMessage(0)}}else g=function(){setTimeout(a,0)};return la}(),ma=a(Array.prototype.slice),na=a(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(1===arguments.length)for(;;){if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),oa=a(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),pa=a(Array.prototype.map||function(a,b){var c=this,d=[];return na(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),qa=Object.create||function(a){function b(){}return b.prototype=a,new b},ra=a(Object.prototype.hasOwnProperty),sa=Object.keys||function(a){var b=[];for(var c in a)ra(a,c)&&b.push(c);return b},ta=a(Object.prototype.toString);ia="undefined"!=typeof ReturnValue?ReturnValue:function(a){this.value=a};var ua;try{new Function("(function* (){ yield 1; })"),ua=!0}catch(a){ua=!1}var va="From previous event:";m.nextTick=la,m.longStackSupport=!1,m.defer=n,n.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(ma(arguments,1)):a.resolve(c)}},m.promise=o,m.makePromise=p,p.prototype.then=function(a,b,c){function d(b){try{return"function"==typeof a?a(b):b}catch(a){return B(a)}}function e(a){if("function"==typeof b){f(a,h);try{return b(a)}catch(a){return B(a)}}return B(a)}function g(a){return"function"==typeof c?c(a):a}var h=this,i=n(),j=!1;return la(function(){h.promiseDispatch(function(a){j||(j=!0,i.resolve(d(a)))},"when",[function(a){j||(j=!0,i.resolve(e(a)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=g(a)}catch(a){if(c=!0,!m.onerror)throw a;m.onerror(a)}c||i.notify(b)}]),i.promise},p.prototype.thenResolve=function(a){return G(this,function(){return a})},p.prototype.thenReject=function(a){return G(this,function(){throw a})},na(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","mapply","invoke","mcall","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","nmapply","ninvoke","nmcall","nodeify"],function(a,b){p.prototype[b]=function(){return m[b].apply(m,[this].concat(ma(arguments)))}},void 0),p.prototype.toSource=function(){return this.toString()},p.prototype.toString=function(){return"[object Promise]"},m.nearer=q,m.isPromise=r,m.isPromiseAlike=s,m.isPending=t,m.isFulfilled=u,m.isRejected=v;var wa=[],xa=[],ya=!1,za=!0;m.resetUnhandledRejections=y,m.getUnhandledReasons=function(){return wa.slice()},m.stopUnhandledRejectionTracking=function(){y(),"undefined"!=typeof b&&b.on&&b.removeListener("exit",x),za=!1},y(),m.reject=B,m.fulfill=C,m.resolve=D,m.master=F,m.when=G,m.spread=H,m.async=I,m.spawn=J,m.return=K,m.promised=L,m.dispatch=M,m.dispatcher=N,m.get=N("get"),m.set=N("set"),m.delete=m.del=N("delete");var Aa=m.post=N("post");m.mapply=Aa,m.send=O,m.invoke=O,m.mcall=O,m.fapply=P,m.try=Q,m.fcall=Q,m.fbind=R,m.keys=N("keys"),m.all=S,m.allResolved=l(T,"allResolved","allSettled"),m.allSettled=U,m.catch=m.fail=V,m.progress=W,m.finally=m.fin=X,m.done=Y,m.timeout=Z,m.delay=$,m.nfapply=_,m.nfcall=aa,m.nfbind=ba,m.denodeify=m.nfbind,m.nbind=ca,m.npost=da,m.nmapply=da,m.nsend=ea,m.ninvoke=m.nsend,m.nmcall=m.nsend,m.nodeify=fa;var Ba=k();return m})}).call(b,c(9),c(10).setImmediate)},function(a,b,c){"use strict";var d=c(25),e=c(32),f=c(36),g={constructors:f,scheduleEventTypes:e,videoEngineFactory:d};a.exports=g},function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){this.technologyName=a,this.instance=b,this.adInstance=g,this.videoModel=c,this.adVideoModel=d,this.playbackScheduler=e,this.remove=f}function e(a,b){function c(b){var c=a.dash&&a.dash.dashImpl||"dashjs";if(b in k){var d="dash"===b?k[b][c]:k[b];return d.technologyName=b,l(d)}return l.reject(new Error("Found no implementation of the specified technology labeled '"+b+"'."))}function e(a){var b=this;a.length>0&&Object.getOwnPropertyNames(a[0]).forEach(function(c){b[c]=function(){var b=arguments;a.forEach(function(a){"function"==typeof a[c]&&a[c].apply(a[c],b)})}}),this.addUpdater=function(b){a.push(b)}}function f(c,f,k){return k.inserter.applyContext(a).insert(c,f).then(function(c){function f(){return u.stop(),s.unobserve(),o.unobserve&&o.unobserve(),m&&m(),l(c.remove&&c.remove())}var m,o=new k.VideoUpdater(c),p=new e([o]),q=new g(p),r=new h,s=new k.VideoObserver(q,c),t=new i(r),u=new j.PlaybackScheduler(k.getPlaybackScheduler.applyContext(a,{instance:c,streamFailover:b&&b.streamFailover}),t),v=n(q,s,o,p);return m=v.remove,u.setAdEngineAddNotificator(v.onAdEngineAdded),new d(k.technologyName,c,q,r,u,f)})}function m(c,f,k){return k.inserter.applyContext(a).insert(c,f).then(function(f){function m(a){s.setActive(a),r.setActive(!a),x.setActive(a),w.setActive(!a)}function o(){return z.stop(),w.unobserve(),x.unobserve(),r.unobserve&&r.unobserve(),p&&p(),l(f.remove&&f.remove()).then(function(){return l(q.remove&&q.remove())})}var p,q=k.ads.inserter.applyContext(a).insert(c,m),r=new k.VideoUpdater(f),s=new k.ads.VideoUpdater(q.instance),t=new e([r,s]),u=new g(t),v=new h,w=new k.VideoObserver(u,f),x=new k.ads.VideoObserver(u,q.instance),y=new i(v),z=new j.PlaybackScheduler(k.getPlaybackScheduler.applyContext(a,{instance:f,adCuer:q.cuer,streamFailover:b&&b.streamFailover}),y),A=n(u,w,r,t);return p=A.remove,z.setAdEngineAddNotificator(A.onAdEngineAdded),x.setActive(!1),s.setActive(!1),new d(k.technologyName,f,u,v,z,o,q.instance)})}function n(a,b,c,d){function e(a){i.setActive(a),c.setActive(!a),h.setActive(a),b.setActive(!a)}function f(b){h=b.observer,i=b.updater,h.setVideoModel(a),h.setAdActivityNotifier(e),d.addUpdater(i)}function g(){h&&h.unobserve&&h.unobserve(),i&&i.unobserve&&i.unobserve()}var h,i;return{onAdEngineAdded:f,remove:g}}return{create:function(a,b,d){return c(a).then(function(a){return a.ads?m(b,d,a):f(b,d,a)})}}}var f=c(26),g=c(28),h=c(30),i=c(31),j=c(33),k=c(38),l=c(8);a.exports=f(e,"videoEngineFactory")},function(a,b,c){"use strict";function d(a,b){function c(c,d){var f=e.validate(b,c,d);if(!f.isValid)throw f.configuration.isValid||console.error("Configuration didn't validate. Please compare the errors and applied configuration objects:",f.configuration.errors,c),f.dependencies.isValid||console.error("Dependencies didn't validate.  Please compare the errors and applied dependencies objects:",f.dependencies.errors,d),new Error("Dev mode validation of applied context failed. Problems listed in console.");return a(c,d)}return{applyContext:c}}var e=c(27);a.exports=d},function(a,b){"use strict";a.exports={validate:function(){return{isValid:!0,configuration:{isValid:!0,errors:{}},dependencies:{isValid:!0,errors:{}}}}}},function(a,b,c){"use strict";function d(a){e.call(this),this.props=h,this.methods=j,this.constants=i,this.playStates=f,
this.playModes=g,this.playState=f.starting,this.playMode=g.ondemand,this.isAtLivePosition=!1,this.volume=0,this.isMuted=!1,this.isPaused=!1,this.duration=0,this.position=0,this.absolutePosition=new Date(0),this.absoluteStartPosition=new Date(0),this.error=null,this.textTracks=[],this.audioTracks=[],this.isWaitingForUserTap=!1,this.bitrate=0,this.bufferedAhead=0,this.play=a&&a.play,this.pause=a&&a.pause,this.gotoLive=a&&a.gotoLive,this.setPosition=a&&a.setPosition,this.setVolume=a&&a.setVolume,this.setIsMuted=a&&a.setIsMuted,this.capBitrate=a&&a.capBitrate}var e=c(29),f={inactive:"inactive",starting:"starting",waitfortap:"waitfortap",playing:"playing",paused:"paused",seeking:"seeking",buffering:"buffering"},g={ondemand:"ondemand",live:"live",livedvr:"livedvr"},h=Object.freeze({playState:"playState",playMode:"playMode",isAtLivePosition:"isAtLivePosition",volume:"volume",isMuted:"isMuted",duration:"duration",isPaused:"isPaused",position:"position",absolutePosition:"absolutePosition",absoluteStartPosition:"absoluteStartPosition",error:"error",bitrate:"bitrate",textTracks:"textTracks",audioTracks:"audioTracks",bufferedAhead:"bufferedAhead",isWaitingForUserTap:"isWaitingForUserTap"}),i=Object.freeze({props:"props",methods:"methods",playStates:"playStates",playModes:"playModes",constants:"constants"}),j=Object.freeze({play:"play",pause:"pause",gotoLive:"gotoLive",setPosition:"setPosition",setVolume:"setVolume",setIsMuted:"setIsMuted",capBitrate:"capBitrate"});a.exports=d},function(a,b,c){"use strict";var d=c(4),e=d.get("ObservableModel"),f=function(){this.handlers={},this.props={},this.methods={},this.constants={},this.observe=function(a,b){var c=Array.prototype.slice.call(arguments,0,-1);b=Array.prototype.slice.call(arguments,-1)[0],c.forEach(function(a){this.handlers[a]||(this.handlers[a]=[]),this.handlers[a].push(b),b(this[a])},this)},this.unobserve=function(){if(1===arguments.length)delete this.handlers[arguments[0]];else if(arguments.length>1){var a=Array.prototype.slice.call(arguments,0,-1),b=Array.prototype.slice.call(arguments,-1)[0];a.forEach(function(a){if(b&&this.handlers[a]){var c=this.handlers[a].indexOf(b);c>-1&&this.handlers[a].splice(c,1)}},this)}},this.update=function(a,b){var c,d=a.split(".");if(d.length>1&&"feature"===d[0]?(c=this.feature[d[1]],this.feature[d[1]]=b):(c=this[a],this[a]=b),c!==b)try{this.handlers[a]&&this.handlers[a].forEach(function(a){a(b,c)})}catch(a){e.warn("Error during model observer notification",a)}}};a.exports=f},function(a,b,c){"use strict";function d(a){e.call(this),this.props=f,this.constants=g,this.methods=h,this.adCount=0,this.adNumber=0,this.remainingDuration=0,this.isAdsPlaying=!1,this.isAdClicked=!1,this.isAdSkipEnabled=!1,this.scheduleType="",this.url=null,this.isEnteringMidrolls=!1,this.isLeavingMidrolls=!1,this.skipAd=function(){a&&a.skipAd&&a.skipAd()}}var e=c(29),f=Object.freeze({isAdsPlaying:"isAdsPlaying",isAdClicked:"isAdClicked",adCount:"adCount",adsDuration:"adsDuration",adNumber:"adNumber",isAdSkipEnabled:"isAdSkipEnabled",remainingDuration:"remainingDuration",scheduleType:"scheduleType",url:"url",isEnteringMidrolls:"isEnteringMidrolls",isLeavingMidrolls:"isLeavingMidrolls"}),g=Object.freeze({props:"props",methods:"methods",constants:"constants"}),h=Object.freeze({skipAd:"skipAd"});a.exports=d},function(a,b,c){"use strict";function d(a){function b(b){switch(b.event){case e.adStarted:a.update(a.props.isAdClicked,!1);break;case e.mainContentStarted:a.update(a.props.isAdsPlaying,!1),a.update(a.props.isEnteringMidrolls,!1),a.update(a.props.isLeavingMidrolls,!1);break;case e.interstitialStarted:a.update(a.props.isAdsPlaying,!0);break;case e.interstitialEnded:a.update(a.props.isAdsPlaying,!1);break;case e.adEnded:b.ad&&"midroll"===b.ad.type&&b.ad.progress.count===b.ad.progress.number&&(a.update(a.props.isEnteringMidrolls,!1),a.update(a.props.isLeavingMidrolls,!0));break;case e.streamError:a.update(a.props.isAdsPlaying,!1);break;case e.adReady:b.ad&&(a.update(a.props.remainingDuration,b.ad.progress.remainingDuration),a.update(a.props.adCount,b.ad.progress.count),a.update(a.props.adNumber,b.ad.progress.number),a.update(a.props.scheduleType,b.ad.type),a.update(a.props.url,b.ad.data.clickThroughUri)),b.ad&&"midroll"===b.ad.type&&1===b.ad.progress.number&&(a.update(a.props.isEnteringMidrolls,!0),a.update(a.props.isLeavingMidrolls,!1))}}return{notify:b}}var e=c(32);a.exports=d},function(a,b){"use strict";var c={waitingForUserInteraction:"waitingForUserInteraction",playlistStarted:"playlistStarted",playlistEnded:"playlistEnded",playlistEntryStarted:"playlistEntryStarted",playlistEntryEnded:"playlistEntryEnded",mainContentReady:"mainContentReady",mainContentStarted:"mainContentStarted",mainContentInterrupted:"mainContentInterrupted",mainContentResumed:"mainContentResumed",mainContentEnded:"mainContentEnded",interstitialStarted:"interstitialStarted",interstitialEnded:"interstitialEnded",adReady:"adReady",adStarted:"adStarted",adEnded:"adEnded",streamError:"streamError",streamWarning:"streamWarning",streamFailover:"streamFailover",bufferingStarted:"bufferingStarted",bufferingEnded:"bufferingEnded",stopped:"stopped"};a.exports=c},function(a,b,c){"use strict";function d(a,b){return new k.VideoSource(a.url,null,null,null,null,null,null,b.metadata)}function e(a,b,c,d,e){this.event=a,this.position=b||0,this.duration=c||0,this.ad=e,this.error=d}function f(a,b){function c(c,g){function t(a,c,d,f,g){var h=a&&a.event?a:new e(a,c,d,f,g);m.invoke(a,h),R.notify(h),b&&b.notify(h)}function u(a,b,c,d,e){try{switch(a){case p.waitingForTap:t(i.waitingForUserInteraction,b,c);break;case p.bufferingStarted:t(i.bufferingStarted,b,c);break;case p.bufferingEnded:t(i.bufferingEnded,b,c);break;case p.started:K&&(t(i.adStarted,b,c,null,Q),U?h.failsafe(U.getStartTracker()):o.warn("Expected ad trackers to be present on ad start."));break;case p.positioned:K||(L&&(L=!1),M?t(i.mainContentResumed):(t(i.mainContentStarted),M=!0));break;case p.temporalupdate:V&&V.updatePosition(b);break;case p.interrupted:H=b;break;case p.ended:A(b,c);break;case p.failed:F(e,b,c);break;case p.warning:E(e,b,c);break;case p.failover:L=!0,t(i.streamFailover);break;case p.cuepreroll:O=q.preroll,x(b,c);break;case p.cuemidroll:O=q.midroll,x(b,c);break;case p.cuepostroll:O=q.postroll,x(b,c)}}catch(a){o.error("onNotified error",a)}}function v(a,b){return function(c){try{o.debug("onAdScheduleProgress",c.event,K),K||c.event!==i.adReady||(T(),O===q.midroll&&t(i.mainContentInterrupted,a,b),t(i.interstitialStarted),K=!0),t(c)}catch(a){o.error("Ad schedule progress failed.",a)}}}function w(){O=q.midroll,N=!0,T(),K||x()}function x(a,b){g?g.requestAds?g.requestAds(O,a,b).then(function(c){P=c&&c.playItems||[],B(a,b)}).fail(z):g.scheduleAds?g.scheduleAds(O,a,b).then(y,z,v(a,b)).fail(z):o.warn("Ad provider contains no recognized ways of getting or scheduling video ads.",g):(O===q.postroll&&t(i.mainContentEnded,a,b),z())}function y(a){O===q.midroll&&a.resumePosition&&(I=a.resumePosition-H,o.debug("Resume position delivered from ad provider",a)),z()}function z(a){try{g&&o.debug("Resume from ad break.",a);var b=K&&O===q.midroll;K&&t(i.interstitialEnded),N=!1,K=!1,O===q.postroll?(t(i.playlistEntryEnded),t(i.playlistEnded),R.fulfill()):(O===q.preroll&&t(i.mainContentReady),S(b&&I))}catch(a){o.error("Error when resuming from ad break."),R.reject(a)}}function A(a,b){o.debug("On end"),K?N||(t(i.adEnded,a,b,null,Q),U?h.failsafe(U.getCompleteTracker()):o.warn("Expected ad trackers to be present on ad end."),D(),B(a,b)):t(i.mainContentEnded,a,b)}function B(a,b){if(P){o.debug(P.length+" ads left to be played for mode "+O);var c=P.shift();if(c)try{K||(O===q.midroll&&t(i.mainContentInterrupted,a,b),t(i.interstitialStarted)),K=!0;var d=C(c);return t(i.adReady,0,0,null,Q),void T(d)}catch(a){o.error("Error in ad scheduling.",a)}}o.debug("No ad schedule, resuming."),z()}function C(a){var b=d(a,c);return a.tracker&&a.tracker._attach&&(U=a.tracker._attach(),V=new l.PositionNotificator(!1),V.addSubscribers(U.getPositionTrackers()),s=U.getClickTracker()),Q=a.adData,j.currentAdSource=b,b}function D(){U=null,V&&V.stop(),V=null,Q=null,j.currentAdSource=null}function E(a,b,c){t(i.streamWarning,b,c,a)}function F(a,b,c){K?B():(g&&g.stop&&g.stop(),t(i.streamError,b,c,a))}function G(){t(i.playlistStarted),t(i.playlistEntryStarted);var b=a(u,c,J);S=b.resume,k=function(){b.stop(),t(i.stopped),R.fulfill(!1)},j.stop=k,T=b.scheduleAd}var H,I,J,K=!1,L=!1,M=!1,N=!1,O=null,P=[],Q=null,R=n.defer(),S=r,T=r,U=null,V=null;j.currentMainSource=c;try{if(g){J=g.interstitialSetup,I=g.interstitialSetup&&g.interstitialSetup.resumeOffset||0,g.registerInterstitialBreaker&&g.registerInterstitialBreaker(w);try{g.getAdVideoAdapters&&g.getAdVideoAdapters().then(f)}catch(a){o.error("Tried to get ad video adapters, but failed.",a)}}}catch(a){o.error("Could not retrieve interstitial positions.",a)}return window.setTimeout(G,10),R.promise}var f,j=this,k=function(){},m=new g(this,i),r=function(){},s=null;this.schedule=function(a,b){return c(a,b)},this.currentMainSource=null,this.currentAdSource=null,this.addEventListener=m.addEventListener,this.removeEventListener=m.removeEventListener,this.stop=k,this.trackAdClick=function(){try{s&&s()}catch(a){o.error("Ad click track failed.",a)}},this.setAdEngineAddNotificator=function(a){f=a}}var g=c(34),h=c(7),i=c(32),j=c(35),k=c(36),l=c(37),m=c(4),n=c(8),o=m.get("playbackScheduler"),p=j.basicEventTypes,q=j.adModes;a.exports={PlaybackScheduler:f}},function(a,b,c){"use strict";function d(a,b){var c={};return{addEventListener:function(a,d){if(!b[a])throw new Error("The event type "+a+" is not recognized.");null==c[a]&&(c[a]=[]),c[a].push(d)},removeEventListener:function(a,d){if(!b[a])throw new Error("The event type "+a+" is not recognized.");if(null!=c[a]){var e=c[a].indexOf(d);c[a].splice(e,1)}},invoke:function(b,d){if(null!=c[b]){Array.isArray(d)||(d=Array.prototype.slice.call(arguments,[1]));for(var f=0;f<c[b].length;f++)try{c[b][f].apply(a,d||[])}catch(c){e.warn("An event handler for the "+b+" event failed",a,d)}}},eventTypes:b}}var e=c(4).get("eventPublisher");a.exports=d},function(a,b){a.exports={basicEventTypes:{waitingForTap:"waitingForTap",bufferingStarted:"bufferingStarted",bufferingEnded:"bufferingEnded",started:"started",positioned:"positioned",temporalupdate:"temporalupdate",interrupted:"interrupted",seekstarted:"seekstarted",seekended:"seekended",ended:"ended",failed:"failed",warning:"warning",failover:"failover",cuepreroll:"cuepreroll",cuemidroll:"cuemidroll",cuepostroll:"cuepostroll"},adModes:{preroll:"preroll",midroll:"midroll",postroll:"postroll"}}},function(a,b){"use strict";function c(a,b,c,d,e,f){this.src=a,this.label=b,this.kind=e||"subtitles",this.language=d,this.contentType=c,this.isDefault=f}function d(){this.alignmentType="",this.trimStart=0,this.trimLength=0}function e(a){this.alignmentType="relativeToStart",this.baseDateTime=a}function f(a){this.alignmentType="relativeToLive",this.centralTimeZoneOffset=a}function g(a){this.alignmentType="timeComponentFromStream",this.centralTimeZoneOffset=a}function h(a,b,c,d,e,f,g,h){this.streamUrl=a,this.startPosition=b||0,this.isLive=c||!1,this.licenseUrl=d,this.fallbackUrls=e,this.tracks=f||[],this.timingModel=g,this.metadata=h}function i(){this.tracker=null,this.url=null,this.duration=0,this.clickThroughUrl=null,this.adData={type:null,data:null,index:0,progress:{number:0,count:0,remainingDuration:0}}}function j(){this.type=null,this.playItems=[]}e.prototype=Object.create(d),e.prototype.constructor=d,f.prototype=Object.create(d),f.prototype.constructor=d,g.prototype=Object.create(d),g.prototype.constructor=d,a.exports={VideoSource:h,Track:c,TimingModel:{Base:d,RelativeToStart:e,RelativeToLive:f,TimeComponentFromStream:g},AdSchedule:j,ScheduledAd:i}},function(a,b,c){"use strict";function d(a,b){this.startPosition=a,this.handler=b}function e(a,b,c){this.startPosition=a,this.endPosition=b,this.handler=c}function f(a){return{startPosition:a.startPosition,endPosition:a.endPosition||a.startPosition+5,isInPosition:!1,isHandled:!1,wasHandled:!1,hasResetPending:!1,handler:a.handler}}function g(a){function b(b){for(var e=[],f=0;f<d.length;f++){var h=d[f];a&&h.isHandled&&!h.hasResetPending&&(h.endPosition+g<b||0!==b&&h.startPosition-g>b)&&(c(h),h.hasResetPending=!0);var j=!(h.isHandled||h.isInPosition);h.isInPosition=h.startPosition<b&&h.endPosition>b,j&&h.isInPosition&&(h.isHandled=!0,e.push(h))}e.forEach(function(a){try{a.handler(a.startPosition,a.wasHandled)}catch(b){i.error("Position subscriber at position "+a.startPosition+" threw an error when handled.",b)}})}function c(a){window.setTimeout(function(){a.isHandled=!1,a.hasResetPending=!1,a.wasHandled=!0,i.debug("Resetting handled state for midroll with cue "+a.startPosition)},2e4)}var d=[],e=!0,g=5;this.addSubscribers=function(a){d=d.concat(a).sort(function(a,b){return a.position-b.position}).map(f)},this.updatePosition=function(a){e&&b(a)},this.stop=function(){e=!1}}var h=c(4),i=h.get("positionNotificator");e.prototype=Object.create(d),e.prototype.constructor=e,a.exports={PositionListener:d,TimeSpanListener:e,PositionNotificator:g}},function(a,b,c){"use strict";var d=c(39),e=c(41),f=c(44),g=c(56),h=c(57),i=c(59),j=c(61),k=c(67),l=c(68),m=c(69),n=c(71),o=c(72),p=c(73),q=c(76),r=c(78),s=c(79);a.exports={html:{inserter:d,VideoUpdater:e.VideoUpdater,VideoObserver:e.VideoObserver,getPlaybackScheduler:f.getPlaybackScheduler},silverlight:{inserter:h,VideoUpdater:i.VideoUpdater,VideoObserver:i.VideoObserver,getPlaybackScheduler:j.getPlaybackScheduler,ads:{inserter:g,VideoUpdater:e.VideoUpdater,VideoObserver:e.VideoObserver}},flash:{inserter:k,VideoUpdater:l.VideoUpdater,VideoObserver:l.VideoObserver,getPlaybackScheduler:m.getPlaybackScheduler,ads:{inserter:g,VideoUpdater:e.VideoUpdater,VideoObserver:e.VideoObserver}},dash:{dashjs:{inserter:q,VideoUpdater:r.VideoUpdater,VideoObserver:r.VideoObserver,getPlaybackScheduler:s.getPlaybackScheduler,ads:{inserter:g,VideoUpdater:e.VideoUpdater,VideoObserver:e.VideoObserver}},shaka:{inserter:n,VideoUpdater:o.VideoUpdater,VideoObserver:o.VideoObserver,getPlaybackScheduler:p.getPlaybackScheduler,ads:{inserter:g,VideoUpdater:e.VideoUpdater,VideoObserver:e.VideoObserver}}}}},function(a,b,c){"use strict";function d(a){function b(b,c){return c||(c=document.createElement("video")),c.removeAttribute("style"),c.setAttribute("autoplay","true"),c.setAttribute("controls","true"),a.html&&a.html.domClassName&&(c.className=a.html.domClassName),b&&b.appendChild(c),window.setTimeout(function(){i.debug("Video element inserted with size: "+c.clientWidth+"x"+c.clientHeight)},800),c}function c(c,g){g=b(c,g),e=g,g.controls=!1;var i={livePresentationDelay:a.html&&a.html.livePresentationDelay};return h(new f("html","HTMLVideoElement",g,g,i,d))}function d(){try{e.pause(),e.src="",e.parentNode.removeChild(e)}catch(a){i.warn("The targeted video element to remove does not exist in DOM",a)}}var e;return{insert:c,remove:d,build:b}}var e=c(26),f=c(40),g=c(4),h=c(8),i=g.get("videoElement");a.exports=e(d,"htmlVideoInserter")},function(a,b){"use strict";function c(a,b,c,d,e,f){this.implementationName=b,this.technologyName=a,this.domElement=c,this.implementationApi=d,this.internals=e,this.remove=f}a.exports=c},function(a,b,c){"use strict";function d(a,b){return a.duration!==1/0?a.duration:a.seekable.length>0?a.seekable.end(0)-a.seekable.start(0)-b:0}function e(a,b){return d(a,b)+(a.seekable.length>0?a.seekable.start(0):0)}function f(a,b){function c(b,c){if(z)return a.update(b,c)}function f(b){x?c(a.props.playState,b||w.ended&&a.playStates.inactive||w.paused&&a.playStates.paused||a.playStates.playing):c(a.props.playState,a.playStates.starting)}function g(){c(a.props.isPaused,w.paused)}function j(){c(a.props.volume,w.volume),c(a.props.isMuted,w.muted)}function n(){var d=w.currentTime,e=null,f=null;if(c(a.props.position,d),w.currentTime>0&&w.getStartDate&&!isNaN(w.getStartDate()))f=w.getStartDate(),e=new Date(f.getTime()+1e3*d),c(a.props.absoluteStartPosition,f),c(a.props.absolutePosition,e);else{var g=b.internals&&b.internals.timingModel;g&&g.baseDateTime&&g.baseDateTime.getTime&&!isNaN(g.baseDateTime.getTime())&&(f=g.baseDateTime,c(a.props.absoluteStartPosition,f),e=new Date(f.getTime()+1e3*d),c(a.props.absolutePosition,e))}}function o(){c(a.props.duration,d(w,y))}function p(){if(w.duration===1/0)try{var b;w.seekable.length>0&&(b=w.seekable.end(0)-w.seekable.start(0)),b&&b!=1/0&&b>m?c(a.props.playMode,a.playModes.livedvr):c(a.props.playMode,a.playModes.live),o()}catch(b){k.warn("Failed to operate on TimeRanges when trying to get video.seekable.end(0)\nRetrying when video reaches readyState === 4."),c(a.props.playMode,a.playModes.live)}else c(a.props.playMode,a.playModes.ondemand)}function q(){c(a.props.isAtLivePosition,w.currentTime>=e(w,y)-l)}function r(){if(c(a.props.textTracks,h.getFromTrackList(w.textTracks)),w.audioTracks&&w.audioTracks.length>0){var b=w.audioTracks,d=Array.prototype.slice.call(b,0),e=d.map(function(a){var c=function(){for(var c=0;c<b.length;c++)b[c].id==a.id?b[c].enabled=!0:b[c].enabled=!1};return new i.AudioTrackSelectionModel(c,a.id,a.kind,a.language,a.label)});c(a.props.audioTracks,e)}}function s(){for(var b=w.currentTime,d=w.buffered,e=0,f=0,g=0;g<d.length;++g)if(d.start(g)<=b&&d.end(g)>=b){e=d.end(g)-b,f=b-d.start(g);break}c(a.props.bufferedAhead,e)}function t(){c("error",w.error)}function u(b){c(a.props.isWaitingForUserTap,b)}function v(){j(),f(),o(),n(),p(),g(),s(),r(),t()}var w=b.implementationApi,x=!1,y=b.internals&&b.internals.livePresentationDelay||0,z=!0,A={abort:function(){},canplay:function(){},canplaythrough:function(){},durationchange:function(){o(),p()},ended:function(){f(a.playStates.inactive),g(),x=!1},error:function(){t(),f(a.playStates.inactive),g()},load:function(){p()},loadeddata:function(){o(),p()},loadedmetadata:function(){o(),n(),r(),p()},loadstart:function(){f(a.playStates.buffering),p(),g()},pause:function(){f(a.playStates.paused),g()},play:function(){f(a.playStates.playing),g(),p()},playing:function(){x=!0,f(a.playStates.playing),g()},progress:function(){},ratechange:function(){},seeked:function(){f(),g()},seeking:function(){f(a.playStates.seeking),g()},stalled:function(){g()},suspend:function(){},timeupdate:function(){n(),p(),q(),s()},volumechange:function(){j()},waiting:function(){f(a.playStates.buffering)},waitingForUserStart:function(){u(!0)},startedByUser:function(){u(!1)}};v(),Object.getOwnPropertyNames(A).forEach(function(a){w.addEventListener(a,A[a])}),w.textTracks&&(w.textTracks.addEventListener("addtrack",function(){r()}),w.textTracks.addEventListener("removetrack",function(){r()})),w.audioTracks&&(w.audioTracks.addEventListener("addtrack",function(){r()}),w.audioTracks.addEventListener("removetrack",function(){r()})),this.setActive=function(a){a!==z&&(z=a,k.debug("Setting HTML video observer "+(a?" active":"inactive")),z&&v())},this.unobserve=function(){Object.getOwnPropertyNames(A).forEach(function(a){w.removeEventListener(a,A[a])})}}function g(a){var b=a.implementationApi,c=b.volume,d=a.internals&&a.internals.livePresentationDelay||0,f=!0;this.play=function(){f&&b.play()},this.pause=function(){f&&b.pause()},this.setPosition=function(a){f&&!isNaN(parseFloat(a))&&isFinite(a)&&(b.currentTime=a)},this.setVolume=function(a){b.muted=0===parseFloat(a),b.volume=a},this.setIsMuted=function(a){a?(c=b.volume,b.volume=0):b.volume=c,b.muted=a},this.gotoLive=function(){f&&(b.currentTime=e(b,d))},this.capBitrate=function(a){},this.setActive=function(a){a!==f&&(k.debug("Setting HTML video updater "+(a?" active":"inactive")),f=a)}}var h=c(42),i=c(43),j=c(4),k=j.get("HtmlVideoModelAdapter"),l=30,m=100;a.exports={VideoUpdater:g,VideoObserver:f}},function(a,b,c){"use strict";function d(a,b,c,d,e,f){g.call(this),this.select=e,this.unselect=f,this.setVisibility=d,this.isVisible=!1,this.kind=a,this.label=c,this.language=b}function e(a,b){function c(a,b){e&&e.update(a,b)}var e,f=function(b){b?a.mode="number"==typeof a.mode?2:"showing":a.mode="number"==typeof a.mode?1:"hidden",c("isVisible",b)},g=function(){b(),f(!0)},h=function(){f(!1)};return e=new d(a.kind,a.language,a.label,f,g,h)}function f(a){function b(){c.forEach(function(a){a.mode="number"==typeof a.mode?1:"hidden"}),d.forEach(function(a){a.update("isVisible",!1)})}var c=[],d=[];if(a)for(var f=0;f<a.length;f++){var g=a[f];"subtitles"!==g.kind&&"captions"!==g.kind||(c.push(g),d.push(e(g,b)))}return d}var g=c(29);a.exports={getFromTrackList:f,SubtitleSelectionModel:d}},function(a,b,c){"use strict";function d(a,b,c,d,f){e.call(this),this.select=a,this.id=b,this.kind=c,this.label=f,this.language=d}var e=c(29);a.exports={AudioTrackSelectionModel:d}},function(a,b,c){"use strict";function d(a,b){var c=e(a,b);return h.getScheduler(c)}function e(a,b){function c(){return t.currentTime}function d(){t.src="",f&&f()}function e(c,d){function e(){if(I=new Date,t.removeEventListener(j.loadedmetadata,e),O>0){if(k||p){t.pause();var a=0,b=window.setInterval(function(){r.debug("iResume."),a>10||t.seekable.length>0&&t.seekable.end(0)>P?(r.debug("Trying to resume."),window.clearInterval(b),l(),t.play()):(a++,r.debug("Resume position not available "+t.seekable.length+"/"+P))},400)}else l();void 0!==F&&(t.controls=F)}else t.duration===1/0&&h&&(N=0,m())}function l(){var a=k?g.enforcePrecision(P,1):P;r.debug("Resuming position "+a),t.currentTime=a,c(s.positioned,a),P=0,E=!0}function m(){t.seekable.length>0?(t.currentTime=t.seekable.end(0)-h,r.debug("Applying live presentation delay",h)):N<10&&(N++,G=window.setTimeout(m,1e3))}function v(){I=new Date,M=!0,c(s.bufferingEnded),t.removeEventListener(j.playing,v),c(s.started),0===O&&c(s.positioned),void 0!==F&&(t.controls=F)}function w(){if(!M)return r.warn("Video element ended before starting. Attempting to recover gracefully."),t.time=O||0,void t.play();r.info("Actual end event, %s seconds after start.",Math.round(((new Date).getTime()-I.getTime())/1e3));var a=c;D(),a(s.ended,K,L,!1),J.fulfill()}function x(){k&&!d.isLive&&t.currentTime>=t.duration?(r.debug("Force ending stream on iOS."),t.pause(),t.src="",w()):(K=t.currentTime,E&&c(s.temporalupdate,t.currentTime,t.duration,t.paused))}function y(){L=t.duration,c(s.temporalupdate,t.currentTime,t.duration,t.paused)}function z(){c(s.seekstarted,t.currentTime,t.duration,t.paused),Q=!0}function A(){Q=!1,c(s.seekended,t.currentTime,t.duration,t.paused)}function B(){a.html.supportsAutoplay||r.warn("Video Error: Check if poster fails for some reason and throws a video error"),r.warn("Video element error",t.error);var b=c;D(),b(s.failed,K,L,!1,t.error)}function C(){if(f&&f(),b.instance.internals&&(b.instance.internals.timingModel=d.timingModel),a.html.enableLicenseAcquisition&&d.licenseUrl)if(window.WebKitMediaKeys&&window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")&&a.html.fairplay&&a.html.fairplay.certificateUrl)var e=d.metadata&&d.metadata.asset&&d.metadata.asset.id||d.metadata&&d.metadata.contentId,g=o.getLicenseAcquirer(window,t,e,{useLicenseUrlFromStream:a.html.fairplay.useLicenseUrlFromStream,licenseUrl:d.licenseUrl,certificateUrl:a.html.fairplay.certificateUrl,contentIdExtractMatch:a.html.fairplay.contentIdExtractMatch});else r.debug("Activating license acquisition for HTML playback."),g=n.getLicenseAcquirer(window,t,{licenseUrl:d.licenseUrl});t.addEventListener(j.playing,v),t.addEventListener(j.ended,w),t.addEventListener(j.error,B),t.addEventListener(j.timeupdate,x),t.addEventListener(j.durationchange,y),t.addEventListener(j.seeking,z),t.addEventListener(j.seeked,A);var h=!!t.src;if(t.src=d.streamUrl,r.info("Stream starting. "+d.streamUrl),u.setTracks(d.tracks),f=D,h||!a.html||a.html.supportsAutoplay!==!1)c(s.bufferingStarted);else{r.debug("Autoplay workaround activated."),i.runInAutoplayEnabledContext(function(){t.play(),t.controls=F;var a=new CustomEvent("startedByUser");t.dispatchEvent(a)}),F=t.controls,t.controls=!0,d.metadata&&d.metadata.posterImageUrl&&(t.poster=d.metadata.posterImageUrl),c(s.waitingForTap);var k=new CustomEvent("waitingForUserStart");t.dispatchEvent(k)}try{t.currentTime=0}catch(a){r.debug("Midroll bug fix was applied, but video element didn't like it.",a)}t.play()}function D(){c=function(){},t.removeEventListener(j.error,B),t.removeEventListener(j.timeupdate,x),t.removeEventListener(j.durationchange,y),t.removeEventListener(j.playing,v),t.removeEventListener(j.ended,w),t.removeEventListener(j.seeking,z),t.removeEventListener(j.seeked,A),H&&H.remove()}var E,F,G,H,I,J=q.defer(),K=0,L=0,M=!1,N=0;try{var O=d.startPosition||0,P=O,Q=!1;t.addEventListener(j.loadedmetadata,e),0===O&&(E=!0),C()}catch(a){r.error("Play startup error",a),J.reject(a)}return J.promise}var f=null,h=b.instance.internals&&b.instance.internals.livePresentationDelay,k=navigator.userAgent.match(/(iPad|iPhone|iPod)/i),p=navigator.userAgent.match(/(Android)/i),t=b.instance.implementationApi,u=new m(t,a.subtitles);return new l.SimpleCuer(e,d,c)}var f=c(26),g=c(7),h=c(45),i=c(46),j=c(47),k=c(35),l=c(48),m=c(49),n=c(54),o=c(55),p=c(4),q=c(8),r=p.get("htmlPlaybackScheduler"),s=k.basicEventTypes;a.exports={getPlaybackScheduler:f(d,"htmlPlaybackScheduler"),getVideoCuer:f(e,"htmlPlaybackScheduler")}},function(a,b,c){"use strict";function d(a,b,c,d){function e(a){return new h.PositionListener(a,d)}this.main={source:a,lastKnownPosition:0,lastKnownDuration:0,startPosition:b},this.isSeeking=!1,this.isSchedulingAds=!1,this.hasInterstitials=c&&Array.isArray(c.positions)&&c.positions.length>0,this.interstitialNotificator=new h.PositionNotificator(!0),this.adProgress=k.preroll,this.isStarted=!1,this.isEnded=!1,this.hasInterstitials&&this.interstitialNotificator.addSubscribers(c.positions.map(e))}function e(a,b){return function(c,e,f){function h(a,b,d,e,f){if(!w.isEnded)if(a===l.ended)r(),c.apply(null,arguments);else switch(c.apply(null,arguments),a){case l.temporalupdate:u(b,d,e);break;case l.seekstarted:w.isSeeking=!0;break;case l.seekended:w.isSeeking=!1;break;case l.failed:v.reject(f)}}function i(){}function n(){w.adProgress=k.preroll,c(l.cuepreroll,w.main.startPosition,0)}function o(d){var e=w.isSchedulingAds;w.isSchedulingAds=!0,w.adProgress!==k.midroll||e||(w.main.startPosition=a.getPosition(),m.debug("Storing start position "+w.main.startPosition),c(l.interrupted,w.main.startPosition,w.lastKnownDuration)),d?a.play(h,d):a.stop(),w.isStarted=!0,b&&b.disable()}function p(c){var d=w.main.startPosition;"number"==typeof c&&0!==c&&(d+=c),m.debug("Scheduling main content from position "+d),a.play(h,g.combine(w.main.source,{startPosition:d})),b&&b.enable(),w.isStarted=!0}function q(a){var b=w.isSchedulingAds;w.isSchedulingAds=!1;var c=w.adProgress;switch(c){case k.preroll:w.adProgress=k.midroll,p();break;case k.midroll:b&&p(a);break;case k.postroll:s()}}function r(){w.isEnded||w.isSchedulingAds||(w.adProgress=k.postroll,c(l.cuepostroll,w.main.lastKnownPosition,w.lastKnownDuration))}function s(){c=function(){},w.isEnded=!0,v.fulfill()}function t(a){c(l.cuemidroll,a,w.main.lastKnownDuration)}function u(a,b,c){w.isEnded||w.isSchedulingAds||w.isSeeking||c||(w.main.lastKnownPosition=a,w.main.lastKnownDuration=b,w.interstitialNotificator.updatePosition(a))}var v=j.defer(),w=new d(e,e.startPosition,f,t);return m.debug("Scheduling "+e.streamUrl+" with start position "+e.startPosition),i(),window.setTimeout(n,10),{promise:v.promise,resume:q,scheduleAd:o,stop:a.stop}}}var f=c(35),g=c(7),h=c(37),i=c(4),j=c(8),k=f.adModes,l=f.basicEventTypes,m=i.get("serialSchedulerHelper");a.exports={getScheduler:e}},function(a,b,c){"use strict";function d(a,b,c){a.src=c,a.play(),a.pause()}function e(a){function b(c){c.preventDefault(),a(),document.body.removeEventListener("touchend",b,!0)}return f.debug("RegistrertAutoplayListener saken."),document.body.addEventListener("touchend",b,!0),{cancel:function(){document.body.removeEventListener("touchend",b,!0)}}}var f=c(4);a.exports={enforceAutoplay:d,runInAutoplayEnabledContext:e}},function(a,b){a.exports={abort:"abort",canplay:"canplay",canplaythrough:"canplaythrough",durationchange:"durationchange",emptied:"emptied",ended:"ended",error:"error",loadeddata:"loadeddata",loadedmetadata:"loadedmetadata",loadstart:"loadstart",pause:"pause",play:"play",playing:"playing",progress:"progress",ratechange:"ratechange",seeked:"seeked",seeking:"seeking",stalled:"stalled",suspend:"suspend",timeupdate:"timeupdate",volumechange:"volumechange",waiting:"waiting"}},function(a,b){"use strict";function c(a,b,c){this.play=a,this.stop=b,this.getPosition=c}function d(a,b,c,d,e){this.play=a,this.interrupt=d,this.resume=e,this.stop=b,this.getPosition=c}d.prototype=Object.create(c),d.prototype.constructor=d,a.exports={SimpleCuer:c,InterruptableMainCuer:d}},function(a,b,c){"use strict";function d(a){return a.kind+"_"+a.language}function e(a,b){function c(b){if(!b.cueData){var c=document.createElement("track");return c.kind=b.kind,c.src=b.src,b.language&&(c.srclang=b.language),b.isDefault&&(c.default=b.isDefault),b.label&&(c.label=b.label),i.debug("Adding track with URL.",b,c),a.appendChild(c),c}var d=a.addTextTrack(b.kind,b.label,b.language);b.cueData.forEach(function(a){d.addCue(new q(a.start,a.end,a.data))}),i.debug("Adding track with cues from parsed file.",b)}function e(a){var b=a.track;return r&&"ttml"===a.type?u.getAndParse("application/ttml+xml",b.src).then(function(a){b.cueData=a,c(b)},function(a){i.error("Fetching, parsing or adding subtitle file failed.",b.src,a)}):void c(b)}function g(a){var b=(a.contentType||"").toLowerCase(),c=!1;t.forEach(function(a){b.indexOf(a)>=0&&(c=!0)});var d=!1;return s.forEach(function(a){b.indexOf(a)>=0&&(d=!0)}),{track:a,type:c?"vtt":d?"ttml":"unknown"}}function k(a){var b={};return a.filter(function(a){return"unknown"!==a.type}).forEach(function(a){var c=d(a.track);b[c]&&"vtt"!==a.type?i.debug("Discarding track of format "+a.type+", because there was an existing or better alternative added.",a.track):b[c]=a}),Object.getOwnPropertyNames(b).map(function(a){return b[a]})}function l(a){if(p=[0],Array.isArray(a))return k(a.map(g)).map(e).reduce(h.when,h())}function m(){var b=0===p.length;if(a.textTracks)for(var c=0;c<a.textTracks.length;c++){var d=a.textTracks[c];b&&(j="number"==typeof d.mode,p[c]=d.mode),d.mode=j?0:"off"}}function n(){if(a.textTracks&&p.length===a.textTracks.length)for(var b=0;b<a.textTracks.length;b++){var c=a.textTracks[b];c.mode=p[b]}p=[]}function o(){}var p=[],q=window.VTTCue||window.TextTrackCue,r=b&&b.ttmlParsingRequired,s=b&&b.contentTypeMappings?b.contentTypeMappings.ttml:["ttml","xml"],t=b&&b.contentTypeMappings?b.contentTypeMappings.vtt:["vtt"],u=r?new f(b):null;return{setTracks:l,disable:m,enable:n,cleanup:o}}var f=c(50),g=c(4),h=c(8),i=g.get("textTrackManager"),j=!1;a.exports=e},function(a,b,c){"use strict";function d(a){function b(b,c){return"application/ttml+xml"===b?e.parse(c,a.allowTimeCodesWithDotFrameSeparator,a.defaultFramerate):c}function c(a,c){return f.fetch(c).then(function(c){return b(a,c)})}function d(a){return f.fetch(a)}this.get=d,this.getAndParse=c}var e=c(51),f=c(52);a.exports=d},function(a,b,c){"use strict";function d(a,b){var c,d,e,f,g,h=/^([0-9]+:){0,2}[0-9]+([.:;][0-9]+)?$/,i="Invalid time format",j=0;return"number"==typeof a?a:("string"!=typeof a||h.test(a)||n.error(i,a),c=a.split(":"),d=c.length-1,e=c[d],4==c.length?(g=c.pop(),d=c.length-1,b&&"number"==typeof b&&(j=parseInt(g,10)/b),c[d]=parseInt(c[d],10)+j):e.indexOf(";")>-1&&(g=e.split(";"),b&&"number"==typeof b&&(j=parseFloat(g[1])/b),c[d]=parseInt(g[0],10)+j),f=c[0],{1:parseFloat(f),2:60*parseInt(f,10)+parseFloat(c[1]),3:3600*parseInt(f,10)+60*parseInt(c[1],10)+parseFloat(c[2])}[c.length||1])}function e(a,b,c,d){for(var h,j=a.firstChild,k=f(a,d),l=[];j;)1===j.nodeType&&("p"===j.nodeName?l.push(g(j,c,k,b)):"div"===j.nodeName&&(h=i(j.getAttribute("begin"),0,b),h<0&&(h=c),l.push.apply(l,e(j,b,h,k)))),j=j.nextSibling;return l}function f(a,b){var c=a.getAttribute("region");return null!==c?c:b||""}function g(a,b,c,d){var e={};return e.text=h(a),
e.data=e.text,e.id=a.getAttribute("xml:id")||a.getAttribute("id"),e.start=i(a.getAttribute("begin"),b,d),e.end=i(a.getAttribute("end"),b,d),e.target=f(a,c),e.end<0&&(e.end=i(a.getAttribute("duration"),0,d),e.end>=0?e.end+=e.start:e.end=Number.MAX_VALUE),e}function h(a){return a.nodeType===a.TEXT_NODE?a.textContent.replace(o,""):"br"===a.nodeName.toLowerCase()?"\n":Array.prototype.map.call(a.childNodes,h).join("")}function i(a,b,c){var e;if(!a)return-1;try{var f=d(a,c);return f}catch(c){return e=j(a),parseFloat(a.substring(0,e))*k(a.substring(e))+(b||0)}}function j(a){for(var b=a.length-1;b>=0&&a[b]<="9"&&a[b]>="0";)b--;return b}function k(a){return{h:3600,m:60,s:1,ms:.001}[a]||-1}function l(a,b,c){var d,f=new DOMParser;if(!a)return[];try{d=f.parseFromString(a,"text/xml").documentElement.firstChild}catch(a){return n.error("TTML parse error",a),[]}if(!d)return[];for(;"body"!==d.nodeName;)d=d.nextSibling;return d?e(d,c,0):void 0}var m=c(4),n=m.get("ttmlParser"),o=/(?:\r\n|\r|\n)/gm;a.exports={parse:l}},function(a,b,c){"use strict";function d(a,b,c,d,e){var i=h.defer(),j=new XMLHttpRequest,k=function(b){f.warn("XHR error",b,j.status),i.reject(new g(j.status,"xhr: Request failed.",a,b))},l=function(b){f.warn("XHR abort",b),i.reject(new g(j.status,"xhr: Request aborted.",a,b))},m=function(b){f.warn("XHR timeout",b),i.reject(new g(j.status,"xhr: Request aborted.",a,b))};return e&&e.timeout&&window.setTimeout(function(){i.reject(new g(0,"xhr: Request aborted.",a)),j.abort()},1e3*e.timeout),j.onreadystatechange=function(){try{4==j.readyState&&i.resolve(j)}catch(a){i.reject(a)}},j.onerror=k,j.onabort=l,j.ontimeout=m,j.open(b,a),j.withCredentials=!!e&&null!=e.withCredentials&&e.withCredentials,j.setRequestHeader("Accept","application/json, application/javascript, text/plain"),d&&Object.getOwnPropertyNames(d).forEach(function(a){j.setRequestHeader(a,d[a])}),e&&e.authorization&&j.setRequestHeader("Authorization",e.authorization),j.send(c),i.promise}function e(a){return d(a,"GET",null,null,null).then(function(a){return a.response})}var f=c(4).get("xhrRequester"),g=c(53),h=c(8);a.exports={doRequest:d,fetch:e}},function(a,b){"use strict";function c(a,b,c,d){this.code=a,this.message=b||"Rest client error",this.url=c,this.response=d,this.requester=!0}c.prototype=new Error,c.prototype.constructor=c,a.exports=c},function(a,b,c){"use strict";function d(a,b,c){function d(a,b,c){e.debug("Fetching license",a);var d,f=new XMLHttpRequest;f.open("POST",a),f.responseType="arraybuffer",f.onreadystatechange=function(){if(4===f.readyState){if(200!==f.status)throw"XHR failed ("+a+"). Status: "+f.status+" ("+f.statusText+")";c(f.response)}};var g=(new DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(b)),"application/xml");if(!g.getElementsByTagName("Challenge")[0])throw"Cannot find <Challenge> in key message";d=atob(g.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue);var h=g.getElementsByTagName("name"),i=g.getElementsByTagName("value");if(h.length!==i.length)throw"Mismatched header <name>/<value> pair in key message";for(var j=0;j<h.length;j++)f.setRequestHeader(h[j].childNodes[0].nodeValue,i[j].childNodes[0].nodeValue);f.send(d)}function g(a){void 0===m&&h(a),j(a.target,a.initDataType,a.initData)}function h(){navigator.requestMediaKeySystemAccess(f,[{initDataTypes:["keyids","cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a"'}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1"'}]}]).then(function(a){a.createMediaKeys().then(i).catch(function(a){e.error("createMediaKeys failed.",a)})},function(a){e.error("Key system access failed.",a)})}function i(a){e.debug("createMediaKeys success"),m=a;for(var c=0;c<b.pendingSessionData.length;c++){var d=b.pendingSessionData[c];g(a,d.initDataType,d.initData)}b.pendingSessionData=[],b.setMediaKeys(a)}function j(a,b,c){m?g(m,b,c):(e.debug("Storing pending session data"),a.pendingSessionData.push({initDataType:b,initData:c}))}function k(g){if(e.debug("msneedkey invoked"),b.msKeys)return void e.debug("Already set media keys for this session.");try{b.msSetMediaKeys(new a.MSMediaKeys(f)),e.debug("Using prefixed EME and PlayReady DRM.")}catch(a){throw'Unable to create MediaKeys("'+f+'"). Verify the components are installed and functional. Original error: '+a.message}var h=b.msKeys.createSession("video/mp4",g.initData);if(!h)throw e.debug("Failed creating session.",g,b.msKeys),"Could not create key session";h.addEventListener("mskeymessage",function(a){return e.debug("mskeymessage invoked"),n?void e.warn("Key session still active after closedown.",a,c):void d(c.licenseUrl,a.message.buffer,function(a){h.update(new Uint8Array(a))})}),h.addEventListener("mskeyerror",function(){if(e.warn("mskeyerror invoked",h.error),n)return void e.warn("Key session still active after closedown.",event,c);throw"Unexpected 'keyerror' event from key session. Code: "+h.error.code+", systemCode: "+h.error.systemCode})}function l(){a.navigator.requestMediaKeySystemAccess?b.removeEventListener("encrypted",g,!1):b.removeEventListener("msneedkey",k,!1),n=!0}var m,n;return a.navigator.requestMediaKeySystemAccess?b.addEventListener("encrypted",g,!1):b.addEventListener("msneedkey",k,!1),{remove:l}}var e=c(4).get("licenseManager"),f="com.microsoft.playready";a.exports={getLicenseAcquirer:d}},function(a,b,c){"use strict";var d=c(4).get("fairplayLicenseAcquirer"),e=function(a,b,c,e){function f(a){for(var b=new ArrayBuffer(2*a.length),c=new Uint16Array(b),d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);return c}function g(a){var b=new Uint16Array(a.buffer);return String.fromCharCode.apply(null,b)}function h(a){for(var b=window.atob(a),c=b.length,d=new Uint8Array(new ArrayBuffer(c)),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d}function i(a){for(var b,c,d,e,f,g,h,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",j="",k=0;k<a.length;)b=a[k++],c=k<a.length?a[k++]:Number.NaN,d=k<a.length?a[k++]:Number.NaN,e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),j+=i.charAt(e)+i.charAt(f)+i.charAt(g)+i.charAt(h);return j}function j(a){var b=g(a),c=e&&e.contentIdExtractMatch||/([0-9]+)$/,d=c.exec(b);return d&&d[0]}function k(a,b,c){"string"==typeof b?b=f(b):"number"==typeof b&&(b=f(""+b));var d=0,e=new ArrayBuffer(a.byteLength+4+b.byteLength+4+c.byteLength),g=new DataView(e),h=new Uint8Array(e,d,a.byteLength);h.set(a),d+=a.byteLength,g.setUint32(d,b.byteLength,!0),d+=4;var i=new Uint8Array(e,d,b.byteLength);i.set(b),d+=i.byteLength,g.setUint32(d,c.byteLength,!0),d+=4;var j=new Uint8Array(e,d,c.byteLength);return j.set(c),new Uint8Array(e,0,e.byteLength)}function l(b){d.debug("needkey",b);var f=b.target,h=b.initData;if(c||(c=j(h),d.debug("Content ID extracted from initData.",c)),f.webkitKeys||f.webkitSetMediaKeys(new a.WebKitMediaKeys(u)),!f.webkitKeys)throw"Could not create MediaKeys";var i=e.licenseUrl;if(e.useLicenseUrlFromStream){var l=g(h).substring(1);i=l.substring(l.indexOf("/",l.indexOf("://")+3))}if(v)m(f,i,k(h,c,v));else{var n=new XMLHttpRequest;n.responseType="arraybuffer",n.addEventListener("load",function(a){var b=a.target;v=new Uint8Array(b.response),m(f,i,k(h,c,v))},!1),n.addEventListener("error",s,!1),n.open("GET",e.certificateUrl,!0),n.send()}}function m(a,b,e){var f=a.webkitKeys.createSession("video/mp4",e);if(!f)throw"Could not create key session";f.contentId=c,f.licenseURL=b,f.addEventListener("webkitkeymessage",n,!1),f.addEventListener("webkitkeyadded",q,!1),f.addEventListener("webkitkeyerror",r,!1),d.debug("keySession: ",f)}function n(a){var b=a.target,c=a.message,d=new XMLHttpRequest;d.responseType="text",d.session=b,d.addEventListener("load",o,!1),d.addEventListener("error",p,!1),d.open("POST",b.licenseURL,!0),d.send(i(c))}function o(a){var b=a.target,c=b.session,d=b.responseText.trim();"<ckc>"===d.substr(0,5)&&"</ckc>"===d.substr(-6)&&(d=d.slice(5,-6));var e=h(d);c.update(e)}function p(a){d.error("License request failed",a)}function q(a){d.debug("Decryption key added",a)}function r(a){d.error("Failed to get decryption key",a)}function s(a){d.error("Failed to retrieve the server certificate.",a)}function t(){b.removeEventListener("webkitneedkey",l,!1)}var u="com.apple.fps.1_0",v=null;return e&&d.debug("Protection data for FairPlay available.",e,c),b.addEventListener("webkitneedkey",l,!1),{remove:t}};a.exports={getLicenseAcquirer:e}},function(a,b,c){"use strict";function d(a){function b(b,c){function d(){n.classList.add(p),n.classList.remove(q),c(!0)}function e(){n.classList.add(q),n.classList.remove(p),c(!1)}function k(a,b){function c(b){b!==j.basicEventTypes.ended&&b!==j.basicEventTypes.failed||e(),a.apply(a,arguments)}return d(),r.play(c,b)}function l(){return e(),r.stop()}function m(){n.pause(),n.src="",n.parentNode&&n.parentNode.removeChild(n)}var n=g.applyContext(a).build(),o=new i("html","HTMLVideoElement",n,n),p=a.htmlAdOverlay.activeClassName,q=a.htmlAdOverlay.inactiveClassName,r=f.getVideoCuer.applyContext(a,{instance:o});return n.classList.add(q),n.controls=!1,b.appendChild(n),{cuer:new h.SimpleCuer(k,l,r.getPosition),remove:m,instance:o}}return{insert:b}}var e=c(26),f=c(44),g=c(39),h=c(48),i=c(40),j=c(35);a.exports=e(d,"htmlAdOverlayInserter")},function(a,b,c){"use strict";function d(a){var b=document.createElement("param");return b.setAttribute("name",a.name),b.setAttribute("value",a.value),b}function e(a){var b="interactive=false";if(a){var c=Object.getOwnPropertyNames(a).map(function(b){return a[b]&&a[b].file||""}).join(";");c.length>0&&(b+=",plugins="+c)}return b}function f(){var a=document.createElement("a");a.setAttribute("href","http://go.microsoft.com/fwlink/?LinkID=149156&v=5.0.61118.0"),a.style.textDecoration="none";var b=document.createElement("img");return b.setAttribute("src","http://go.microsoft.com/fwlink/?LinkId=161376"),a.style.borderStyle="none",a.appendChild(b),a}function g(a,b,c,e,g){var h=document.createElement("object");h.setAttribute("data","data:application/x-silverlight-2,"),h.setAttribute("type","application/x-silverlight-2"),h.className=b;var i=q.concat([{name:"source",value:a},{name:"onLoad",value:e},{name:"onError",value:g},{name:"initParams",value:c}]);return i.map(d).forEach(function(a){h.appendChild(a)}),h.appendChild(f()),h}function h(a){var b=n.get("silverlight");a.addEventListener("LogEntered",function(a,c){var d=[],e=c.Level;if(c.Data&&c.Data.length)for(var f=0;f<c.Data.length;f++)d.push(c.Data[f]);var g=d;g.unshift(c.Message),b[e.toLowerCase()].apply(b,g)})}function i(a,b){function c(a,b){var c=!b.Error,g=b.Name;if(d[g]=c?a:f,e[g]){try{c?(p.debug("Silverlight plugin initialized",g),e[g].resolve({pluginInstance:a})):(p.debug("Failed to initialice silverlight plugin",g,b.Error),e[g].reject("Failed to initialize plugin: "+g))}catch(a){p.error("Plugin consumer notification failed.",a)}delete e[g]}}var d={},e={},f="failed";return a&&b&&(b.PluginInitialized=c,b.PluginFailed=c),{getPlugin:function(b){var c=o.defer();if(d[b])d[b]!==f?(p.debug("Plugin consumer being fed.",b),c.resolve({pluginInstance:d[b]})):c.reject("Failed to initialize plugin: "+b);else{var g=!1;Object.getOwnPropertyNames(a||{}).forEach(function(c){a[c]&&a[c].file===b&&(g=!0)}),g?(p.debug("Waiting for plugin to be loaded.",b),e[b]=c):c.reject("Silverlight plugin not defined in config: "+b)}return c.promise}}}function j(a){function b(b){function c(b){var c,d,e;try{e=n.Content.Player}catch(a){p.error("Unable to get hold of Silverlight API. JS access might be blocked?",a,b),j.reject(a)}try{a.silverlight.core.plugins&&(c=n.Content.PluginLoader)}catch(a){p.warn("Unable to set up plugin loading.",a,b)}try{h(e)}catch(a){p.error("Initialization of player failed, recovering gracefully.",a)}try{d=i(a.silverlight.core.plugins,c)}catch(a){p.warn("Plugin manager init failed",a,b)}j.resolve(new m("silverlight","Vimond.Player.Core",n,e,{pluginManager:d},f))}function d(b,c){p.debug("Silverlight plugin reported an error when trying to load the app. Check that the XAP url, '"+a.silverlight.core.xapUrl+"', is correctly configured.",b,c),j.reject(c)}function f(){window.setTimeout(function(){n.parentNode.removeChild(n),p.debug("Silverlight element removed.")},6e3)}var j=o.defer(),k=a.silverlight.core.domClassName||"",n=g(a.silverlight.core.xapUrl,k,e(a.silverlight.core.plugins),l.addGlobalPollutant("onSlLoad",c,!0),l.addGlobalPollutant("onSlError",d,!0));return b.appendChild(n),j.promise}return{insert:b}}var k=c(26),l=c(58),m=c(40),n=c(4),o=c(8),p=n.get("silverlightVideoInserter"),q=[{name:"background",value:"black"},{name:"minRuntimeVersion",value:"4.0.60310.0"},{name:"enableGPUAcceleration",value:"true"},{name:"windowless",value:"true"},{name:"enableHTMLAccess",value:"true"},{name:"autoUpgrade",value:"true"}];a.exports=k(j,"silverlightVideoInserter")},function(a,b,c){"use strict";function d(a){return"['"+a+"']"}function e(){return window.vimond?"vimond":"___vimond"}function f(){var a=e();return window[a]=window[a]||{}}function g(a,b,c){for(var d=a;d in window;)d+="_";return window[d]=function(){try{b.apply(this,arguments)}catch(a){j.error("Call to registered global function failed",d,a,arguments)}c&&delete window[d]},d}function h(a){function b(a){return"window"+d(e())+d(c)+d(a)}var c="p-"+a,g=f(),h=g[c]=g[c]||{};return j.debug("Global namespace polluted with "+d(e())+d(c)),{addPollutant:function(a,c){return h[a]=c,b(a)},getPollutant:function(a){return h[a]},getPollutantPath:function(a){return b(a)}}}var i=c(4),j=i.get("globalScopePolluter");a.exports={get:function(a){return new h(a)},getBase:f,getBasePath:function(){return polluterBaseProperty},addGlobalPollutant:g}},function(a,b,c){"use strict";function d(a,b){function c(){return b.internals&&b.internals.streamTrimmer}function d(a){var b=a%86400;g.debug("Live position reported upon live stream startup.",i.formatTimeFromSeconds(b),a)}function e(){var a=b.internals&&b.internals.timingModel;if(a)if("timeComponentFromStream"===a.alignmentType){var c=x.LivePosition;c&&(d(c),v=h.computeBaseDateForClockTimeWithDays(c,a.centralTimeZoneOffset||0,new Date),g.debug("Absolute timing base date computed with central time offset "+(a.centralTimeZoneOffset||0)+" seconds: "+v))}else v=(a.baseDateTime instanceof Date&&a.baseDateTime||new Date).getTime()/1e3,g.debug("Setting base date aligned with stream start.",v);else g.debug("Timing model not found."),v=(new Date).getTime()/1e3}function j(b,c){if(w)return a.update(b,c)}function k(b){b||(!y||x.IsStreamOpen?x.IsBuffering?b=z?a.playStates.buffering:a.playStates.starting:x.IsPaused?(z=!0,b=a.playStates.paused):x.IsSeeking?b=z?a.playStates.seeking:a.playStates.starting:(z=!0,b=a.playStates.playing):b=a.playStates.inactive),j(a.props.playState,b)}function l(){j(a.props.isPaused,x.IsStreamOpen&&x.IsPaused)}function m(){j(a.props.volume,x.Volume),j(a.props.isMuted,x.IsMuted)}function n(){var b=new Date,d=new Date;b.setTime(1e3*(v+x.AbsolutePosition)),d.setTime(1e3*(v+x.AbsoluteStartPosition));var e=c()?c().getPosition():x.RelativePosition;j(a.props.position,e),j(a.props.absoluteStartPosition,d),j(a.props.absolutePosition,b)}function o(){var b=c();j(a.props.duration,b?b.getDuration():x.Duration)}function p(){var b=c();x.IsLive?(b?b.getDuration():x.Duration)>100?j(a.props.playMode,a.playModes.livedvr):j(a.props.playMode,a.playModes.live):j(a.props.playMode,a.playModes.ondemand)}function q(){j(a.props.isAtLivePosition,x.IsLivePosition)}function r(){j(a.props.bitrate,x.CurrentBitrate)}function s(){j("error",x.ErrorMessage)}function t(){var c=b.internals&&b.internals.subtitlesManager;c&&j(a.props.textTracks,c.selectableTracks)}function u(a){e(),m(),k(a),o(),n(),p(),q(),l(),t(),r(),s()}var v,w=!0,x=b.implementationApi,y=!1,z=!1,A=!1,B={},C=0,D=[];B.audioTrackFound=x.addEventListener("AudioTrackFound",function(b,c){var d=c.Name,e=c.Language,h=c.AudioStreamCount,i=function(){x.SelectTrack(d,e)};C++;var k=new f.AudioTrackSelectionModel(i,C,"",e,d);D.push(k),C==h&&j(a.props.audioTracks,D),g.debug("AudioTrackFound invoked",e,d,h)}),B.streamStarted=x.addEventListener("StreamStarted",function(){g.debug("StreamStarted invoked"),u()}),B.streamEnded=x.addEventListener("StreamEnded",function(){g.debug("StreamEnded invoked"),y=!0,k(),l()}),B.streamFailed=x.addEventListener("StreamFailed",function(){g.debug("StreamFailed invoked"),s(),k(a.playStates.inactive),l()}),B.positionUpdated=x.addEventListener("PositionUpdated",function(){n(),o(),(x.IsLive||A)&&(p(),q(),A=x.IsLive)}),B.playstateChanged=x.addEventListener("PlaystateChanged",function(){g.debug("PlaystateChanged invoked"),k(),l(),q()}),B.volumeChanged=x.addEventListener("VolumeChanged",function(){m()}),B.bitrateChanged=x.addEventListener("BitrateChanged",function(){r()}),u(a.playStates.starting),this.setActive=function(a){a!==w&&(w=a,g.debug("Setting Silverlight video observer "+(a?"active":"inactive")),w&&u())},this.unobserve=function(){try{}catch(a){g.warn("A proper way of detaching Silverlight event listeners is apparently not found.",a)}}}function e(a){var b=a.implementationApi,c=b.Volume,d=!0;this.play=function(){d&&b.Play()},this.pause=function(){d&&b.Pause()},this.setPosition=function(c){d&&(a.internals&&a.internals.streamTrimmer?a.internals.streamTrimmer.setPosition(c):b.RelativePosition=c)},this.setVolume=function(a){b.IsMuted=0===parseFloat(a),b.Volume=a},this.setIsMuted=function(a){a?(c=b.Volume,b.Volume=0):b.Volume=c,b.IsMuted=a},this.gotoLive=function(){d&&b.SeekToLive()},this.capBitrate=function(a){window.slApi=b,isNaN(a)||a===1/0||a<0?(g.debug("Resetting restrictions for bitrate."),b.LimitBitrates(0,0)):(g.debug("Applying restrictions for bitrate.",a),b.LimitBitrates(a,0))},this.setActive=function(a){a!==d&&(g.debug("Setting Silverlight video updater "+(a?"active":"inactive")),d=a)}}var f=c(43),g=c(4).get("silverlightVideoAdapters"),h=c(60),i=c(7);a.exports={VideoUpdater:e,VideoObserver:d}},function(a,b){"use strict";function c(a){return a>9?a:"0"+a.toString()}function d(a){var b="";if(a.length>19&&":"===a.charAt(16)?b=a.substring(19):a.length>16&&":"!==a.charAt(16)?b=a.substring(16):a.length>13&&":"!==a.charAt(13)&&(b=a.substring(13)),b.length>4){var c="+"===b.charAt(0)?1:-1,d=b.substring(1,3),e=6===b.length?b.substring(4,6):b.substring(3,5);return c*(60*parseInt(d,10)+parseInt(e))*60}return 0}function e(a,b,c){var d=86400*Math.floor(b.getTime()/864e5),e=d-c,f=e+a;return new Date(1e3*f)}function f(a,b,c){var d=86400*Math.floor(c.getTime()/864e5),e=d-b;return e-86400*Math.floor(a/86400)}function g(a,b){var d=new Date(a.getTime()+1e3*(b||0));return c(d.getUTCHours())+":"+c(d.getUTCMinutes())+":"+c(d.getUTCSeconds())}a.exports={convertRemoteClockTimeToFullDate:e,extractTimeZoneOffsetFromIsoDate:d,formatTimeWithTimeZone:g,computeBaseDateForClockTimeWithDays:f}},function(a,b,c){"use strict";function d(a,b,c,d,e){function f(){return a.RelativePosition}function g(b){a.RelativePosition=b}function h(){return a.Duration}function i(){e()}b.streamEnded=a.addEventListener("StreamEnded",i);var j=new l.StreamTrimmer(c,f,g,h,e);return b.positionUpdated=a.addEventListener("PositionUpdated",function(){try{j.onPositionUpdated()}catch(a){q.error("Position update in stream trimmer failed.",a)}d()}),j}function e(a,b,c){var d=new n(b),e=new m.SilverlightSubtitlesManager(d,b,a);return c.getPlugin("Vimond.Player.Subtitles").then(function(a){q.debug("Got the subtitles plugin."),e.setSubtitlesPlugin(a.pluginInstance)}),e}function f(a,b){function c(){return t.getPosition()}function f(){s.Stop(),n=!1}function g(){m=t.getPosition(),q.debug("Interrupting playback for ads.",m),s.Pause()}function h(a){"number"==typeof a&&0!==a?(q.debug("Seeking upon resume according to interval:",a),t.setPosition(m+a)):m&&Math.abs(t.getPosition()-m)>5?q.warn("The position upon resuming is different from the position upon ad break start.",t.getPosition(),m):q.debug("Resuming playback after ads."),m=void 0,s.Play()}function k(c,f){function g(){t=d(s,u,f.timingModel,m,k),b.instance.internals.streamTrimmer=t,u.streamStarted=s.addEventListener("StreamStarted",j),u.streamFailed=s.addEventListener("StreamFailed",l),u.playstateChanged=s.addEventListener("PlaystateChanged",v)}function h(){try{}catch(a){q.warn("Silverlight event handler cleanup failed.",a)}}function i(){try{if(n=!0,g(),q.debug("Setting source",f),s.StreamUri=f.streamUrl,f.licenseUrl){var b=a.silverlight.licenseUrlModifier?f.licenseUrl.replace(a.silverlight.licenseUrlModifier.match instanceof RegExp?a.silverlight.licenseUrlModifier.match:new RegExp(a.silverlight.licenseUrlModifier.match),a.silverlight.licenseUrlModifier.replacement):f.licenseUrl;0===b.indexOf("http")?s.LicenseUri=b:(q.warn("License URL for Silverlight is not containing scheme and possibly host. Assuming current page origin for host/scheme."),0===b.indexOf("//")?s.LicenseUri=document.location.protocol+b:s.LicenseUri=document.location.protocol+"//"+document.location.host+b)}c(r.bufferingStarted,w)}catch(a){q.error("Start error",a),y.reject(a)}}function j(){n&&(c(r.started),x&&c(r.positioned))}function k(){n&&c(r.ended,z,A,!1),h(),n=!1}function l(){n&&(q.warn("Silverlight video error",s.ErrorMessage),c(r.failed,z,A,!1,o.map(s.ErrorMessage))),h(),n=!1}function m(){z=t.getPosition(),A=t.getDuration(),c(r.temporalupdate,z,A,s.IsPaused)}function v(){n&&(w>0&&s.IsStreamOpen?(q.debug("Applying start position",w),t.setPosition(w),B=!0,w=0):s.IsSeeking&&B&&(c(r.positioned,w),B=!1),s.IsBuffering&&!C?c(r.bufferingStarted):C&&!s.IsBuffering&&c(r.bufferingEnded),s.IsSeeking&&!D?c(r.seekstarted,t.getPosition(),t.getDuration(),s.IsPaused):D&&!s.IsSeeking&&c(r.seekended,t.getPosition(),t.getDuration(),s.IsPaused),D=s.IsSeeking,C=s.IsBuffering)}var w=f.startPosition&&+f.startPosition||0,x=0===w,y=p.defer(),z=0,A=0,B=!1,C=!0,D=!1;return b.instance.internals.timingModel=f.timingModel,b.instance.internals.pluginManager&&(b.instance.internals.subtitlesManager=e(f,a.subtitles,b.instance.internals.pluginManager)),i(),y.promise}var m,n,s=b.instance.implementationApi,t=new l.StreamTrimmer,u={};return i.getScheduler(new j.InterruptableMainCuer(k,f,c,g,h),b.adCuer)}var g=c(26),h=c(35),i=c(62),j=c(48),k=c(4),l=c(63),m=c(64),n=c(50),o=c(65),p=c(8),q=k.get("silverlightPlaybackScheduler"),r=h.basicEventTypes;a.exports={getPlaybackScheduler:g(f,"silverlightPlaybackScheduler")}},function(a,b,c){"use strict";function d(a,b,c,d){function e(a){return new g.PositionListener(a,d)}this.main={source:a,lastKnownPosition:0,lastKnownDuration:0,startPosition:b},this.isSeeking=!1,this.isSchedulingAds=!1,this.hasInterstitials=c&&Array.isArray(c.positions)&&c.positions.length>0,this.interstitialNotificator=new g.PositionNotificator(!0),this.adProgress=j.preroll,this.isStarted=!1,this.isEnded=!1,this.hasInterstitials&&this.interstitialNotificator.addSubscribers(c.positions.map(e))}function e(a,b){return function(c,e,f){function g(a,b,d,e,f){if(!v.isEnded)if(a===k.ended||v.isSchedulingAds&&a===k.failed){p();var g=[].slice.apply(arguments);g[0]=k.ended,c.apply(null,g)}else switch(c.apply(null,arguments),a){case k.temporalupdate:s(b,d,e);break;case k.seekstarted:v.isSeeking=!0;break;case k.seekended:v.isSeeking=!1;break;case k.failed:u.reject(f)}}function h(){}function m(){v.adProgress=j.preroll,c(k.cuepreroll,v.main.startPosition,0)}function n(d){v.isSchedulingAds=!0,v.adProgress===j.midroll&&(v.main.startPosition=a.getPosition(),c(k.interrupted,v.main.startPosition,v.lastKnownDuration)),d&&b.play(g,d),a.interrupt(),d&&(v.isStarted=!0)}function o(b){v.isSchedulingAds=!1;var c=v.adProgress;switch(c){case j.preroll:a.play(g,v.main.source),v.adProgress=j.midroll;break;case j.midroll:a.resume(b);break;case j.postroll:q()}}function p(){v.isEnded||v.isSchedulingAds||(v.adProgress=j.postroll,c(k.cuepostroll,v.main.lastKnownPosition,v.lastKnownDuration))}function q(){c=function(){},v.isEnded=!0,u.fulfill()}function r(a){c(k.cuemidroll,a,v.main.lastKnownDuration)}function s(a,b,c){v.isEnded||v.isSchedulingAds||v.isSeeking||c||(v.main.lastKnownPosition=a,v.main.lastKnownDuration=b,v.interstitialNotificator.updatePosition(a))}function t(){a.stop(),b.stop()}var u=i.defer(),v=new d(e,e.startPosition,f,r);return l.debug("Scheduling "+e.streamUrl+" with start position "+e.startPosition),h(),window.setTimeout(m,10),{promise:u.promise,resume:o,scheduleAd:n,stop:t}}}var f=c(35),g=c(37),h=c(4),i=c(8),j=f.adModes,k=f.basicEventTypes,l=h.get("parallelSchedulerHelper");a.exports={getScheduler:e}},function(a,b){"use strict";function c(a,b,c,f,g){var h=a&&a.trimStart||0,i=a&&a.trimLength||0,j=h>0||i>0,k=b||e,l=f||e,m=c||d;this.onPositionUpdated=j?function(){var a=k();a<h?m(h):a>i&&g&&g()}:d,this.getPosition=j?function(){return k()-a.trimStart}:k,this.setPosition=j?function(a){var b=a+h;(0===i||b<=i)&&(0===h||b>=h)&&m(b)}:m,this.getDuration=j?function(){var a=i>0?Math.min(l(),i):l();return a-h}:l}var d=function(){},e=function(){return 0};a.exports={StreamTrimmer:c}},function(a,b,c){"use strict";function d(){var a,b,c,d,e=0;this.setSubtitle=function(c,f){return d&&(d.reject("New subtitle set."),d=null),0!==c.indexOf("http")&&(c=window.location.protocol+"//"+window.location.host+c),a?h(a.SetSubtitle(c,f)):(b=c,e=f,d=h.defer(),d.promise)},this.setSubtitleContent=function(b,f){return d&&(d.reject("New subtitle set."),d=null),a?(i.debug("Setting subtitle",b,f),h(a.SetSubtitleContent(b,f))):(i.debug("Waiting for subtitles plugin to load, delayed setting subtitle.",b,f),c=b,e=f,d=h.defer(),d.promise)},this.removeSubtitle=function(){d&&(d.reject("Subtitle removed."),d=null),a?a.RemoveSubtitle():(b=null,e=0)},this.applyPlugin=function(f){a=f,i.debug("Applying subtitle plugin",c,e),b?d.fulfill(a.SetSubtitle(b,e)):c&&d.fulfill(a.SetSubtitleContent(c,e))}}function e(a,b,c,d,e){function f(a,b){m&&m.update(a,b)}function j(a){if(a!==m.isVisible)return a?k():l()}function k(){if(m.isVisible)return h();d();var g;return n?(g=a.setSubtitleContent(n,b),i.debug("Applying earlier loaded subtitle content.")):g=e.get(c.src).then(function(c){return i.debug("Subtitle content loaded and selected.",c),n=c,a.setSubtitleContent(n,b)}),f("isVisible",!0),g}function l(){m.isVisible&&(a.removeSubtitle(),f("isVisible",!1))}var m,n;return m=new g.SubtitleSelectionModel(c.kind,c.language,c.label,j,k,l)}function f(a,b,c){function f(){l.forEach(function(a){a.unselect()})}function g(a){if("subtitles"===a.kind||"captions"===a.kind)for(var b=0;b<h.length;b++)if(a.contentType&&a.contentType.indexOf(h[b])>=0)return!0;return!1}var h=(b&&b.contentTypeMappings?b.contentTypeMappings.ttml:["ttml","xml"]).concat(b&&b.contentTypeMappings?b.contentTypeMappings.srt:["subrip","text/plain"]),j=c.timingModel&&c.timingModel.trimStart||0,k=new d,l=(c.tracks||[]).filter(g).map(function(b){return e(k,j,b,f,a)});return i.debug("Selectable subtitles found from tracks.",c.tracks,l),{selectableTracks:l,setSubtitlesPlugin:k.applyPlugin}}var g=c(42),h=c(8),i=c(4).get("SilverlightSubtitlesManager");a.exports={SilverlightSubtitlesManager:f}},function(a,b,c){"use strict";function d(a){var b=(""+(a||"")).split(" "),c=e.codes.STREAM_ERROR;if(b[0]){var d=parseInt(b[0],10);f.indexOf(d)>=0?c=e.codes.STREAM_ERROR_DRM_CLIENT_UNAVAILABLE:g.indexOf(d)>=0&&(c=e.codes.STREAM_ERROR_DOWNLOAD)}return new e(c,a,a,"silverlight")}var e=c(66),f=[6011,6004,6008,6e3,6013,6018,6023,6003],g=[6006,6005,6001,6002,6010,6012,6017,6030,3222,3050,4001];a.exports={map:d}},function(a,b){"use strict";function c(a,b,c,d,e){this.code=a,this.message=b,this.sourceError=c,this.technology=d,this.severity=e||"fatal"}c.prototype=new Error,c.prototype.constructor=c,c.codes={STREAM_ERROR_DRM_CLIENT_UNAVAILABLE:"STREAM_ERROR_DRM_CLIENT_UNAVAILABLE",STREAM_ERROR_PLUGIN_UNAVAILABLE:"STREAM_ERROR_PLUGIN_UNAVAILABLE",STREAM_ERROR_DOWNLOAD:"STREAM_ERROR_DOWNLOAD",STREAM_ERROR_DECODE:"STREAM_ERROR_DECODE",STREAM_ERROR:"STREAM_ERROR"},c.severities={fatal:"fatal",warning:"warning"},a.exports=c},function(a,b,c){"use strict";function d(a,b){var c=document.createElement("param");return c.setAttribute("name",a),c.setAttribute("value",b),c}function e(a,b,c,e,f){var g={movie:b,flashVars:i.objectToQueryString(c,""),allowFullscreen:"true",wmode:f||"direct",bgcolor:"#000000",allowscriptaccess:"always"};e&&(g.base=e),navigator.userAgent.match(/(Windows NT 6\.1)|(Firefox)/)&&!f&&(g.wmode="opaque");var h=document.createElement("object");return h.setAttribute("type","application/x-shockwave-flash"),h.setAttribute("data",b),h.className=a,Object.getOwnPropertyNames(g).map(function(a){return d(a,g[a])}).forEach(function(a){h.appendChild(a)}),m.debug("Flash DOM element ready for insertion.",b,c,h),h}function f(){function a(a,b,c){f.forEach(function(a){try{a(b,c)}catch(d){m.error("A Flash player "+b+" event listener failed.",a,c)}})}function b(a){f.push(a)}function c(a){f.splice(f.indexOf(a),1)}function d(){window[e]=null,f.length=0}var e=k.addGlobalPollutant("notifyVupFromSmf",a),f=[];return{callbackName:e,subscribe:b,unsubscribe:c,destroy:d}}function g(a){try{if(a){var b={};return Object.getOwnPropertyNames(a).forEach(function(c){a[c]&&a[c].swfUrl&&Object.getOwnPropertyNames(a[c]).forEach(function(d){"swfUrl"===d?b["plugin_"+c]=a[c].swfUrl:b[c+"_"+d]=a[c][d]})}),m.debug("OSMF plugins set up.",a,b),b}}catch(a){m.warn("An error occurred when configuring OSMF plugins.",a)}return{}}function h(a){function b(){var a=!1;try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b&&(a=!0)}catch(b){navigator.mimeTypes&&void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(a=!0)}return a}function c(a){function c(){return o.delay(5e3).then(function(){q.destroy(),i.parentNode.removeChild(i),m.debug("Flash object element removed.")}),o()}function h(a){"onJavaScriptBridgeCreated"===a&&(m.debug("SMF player is ready.",i),j.fulfill(new l("flash","Vimond.Player.Core",i,i,{eventStreamer:q},c)),q.unsubscribe(h))}var i,j=o.defer(),k=g(d.plugins),p=d.swfUrl,q=f();if(!b()){var r=new n(n.codes.STREAM_ERROR_PLUGIN_UNAVAILABLE,"Missing Flash plugin",{flashPlugin:b()},"flash");j.reject(r)}if(!p)throw new Error("Missing SWF URL for the Flash player.");return k.autoPlay=!0,k.verbose=d.verbose||!1,k.javascriptCallbackFunction=q.callbackName,q.subscribe(h),i=e(d.domClassName,p,k,null,d.wmode),a.appendChild(i),j.promise}var d=a.flash.core;return{insert:c}}var i=c(7),j=c(26),k=c(58),l=c(40),m=c(4).get("strobeVideoInserter"),n=c(66),o=c(8);a.exports=j(h,"flashVideoInserter")},function(a,b,c){"use strict";function d(a,b){function c(b,c){if(v)return a.update(b,c)}function d(b){c(a.props.playState,b||x&&a.playStates.inactive||!y&&a.playStates.starting||w.getSeeking()&&a.playStates.seeking||w.getBuffering()&&a.playStates.buffering||w.getPaused()&&a.playStates.paused||a.playStates.playing)}function e(a,b){switch(a){case"loadstart":h();break;case"waiting":d();break;case"loadedmetadata":d(),m();break;case"play":y=!0,z=!0,d(),m(),n(),i();break;case"pause":d(),i();break;case"seeking":case"seeked":d(),i(),n(),k();break;case"durationchange":l(),k();break;case"timeupdate":l(),k(),n(),m();break;case"volumechange":j();break;case"complete":x=!0,d();break;case"bitratechange":q(b);break;case"error":d(),o(b.error)}}function f(){var a=b.internals.eventStreamer;a.subscribe(e),h()}function h(){j(),l(),k(),m(),n(),i(),p(),q()}function i(){c(a.props.isPaused,w.getPaused())}function j(){c(a.props.volume,w.getVolume()),c(a.props.isMuted,w.getMuted())}function k(){if(B){if(t&&A)if(w.getPaused()||z)z=!1,r=w.getCurrentTime(),s=new Date(t.getTime()-1e3*r);else{var b=(new Date).getTime()-s.getTime()-u;s=new Date(s.getTime()+b),t=new Date(s.getTime()+1e3*r)}else r=w.getCurrentTime(),s=(new Date).getTime()-1e3*r,t=new Date,u=1e3*w.getDuration();c(a.props.position,r),c(a.props.absoluteStartPosition,s),c(a.props.absolutePosition,t)}else c(a.props.position,w.getCurrentTime())}function l(){c(a.props.duration,w.getDuration())}function m(){var b=a.playModes.ondemand;switch(w.getStreamType()){case"dvr":b=a.playModes.livedvr,B=!0,A=!0;break;case"live":b=a.playModes.live,B=!0}c(a.props.playMode,b)}function n(){c(a.props.isAtLivePosition,w.getIsLive());
}function o(b){c(a.props.error,b)}function p(){}function q(b){c(a.props.bitrate,b?b.bitrate:0)}var r,s,t,u,v=!0,w=b.implementationApi,x=!1,y=!1,z=!1,A=!1,B=!1;this.setActive=function(a){a!==v&&(v=a,g.debug("Setting Flash video observer "+(a?"active":"inactive")),v&&h())},this.unobserve=function(){b.internals.eventStreamer.unsubscribe(e)},f()}function e(a){var b=a.implementationApi,c=b.getVolume(),d=!0;this.play=function(){d&&b.play3()},this.pause=function(){d&&b.pause3()},this.setPosition=function(a){d&&b.setCurrentTime(a)},this.gotoLive=function(){d&&b.snapToLive()},this.setVolume=function(a){b.setMuted(0===parseFloat(a)),b.setVolume(a)},this.setIsMuted=function(a){a?(c=b.getVolume(),b.setVolume(0)):b.setVolume(c),b.setMuted(a)},this.capBitrate=function(a){g.info("Bitrate capping not implemented for Flash.")},this.setActive=function(a){a!==d&&(g.debug("Setting Flash video updater "+(a?"active":"inactive")),d=a)}}var f=c(4),g=(c(60),c(7),f.get("flashVideoAdapters"));a.exports={VideoUpdater:e,VideoObserver:d}},function(a,b,c){"use strict";function d(a,b){function c(){if(q)try{return r.getCurrentTime()}catch(a){return 0}}function d(){try{return r.getDuration()}catch(a){return 0}}function e(a){try{return r.setCurrentTime(a)}catch(a){}}function f(){if(q)try{r.stop3()}catch(a){l.debug("Stopping the Strobe player failed, but maybe the stream is already stopped?",a)}q=!1}function i(){if(q)try{p=c(),l.debug("Interrupting playback for ads.",p),r.pause3()}catch(a){l.debug("Attempting to interrupt playback failed.",a)}}function n(a){if(q)try{if("number"==typeof a&&0!==a)l.debug("Seeking upon resume according to interval:",a),r.setCurrentTime(p+a);else{var b=c();p&&Math.abs(b-p)>5?l.warn("The position upon resuming is different from the position upon ad break start.",b,p):l.debug("Resuming playback after ads.")}p=void 0,r.play3()}catch(a){l.debug("Attempting to resume playback failed.",a)}}function o(a,f){function g(){s.subscribe(n)}function h(){s.unsubscribe(n)}function i(){try{q=!0,g(),l.debug("Setting source",f),r.setMediaResourceURL(f.streamUrl),a(m.bufferingStarted,B)}catch(a){l.error("Start error",a),D.reject(a)}}function n(a,b){try{switch(a){case"waiting":w();break;case"play":x(),v();break;case"pause":p();break;case"seeking":t();break;case"seeked":u();break;case"durationchange":case"timeupdate":A();break;case"complete":y();break;case"error":z(b.error)}}catch(a){l.error("Strobe event handling failed.",a)}}function o(){q&&(I||(G=!1,a(m.started),a(m.positioned),I=!0,x("firstplay")))}function p(){x("pause")}function t(){q&&!J&&(J=!0,G||a(m.seekstarted,c(),d(),r.getPaused()))}function u(){q&&J&&(J=!1,G?o():(a(m.seekended,c(),d(),r.getPaused()),x("seekcomplete")))}function v(){G&&(C?o():e(f.startPosition))}function w(){q&&!H&&(H=!0,a(m.bufferingStarted,c()))}function x(b){l.debug("Buffering end reported from "+b),q&&H&&a(m.bufferingEnded),H=!1}function y(){q&&(H&&a(m.bufferingEnded,E,F,!1),J&&a(m.seekended,E,F,!1),a(m.ended,E,F,!1)),h(),q=!1}function z(b){q&&(l.warn("Strobe video error",b),a(m.failed,E,F,!1,j.map(b))),q=!1}function A(){E=c(),F=d();var b=!1;try{b=r.getPaused()}catch(a){}a(m.temporalupdate,E,F,b)}var B=f.startPosition&&+f.startPosition||0,C=0===B,D=k.defer(),E=0,F=0,G=!0,H=!0,I=!1,J=!1;return b.instance.internals.timingModel=f.timingModel,i(),D.promise}var p,q,r=b.instance.implementationApi,s=b.instance.internals.eventStreamer;return g.getScheduler(new h.InterruptableMainCuer(o,f,c,i,n),b.adCuer)}var e=c(26),f=c(35),g=c(62),h=c(48),i=c(4),j=c(70),k=c(8),l=i.get("flashPlaybackScheduler"),m=f.basicEventTypes;a.exports={getPlaybackScheduler:e(d,"flashPlaybackScheduler")}},function(a,b,c){"use strict";function d(a){var b=e.codes.STREAM_ERROR,c="Stream playback failed";if(a.errorID)switch(a.errorID){case 2047:case 2048:case 2049:case 2119:case 2120:case 2121:case 2122:case 2123:b=e.codes.STREAM_ERROR_DOWNLOAD,c="Security restrictions blocked the video from being played in Flash.";break;case 16:case 2032:case 2035:b=e.codes.STREAM_ERROR_DOWNLOAD,c="Stream resource not found or not reached."}return new e(b,c,a,"flash")}var e=c(66);a.exports={map:d}},function(a,b,c){"use strict";function d(a){function b(b,c){var d=a.dash.shaka;return g.promiseScript("shaka",d.libraryUrl).then(function(e){function g(){try{l.isDestroying=!0,m.destroy()}catch(a){i.warn("Failed while resetting Shaka player instance",a)}try{k.src="",k.parentNode.removeChild(k)}catch(a){i.warn("The targeted video element to remove does not exist in DOM",a)}}var j={html:{domClassName:a.dash.shaka.domClassName}},k=f.applyContext(j).build(b,c),l={};e.polyfill.installAll(),e.log&&e.log.Level&&e.log.setLevel&&"string"==typeof d.logLevel&&e.log.setLevel(e.log.Level[d.logLevel]),k.controls=!1;var m=new e.player.Player(k);if(m.configure({disableCacheBustingEvenThoughItMayAffectBandwidthEstimation:d.disableCacheBusting,enableShutdownOnLiveError:d.enableShutdownOnLiveError}),d.enableWithCredentialsOnHTTPAndMatchedCookie){var n=d.enableWithCredentialsOnHTTPAndMatchedCookieRegExpString,o=d.enableWithCredentialsOnHTTPAndMatchedCookieRegExpOption;try{new RegExp(n,o).test(document.cookie)&&m.configure({enableWithCredentialsOnHTTP:!0})}catch(a){i.warn("Ignore the invalid regular expression",a)}}return new h("dash","Shaka Player",k,m,l,g)})}return{insert:b}}var e=c(26),f=c(39),g=c(7),h=c(40),i=c(4).get("shakaVideoInserter");a.exports=e(d,"shakaVideoInserter")},function(a,b,c){"use strict";function d(a,b){function c(b,c){if(E)return a.update(b,c)}function d(){return 0!==H.end||0!==H.start?H.end-H.start:B.duration}function e(b){F?c(a.props.playState,b||B.ended&&a.playStates.inactive||D&&a.playStates.buffering||B.paused&&a.playStates.paused||a.playStates.playing):c(a.props.playState,a.playStates.starting),i.debug("Set playState:",a.playState)}function h(){c(a.props.isPaused,B.paused)}function j(){c(a.props.volume,B.volume),c(a.props.isMuted,B.muted)}function m(){var b=new Date(1e3*(G+B.currentTime)),d=new Date(1e3*(G+H.start));c(a.props.position,B.currentTime-H.start),c(a.props.absolutePosition,b),c(a.props.absoluteStartPosition,d)}function n(){c(a.props.duration,d())}function o(){try{C.isLive()?d()>l?c(a.props.playMode,a.playModes.livedvr):c(a.props.playMode,a.playModes.live):c(a.props.playMode,a.playModes.ondemand)}catch(b){c(a.props.playMode,a.playModes.ondemand)}}function p(){c(a.props.isAtLivePosition,d()-(B.currentTime-H.start)<k)}function q(){c(a.props.textTracks,f.getFromTrackList(B.textTracks)),r()}function r(){if(C.getAudioTracks){var b=C.getAudioTracks();if(b&&b.length>0){var d=b.map(function(a){var b=function(){C.selectAudioTrack(a.id,void 0)};return new g.AudioTrackSelectionModel(b,void 0!==a.id?a.id:a.index,a.kind,a.language?a.language:a.lang,a.label)});c(a.props.audioTracks,d)}}else i.debug("Unfortunately this particular shaka player version does not support getAudioTracks()")}function s(){for(var b=B.currentTime,d=B.buffered,e=0,f=0,g=0;g<d.length;++g)if(d.start(g)<=b&&d.end(g)>=b){e=d.end(g)-b,f=b-d.start(g);break}c(a.props.bufferedAhead,e)}function t(){c("error",B.error)}function u(){j(),e(a.playStates.starting),n(),m(),o(),p(),h(),q(),s(),t()}function v(){D=!0,e()}function w(){D=!1,e()}function x(a){H.start=a.start,H.end=a.end,!G&&b.internals.availabilityStartTime&&(G=b.internals.availabilityStartTime),n(),o(),m()}function y(){e(a.playStates.inactive),h()}function z(a){return a.active}function A(b){var d=C.getVideoTracks().filter(z)[0],e=C.getAudioTracks().filter(z)[0];if(i.debug("Shaka adaptation occurred.",d,e,b),d&&e){var f=Math.floor((d.bandwidth+e.bandwidth)/1e3);c(a.props.bitrate,f)}}var B=b.domElement,C=b.implementationApi,D=!1,E=!0,F=!1,G=0,H={start:0,end:0},I={durationchange:function(){o(),m(),n()},error:function(){t(),e(a.playStates.inactive),h()},ended:y,loadedmetadata:function(){n(),m(),q()},loadstart:function(){h()},pause:function(){e(),h()},play:function(){e(a.playStates.playing),h()},playing:function(){F=!0,e(a.playStates.playing),h()},seeked:function(){e(),h()},seeking:function(){e(a.playStates.seeking),h()},stalled:function(){h()},timeupdate:function(){m(),p(),n(),o(),s(),!B.paused&&0!==B.playbackRate&&!C.isLive()&&B.currentTime-H.start>d()-1&&(i.debug("Detected missing end"),y())},volumechange:function(){j()},waiting:function(){e(a.playStates.buffering)}};u(),Object.getOwnPropertyNames(I).forEach(function(a){B.addEventListener(a,I[a])}),C.addEventListener("bufferingStart",v),C.addEventListener("bufferingEnd",w),C.addEventListener("ended",y),C.addEventListener("seekrangechanged",x),C.addEventListener("adaptation",A),C.addEventListener("trackschanged",r),B.textTracks.addEventListener("addtrack",function(){q()}),B.textTracks.addEventListener("removetrack",function(){q()}),this.setActive=function(a){a!==E&&(E=a,i.debug("Setting Shaka video observer "+(a?"active":"inactive")),E&&u())},this.unobserve=function(){Object.getOwnPropertyNames(I).forEach(function(a){B.removeEventListener(a,I[a])}),C.removeEventListener("bufferingStart",v),C.removeEventListener("bufferingEnd",w),C.removeEventListener("ended",y),C.removeEventListener("seekrangechanged",x),C.removeEventListener("adaptation",A)}}function e(a){function b(a){h.start=a.start,h.end=a.end}function c(){return 0!==h.end||0!==h.start?h.end-h.start:d.duration}var d=a.domElement,e=a.implementationApi,f=d.volume,g=!0,h={start:0,end:0};e.addEventListener("seekrangechanged",b),this.play=function(){g&&d.play()},this.pause=function(){g&&d.pause()},this.setPosition=function(a){if(g)try{d.currentTime=h.start+a}catch(a){}},this.setVolume=function(a){d.muted=0===parseFloat(a),d.volume=a},this.setIsMuted=function(a){a?(f=d.volume,d.volume=0):d.volume=f,d.muted=a},this.gotoLive=function(){if(g){var a=c()-j;i.debug("Seeking to live",a),d.currentTime=h.start+a}},this.capBitrate=function(a){if(isNaN(a)||a===1/0||a<0)i.debug("Resetting restrictions for bitrate."),e.configure({restrictions:new shaka.player.Restrictions});else{var b=new shaka.player.Restrictions;b.maxBandwidth=1e3*a,i.debug("Applying restrictions for bitrate.",b),e.configure({restrictions:b})}},this.setActive=function(a){a!==g&&(i.debug("Setting Shaka video updater "+(a?"active":"inactive")),g=a)},this.unobserve=function(){e.removeEventListener("seekrangechanged",b)}}var f=c(42),g=c(43),h=c(4),i=h.get("shakaVideoModelAdapter"),j=10,k=20,l=100;a.exports={VideoUpdater:e,VideoObserver:d}},function(a,b,c){"use strict";function d(a,b){function c(){return x.currentTime}function d(){return 0!==y.end||0!==y.start?y.end-y.start:x.duration}function e(){q.debug("Stopping and resetting playback.");try{v.unload(),t&&t()}catch(a){q.error("Failed cleaning up upon playback stop.",a)}}function f(){u=x.currentTime,q.debug("Interrupting playback for ads.",u),x.pause()}function l(a){"number"==typeof a&&0!==a?(q.debug("Seeking upon resume according to interval:",a),x.currentTime=u+a):u&&Math.abs(x.currentTime-u)>5?q.warn("The position upon resuming is different from the position upon ad break start.",x.currentTime,u):q.debug("Resuming playback after ads."),u=void 0,x.play()}function s(e,f){function g(a,b,c,d,f){a!==r.failed&&(Y=a),e(a,b,c,d,f)}function h(){try{t&&t(),B(),i(),t=T}catch(a){if(!w||!w.isDestroying)throw q.error("Start error",a,f),a;q.debug("Shaka player was destroyed during stream load.",a,f)}}function i(){$=!1,_=!1,D(),U>0&&v.setPlaybackStartTime(U),v.load(A()).catch(function(a){q.debug("Shaka load promise returned error.",a),P(a)}),z.setTracks(f.tracks)}function l(a,b){return(a+b).toString().indexOf("pro")}function s(){var b,c=a.dash.licenseRequests&&a.dash.licenseRequests.widevine&&a.dash.licenseRequests.widevine.headers,d=a.dash.licenseUrlModifier?f.licenseUrl.replace(a.dash.licenseUrlModifier.match instanceof RegExp?a.dash.licenseUrlModifier.match:new RegExp(a.dash.licenseUrlModifier.match),a.dash.licenseUrlModifier.replacement):f.licenseUrl;return c&&(b=function(a){a.headers=c,q.debug("Adding headers to license request.",a)}),d&&q.debug("Using license URL",d),function(a,c){return l(a,c),"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"==a.toLowerCase()?[{keySystem:"com.widevine.alpha",licenseServerUrl:d,licensePreProcessor:b}]:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95"==a.toLowerCase()?[{keySystem:"com.microsoft.playready",licenseServerUrl:d,licensePreProcessor:b}]:void 0}}function u(a){q.debug("Start date/time offset",new Date(1e3*a)),b.instance.internals.availabilityStartTime=a}function A(){var b,c=a.dash.shaka.bandwidthEstimator&&"pessimistic"===a.dash.shaka.bandwidthEstimator?shaka.vimond.PessimisticBandwidthEstimator:shaka.util.EWMABandwidthEstimator,d=a.dash.manifestModifier,e=a.dash.shaka.defaultBandwidth,g=j.getBase(),h=g.shakaEstimator&&!g.shakaEstimator.getDataAge()<3600&&g.shakaEstimator;if(h||(h="pessimistic"===a.dash.shaka.bandwidthEstimator?new c(null,null,null,null,e):new c,g.shakaEstimator=h),h.supportsCaching=function(){return!0},d){var i=d.replacements&&d.replacements.map(function(a){return new shaka.vimond.dash.ReplacementRule(a.match,a.replacement,a.options)});b=new shaka.vimond.dash.ManifestModificationSetup(i,d.presentationTimeOffsetFixPolicy,d.bigIntegersFixPolicy)}var k=a.dash.streamUrlModifier?f.streamUrl.replace(a.dash.streamUrlModifier.match instanceof RegExp?a.dash.streamUrlModifier.match:new RegExp(a.dash.streamUrlModifier.match),a.dash.streamUrlModifier.replacement):f.streamUrl;return q.debug("Shaka playback set up with these parameters.",k,b),new shaka.vimond.player.ModifyableDashVideoSource(k,s(),h,null,u,b)}function B(){x.addEventListener(k.playing,G),x.addEventListener(k.timeupdate,J),x.addEventListener(k.durationchange,K),x.addEventListener(k.loadedmetadata,C),x.addEventListener("ended",I),v.addEventListener("ended",H),v.addEventListener("seekrangechanged",L),v.addEventListener("error",O),v.addEventListener("bufferingStart",function(){try{D()}catch(a){q.error("Buffering start handler failed.",a)}}),v.addEventListener("bufferingEnd",function(){try{E()}catch(a){q.error("Buffering end handler failed.",a)}})}function C(){U>0&&x.addEventListener(k.seeked,F),x.removeEventListener(k.loadedmetadata,C)}function D(){_||(_=!0,g(r.bufferingStarted,x.currentTime||U))}function E(){_&&(_=!1,g(r.bufferingEnded))}function F(){g(r.positioned,U),Z=!0,U=0,x.removeEventListener(k.seeked,F),x.addEventListener(k.seeking,M),x.addEventListener(k.seeked,N)}function G(){E(),x.removeEventListener(k.playing,G),ba.notifyStart(),g(r.started),Z||(g(r.positioned),Z=!0)}function H(){q.debug("Shaka ended"),I()}function I(){var a=g;ba.notifyEnd(),T(),a(r.ended,W,X,!1),V.fulfill()}function J(){W=x.currentTime,g(r.temporalupdate,c(),d(),x.paused),!x.paused&&0!==x.playbackRate&&!v.isLive()&&x.currentTime-y.start>d()-1&&(q.debug("End workaround activated"),I())}function K(){X=d(),g(r.temporalupdate,x.currentTime,d(),x.paused)}function L(a){y.start=a.start,y.end=a.end,K()}function M(){g(r.seekstarted,x.currentTime,d(),x.paused),$=!0}function N(){$=!1,g(r.seekended,x.currentTime,d(),x.paused)}function O(a){a.detail&&502==a.detail.status?P(n.map(a)):ba.notifyError(n.map(a))}function P(c){if(q.warn("Shaka Player fatal error.",c),b.streamFailover)try{b.streamFailover(c,aa,f,a,W,Y).then(Q).done(null,R)}catch(a){q.warn("The failover function failed. There is no failover to the failover, giving up.",a),R(c)}else R(c)}function Q(b){x.removeEventListener(k.playing,G),b.overridingConfiguration&&b.overridingConfiguration.dash&&(a.dash=o.combine(a.dash,b.overridingConfiguration.dash,!0)),b.source&&(f=b.source),U=null!=b.resumePosition?b.resumePosition:W||U,x.addEventListener(k.loadedmetadata,C),x.addEventListener(k.playing,G),g(r.failover),aa++,i()}function R(a){var b=g;T(),b(r.failed,W,X,!1,a)}function S(a){q.warn("Error from Shaka player, but not considered fatal.",a),e(r.warning,W,X,x.paused,a)}function T(){g=function(){},v.removeEventListener("ended",H),v.removeEventListener("seekrangechanged",L),v.removeEventListener("error",O),v.removeEventListener("bufferingStart",D),v.removeEventListener("bufferingEnd",E),x.removeEventListener(k.timeupdate,J),x.removeEventListener(k.durationchange,K),x.removeEventListener(k.playing,G),x.removeEventListener(k.seeking,M),x.removeEventListener(k.seeked,N),x.removeEventListener(k.ended,I),v.removeEventListener("error",O)}var U=+f.startPosition||0,V=p.defer(),W=0,X=0,Y=0,Z=!1,$=!1,_=!1,aa=0,ba=new m(P,S);return y.start=0,y.end=0,h(),V.promise}var t,u,v=b.instance.implementationApi,w=b.instance.internals,x=b.instance.domElement,y={start:0,end:0},z=new i(x,a.subtitles);return g.getScheduler(new h.InterruptableMainCuer(s,e,c,f,l),b.adCuer)}var e=c(26),f=c(35),g=c(62),h=c(48),i=c(49),j=(c(66),c(58)),k=c(47),l=c(4),m=c(74),n=c(75),o=c(7),p=c(8),q=l.get("shakaPlaybackScheduler"),r=f.basicEventTypes;a.exports={getPlaybackScheduler:e(d,"shakaPlaybackScheduler")}},function(a,b,c){"use strict";function d(a,b){var c=!1;return{notifyStart:function(){c=!0},notifyEnd:function(){c=!1},notifyError:function(d){d instanceof e&&("fatal"!==d.severity||d.code===e.codes.STREAM_ERROR_DOWNLOAD&&c)?b(d):(c=!1,a(d))}}}var e=c(66);a.exports=d},function(a,b,c){"use strict";function d(a){if(a){if(a.detail){var b=a.detail;if(b.type){if("net"==b.type)return new e(e.codes.STREAM_ERROR_DOWNLOAD,b.message,b,"dash");if("drm"==b.type&&b.code&&("output-restricted"===b.code||"output-not-allowed"===b.code||"internal-error"===b.code))return new e(e.codes.STREAM_ERROR_DRM_CLIENT_UNAVAILABLE,"The client device is not accepted for playback by the DRM system.",b,"dash");if("stream"==b.type&&b.message.indexOf("previous operation not complete")>0)return new e(e.codes.STREAM_ERROR_DECODE,b.message,b,"dash",e.severities.warning);if("playback"==b.type&&b.message.indexOf("decode")>0)return new e(e.codes.STREAM_ERROR_DECODE,b.message,b,"dash")}return b.message&&b.message.toLowerCase().indexOf("unsupported keysystem")>=0||b.message.toLowerCase().indexOf("none of the requested configurations were supported")>=0||b.message.toLowerCase().indexOf("unable to create the cdm for the key system")>=0?new e(e.codes.STREAM_ERROR_DRM_CLIENT_UNAVAILABLE,"The appropriate DRM system is not enabled or activated on this client device.",b,"dash"):new e(e.codes.STREAM_ERROR,b.message,b,"dash")}var c=a;return new e(e.codes.STREAM_ERROR,"Stream playback failed.",c,"dash")}}var e=c(66);a.exports={map:d}},function(a,b,c){"use strict";function d(a){function b(b,c){return g.promiseScript("MediaPlayer",a.dash.dashjs.libraryUrl).then(function(){function d(){try{m.reset()}catch(a){j.warn("Failed while resetting Dash.js player instance",a)}try{k.src="",k.parentNode.removeChild(k)}catch(a){j.warn("The targeted video element to remove does not exist in DOM",a)}}var e=a.dash.manifestModifier&&i.applyContext(a.dash.manifestModifier),g={html:{domClassName:a.dash.dashjs.domClassName}},k=f.applyContext(g).build(b,c),l=e?new e.HackDashContext:new Dash.di.DashContext,m=new MediaPlayer(l);return k.controls=!1,m.startup(),m.attachView(k),m.setAutoPlay(!0),m.getDebug().setLogToBrowserConsole(a.dash.dashjs.config&&a.dash.dashjs.config.logToBrowserConsole||!1),new h("dash","DASH.js",k,m,{},d)})}return{insert:b}}var e=c(26),f=c(39),g=c(7),h=c(40),i=c(77),j=c(4).get("dashVideoInserter");a.exports=e(d,"dashVideoInserter")},function(a,b,c){"use strict";function d(a){function b(){var b=new Dash.dependencies.DashParser,c=b.parse,e=!0,f=a.presentationTimeOffsetFixPolicy,h=Array.isArray(a.replacements)?a.replacements:a.match&&a.replacement?[{match:a.match,replacement:a.replacement}]:[];return h?b.parse=function(a,i,j){var k=Array.prototype.slice.call(arguments);return k[0]=h.reduce(function(b,c){var d=c.match instanceof RegExp?c.match:new RegExp(c.match.toString(),"g"),f=b.replace(d,c.replacement);return e&&(f!==a?g.debug("Manifest modifier in action: Replaced matches for %s with %s.",d,c.replacement):g.debug("Manifest modifier found nothing to replace for pattern %s to be replaced with %s.",d,c.replacement),e=!1),f},a),d(c.apply(b,k),f)}:b.parse=function(a,e,g){return d(c.apply(b,arguments),f)},b}function c(){return{system:void 0,setup:function(){c.prototype.setup.call(this),this.system.mapClass("parser",b)}}}function d(a,b){if(b&&"static"===a.type){var c="highest"==b?h(a):"lowest"==b?f(a):"higestCeil"==b?i(a):e(a);try{c>0&&(g.debug("Found missing presentationTimeOffset from segment start offset, based on the configured "+b+" policy.",c),a.Period_asArray.forEach(function(a){a.AdaptationSet_asArray.forEach(function(a){a.SegmentTemplate.presentationTimeOffset||(a.SegmentTemplate.presentationTimeOffset=c*(a.SegmentTemplate.timescale||1))})}))}catch(b){return g.error("Attempt of fixing presentationTimeOffset in manifest failed. Trying to continue anyway.",b,a),a}}return a}function e(a){var b=0,c=0,d=0,e=0;try{a.Period_asArray.forEach(function(a){a.AdaptationSet_asArray.forEach(function(a){var f=a.SegmentTemplate;if(f&&!f.presentationTimeOffset){var g=f.SegmentTimeline&&f.SegmentTimeline.S_asArray[0];if(g.t){var h=g.t/(f.timescale||1),i=g.d/(f.timescale||1);"video"===a.contentType?(b=h,e=i):"audio"===a.contentType&&(c=h,d=i)}}})})}catch(a){return g.error("Error when searching for start offset snapping to video segment start.",a),0}var f=b;return f}function f(a){var b=0;try{a.Period_asArray.forEach(function(a){a.AdaptationSet_asArray.forEach(function(a){var c=a.SegmentTemplate;if(c&&!c.presentationTimeOffset){var d=c.SegmentTimeline&&c.SegmentTimeline.S_asArray[0];if(d.t){var e=d.t/(c.timescale||1);b=0===b?e:Math.min(b,e)}}})})}catch(a){g.error("Error when searching for lowest start offset.",a)}return b}function h(a){var b=0;try{a.Period_asArray.forEach(function(a){a.AdaptationSet_asArray.forEach(function(a){var c=a.SegmentTemplate;if(c&&!c.presentationTimeOffset){var d=c.SegmentTimeline&&c.SegmentTimeline.S_asArray[0];if(d.t){var e=d.t/(c.timescale||1);b=Math.max(b,e)}}})})}catch(a){g.error("Error when searching for highest start offset.",a)}return b}function i(a){var b=0;return a.Period_asArray.forEach(function(a){a.AdaptationSet_asArray.forEach(function(a){var c=a.SegmentTemplate;if(c&&!c.presentationTimeOffset){var d=c.SegmentTimeline&&c.SegmentTimeline.S_asArray[0];d.t&&(b=Math.max(b,Math.ceil(d.t/(c.timescale||1))))}})}),b}return c.prototype=new Dash.di.DashContext,c.prototype.constructor=c,{HackDashContext:c,RewritingDashParser:b}}var e=c(4),f=c(26),g=e.get("dashOverrides");a.exports=f(d,"dashOverrides")},function(a,b,c){"use strict";function d(a,b){function c(b,c){if(v)return a.update(b,c)}function d(b){c(a.props.playState,b||t.ended&&a.playStates.inactive||t.paused&&a.playStates.paused||a.playStates.playing)}function e(){c(a.props.isPaused,t.paused)}function h(){c(a.props.volume,t.volume),c(a.props.isMuted,t.muted)}function j(){var b=new Date,d=new Date;b.setTime(1e3*u.timeAsUTC()),d.setTime(1e3*(u.durationAsUTC()-u.duration())),c(a.props.position,u.time()),c(a.props.absolutePosition,b),c(a.props.absoluteStartPosition,d)}function m(){c(a.props.duration,u.duration())}function n(){try{t.duration===1/0?c(a.props.playMode,a.playModes.live):isNaN(u.getDVRWindowSize())||u.getDVRWindowSize()===1/0?c(a.props.playMode,a.playModes.ondemand):u.duration()>l?c(a.props.playMode,a.playModes.livedvr):c(a.props.playMode,a.playModes.live)}catch(b){c(a.props.playMode,a.playModes.ondemand)}}function o(){c(a.props.isAtLivePosition,u.time()>u.duration()-k)}function p(){if(c(a.props.textTracks,f.getFromTrackList(t.textTracks)),u.getTracksFor){var b=u.getTracksFor("audio");if(b&&b.length>0){var d=b.map(function(a){var b=function(){u.setCurrentTrack(a)};return new g.AudioTrackSelectionModel(b,void 0!==a.id?a.id:a.index,a.kind,a.language?a.language:a.lang,a.label)});c(a.props.audioTracks,d)}}else i.debug("Unfortunately this particular Dash.js version does not support getTracksFor()")}function q(){c("error",t.error)}function r(){h(),d(),m(),j(),n(),o(),e(),p(),q()}function s(){w=!0}var t=b.domElement,u=b.implementationApi,v=!0,w=!1,x={abort:function(){},canplay:function(){},canplaythrough:function(){},durationchange:function(){n(),j(),m()},ended:function(){j(),d(a.playStates.inactive),e(),u.removeEventListener(MediaPlayer.events.MANIFEST_LOADED,s)},error:function(){q(),d(a.playStates.inactive),e()},loadeddata:function(){},loadedmetadata:function(){m(),j(),p()},loadstart:function(){e()},pause:function(){d(a.playStates.paused),e()},play:function(){d(a.playStates.playing),e()},playing:function(){d(a.playStates.playing),e()},progress:function(){},ratechange:function(){},seeked:function(){d(),e()},seeking:function(){d(a.playStates.seeking),e()},stalled:function(){e()},suspend:function(){},timeupdate:function(){j(),o(),m(),n()},volumechange:function(){h()},waiting:function(){d(a.playStates.buffering)}};r(),Object.getOwnPropertyNames(x).forEach(function(a){t.addEventListener(a,x[a])}),u.addEventListener("manifestLoaded",s),t.textTracks.addEventListener("addtrack",function(){p()}),t.textTracks.addEventListener("removetrack",function(){p()}),this.setActive=function(a){a!==v&&(v=a,i.debug("Setting DASH video observer "+(a?"active":"inactive")),v&&r())},this.unobserve=function(){Object.getOwnPropertyNames(x).forEach(function(a){t.removeEventListener(a,x[a])})}}function e(a){var b=a.domElement,c=a.implementationApi,d=b.volume,e=!0;this.play=function(){e&&b.play()},this.pause=function(){e&&b.pause()},this.setPosition=function(a){e&&(isNaN(a)||((isNaN(c.getDVRWindowSize())||c.getDVRWindowSize()===1/0)&&a>c.duration()-j?c.seek(c.duration()-j):c.seek(a)))},this.setVolume=function(a){b.muted=0===parseFloat(a),b.volume=a},this.setIsMuted=function(a){a?(d=b.volume,b.volume=0):b.volume=d,b.muted=a},this.gotoLive=function(){e&&!isNaN(c.duration())&&(i.debug("Seeking to live",c.duration()-j),c.seek(c.duration()-j))},this.capBitrate=function(a){isNaN(a)||a===1/0||a<0?(i.debug("Resetting restrictions for bitrate."),c.setMaxAllowedBitrateFor("video",NaN)):(i.debug("Applying restrictions for bitrate.",a),c.setMaxAllowedBitrateFor("video",a))},this.setActive=function(a){a!==e&&(i.debug("Setting DASH video updater "+(a?"active":"inactive")),e=a)}}var f=c(42),g=c(43),h=c(4),i=h.get("dashVideoModelAdapter"),j=20,k=30,l=100;a.exports={VideoUpdater:e,VideoObserver:d}},function(a,b,c){"use strict";function d(a,b){function c(){return s.time()}function d(){o.debug("Stopping and resetting playback.");try{s.reset()}catch(a){o.warn("Failed resettting Dash.js upon playback stop.",a)}try{t.src="",q&&q()}catch(a){o.error("Failed cleaning up upon playback stop.",a)}}function e(){r=s.time(),o.debug("Interrupting playback for ads.",r),t.pause()}function f(a){"number"==typeof a&&0!==a?(o.debug("Seeking upon resume according to interval:",a),s.seek(r+a)):r&&Math.abs(s.time()-r)>5?o.warn("The position upon resuming is different from the position upon ad break start.",s.time(),r):o.debug("Resuming playback after ads."),r=void 0,t.play()}function m(b,c){function d(){try{q&&q(),b(p.bufferingStarted,D),e();var a;if(c.licenseUrl){var d=I.licenseRequests&&I.licenseRequests.widevine&&I.licenseRequests.widevine.headers,f=I.licenseUrlModifier?c.licenseUrl.replace(I.licenseUrlModifier.match instanceof RegExp?I.licenseUrlModifier.match:new RegExp(I.licenseUrlModifier.match),I.licenseUrlModifier.replacement):c.licenseUrl;a={},a[v]=new MediaPlayer.vo.protection.ProtectionData(f,d),o.debug("License URL for system "+v+" specified to Dash.js: "+f)}var g=I.streamUrlModifier?c.streamUrl.replace(I.streamUrlModifier.match instanceof RegExp?I.streamUrlModifier.match:new RegExp(I.streamUrlModifier.match),I.streamUrlModifier.replacement):c.streamUrl;a&&s.attachProtectionData&&s.attachProtectionData(a),s.attachSource(g,null,a),u.setTracks(c.tracks),q=C}catch(a){o.error("Start error",a),E.reject(a)}}function e(){t.addEventListener(l.playing,h),t.addEventListener(l.ended,i),t.addEventListener(l.error,A),t.addEventListener(l.timeupdate,m),t.addEventListener(l.durationchange,r),0===D&&(t.addEventListener(l.seeking,w),t.addEventListener(l.seeked,x)),t.addEventListener(l.loadedmetadata,f),s.addEventListener("error",B)}function f(){D>0&&(o.debug("Applying start position"),t.addEventListener(l.seeked,g),s.seek(D)),t.removeEventListener(l.loadedmetadata,f)}function g(){b(p.positioned,D),D=0,t.addEventListener(l.seeking,w),t.addEventListener(l.seeked,x)}function h(){b(p.bufferingEnded),t.removeEventListener(l.playing,h),J.notifyStart(),b(p.started),0===D&&b(p.positioned)}function i(){var a=b;J.notifyEnd(),C(),a(p.ended,F,G,!1),E.fulfill()}function m(){F=t.currentTime,b(p.temporalupdate,t.currentTime,t.duration,t.paused)}function r(){G=t.duration,b(p.temporalupdate,t.currentTime,t.duration,t.paused)}function w(){b(p.bufferingStarted),b(p.seekstarted,t.currentTime,t.duration,t.paused),H=!0}function x(){H=!1,b(p.bufferingEnded),b(p.seekended,t.currentTime,t.duration,t.paused)}function y(a){o.warn("Unrecoverable stream error.",a);var c=b;C(),c(p.failed,F,G,!1,a)}function z(a){o.warn("Error from Dash.js player, but not considered fatal.",a),b(p.warning,F,G,t.paused,a)}function A(){J.notifyError(k.map(t.error))}function B(a){J.notifyError(k.map(a))}function C(){b=function(){},t.removeEventListener(l.error,A),t.removeEventListener(l.timeupdate,m),t.removeEventListener(l.durationchange,r),t.removeEventListener(l.playing,h),t.removeEventListener(l.ended,i),t.removeEventListener(l.seeking,w),t.removeEventListener(l.seeked,x),s.removeEventListener("error",B)}var D=+c.startPosition||0,E=n.defer(),F=0,G=0,H=!1,I=a.dash,J=new j(y,z);return d(),E.promise}var q,r,s=b.instance.implementationApi,t=b.instance.domElement,u=new i(t,a.subtitles),v=navigator.userAgent.indexOf("Chrome")>=0&&navigator.userAgent.indexOf("Edge")<0?"com.widevine.alpha":"com.microsoft.playready";return g.getScheduler(new h.InterruptableMainCuer(m,d,c,e,f),b.adCuer)}var e=c(26),f=c(35),g=c(62),h=c(48),i=c(49),j=(c(66),c(74)),k=c(80),l=c(47),m=c(4),n=c(8),o=m.get("dashPlaybackScheduler"),p=f.basicEventTypes;a.exports={getPlaybackScheduler:e(d,"dashPlaybackScheduler")}},function(a,b,c){"use strict";function d(a){var b=e.codes.STREAM_ERROR,c="Stream playback failed";return a.error&&("key_session"===a.error&&(a.event.indexOf("DRM system for this content not supported")||a.event.indexOf("The protection system for this content is not supported"))?b=e.codes.STREAM_ERROR_DRM_CLIENT_UNAVAILABLE:"download"===a.error&&(b=e.codes.STREAM_ERROR_DOWNLOAD)),new e(b,c,a,"dash")}var e=c(66);a.exports={map:d}},function(a,b,c){"use strict";function d(a,b,c){function d(){i.setupPlayback(a,b,c).fail(l.getPlaybackStartErrorHandler(a)).then(function(a){n.debug("Startup promise chain fulfilled.",a)})}var e=!0;return function(a){e&&(e=!1,d())}}function e(a,b,c){return a.model.configuration.getConfiguration().tracking&&a.model.configuration.getConfiguration().tracking.followme&&playbackSession.getAsset?playbackSession.getAsset().then(function(){return j.checkResume(a).then(function(a){return a>0&&playbackSession.setResumePosition(a),b(!0)})}):b(c)}function f(a,b,c){var d={startClick:function(c){return a.appContainer.videoElement&&(a.appContainer.videoElement.play(),a.appContainer.videoElement.pause()),e(a,b),c.preventDefault&&c.preventDefault(),!1},imageLoad:function(){a.finished(),k.preloadScripts(a.model.configuration.getConfiguration())}};return h(a,d,c)}var g=c(82),h=c(105),i=c(148),j=c(175),k=c(176),l=c(177),m=c(4),n=m.get("startController");a.exports={init:function(a,b,c,h,i){var j=g.start(b,a.model.configuration);a.model.playbackSession=j,a.model.trackerManager.notifySessionStart(j),a.api.setPlaybackSession(j);var k=d(a,j,c);return i||!h&&(a.model.configuration.getOptions().autoplay||a.model.configuration.getOptions().forceAutoplay)?e(a,k):f(a,k,!!h)}}},function(a,b,c){"use strict";function d(a,b){function c(a){function b(b){return{id:b.id||b["@id"],type:"item",dateBegin:b.dateBegin,dateEnd:b.dateEnd,imageUrl:b.picture&&I.replace(/\{picture\}/gi,b.picture),text:b.text,timeBegin:(b.timeBegin||0)-(a.onDemandTimeBegin||0),timeEnd:(b.timeEnd||0)-(a.onDemandTimeBegin||0),originalTimeBegin:b.originalTimeBegin,title:b.title,categoryName:b.categoryName,duration:b.duration
}}if(null==a||null!=a.itemsPublished&&a.itemsPublished!==!0||!a.items)return k.fcall(function(){return[]});var c;return c=Array.isArray(a.items)?a.items[0]:a.items,c.item?k(Array.isArray(c.item)?c.item.map(b):[b(c.item)]):F.getItems(c["@uri"]).then(function(a){var c=a.item;return Array.isArray(c)?c.map(b):c?b(c):[]})}function d(a){return a?F.getCategory(a.getReference("category")):k.fcall(function(){return null})}function j(){return t||(t=F.getAsset(A))}function m(){return x||(x=j().then(d))}function n(){return u||(u=j().then(c))}function o(a){return function(b){if(a){var c=a.bitrate;if(c)if(parseInt(c,10).toString()==c.toString()){if(b.bitrate!=c)return!1}else{if(c.minimum&&b.bitrate<c.minimum)return!1;if(c.maximum&&b.bitrate>c.maximum)return!1}if(a.mediaFormat&&a.mediaFormat!=b.mediaFormat)return!1;if(a.scheme&&a.scheme!=b.scheme)return!1}return!0}}function p(a){var b=a.license&&(a.license["@uri"]||a.license.uri);if(b){b=F.getResourceUrl("license",b,null,!0);var c=i.combine(a,null,!0);return c.license={"@uri":b},c}return a}function q(a,c){var d=c?e.get(E.rest,c):F,g=K?f.getDeviceInfo(b.getConfiguration()):k();return v=g.then(function(a){return j().then(function(b){var e=k(void 0);return"undefined"!=typeof externalStreamLookup&&(e=externalStreamLookup(b,c)),e.then(function(c){return c?c:d.getPlayback(b.id,J,a)},function(a){console.warn(a,"externalStreamLookup in playbackSession returned an error")})}).then(function(a){if(w=a,a.drmProtected&&c.supportsDrm===!1)return[];if(a.live&&!c.supportsLive&&"ASSET_PLAYBACK_INVALID_VIDEO_FORMAT"===a.playbackStatus)return[];if("OK"===w.playbackStatus){var b=w.getList("items");return b.filter(o(c&&c.filter)).map(p)}var d=new Error("Not available for playback.");throw d.playback=w,d},function(a){if(a.code&&"ASSET_PLAYBACK_INVALID_VIDEO_FORMAT"===a.code)return[];throw a})})}function r(){return v}function s(){return w}var t,u,v,w,x,y,z,A,B,C=0,D=g.decorate(a),E=b.getConfiguration(),F=e.get(E.rest,b.getEmbedContext()),G=E.imageUrlPatterns&&E.imageUrlPatterns.assetId||"",H=E.imageUrlPatterns&&E.imageUrlPatterns.imagePack||!1,I=E.imageUrlPatterns&&E.imageUrlPatterns.itemPicture||"{picture}",J=E.appName.html||E.appName,K=E.deviceId&&E.deviceId.enabled,L=a;if("[object Array]"===Object.prototype.toString.call(a)&&a.length>0&&(L=a[0]),L.asset&&L.asset["@id"])t=k(L.asset);else{var M=0,N=0;if(parseInt(L,10).toString()==L?A=parseInt(L,10):(A=L.assetId||0,B=L.itemId||0,M=L.playQueueId||L.playQueue||L.playqueue||L.queue||0,N=L.startAtItem||L.startAtItemId||L.startAt||0),0===A)throw new Error("Only assets specified by their native ids or full resource objects can be played at this time.")}return{getAsset:j,getImageUrl:function(){if(t&&"fulfilled"==t.inspect().state){var a=t.inspect().value;if(a)return H?a.metadata&&a.metadata["image-pack"]?H.replace(/\{picture}/,a.metadata["image-pack"].$):"":a.imageVersions&&a.imageVersions.image&&a.imageVersions.image.url;l.warn("Asset promise fulfilled, but result is null.")}return G.replace(/\{trunc\}/gi,Math.floor(A/1e3).toString()).replace(/\{assetId\}/gi,A)},getItems:n,getCurrentItem:function(){return y},setCurrentItem:function(a){y=a},getStartItem:function(){return z||(z=n().then(function(a){return h(a,function(a){return a.id==B})}))},lookupStreams:q,getStreams:r,getPlayback:s,getCategory:m,getSubtitlesList:function(){return F.getSubtitlesList(A)},logPlayback:function(a,b){l.debug("Playback logged."),a&&a.log&&a.log["@uri"]&&F.postPlaybackLog(a.log["@uri"],b)},getAssetReference:function(a){return F.getResourceUrl("asset",A,{},a)},getStartParameters:function(){return D},getStartPosition:function(){return C||D.getStartPosition()},setResumePosition:function(a){C=a},getCentralTimeOffset:F.getCentralTimeOffset}}var e=c(83),f=c(22),g=c(95),h=c(96),i=c(7),j=c(4),k=c(23),l=j.get("playbackSession");a.exports={start:function(a,b){return new d(a,b)}}},function(a,b,c){"use strict";function d(a,b,c,d){this.code=a,this.message=b,this.resourceType=c,this.resourceReference=d,this.rest=!0}function e(a){if(a.error)throw new d(a.error.code,a.error.description,a.error.resourceType,a.error.resourceReference);return a}var f=c(84),g=c(94),h=c(7),i=c(23),j={SESSION_NOT_AUTHENTICATED:"loginRequired",UNAUTHORIZED:"purchaseRequired",ASSET_PLAYBACK_INVALID_GEO_LOCATION:"geoBlocked",DEVICE_INFO_REQUIRED:"deviceInfoRequired",DEVICE_LIMIT_EXCEEDED:"deviceLimitExceeded"};d.prototype=new Error,d.prototype.constructor=d,a.exports={get:function(a,b){var c={resourceProperties:g,centralTimeOffset:0};a&&(c.apiServer=a.apiServer||document.location.protocol+"//"+document.location.host,c.basePath=a.basePath,c.useSsl=a.useSsl||!1,c.resourceParameters=a.resourceParameters||{},c.platform=a.platform,c.authorization=a.authorization,c.deviceRegistration=a.deviceRegistration,c.customResourceProperties=a.customResourceProperties||void 0,a.enableCentralTimeOffsetRetrieval&&(c.centralTimeOffset=void 0)),b&&(c.platform=b.platform,c.streamParameters={},b.protocol&&(c.streamParameters.protocol=b.protocol),b.customParam&&(c.streamParameters.customParam=b.customParam),b.videoFormat&&(c.streamParameters.videoFormat=b.videoFormat),b.centralTimeOffset&&(c.centralTimeOffset=b.centralTimeOffset));var k=f.createContext(c);return{get:function(a){return k.performRequest(null,a,f.GET)},getAsset:function(a,b){return b=h.combine(b,c.resourceParameters.asset),k.performRequest("asset",a,f.GET,b).then(e)},getPlayback:function(a,b,e){var g,h,i=c.streamParameters||{},l=f.GET;return b&&(i.app_name=b),c.deviceRegistration?(g=JSON.stringify({playRequest:{authorize:{device:{udid:c.deviceRegistration.udid||"",label:c.deviceRegistration.label||""}}}}),h="application/json",l=f.POST):e&&(g=JSON.stringify({playRequest:{authorize:{device:e}}}),h="application/json",l=f.POST),k.performRequest("playback",a,l,i,g,h).then(function(b){if(b.error){var c=j[b.error.code],e={description:b.error.description};if(c&&(e[c]=!0),e.deviceLimitExceeded||e.loginRequired||e.purchaseRequired||e.geoBlocked)return e.playbackStatus=b.error.code,e.items={item:[]},e;throw new d(b.error.code,b.error.description,"playback",a)}return b})},postPlaybackLog:function(a,b){return k.performRequest("playbacklog",a,f.POST,{},"payload="+encodeURIComponent(b),"application/x-www-form-urlencoded")},getItems:function(a){return k.performRequest("items",a,f.GET).then(e)},getSubtitlesList:function(a){return k.performRequest("subtitles",a,f.GET).then(e).then(function(a){try{Array.isArray(a)&&a.forEach(function(a){a.subtitles.uri=k.getResourceUrl("subtitle",a.subtitles.uri)})}catch(a){logger.warn("Modifying subtitles URLs failed",a)}return a})},getSubtitlesFile:function(a){return k.performRequest("subtitlesFile",a,f.GET,null,null,null,!1).then(e)},getCategory:function(a){var b=h.combine(b,c.resourceParameters.category);return k.performRequest("category",a,f.GET,b).then(e)},getCategories:function(a){return k.performRequest("categories",a,f.GET).then(e)},getAssets:function(a){return k.performRequest("assets",a,f.GET,c.resourceParameters.assets).then(e)},searchForAssets:function(a,b){return k.performRequest("assetSearch",a,f.GET,b).then(e)},searchForCategories:function(a,b){return k.performRequest("categorySearch",a,f.GET,b).then(e)},getAuthenticationStatus:function(){return k.performRequest("authenticationStatus",0,f.GET).then(e)},getUser:function(){return k.performRequest("user",0,f.GET).then(e)},getSchedule:function(a,b,c){if(b instanceof Date&&c instanceof Date){var d="{mm}/{dd}/{yyyy}",g={channel:a,airDateStart:{noEscape:!0,value:h.format(d,{mm:b.getMonth()+1,dd:b.getDate(),yyyy:b.getFullYear()})},airDateEnd:{noEscape:!0,value:h.format(d,{mm:c.getMonth()+1,dd:c.getDate(),yyyy:c.getFullYear()})}};return k.performRequest("schedule",a,f.GET,g).then(e)}return i.reject(new Error("Start and end date arguments are mandatory for getSchedule()"))},getResourceUrl:function(a,b,d,e,f){var g=f?c.resourceParameters[a]:{};return k.getResourceUrl(a,b,h.combine(d,g),e)},getCentralTimeOffset:function(){return c.centralTimeOffset?(b.centralTimeOffset=c.centralTimeOffset,c.centralTimeOffset):0}}},RestError:d}},function(a,b,c){(function(b){"use strict";function d(a,b,c,d){var e=b;if("string"==typeof b){var f=0===b.indexOf("http");if(f||0===b.indexOf("/")){var g="";return g=null==c||l(c)?b:b+m.objectToQueryString(c,b.indexOf("?")>0?"&":"?"),f||(this.basePath&&(g=this.basePath+g),d&&(g=this.apiServer+g)),g}}if(b=parseInt(b,10),!isNaN(b)){var h=this.customResourceProperties&&this.customResourceProperties[a]&&this.customResourceProperties[a].pattern||this.resourceProperties[a]&&this.resourceProperties[a].pattern;if(h){var i=h.replace(/\{platform\}/gi,this.platform).replace(/\{id\}/gi,b).replace(/\{parameters\}/gi,m.objectToQueryString(c,"?"));return this.basePath&&(i=this.basePath+i),d?this.apiServer+i:i}}throw new Error("Unable to identify REST resource "+e)}function e(a,c,e,h,i,j,k){var l=d.call(this,a,c,h,!0),m=this.resourceProperties[a],n=null==this.centralTimeOffset;return this.centralTimeOffset=0,b.doRequest(l,e,i,j,{authorization:this.authorization,shouldParse:k,includeDateHeader:n}).then(function(b){this&&b.date&&(this.centralTimeOffset=g(b.date));var d=f(b.data,a,c,m);return null==d&&"GET"==e&&o.warn("REST GET request for type "+a+" with status returned no content.",c),d}.bind(this),function(a){throw a.message?o.warn("REST request failed.",a.message):o.warn("REST request failed.",a),a})}function f(a,b,c,d){if(a&&a.error&&(a.error.resourceReference=c,a.error.resourceType=b),d&&"searchResult"==d.structure)return h(a,d.returnType,d.pluralReturnType);var e=a&&b&&a[b]||a;return e&&j(e),e}function g(a){try{var b=new Date,c=new Date(a);return o.debug("Central time offset found from date header "+a+": "+(b.getTime()-c.getTime())/1e3),(b.getTime()-c.getTime())/1e3}catch(b){return o.debug("Not possible to compute central time, defaulting to 0.",a),0}}function h(a,b,c){var d=c||b+"s";if(b){var e=a[d];if(null!=e){var f={numberOfHits:e.numberOfHits||0},g=e[b],h=[];if(g)if(Array.isArray(g))for(var l=0;l<g.length;l++)j(g[l]),h.push(g[l]);else j(g),h.push(g);return f.getList=function(){return h},f.list=h,i(a,!1),0===f.numberOfHits&&(f.numberOfHits=h.length),f}throw new k("data","Misconfigured API search request. Return type missing.")}throw new k("data","Misconfigured API search request. Return type not configured.")}function i(a,b){for(var c in a)if(a.hasOwnProperty(c))if("@"==c.charAt(0)){var d=c.substring(1);null==a[d]&&(a[d]=a[c])}else b&&m.isJson(a[c])&&i(a[c],!0);a["@uri"]&&null==a.reference&&(a.reference=a["@uri"])}function j(a){a.getProperty=function(b){try{for(var c=b.split("."),d=a,e=0;e<c.length;e++)d=d[c[e]];return d}catch(a){return null}},a.getReference=function(b){var c=a.getProperty(b);return c?c["@uri"]:null};try{i(a,!0)}catch(a){o.error("Trouble",a)}a.getList=function(b,c){if(!c){var d=b.split("."),e=d[d.length-1];c=e.substring(0,e.length-1)}var f=a.getProperty(b),g=f&&f[c];return null==g?[]:Array.isArray(g)?g:[g]}}var k=c(86),l=c(87),m=c(7),n=c(4),o=n.get("requester");a.exports={createContext:function(a){return{performRequest:function(){return e.apply(a,arguments)},getResourceUrl:function(){return d.apply(a,arguments)}}},RequestError:k,GET:"GET",POST:"POST"}}).call(b,c(85))},function(a,b,c){"use strict";function d(a,b,c,d,h){var i=!1,j=g.defer(),k=new XMLHttpRequest,l=function(b){i||(e.warn("XHR error",b,k.status),j.reject(new f("xhr","Request failed.",a)))},m=function(b){e.warn("XHR abort",b),j.reject(new f("xhr","Request aborted.",a))},n=function(b){e.warn("XHR timeout",b),j.reject(new f("xhr","Request aborted.",a))};return k.onreadystatechange=function(){try{if(4==k.readyState)if(0!==k.responseText.indexOf("<?xml")&&0!==k.responseText.indexOf("<html")||h.shouldParse===!1){var c=h.includeDateHeader&&k.getResponseHeader("Date");if(k.responseText.length>0){var d=h.shouldParse===!1?k.responseText:JSON.parse(k.responseText);j.resolve({data:d,date:c})}else{if("GET"==b&&0===k.status)return void j.reject(new f("xhr","Request returned with no response. Please look for cors errors",a));j.resolve({data:null,date:c})}}else e.warn("(X|HT)ML instead of JSON returned from Vimond API request.",{content:k.responseText}),j.reject(new f("xml","The server returned an unknown error.",a,k.responseText))}catch(a){j.reject(a)}},k.onerror=l,k.onabort=m,k.ontimeout=n,k.open(b,a),k.withCredentials=!h||null==h.withCredentials||h.withCredentials,k.setRequestHeader("Accept","application/json, application/javascript"),d&&k.setRequestHeader("Content-type",d),h.authorization&&k.setRequestHeader("Authorization",h.authorization),k.send(c),j.promise}var e=c(4),f=c(86),g=c(23);a.exports={doRequest:d}},function(a,b,c){var d,e;d=[],e=function(){function a(a,b,c,d){this.code=a,this.message=b||"Rest client error",this.url=c,this.response=d,this.requester=!0}return a.prototype=new Error,a.prototype.constructor=a,a}.apply(b,d),!(void 0!==e&&(a.exports=e))},function(a,b,c){function d(a){return!!a&&"object"==typeof a}function e(a){return function(b){return null==b?void 0:b[a]}}function f(a){return null!=a&&g(o(a))}function g(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=n}function h(a){return null==a||(f(a)&&(j(a)||l(a)||i(a)||d(a)&&k(a.splice))?!a.length:!m(a).length)}var i=c(88),j=c(89),k=c(90),l=c(91),m=c(92),n=9007199254740991,o=e("length");a.exports=h},function(a,b){function c(a){return function(b){return null==b?void 0:b[a]}}function d(a){return f(a)&&p.call(a,"callee")&&(!r.call(a,"callee")||q.call(a)==l)}function e(a){return null!=a&&h(s(a))&&!g(a)}function f(a){return j(a)&&e(a)}function g(a){var b=i(a)?q.call(a):"";return b==m||b==n}function h(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=k}function i(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function j(a){return!!a&&"object"==typeof a}var k=9007199254740991,l="[object Arguments]",m="[object Function]",n="[object GeneratorFunction]",o=Object.prototype,p=o.hasOwnProperty,q=o.toString,r=o.propertyIsEnumerable,s=c("length");a.exports=d},function(a,b){function c(a){return!!a&&"object"==typeof a}function d(a,b){var c=null==a?void 0:a[b];return h(c)?c:void 0}function e(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=r}function f(a){return g(a)&&o.call(a)==j}function g(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function h(a){return null!=a&&(f(a)?p.test(m.call(a)):c(a)&&k.test(a))}var i="[object Array]",j="[object Function]",k=/^\[object .+?Constructor\]$/,l=Object.prototype,m=Function.prototype.toString,n=l.hasOwnProperty,o=l.toString,p=RegExp("^"+m.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),q=d(Array,"isArray"),r=9007199254740991,s=q||function(a){return c(a)&&e(a.length)&&o.call(a)==i};a.exports=s},function(a,b){function c(a){var b=d(a)?h.call(a):"";return b==e||b==f}function d(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var e="[object Function]",f="[object GeneratorFunction]",g=Object.prototype,h=g.toString;a.exports=c},function(a,b){function c(a){return!!a&&"object"==typeof a}function d(a){return"string"==typeof a||c(a)&&g.call(a)==e}var e="[object String]",f=Object.prototype,g=f.toString;a.exports=d},function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}function e(a){return null!=a&&g(s(a))}function f(a,b){return a="number"==typeof a||n.test(a)?+a:-1,b=null==b?r:b,a>-1&&a%1==0&&a<b}function g(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=r}function h(a){for(var b=j(a),c=b.length,d=c&&a.length,e=!!d&&g(d)&&(m(a)||l(a)),h=-1,i=[];++h<c;){var k=b[h];(e&&f(k,d)||p.call(a,k))&&i.push(k)}return i}function i(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function j(a){if(null==a)return[];i(a)||(a=Object(a));var b=a.length;b=b&&g(b)&&(m(a)||l(a))&&b||0;for(var c=a.constructor,d=-1,e="function"==typeof c&&c.prototype===a,h=Array(b),j=b>0;++d<b;)h[d]=d+"";for(var k in a)j&&f(k,b)||"constructor"==k&&(e||!p.call(a,k))||h.push(k);return h}var k=c(93),l=c(88),m=c(89),n=/^\d+$/,o=Object.prototype,p=o.hasOwnProperty,q=k(Object,"keys"),r=9007199254740991,s=d("length"),t=q?function(a){var b=null==a?void 0:a.constructor;return"function"==typeof b&&b.prototype===a||"function"!=typeof a&&e(a)?h(a):i(a)?q(a):[]}:h;a.exports=t},function(a,b){function c(a){return!!a&&"object"==typeof a}function d(a,b){var c=null==a?void 0:a[b];return g(c)?c:void 0}function e(a){return f(a)&&m.call(a)==h}function f(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function g(a){return null!=a&&(e(a)?n.test(k.call(a)):c(a)&&i.test(a))}var h="[object Function]",i=/^\[object .+?Constructor\]$/,j=Object.prototype,k=Function.prototype.toString,l=j.hasOwnProperty,m=j.toString,n=RegExp("^"+k.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=d},function(a,b,c){!(a.exports={asset:{pattern:"/api/{platform}/asset/{id}{parameters}",structure:"single"},playback:{pattern:"/api/{platform}/asset/{id}/play{parameters}",structure:"single"},subtitles:{pattern:"/api/{platform}/asset/{id}/subtitles"},assetSearch:{pattern:"/api/{platform}/search/categories/{id}/assets{parameters}",structure:"searchResult",returnType:"asset"},categorySearch:{pattern:"/api/{platform}/search/categories/{id}{parameters}",structure:"searchResult",returnType:"category",pluralReturnType:"categories"},category:{pattern:"/api/{platform}/category/{id}",structure:"single"},categories:{pattern:"/api/{platform}/category/{id}/categories",structure:"searchResult",returnType:"category",pluralReturnType:"categories"},assets:{pattern:"/api/{platform}/category/{id}/assets{parameters}",structure:"searchResult",returnType:"asset",pluralReturnType:"assets"},authenticationStatus:{pattern:"/api/authentication/user/",structure:"single"},schedule:{pattern:"/api/{platform}/schedule{parameters}",structure:"single"},user:{pattern:"/api/{platform}/user",structure:"single"}})},function(a,b,c){"use strict";function d(a){function b(b){return d?a[b||0]:a}function c(a){return a.assetId||(a.asset?a.asset.id:a)}var d=Array.isArray(a);return{getAssetId:function(a){return c(b(a))},getStartPosition:function(a){return b(a).startPosition||0},getItemId:function(a){return b(a).itemId||0},findEntryByAssetId:function(b){return d?e(a,function(a){return c(a)==b}):b==c(a)?a:void 0},original:a}}var e=c(96);a.exports={decorate:function(a){return new d(a)}}},function(a,b,c){function d(a,b){return function(c,d,f){if(d=e(d,f,3),i(c)){var j=h(c,d,b);return j>-1?c[j]:void 0}return g(c,d,a)}}var e=c(97),f=c(102),g=c(103),h=c(104),i=c(89),j=d(f);a.exports=j},function(a,b,c){function d(a){return null==a?"":a+""}function e(a,b,c){var d=typeof a;return"function"==d?void 0===b?a:w(a,b,c):null==a?t:"object"==d?h(a):void 0===b?u(a):i(a,b)}function f(a,b,c){if(null!=a){void 0!==c&&c in p(a)&&(b=[c]);for(var d=0,e=b.length;null!=a&&d<e;)a=a[b[d++]];return d&&d==e?a:void 0}}function g(a,b,c){var d=b.length,e=d,f=!c;if(null==a)return!e;for(a=p(a);d--;){var g=b[d];if(f&&g[2]?g[1]!==a[g[0]]:!(g[0]in a))return!1}for(;++d<e;){g=b[d];var h=g[0],i=a[h],j=g[1];if(f&&g[2]){if(void 0===i&&!(h in a))return!1}else{var k=c?c(i,j,h):void 0;if(!(void 0===k?v(j,i,c,!0):k))return!1}}return!0}function h(a){var b=m(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null!=a&&a[c]===d&&(void 0!==d||c in p(a))}}return function(a){return g(a,b)}}function i(a,b){var c=x(a),d=n(a)&&o(b),e=a+"";return a=q(a),function(g){if(null==g)return!1;var h=e;if(g=p(g),(c||!d)&&!(h in g)){if(g=1==a.length?g:f(g,l(a,0,-1)),null==g)return!1;h=r(a),g=p(g)}return g[h]===b?void 0!==b||h in g:v(b,g[h],void 0,!0)}}function j(a){return function(b){return null==b?void 0:b[a]}}function k(a){var b=a+"";return a=q(a),function(c){return f(c,a,b)}}function l(a,b,c){var d=-1,e=a.length;b=null==b?0:+b||0,b<0&&(b=-b>e?0:e+b),c=void 0===c||c>e?e:+c||0,c<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function m(a){for(var b=y(a),c=b.length;c--;)b[c][2]=o(b[c][1]);return b}function n(a,b){var c=typeof a;if("string"==c&&A.test(a)||"number"==c)return!0;if(x(a))return!1;var d=!z.test(a);return d||null!=b&&a in p(b)}function o(a){return a===a&&!s(a)}function p(a){return s(a)?a:Object(a)}function q(a){if(x(a))return a;var b=[];return d(a).replace(B,function(a,c,d,e){b.push(d?e.replace(C,"$1"):c||a)}),b}function r(a){var b=a?a.length:0;return b?a[b-1]:void 0}function s(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function t(a){return a}function u(a){return n(a)?j(a):k(a)}var v=c(98),w=c(100),x=c(89),y=c(101),z=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,A=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,C=/\\(\\)?/g;a.exports=e},function(a,b,c){function d(a){return!!a&&"object"==typeof a}function e(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function f(a,b,c,e,h,i){return a===b||(null==a||null==b||!k(a)&&!d(b)?a!==a&&b!==b:g(a,b,f,c,e,h,i))}function g(a,b,c,d,e,f,g){var k=l(a),n=l(b),q=p,r=p;k||(q=z.call(a),q==o?q=u:q!=u&&(k=m(a))),n||(r=z.call(b),r==o?r=u:r!=u&&(n=m(b)));var s=q==u,t=r==u,v=q==r;if(v&&!k&&!s)return i(a,b,q);if(!e){var w=s&&y.call(a,"__wrapped__"),x=t&&y.call(b,"__wrapped__");if(w||x)return c(w?a.value():a,x?b.value():b,d,e,f,g)}if(!v)return!1;f||(f=[]),g||(g=[]);for(var A=f.length;A--;)if(f[A]==a)return g[A]==b;f.push(a),g.push(b);var B=(k?h:j)(a,b,c,d,e,f,g);return f.pop(),g.pop(),B}function h(a,b,c,d,f,g,h){var i=-1,j=a.length,k=b.length;if(j!=k&&!(f&&k>j))return!1;for(;++i<j;){var l=a[i],m=b[i],n=d?d(f?m:l,f?l:m,i):void 0;if(void 0!==n){if(n)continue;return!1}if(f){if(!e(b,function(a){return l===a||c(l,a,d,f,g,h)}))return!1}else if(l!==m&&!c(l,m,d,f,g,h))return!1}return!0}function i(a,b,c){switch(c){case q:case r:return+a==+b;case s:return a.name==b.name&&a.message==b.message;case t:return a!=+a?b!=+b:a==+b;case v:case w:return a==b+""}return!1}function j(a,b,c,d,e,f,g){var h=n(a),i=h.length,j=n(b),k=j.length;if(i!=k&&!e)return!1;for(var l=i;l--;){var m=h[l];if(!(e?m in b:y.call(b,m)))return!1}for(var o=e;++l<i;){m=h[l];var p=a[m],q=b[m],r=d?d(e?q:p,e?p:q,m):void 0;if(!(void 0===r?c(p,q,d,e,f,g):r))return!1;o||(o="constructor"==m)}if(!o){var s=a.constructor,t=b.constructor;if(s!=t&&"constructor"in a&&"constructor"in b&&!("function"==typeof s&&s instanceof s&&"function"==typeof t&&t instanceof t))return!1}return!0}function k(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var l=c(89),m=c(99),n=c(92),o="[object Arguments]",p="[object Array]",q="[object Boolean]",r="[object Date]",s="[object Error]",t="[object Number]",u="[object Object]",v="[object RegExp]",w="[object String]",x=Object.prototype,y=x.hasOwnProperty,z=x.toString;a.exports=f},function(a,b){function c(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=f}function d(a){return!!a&&"object"==typeof a}function e(a){return d(a)&&c(a.length)&&!!E[G.call(a)]}var f=9007199254740991,g="[object Arguments]",h="[object Array]",i="[object Boolean]",j="[object Date]",k="[object Error]",l="[object Function]",m="[object Map]",n="[object Number]",o="[object Object]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object WeakMap]",t="[object ArrayBuffer]",u="[object DataView]",v="[object Float32Array]",w="[object Float64Array]",x="[object Int8Array]",y="[object Int16Array]",z="[object Int32Array]",A="[object Uint8Array]",B="[object Uint8ClampedArray]",C="[object Uint16Array]",D="[object Uint32Array]",E={};E[v]=E[w]=E[x]=E[y]=E[z]=E[A]=E[B]=E[C]=E[D]=!0,E[g]=E[h]=E[t]=E[i]=E[u]=E[j]=E[k]=E[l]=E[m]=E[n]=E[o]=E[p]=E[q]=E[r]=E[s]=!1;var F=Object.prototype,G=F.toString;a.exports=e},function(a,b){function c(a,b,c){if("function"!=typeof a)return d;if(void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function d(a){return a}a.exports=c},function(a,b,c){function d(a){return e(a)?a:Object(a)}function e(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function f(a){a=d(a);for(var b=-1,c=g(a),e=c.length,f=Array(e);++b<e;){var h=c[b];f[b]=[h,a[h]]}return f}var g=c(92);a.exports=f},function(a,b,c){function d(a,b){return n(a,b,k)}function e(a){return function(b){return null==b?void 0:b[a]}}function f(a,b){return function(c,d){var e=c?o(c):0;if(!h(e))return a(c,d);for(var f=b?e:-1,g=i(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function g(a){return function(b,c,d){for(var e=i(b),f=d(b),g=f.length,h=a?g:-1;a?h--:++h<g;){var j=f[h];if(c(e[j],j,e)===!1)break}return b}}function h(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=l}function i(a){return j(a)?a:Object(a)}function j(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var k=c(92),l=9007199254740991,m=f(d),n=g(),o=e("length");a.exports=m},function(a,b){function c(a,b,c,d){var e;return c(a,function(a,c,f){if(b(a,c,f))return e=d?c:a,!1}),e}a.exports=c},function(a,b){function c(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}a.exports=c},function(a,b,c){(function(b){"use strict";var d=(c(142),c(143),c(147)),e=function(a,c,e){var f,g,h=!0,i=(a.model.configuration.get("displayStartSummary")?"summary":a.model.configuration.getConfiguration().html.startPoster.template,a.model.playbackSession),j=a.model.configuration.getConfiguration().containerClassName,k=a.appContainer.innerContainer,l=a.model.configuration.getResourceUrl("startImageFallbackUrl");return a.wait(),i.getAsset().then(function(e){g={background:i.getImageUrl()||l,onload:c.imageLoad,onclick:c.startClick};var m=i.getCentralTimeOffset(),n=new Date(e.liveBroadcastTime),o=new Date;o.setTime(n.getTime()+m);var p=new Date;return o.getTime()>p.getTime()&&(h=!1),d(g,{url:"#asset"+e.id,duration:e.duration,isLive:e.live,onDemandTimeBegin:e.onDemandTimeBegin,onDemandTimeEnd:e.onDemandTimeEnd,viewCount:e.views,title:e.title,localLiveStartTime:o}),f=new b.startPoster(g,a.model.configuration),f.attach(k),f.setPrefix(j),h||a.api.setState(a.api.exposed.playerStates.unstartedTransmission),h},function(b){var c=a.appContainer.showMessage;c(b,c.types.fatal)})};a.exports=e}).call(b,c(106))},function(a,b,c){(function(b){"use strict";function d(a,b){var c={playpause:new i({className:"playpause-toggle",titles:{on:s.msg("controls.pause"),off:s.msg("controls.play")},classes:{on:"playpause-playing",off:"playpause-paused"}}),episodeselector:new m({showData:b.getOptions().showData,videoData:a,locale:b.getOptions().preferredLanguage||"en_US",strings:{close:s.msg("controls.close"),open:s.msg("controls.open"),currentEpisodeTemplate:b.getOptions().showData&&b.getOptions().showData.imageUrl?u.templates.currentepisode_sportal:u.templates.currentepisode}}),skipback:"",timeline:new o({videoData:a}),skipforward:"",livetoggle:new i({className:"live-toggle",titles:{on:s.msg("controls.live"),off:s.msg("controls.gotolive")},content:"titles"}),timedisplay:new p({duration:a.duration,startPosition:a.startPosition}),subtitles_selector:new q({strings:{label:u.controls.subtitles,subtitles:u.subtitles}}),soundtoggle:new i({className:"sound-toggle",titles:{on:s.msg("controls.unmute"),off:s.msg("controls.mute")},classes:{on:"sound-muted"}}),volume:new k({className:"volume-container",children:{bar:new k({id:"bar",className:"bar-container"}),slider:new h({id:"volume",className:"volume"})}}),fullscreen:new i({className:"fullscreen-toggle",titles:{on:s.msg("controls.exitfullscreen"),off:s.msg("controls.enterfullscreen")}})};b.getConfiguration().useRewindFastForwardControls?(c.skipback=new j({className:"skip-back toggle-button"}),c.skipforward=new j({className:"skip-forward toggle-button"})):(delete c.skipback,delete c.skipforward);var d=new r({className:b.getConfiguration().autoAdvance&&b.getConfiguration().autoAdvance.enableOverlay?"":"play-next",locale:b.getOptions().preferredLanguage||"en_US",videoData:a,configuration:b});return b.getConfiguration().suggestNextEpisodeOffset&&(d.getNextEpisodeOffset=function(){return b.getConfiguration().suggestNextEpisodeOffset}),{topOverlay:new k({className:"top-overlay",children:{closePlayer:new j({className:"close-button",title:s.msg("close")}),watermark:new k({className:"watermark-container",title:"iflix"})}}),centerOverlay:new k({className:b.getConfiguration().autoAdvance&&b.getConfiguration().autoAdvance.enableOverlay?"center-overlay next-video-countdown":"center-overlay",children:{playToNext:d}}),bottomOverlay:new k({className:"bottom-overlay",children:c})}}function e(){return{message:new t,skipbutton:new l({className:"adskipbutton",content:s.msg("adSkip")})}}function f(a){return new n({className:"start-poster-widget",onload:a.onload,onclick:a.onclick,background:a.background,url:a.url})}function g(){return new g({className:"end-poster-widget"})}var h=c(108),i=c(116),j=c(117),k=c(109),l=c(118),m=c(125),n=c(128),g=c(129),o=c(132),p=c(137),q=c(138),r=c(140),s=c(130),t=c(141),u=b;a.exports={widgets:d,adoverlay:e,startPoster:f,endPoster:g}}).call(b,c(107))},function(a,b,c){!(a.exports={summaryBarPublished:"Published: ",summaryBarLive:"Live ",startPosterLive:"Live",startPosterCountdownLead:"Countdown to start",startPosterAt:" ",summaryBarDuration:"Duration: ",summaryBarViews:"Views: ",recommendationsHeader:"Watch more videos",resumePrompt:"Would you like to continue watching this video where you left?",resumeStartOver:"Start over",resumeResume:"Resume from {time}",startupError:"The player failed.",generalError:"The player failed.",userKicked:"You have been logged out because your account was used for login on another device.",playbackError:"The playback failed.",noPlaybackTechnologies:"The video can unfortunately not be played in this browser.",continue:"Continue",adSkip:"Skip this ad",close:"Exit",controls:{play:"Play",pause:"Pause",gotolive:"Go live",live:"Live",mute:"Mute",unmute:"Unmute",enterfullscreen:"Enter fullscreen",exitfullscreen:"Exit fullscreen",timeline:"Timeline",volume:"Volume",open:"Open",close:"Close",subtitles:"Subtitles"},nextepisode:{title:"Episode Selanjutnya ",just_watched:"Kamu baru saja menonton ",episode:"Episode "},templates:{currentepisode:'<img src="https://images.iflix.com/<%=data.imagepack%>_s_150x225"><p>Playing now:</p><h4><%=data.title%></h4>',currentepisode_sportal:'<img src="<%=data.imagepack%>"><p>Playing now:</p><h4><%=data.title%></h4>',adPlaybackMessage:"Ad <%= data.adNumber %> of <%= data.adCount %>: Your video starts in <%= data.countdown %> seconds.",adPostrollPlaybackMessage:"Ad <%= data.adNumber %> of <%= data.adCount %>: Completed in <%= data.countdown %> seconds."},rest:{ASSET_NOT_FOUND:"The video was not found.",ASSET_NOT_PUBLISHED:"The video is not published.",ASSET_PLAYBACK_INVALID_VIDEO_FORMAT:"The video is not published in the correct format.",SESSION_NOT_AUTHENTICATED:"The video is restricted an cannot be played.",UNAUTHORIZED:"The video is restricted an cannot be played.",ASSET_PLAYBACK_INVALID_GEO_LOCATION:"The video cannot be played in your geographical area.",asset:"The video was not found.",playback:"The video was not available for playback.",noplayback:"No available streams for this video."},subtitles:{captions:"Captions",subtitles:"Subtitles",no_subtitles:"No subtitles",en:"English",no:"Norwegian",sv:"Swedish",dk:"Danish",fi:"Finnish"},request:{xhr:"Request failed."}})},function(a,b,c){"use strict";function d(a){function b(a){(1==a.which||i)&&(this.isDragging=!0,this.addClass("dragging"),this.lastThumbPos=o(this.view),l.detail.positionPercent=n(p(this.view,a)),this.view.dom.dispatchEvent(l))}function c(a){this.isDragging&&(m.detail.positionPercent=n(p(this.view,a)),m.detail.type=a.type,this.view.dom.dispatchEvent(m),a.preventDefault())}function d(b){(1==b.which||i)&&this.isDragging&&(k.detail.positionPercent=n(p(this.view,b)),a.shadow_thumb&&n(k.detail.positionPercent,this.shadow_thumb.view.dom),this.view.dom.dispatchEvent(k),this.isDragging=!1,this.removeClass("dragging"),
b.preventDefault())}function h(a){this.isDragging&&(this.isDragging=!1,this.removeClass("dragging"),n(this.lastThumbPos))}e.call(this,a),this.addClass((a.vertical?"vertical-":"")+"slider"),this.addSubWidget({thumb:new e({className:a.className+"-thumb thumb"})}),a.shadow_thumb&&this.addSubWidget({shadow_thumb:new e({className:a.className+"-shadow-thumb shadow-thumb"})}),this.name=a.id,this.vertical=!!a.vertical,this.position=0,this.isDragging=!1,this.lastThumbPos=0,this.globalListeners={},this.setThumbPos=function(b){this.position=b,n(b,this.thumb.view.dom),a.shadow_thumb&&n(b,this.shadow_thumb.view.dom)};var i="ontouchend"in window,j="onmouseup"in window;i&&(this.listen({touchstart:b}),this.listen({touchmove:c}),this.listen({touchend:d}),g(this.globalListeners,{touchmove:c,touchend:d})),j&&(this.listen({mousedown:b}),this.listen({mousemove:c}),this.listen({mouseup:d}),g(this.globalListeners,{mousemove:c,mouseup:d,mouseleave:h}));var k=new CustomEvent("sliderchange",{detail:{},bubbles:!0}),l=new CustomEvent("sliderstart",{detail:{},bubbles:!0}),m=new CustomEvent("sliderdrag",{detail:{},bubbles:!0}),n=function(a,b){return a<0&&(a=0),a>1&&(a=1),b||(b=this.thumb.view.dom),this.vertical?b.style.bottom=100*a+"%":b.style.left=100*a+"%",a}.bind(this),o=function(a){return this.vertical?(a.dom.offsetHeight-(this.thumb.view.dom.offsetTop+this.thumb.view.dom.offsetHeight/2))/a.dom.offsetHeight:(this.thumb.view.dom.offsetLeft+this.thumb.view.dom.offsetWidth/2)/a.dom.offsetWidth}.bind(this),p=function(a,b){return this.vertical?(a.dom.offsetHeight-f.getPointerPos(b,a.dom).y)/a.dom.offsetHeight:f.getPointerPos(b,a.dom).x/a.dom.offsetWidth}.bind(this)}var e=c(109),f=c(7),g=c(111);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a,b){if(this.dom=document.createElement(a||"div"),b)for(var c in b)this.dom[c]=b[c]}var e=c(110),f=function(a){this.view||(this.view=new d(a.type,a.properties)),e.call(this,a),a.id&&(this.id=a.id),a.key&&(this.key=a.key),a.className&&this.setClassName(a.className),a.classname&&this.setClassName(a.classname),a.html&&(this.view.dom.innerHTML=a.html)};f.prototype=Object.create(e.prototype),a.exports=f},function(a,b){"use strict";var c=function(a){a.prefix&&this.setPrefix(a.prefix),a.children&&this.addSubWidgets(a.children),this.isInitialized=!1};c.prototype.listen=function(a){this.listeners||(this.listeners={}),Object.getOwnPropertyNames(a).forEach(function(b){this.listeners[b]&&this.unListen([b]),this.listeners[b]=a[b].bind(this),b.split(/[ ,]+/).forEach(function(a){this.view.dom.addEventListener(a,this.listeners[b])},this)},this)},c.prototype.unListen=function(a){a.forEach(function(a){this.listeners[a]&&(a.split(/[ ,]+/).forEach(function(b){this.view.dom.removeEventListener(b,this.listeners[a])},this),delete this.listeners[a])},this)},c.prototype.removeAllListeners=function(){this.listeners&&this.unListen(Object.getOwnPropertyNames(this.listeners))},c.prototype.emit=function(a){for(var b,c={},d=Array.prototype.slice.call(arguments,1),e=d.length-1;e>=0;e--){if(d[e]instanceof Node){b=d[e];break}d[e].detail||d[e].cancelable||d[e].bubbles?Object.assign(c,d[e]):c.detail=d[e]}if(b=b?b:this.view.dom,this.events||(this.events=[]),this.events[a]){if(this.events[a]instanceof window.Event)for(var f in c.detail)this.events[a].detail[f]=c.detail[f]}else this.events[a]=new CustomEvent(a,c);b.dispatchEvent(this.events[a])},c.prototype.setPrefix=function(a){this.prefix=a,this.prefix&&(this.setClassName((this.view&&this.view.dom||this.dom).className),this.children&&this.children.forEach(function(b){b.setPrefix(a)}))},c.prototype.getPrefixedClassName=function(a){return(this.prefix?this.prefix+"-":"")+a},c.prototype.addClass=function(a,b){a.split(" ").forEach(function(a){(b||this.view&&this.view.dom||this.dom).classList.add(this.getPrefixedClassName(a))}.bind(this))},c.prototype.removeClass=function(a,b){a.split(" ").forEach(function(a){(b||this.view&&this.view.dom||this.dom).classList.remove(this.getPrefixedClassName(a))}.bind(this))},c.prototype.hasClass=function(a,b){return(b||this.view&&this.view.dom||this.dom).classList.contains(this.getPrefixedClassName(a))},c.prototype.setClassName=function(a,b){b=b||this.view&&this.view.dom||this.dom,this.prefix&&a&&(a=a.split(" ").map(function(a){var b=a.trim();return 0===b.indexOf(this.prefix)?b:this.prefix+"-"+b}.bind(this)).join(" ")),b.className=a},c.prototype.detach=function(){this.view.dom.parentNode&&(this.parentNode=this.view.dom.parentNode,this.siblingNode=this.view.dom.nextSibling,this.parentNode.removeChild(this.view.dom))},c.prototype.reattach=function(a){this.view.dom.parentNode||(a=a?a:this.parentNode,this.siblingNode?a.insertBefore(this.view.dom,this.siblingNode):a.appendChild(this.view.dom))},c.prototype.addSubWidgets=function(a,b){function d(a){e.appendChild(a.view.dom)}var e=b?b:this.view.dom;if(this.children||(this.children=[]),a instanceof c){var f=a;f.setPrefix(this.prefix),f.initComponent(),d(f),this.children.push(f)}else a instanceof Array?a.forEach(function(a){a.setPrefix(this.prefix),a.initComponent(),d(a),this.children.push(a),a.key&&(this[a.key]=a)}.bind(this)):a[Object.getOwnPropertyNames(a)[0]]instanceof c&&Object.getOwnPropertyNames(a).forEach(function(b){a[b].setPrefix(this.prefix),a[b].initComponent(),d(a[b]),this[b]=a[b],a[b].key=b,this.children.push(a[b])}.bind(this))},c.prototype.replaceSubWidget=function(a,b){var d=b?b:this.view.dom,e=function(a){var b=!1;this[a.key]&&(this[a.key]=a,b=!0),this.children=this.children.map(function(c){return a.key==c.key&&(d.replaceChild(a.view.dom,c.view.dom),c=a,b=!0),c}),b&&(a.setPrefix(this.prefix),a.initComponent())}.bind(this);if(a instanceof c)e(a);else if(a instanceof Array){var f=a;f.forEach(function(a){a instanceof c&&e(a)})}else Object.keys(a).length>0&&a[Object.getOwnPropertyNames(a)[0]]instanceof c&&Object.getOwnPropertyNames(a).forEach(function(b){e(a[b])}.bind(this))},c.prototype.replaceSubWidgets=c.prototype.replaceSubWidget,c.prototype.removeSubWidget=function(a,b){function c(a){d.removeChild(a.view.dom)}var d=b?b:this.view.dom;if(this.children){var e=this.children[this.children.indexOf(a)],f=e.key;c(e),f&&delete this[f],this.children.splice(this.children.indexOf(e),1)}},c.prototype.removeAllSubWidgets=function(a,b){function c(a,b){d.removeChild(a.view.dom)}var d=b?b:this.view.dom;this.children&&(this.children.forEach(function(a){var b=a.key;c(a,this.children),b&&delete this[b]}.bind(this)),this.children.length=0)},c.prototype.addSubWidget=c.prototype.addSubWidgets,c.prototype.initComponent=function(){function a(a){for(var b in a.globalListeners){var c=a.globalListeners[b];document.body.addEventListener(b,c.bind(a))}}this.isInitialized||("function"==typeof this.init&&this.init(),this.globalListeners&&a(this),this.isInitialized=!0)},c.prototype.attach=function(a){function b(a){a.children&&a.children.forEach(function(a){b(a)},d);for(var e in a)a[e]instanceof c&&b(a[e]);a.initComponent()}var d=this;a.appendChild(d.view.dom),b(d)},c.prototype.getComponents=function(a){if(!a)var a={};return this.key&&!a[this.key]&&(a[this.key]=this),this.children&&this.children.forEach(function(b){b.getComponents(a)}.bind(this)),a},a.exports=c},function(a,b,c){function d(a,b,c){for(var d=-1,e=g(b),f=e.length;++d<f;){var h=e[d],i=a[h],j=c(i,b[h],h,a,b);(j===j?j===i:i!==i)&&(void 0!==i||h in a)||(a[h]=j)}return a}var e=c(112),f=c(114),g=c(92),h=f(function(a,b,c){return c?d(a,b,c):e(a,b)});a.exports=h},function(a,b,c){function d(a,b){return null==b?a:e(b,f(b),a)}var e=c(113),f=c(92);a.exports=d},function(a,b){function c(a,b,c){c||(c={});for(var d=-1,e=b.length;++d<e;){var f=b[d];c[f]=a[f]}return c}a.exports=c},function(a,b,c){function d(a){return g(function(b,c){var d=-1,g=null==b?0:c.length,h=g>2?c[g-2]:void 0,i=g>2?c[2]:void 0,j=g>1?c[g-1]:void 0;for("function"==typeof h?(h=e(h,j,5),g-=2):(h="function"==typeof j?j:void 0,g-=h?1:0),i&&f(c[0],c[1],i)&&(h=g<3?void 0:h,g=1);++d<g;){var k=c[d];k&&a(b,k,h)}return b})}var e=c(100),f=c(115),g=c(16);a.exports=d},function(a,b){function c(a){return function(b){return null==b?void 0:b[a]}}function d(a){return null!=a&&g(k(a))}function e(a,b){return a="number"==typeof a||i.test(a)?+a:-1,b=null==b?j:b,a>-1&&a%1==0&&a<b}function f(a,b,c){if(!h(c))return!1;var f=typeof b;if("number"==f?d(c)&&e(b,c.length):"string"==f&&b in c){var g=c[b];return a===a?a===g:g!==g}return!1}function g(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=j}function h(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var i=/^\d+$/,j=9007199254740991,k=c("length");a.exports=f},function(a,b,c){"use strict";function d(a){e.call(this,a),this.addClass("toggle-button"),this.onClass=a.classes&&a.classes.on?a.classes.on:"on",this.offClass=a.classes&&a.classes.off?a.classes.off:"off",this.onTitle=a.titles&&a.titles.on||"",this.offTitle=a.titles&&a.titles.off||"","titles"==a.content?(this.onContent=this.onTitle,this.offContent=this.offTitle):a.content&&a.content.html?(this.htmlInsert=!0,this.onContent=a.content.html.on||a.content.html,this.offContent=a.content.html.off||this.onContent):a.content&&(this.onContent=a.content,this.offContent=this.onContent),this.state=!!a.onByDefault,this.isEnabled=!a.disabledByDefault;var b,c=new CustomEvent("toggle",{detail:{},bubbles:!0}),d=function(a){return"click"===a.type&&b?(clearTimeout(b),void(b=null)):("touchend"===a.type&&(b=setTimeout(function(){b=null},3e3)),void(this.isEnabled&&(c.detail.newStateOn=!this.state,this.setOn(!this.state),this.view.dom.dispatchEvent(c))))}.bind(this);this.view.dom.addEventListener("click",d),this.view.dom.addEventListener("touchend",d),this.setOn=function(a){this.state=a,this.addClass(a?this.onClass:this.offClass),this.removeClass(a?this.offClass:this.onClass),this.view.dom.setAttribute("title",(a?this.onTitle:this.offTitle)||""),this.htmlInsert?this.view.dom.innerHTML=a?this.onContent:this.offContent:this.onContent&&this.offContent&&(this.view.dom.textContent=a?this.onContent:this.offContent),this.view.dom.setAttribute("aria-label",a?this.onTitle:this.offTitle)},this.setIsEnabled=function(a){this.isEnabled=a},this.init=function(){this.setOn(this.state)}}var e=c(109);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){var b={className:a.className,type:a.type||"div",key:a.key,html:a.html,properties:{title:a.title?a.title:a.id?a.id:"","aria-label":a.title?a.title:a.id,innerText:a.text||"",textContent:a.text||""}};e.call(this,b),this.addClass("button")}var e=c(109);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){this.data=a.data?a.data:null,this.view=new e(a.tag),f.call(this,a),this.addClass("template-element"),a.template?(this.setTemplate=function(a){this.template=g(a,null,{variable:"data"})},this.update=function(a){this.view.dom.innerHTML=this.template(a?a:this.data)},this.init=function(){this.data&&this.update(this.data)},"function"==typeof a.template?this.template=a.template:this.setTemplate(a.template)):a.content&&(this.view.dom.innerHTML=a.content,this.setContent=function(a){this.view.dom.innerHTML=a}),this._setPrefix=this.setPrefix,this.setPrefix=function(a,b){this._setPrefix(a,b)}}function e(a){var b=a?a:"div";this.dom=document.createElement(b)}var f=c(109),g=c(119);d.prototype=Object.create(f.prototype),a.exports=d},function(a,b,c){function d(a){return"\\"+z[a]}function e(a){return!!a&&"object"==typeof a}function f(a,b,c,d){return void 0!==a&&B.call(d,c)?a:b}function g(a,b,c){for(var d=-1,e=p(b),f=e.length;++d<f;){var g=e[d],h=a[g],i=c(h,b[g],g,a,b);(i===i?i===h:h!==h)&&(void 0!==h||g in a)||(a[g]=i)}return a}function h(a,b){return null==b?a:k(b,p(b),a)}function i(a){return e(a)&&"string"==typeof a.message&&C.call(a)==s}function j(a,b,c){var e=r.imports._.templateSettings||r;c&&n(a,b,c)&&(b=c=void 0),a=l(a),b=g(h({},c||b),e,f);var j,k,q=g(h({},b.imports),e.imports,f),s=p(q),z=m(q,s),A=0,B=b.interpolate||x,C="__p += '",E=RegExp((b.escape||x).source+"|"+B.source+"|"+(B===o?w:x).source+"|"+(b.evaluate||x).source+"|$","g"),F="sourceURL"in b?"//# sourceURL="+b.sourceURL+"\n":"";a.replace(E,function(b,c,e,f,g,h){return e||(e=f),C+=a.slice(A,h).replace(y,d),c&&(j=!0,C+="' +\n__e("+c+") +\n'"),g&&(k=!0,C+="';\n"+g+";\n__p += '"),e&&(C+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),A=h+b.length,b}),C+="';\n";var G=b.variable;G||(C="with (obj) {\n"+C+"\n}\n"),C=(k?C.replace(t,""):C).replace(u,"$1").replace(v,"$1;"),C="function("+(G||"obj")+") {\n"+(G?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(j?", __e = _.escape":"")+(k?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+C+"return __p\n}";var H=D(function(){return Function(s,F+"return "+C).apply(void 0,z)});if(H.source=C,i(H))throw H;return H}var k=c(113),l=c(120),m=c(121),n=c(115),o=c(122),p=c(92),q=c(16),r=c(123),s="[object Error]",t=/\b__p \+= '';/g,u=/\b(__p \+=) '' \+/g,v=/(__e\(.*?\)|\b__t\)) \+\n'';/g,w=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,x=/($^)/,y=/['\n\r\u2028\u2029\\]/g,z={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},A=Object.prototype,B=A.hasOwnProperty,C=A.toString,D=q(function(a,b){try{return a.apply(void 0,b)}catch(a){return i(a)?a:new Error(a)}});a.exports=j},function(a,b){function c(a){return null==a?"":a+""}a.exports=c},function(a,b){function c(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}a.exports=c},function(a,b){var c=/<%=([\s\S]+?)%>/g;a.exports=c},function(a,b,c){var d=c(124),e=c(122),f=/<%-([\s\S]+?)%>/g,g=/<%([\s\S]+?)%>/g,h={escape:f,evaluate:g,interpolate:e,variable:"",imports:{_:{escape:d}}};a.exports=h},function(a,b,c){function d(a){return n[a]}function e(a){return!!a&&"object"==typeof a}function f(a){return"symbol"==typeof a||e(a)&&p.call(a)==k}function g(a){if("string"==typeof a)return a;if(null==a)return"";if(f(a))return q?s.call(a):"";var b=a+"";return"0"==b&&1/a==-j?"-0":b}function h(a){return a=g(a),a&&m.test(a)?a.replace(l,d):a}var i=c(13),j=1/0,k="[object Symbol]",l=/[&<>"'`]/g,m=RegExp(l.source),n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},o=Object.prototype,p=o.toString,q=i.Symbol,r=q?q.prototype:void 0,s=q?r.toString:void 0;a.exports=h},function(a,b,c){"use strict";function d(a,b){function c(a){return(a["@id"]||a.id)==b}for(var d=0;d<a.seasons.length;d++){var e=a.seasons[d],f=e.episodes.filter(c);if(f.length>0)return{season:e,episode:f[0]}}}function e(a){if(a.seasons)for(var b=0;b<a.seasons.length;b++){var c=a.seasons[b];if(c.episodes&&c.episodes.length>0)return!0}return!1}function f(a){function b(a){return new CustomEvent("select",{detail:a,bubbles:!0})}g.call(this,a),this.addClass("episodes-widget"),this.disabledClass="episodes-disabled",this.isEnabled=!0,this.addSubWidgets({toggle:new h({className:"episodes-toggle",titles:{on:a.strings.close,off:a.strings.open},classes:{on:"episodes-open",off:"episodes-closed"}}),container:new l({className:"episodes-selector-container",strings:{title:a.showData.title||a.showData&&a.showData.show&&a.showData.show.title},children:{currentepisode:new j({className:"current-episode",template:a.strings.currentEpisodeTemplate}),seasons:new i({className:"seasons",formatters:n}),episodes:new i({className:"episodes",formatters:o})}})}),this.init=function(){try{if(a.showData&&e(a.showData)){var c=a.videoData.id?d(a.showData,a.videoData.id):null;if(this.container.toggle=function(){this.toggle.setOn(!1)}.bind(this),this.toggle.listen({toggle:function(){this.toggle.state&&(this.container.seasons.scrollSelectionIntoView(),this.container.episodes.scrollSelectionIntoView())}.bind(this)}),this.container.seasons.setItems(a.showData.seasons),c){c.season.seasonNumber&&(c.season.locale=a.locale,c.season.episodes.forEach(function(b){b.seasonNumber=c.season.seasonNumber,b.locale=a.locale})),m.debug("Found matching selection.",c);var f=a.showData.imageUrl||c.season.metadata&&c.season.metadata["image-pack"]&&c.season.metadata["image-pack"].$||a.showData.show&&a.showData.show.metadata&&a.showData.show.metadata["image-pack"]&&a.showData.show.metadata["image-pack"].$;this.container.episodes.setItems(c.season.episodes),this.container.seasons.setSelectedItem(c.season,!1),this.container.episodes.setSelectedItem(c.episode,!1),this.container.currentepisode.update({title:o&&o.title?o.title(c.episode):c.episode.title,description:o&&o.description?o.description(c.episode):c.episode,imagepack:f})}else m.debug("No matching selection found."),this.container.episodes.setItems(a.showData.seasons[0].episodes);this.container.seasons.listen({select:function(b){m.debug("Season selected",b),b.detail.seasonNumber&&(b.detail.locale=a.locale,b.detail.episodes.forEach(function(c){c.seasonNumber=b.detail.seasonNumber,c.locale=a.locale})),this.container.episodes.setItems(b.detail.episodes),c&&c.season===b.detail&&this.container.episodes.setSelectedItem(c.episode,!0),this.container.episodes.scrollSelectionIntoView()}.bind(this)}),this.container.episodes.listen({select:function(a){this.view.dom.dispatchEvent(b(a.detail)),m.debug("Episode selected",a)}.bind(this)})}else this.isEnabled=!1,this.addClass(this.disabledClass)}catch(b){this.isEnabled=!1,this.addClass(this.disabledClass),m.error("Something went wrong when filling episode selector. Bad data?",b,a.showData)}}}var g=c(109),h=c(116),i=c(126),j=c(118),k=c(4),l=c(127),m=k.get("episodeSelector"),n={title:function(a){var b=a.locale||"en_US";return a.title[b]||a.title["*"]||a.title}},o={title:function(a){var b=a.locale||"en_US",c=a.seasonNumber||a.metadata&&a.metadata.season&&a.metadata.season.$,d=a.episodeNumber||a.metadata&&a.metadata.episode&&a.metadata.episode.$,e="string"==typeof a.title?a.title:a.title[b]||a.title.en_US||"",f=parseInt(c||"1"),g=parseInt(d||"1");return isNaN(f)||isNaN(g)?e:(f<10&&(f="0"+f),g<10&&(g="0"+g),"S"+f+" E"+g+": "+e)}};f.prototype=Object.create(g.prototype),a.exports=f},function(a,b,c){"use strict";function d(a,b,c,d,e){this.isSelected=!1;var g="";a.description&&(g=e&&e.description?e.description(a):a.description),f.call(this,{type:"li",className:c,properties:{textContent:e&&e.title?e.title(a):a.title,title:g}}),this.listen({click:function(){b(a)}.bind(this)}),this.setSelectedState=function(a){this.isSelected=a,this.isSelected?this.addClass(d):this.removeClass(d)}.bind(this)}function e(a){function b(a){return new CustomEvent("select",{detail:a,bubbles:!1})}var c=a.className,e="list-item "+c+"-list-item",g="list-item-selected "+c+"list-item-selected";this.setSelectedItem=function(a,c){var d=this.items.indexOf(a);this.selectedItem=a,this.widgetList.forEach(function(a,b){a.setSelectedState(b===d)}),c||this.view.dom.dispatchEvent(b(a))}.bind(this),f.call(this,{className:c,type:"ol"}),this.addClass("list"),this.createWidgets=function(b){this.widgetList=[],this.removeAllSubWidgets(),b.forEach(function(b){var c=new d(b,this.setSelectedItem,e,g,a.formatters);this.addSubWidgets(c),this.widgetList.push(c)}.bind(this))},this.items=[],this.selectedItem=null,this.scrollSelectionIntoView=function(){if(null==this.selectedItem)this.widgetList.length>0&&this.widgetList[0].view.dom.scrollIntoView();else for(var a=0;a<this.widgetList.length;a++){var b=this.widgetList[a];if(b.isSelected){var c=b.view.dom.offsetTop;return void(b.view.dom.offsetParent.scrollTop=Math.max(0,c-12))}}}.bind(this),this.setItems=function(a){this.items=a,this.createWidgets(a),this.selectedItem=null},this.onContextUpdated=function(){this.addClass(c+"-list"),this.addClass("list")}}var f=c(109);d.prototype=Object.create(f.prototype),e.prototype=Object.create(f.prototype),a.exports=e},function(a,b,c){"use strict";function d(a){this.isOpen=!1,e.call(this,{className:a.className,children:{header:new e({className:"header",children:{title:new e({className:"title",type:"h3",properties:{textContent:a.strings.title}}),close:new e({className:"close"})}})}}),this.addClass("options-container"),this.addSubWidgets(a.children),this.header.close.listen({click:function(a){this.toggle()}.bind(this)}),this.toggle=function(){this.isOpen?(this.isOpen=!1,this.view.dom.style.display="none"):(this.isOpen=!0,this.view.dom.style.display="block")}}var e=c(109);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",c={className:a.className,type:a.type||"span",children:{image:new e({type:"img",className:"poster-image",properties:{src:a.background||b}}),link:new e({type:"a",properties:{href:a.url||""}})}};e.call(this,c),this.renderBlackImage=function(){this.image.view.dom.setAttribute("src",b)},a.onload&&this.image.listen({load:a.onload,error:this.renderBlackImage.bind(this)}),a.onclick&&this.listen({click:a.onclick})}var e=c(109);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){function b(a,b){var c={currentEpisode:null,nextEpisode:null};return a&&b&&b.seasons?(b.seasons.forEach(function(b,d){b.episodes&&b.episodes.forEach(function(e,f){(e.id||e["@id"])==a&&(c.currentEpisode=e,b.episodes[f+1]?c.nextEpisode=b.episodes[f+1]:f==b.episodes.length-1&&k.seasons[d+1]&&(c.nextEpisode=k.seasons[d+1].episodes[0]))})}),c):c}a.className="end-poster-widget",e.call(this,a);var c,d,i=a.locale||"en_US",j=a&&a.assetId||null,k=a&&a.videoData&&a.videoData.showData||null,l=b(j,k),m=l.nextEpisode,n=l.currentEpisode,o=k&&"string"==typeof k.title&&k.title||k.title&&k.title[i]||m&&m.categoryTitle||"",p=n&&(n.episodeNumber||n.metadata&&n.metadata.episode&&n.metadata.episode.$)||null,q=m&&(m.episodeNumber||m.metadata&&m.metadata.episode&&m.metadata.episode.$)||null,r=m&&(m.title&&m.title[i]||m.metadata&&m.metadata.episode&&m.metadata.title.$)||null,s=n&&(n.metadata&&n.metadata.season&&n.metadata.season.$||n.seasonNumber)||null,t=m&&(m.metadata&&m.metadata.season&&m.metadata.season.$||m.seasonNumber)||null,u=k&&k.show&&k.show.metadata&&k.show.metadata["image-pack"]&&k.show.metadata["image-pack"].$||null;u?(c="http://images.iflix.com/"+u+"_s_150x225",d="http://images.iflix.com/"+u+"_s_300x450"):(c=k&&k.imageUrl?k.imageUrl.replace("_s_200x300","_s_150x225"):"",d=k&&k.imageUrl?k.imageUrl.replace("_s_200x300","_s_300x450"):"");var v=this;if(this.playbutton=new f({className:"nextepisode-button",title:"Play"}),this.largeImageTemplate=new g({className:"nextepisode",template:'<img src="<%= data.src %>"/>',data:{src:d}}),this.smallImageTemplate=new g({className:"currentepisode",template:'<img src="<%= data.src %>"/>',data:{src:c}}),this.closeButton=new f({className:"close-button",title:h.msg("controls.close")}),this.closeButton.listen({click:function(){v.emit("exit.click")}}),this.addSubWidget({close:this.closeButton}),n&&this.addSubWidget({justWatchedContainer:new e({className:"just-watched-container",children:[this.smallImageTemplate,new g({id:"just-watched",template:"<p>"+h.msg("nextepisode.just_watched")+"<br/><%= data.seasonTitle %>, Episode <%= data.episodeNumber%></p>",data:{seasonTitle:n.categoryTitle||o+" - Season "+parseInt(s),episodeNumber:parseInt(p)}})]})}),m){var w,x,v=this,y=function(a){v.posterContainer.nextupDescription.countdown.update({countdown:a}),0==a?(m["@id"]=m["@id"]||m.id,v.emit("nextepisode.click",{asset:m}),window.clearTimeout(x)):(a-=1,x=setTimeout(function(){y(a)},1e3))};this.addSubWidget({posterContainer:new e({className:"poster-container",children:{nextUpImage:new e({className:"nextup-image-container",children:[this.playbutton,this.largeImageTemplate]}),nextupDescription:new e({className:"nextup-description-container",children:{description:new g({className:"description",template:"<h1><%= data.header %></h1><h3><%= data.seasonTitle %>, Episode <%= data.episodeNumber %>:<br/><%= data.episodeTitle %></h3><p><%= data.episodeDescription %></p>",data:{header:h.msg("nextepisode.title"),episodeTitle:r,episodeNumber:parseInt(q),episodeDescription:m&&(m.synopsis&&m.synopsis[i]||m.description||""),seasonTitle:m.categoryTitle||o+" - Season "+parseInt(t)}})}})}})}),a.configuration.autoAdvance&&a.configuration.autoAdvance.enableEndPoster&&(w=a.configuration.autoAdvance.countdown||15,v.posterContainer.nextupDescription.addSubWidget({countdown:new g({className:"countdown",template:"<h3>"+h.msg("nextepisode.countdowntext")+"</h3>",data:{countdown:w}})}),y(w))}this.playbutton.listen({click:function(){x&&window.clearTimeout(x),m["@id"]=m["@id"]||m.id,v.emit("nextepisode.click",{asset:m})}})}var e=c(109),f=c(117),g=c(118),h=c(130);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){(function(b,d){"use strict";function e(a){var c=f.getGlobalConfiguration(),e=c.getOptions(),g=e&&e.preferredLanguage||null;if(g&&b[g]&&b[g][a])return b[g][a];for(var i=a.split("."),j=d,k=0;k<i.length;k++)j=j[i[k]];return!j&&i.length?(h.error('String value does not exist for key "%s"',a),""):j}var f=c(5),g=c(4),h=g.get("i18n");a.exports={msg:e}}).call(b,c(131),c(107))},function(a,b){"use strict";a.exports={en_US:{summaryBarPublished:"Published: ",summaryBarLive:"Live ",startPosterLive:"Live",startPosterCountdownLead:"Countdown to start",startPosterAt:" ",summaryBarDuration:"Duration: ",summaryBarViews:"Views: ",recommendationsHeader:"Watch more videos",resumePrompt:"Would you like to continue watching this video where you left?",resumeStartOver:"Start over",resumeResume:"Resume from {time}",startupError:"The player failed.",generalError:"The player failed.",userKicked:"You have been logged out because your account was used for login on another device.",playbackError:"The playback failed.",noPlaybackTechnologies:"The video can unfortunately not be played in this browser.",continue:"Continue",adSkip:"Skip this ad",close:"Exit","controls.play":"Play","controls.pause":"Pause","controls.gotolive":"Go live","controls.live":"Live","controls.mute":"Mute","controls.unmute":"Unmute","controls.enterfullscreen":"Enter fullscreen","controls.exitfullscreen":"Exit fullscreen","controls.timeline":"Timeline","controls.volume":"Volume","controls.open":"Open","controls.close":"Close","controls.subtitles":"Subtitles","rest.ASSET_NOT_FOUND":"The video was not found.","rest.ASSET_NOT_PUBLISHED":"The video is not published.","rest.ASSET_PLAYBACK_INVALID_VIDEO_FORMAT":"The video is not published in the correct format.","rest.SESSION_NOT_AUTHENTICATED":"The video is restricted an cannot be played.","rest.UNAUTHORIZED":"The video is restricted an cannot be played.","rest.ASSET_PLAYBACK_INVALID_GEO_LOCATION":"The video cannot be played in your geographical area.","rest.asset":"The video was not found.","rest.playback":"The video was not available for playback.","rest.noplayback":"No available streams for this video.","subtitles.captions":"Captions","subtitles.subtitles":"Subtitles","subtitles.no_subtitles":"No subtitles","subtitles.en":"English","subtitles.no":"Norwegian","subtitles.sv":"Swedish","subtitles.dk":"Danish","subtitles.fi":"Finnish","nextepisode.title":"Next episode","nextepisode.just_watched":"You have just watched","nextepisode.episode":"Episode","nextepisode.countdowntext":" Starting in <%= data.countdown %> seconds","request.xhr":"Request failed."},th_TH:{summaryBarPublished:"Published: ",summaryBarLive:"Live ",startPosterLive:"Live",startPosterCountdownLead:"Countdown to start",startPosterAt:" ",summaryBarDuration:"Duration: ",summaryBarViews:"Views: ",recommendationsHeader:"Watch more videos",resumePrompt:"คุณต้องการรับชมต่อจากครั้งที่แล้วใช่หรือไม่?",resumeStartOver:"เริ่มใหม่",resumeResume:"ชมต่อที่เวลา {time}",startupError:"การเริ่มโปรแกรมผิดพลาด",generalError:"เกิดข้อผิดพลาด",userKicked:"เนื่องจากมีการเข้าสู่ระบบจากที่อื่น  ต้องขอนำคุณออกจากระบบ",playbackError:"ไม่สามารถเล่นวิดีโอได้",noPlaybackTechnologies:"Web browser ที่คุณกำลังใช้ไม่สามารถเล่นวิดีโอได้",continue:"ชมต่อ",adSkip:"ข้ามโฆษณา",close:"ออกจากระบบ","controls.play":"Play","controls.pause":"Pause","controls.gotolive":"Go live","controls.live":"Live","controls.mute":"Mute","controls.unmute":"Unmute","controls.enterfullscreen":"เล่นเต็มจอ","controls.exitfullscreen":"ออกจากโหมดเต็มจอ","controls.timeline":"Timeline","controls.volume":"ระดับเสียง","controls.open":"Open","controls.close":"Close","controls.subtitles":"Subtitles","rest.ASSET_NOT_FOUND":"The video was not found.","rest.ASSET_NOT_PUBLISHED":"The video is not published.","rest.ASSET_PLAYBACK_INVALID_VIDEO_FORMAT":"The video is not published in the correct format.","rest.SESSION_NOT_AUTHENTICATED":"The video is restricted an cannot be played.","rest.UNAUTHORIZED":"The video is restricted an cannot be played.","rest.ASSET_PLAYBACK_INVALID_GEO_LOCATION":"The video cannot be played in your geographical area.","rest.asset":"The video was not found.","rest.playback":"The video was not available for playback.","rest.noplayback":"No available streams for this video.","subtitles.captions":"Captions","subtitles.subtitles":"Subtitles","subtitles.no_subtitles":"No subtitles","subtitles.en":"English","subtitles.no":"Norwegian","subtitles.sv":"Swedish","subtitles.dk":"Danish","subtitles.fi":"Finnish","nextepisode.title":"Next episode","nextepisode.just_watched":"You have just watched","nextepisode.episode":"Episode","nextepisode.countdowntext":"เริ่มในอีก <%= data.countdown %> วินาที","request.xhr":"Request failed."},in_ID:{summaryBarPublished:"Terbitkan",summaryBarLive:"Live ",startPosterLive:"Live ",startPosterCountdownLead:"Hitung Mundur ",startPosterAt:" ",summaryBarDuration:"Durasi ",summaryBarViews:"Dilihat ",recommendationsHeader:"Tonton video lain ",resumePrompt:"Apakah kamu ingin melanjutkan tontonan dari sebelumnya? ",resumeStartOver:"Mulai dari awal ",resumeResume:"Mulai dari  ",startupError:"Pemutar gagal ",generalError:"Pemutar gagal ",userKicked:"Kamu dikeluarkan karena akun kamu digunakan di perangkat lain ",playbackError:"Playback gagal ",noPlaybackTechnologies:"Sayang sekali video ini tidak bisa diputar di browser ini ",continue:"Lanjut ",adSkip:"Lewati iklan ",close:"Keluar ","controls.play":"Mulai ","controls.pause":"Pause ","controls.gotolive":"Go Live ","controls.live":"Live ","controls.mute":"Mute ","controls.unmute":"Unmute ","controls.enterfullscreen":"Masuk fullscreen ","controls.exitfullscreen":"Keluar fullscreen ","controls.timeline":"Timeline ","controls.volume":"Volume ","controls.open":"Buka ","controls.close":"Tutup ","controls.subtitles":"Terjemahan ","rest.ASSET_NOT_FOUND":"Video tidak dapat ditemukan ","rest.ASSET_NOT_PUBLISHED":"Video tidak diterbitkan ","rest.ASSET_PLAYBACK_INVALID_VIDEO_FORMAT":"Video tidak diterbitkan dengan format yang tepat ","rest.SESSION_NOT_AUTHENTICATED":"Video ini dibatasi dan tidak dapat diputar ","rest.UNAUTHORIZED":"Video ini dibatasi dan tidak dapat diputar ","rest.ASSET_PLAYBACK_INVALID_GEO_LOCATION":"Video ini tidak bisa diputar diwilayah kamu ","rest.asset":"Video tidak dapat ditemukan ","rest.playback":"Video tidak dapat diputar ulang ","rest.noplayback":"Streaming tidak tersedia untuk video ini ","subtitles.captions":"Teks ","subtitles.subtitles":"Terjemahan ","subtitles.no_subtitles":"Tanpa Terjemahan ","subtitles.en":"Bahasa Inggris ","subtitles.no":"Bahasa Norwegia ","subtitles.sv":"Bahasa Swedia ","subtitles.dk":"Bahasa Denmark ","subtitles.fi":"Bahasa Finlandia ","nextepisode.title":"Episode Selanjutnya ","nextepisode.just_watched":"Kamu baru saja menonton ","nextepisode.episode":"Episode ","nextepisode.countdowntext":"Akan dimulai dalam <%= data.countdown %> detik","request.xhr":"Permintaan gagal "},ms_MY:{summaryBarPublished:"Diterbit ",summaryBarLive:"Langsung ",startPosterLive:"Langsung",startPosterCountdownLead:"Kira detik mula",startPosterAt:" ",summaryBarDuration:"Tempoh",summaryBarViews:"Tontonan ",recommendationsHeader:"Lebih banyak video",resumePrompt:"Sambung tontonan video dari mana anda berhenti?",resumeStartOver:"Ulang",resumeResume:"Sambung dari {time}",startupError:"Pemain video telah gagal.",generalError:"Penyiar telah gagal.",userKicked:"Anda dilog keluar kerana akaun anda telah dilog masuk pada peranti lain.",playbackError:"Video gagal dimainkan.",
noPlaybackTechnologies:"Maaf, video ini tidak boleh dimainkan menggunakan pelayar web ini.",continue:"Sambung",adSkip:"Langkau iklan ini",close:"Keluar","controls.play":"Mula","controls.pause":"Berhenti","controls.gotolive":"Tayangkan","controls.live":"Langsung","controls.mute":"Senyap","controls.unmute":"Bersuara","controls.enterfullscreen":"Papar skrin penuh","controls.exitfullscreen":"Keluar skrin penuh","controls.timeline":"Garis masa","controls.volume":"Bunyi","controls.open":"Buka","controls.close":"Tutup","controls.subtitles":"Sarikata","rest.ASSET_NOT_FOUND":"Video tidak ditemui.","rest.ASSET_NOT_PUBLISHED":"Video ini tidak diterbitkan.","rest.ASSET_PLAYBACK_INVALID_VIDEO_FORMAT":"Video ini tidak diterbitkan dengan format yang betul.","rest.SESSION_NOT_AUTHENTICATED":"Video ini disekat dan tidak dapat dimainkan.","rest.UNAUTHORIZED":"Video ini disekat dan tidak dapat dimainkan.","rest.ASSET_PLAYBACK_INVALID_GEO_LOCATION":"Video ini tidak boleh dimainkan di rantau anda.","rest.asset":"Video tidak ditemui.","rest.playback":"Video ini tiada untuk dimainkan.","rest.noplayback":"Tiada saluran disediakan untuk video ini.","subtitles.captions":"Kapsyen","subtitles.subtitles":"Sarikata","subtitles.no_subtitles":"Tiada sarikata","subtitles.en":"Bahasa Inggeris","subtitles.no":"Bahasa Norway","subtitles.sv":"Bahasa Sweden","subtitles.dk":"Bahasa Denmark","subtitles.fi":"Bahasa Finland","nextepisode.title":"Episod seterusnya","nextepisode.just_watched":"Anda baru sahaja menonton","nextepisode.episode":"Episod","nextepisode.countdowntext":"Akan mula dalam <%= data.countdown %> saat","request.xhr":"Permintaan gagal."}}},function(a,b,c){"use strict";function d(a){i.call(this,a),this.addClass("timeline"),this.position=0,this.liveTime=0,this.duration=a.videoData&&a.videoData.duration?a.videoData.duration:1,this.timeZoneOffset=a.videoData&&a.videoData.timeZoneOffset,this.startPosition=a.videoData&&a.videoData.startPosition?a.videoData.startPosition:0,this.isAtLivePosition=!1,this.markerTypes=[],this.addSubWidgets({progress:new h({id:"timeline",className:"timeline-progressbar"}),slider:new g({id:"timeline",className:"timeline-slider"})}),this.addSubWidgets({markers:new e({videoData:a.videoData,container:this.view.dom})}),this.markerTypes.push(this.markers),a.videoData&&a.videoData.markers&&a.videoData.markers.length>0&&this.markers.addMarkers(a.videoData.markers),this.addCustomMarkers=function(b,c,d){var f={};f[d]=new e({videoData:a.videoData,container:this.view.dom,className:d}),this.addSubWidgets(f),this[d].addMarkers(b,c),this.markerTypes.push(this[d])},this.addMarkers=function(a){this.markers.addMarkers(a)},this.clearMarkers=function(){this.markers.clearMarkers()},this.addSubWidget({timeindicator:new f(this.duration,this.isLive,this.timeZoneOffset,this.view.dom,a.displayTimeshiftOffset)}),this.setDuration=function(a){this.duration=a,this.timeindicator&&(this.timeindicator.duration=a),this.markerTypes.forEach(function(b){b.updateDuration(a)})},this.setPosition=function(a){this.position=a,this.timeindicator&&(this.timeindicator.position=a)},this.setLiveTime=function(a){this.liveTime=a,this.timeindicator&&(this.timeindicator.liveTime=a)},this.setIsAtLivePosition=function(a){this.isAtLivePosition=a},this.setTimeZoneOffset=function(a){this.timeZoneOffset=a,this.timeindicator&&this.timeindicator.setTimeZoneOffset(a)},this.getCorrectedRelativePosition=function(a){var b=this.duration-a<30;return"livedvr"===this.playMode&&this.isAtLivePosition&&b?this.duration:a/this.duration},this.setProgress=function(a){this.progress&&this.progress.setProgress(this.getCorrectedRelativePosition(a))},this.setSlider=function(a){this.slider.setThumbPos(this.getCorrectedRelativePosition(a))},this.init=function(){this.duration>1&&this.setProgress(this.startPosition)};var b;a.videoModel&&(a.videoModel.observe("playMode",function(b){switch(this.playMode=b,b){case"livedvr":this.isLive=!0,this.timeindicator&&(this.timeindicator.isLive=!0),this.slider.reattach(),this.setProgress(a.videoModel.duration);break;case"live":this.isLive=!0,this.timeindicator&&(this.timeindicator.isLive=!0),this.slider.detach(),this.setProgress(a.videoModel.duration);break;case"ondemand":this.isLive=!1,this.timeindicator&&(this.timeindicator.isLive=!1),this.slider.reattach(),this.setProgress(0)}}.bind(this)),a.videoModel.observe("position",function(b){this.slider.isDragging||"live"==this.playMode||(this.setSlider(b),this.setProgress(b),this.setPosition(b)),"live"==this.playMode&&this.setProgress(a.videoModel.duration)}.bind(this)),a.videoModel.observe("absolutePosition",function(a){this.isLive&&(this.setLiveTime(a),this.timeindicator&&this.timeindicator.updateLiveTimeIndicator(a))}.bind(this)),a.videoModel.observe("isAtLivePosition",this.setIsAtLivePosition.bind(this)),a.videoModel.observe("duration",function(b){b>0&&b!==1/0&&!isNaN(b)&&(this.setDuration(b),this.setProgress(a.videoModel.position))}.bind(this)),this.listen({sliderchange:function(b){a.videoModel.setPosition(b.detail.positionPercent*a.videoModel.duration)},"sliderstart, sliderdrag":function(c){b&&b.setProgress(c.detail.positionPercent*a.videoModel.duration),this.setProgress(c.detail.positionPercent*a.videoModel.duration)},"marker.click":function(b){a.videoModel.setPosition(b.detail.marker.timeBegin)}})),this.setTimedisplay=function(a){b=a}}var e=c(133),f=c(135),g=c(108),h=c(136),i=c(109);d.prototype=Object.create(i.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){function b(a,b,c){var d,e=a.offsetLeft,f=b.offsetWidth,g=c.offsetWidth;return d=e<f/2?e:e+f/2>g?f-(g-e):f/2,-d}this.container=a.container,f.call(this,{className:a.className&&a.className+" timeline-markers"||"chapters timeline-markers"}),this.duration=a.videoData&&a.videoData.duration?a.videoData.duration:1,this.markers=[],this.addMarkers=function(a,b){a.forEach(function(a){var c=b||e,d=new c({model:a});this.addSubWidgets(d),this.markers.push(d);var f=this.markers.length-1;d.listen({click:function(a){this.click(f,a)}.bind(this),mouseenter:function(a){this.mouseover(f,a.target)}.bind(this)})},this),this.updateDuration(this.duration)},this.clearMarkers=function(){this.removeAllSubWidgets(),this.markers.length=0},this.removeMarker=function(a){a.removeAllListeners(),this.removeSubWidget(a),this.markers.splice(this.markers.indexOf(a),1)};var c=new CustomEvent("marker.click",{detail:{},bubbles:!0});this.container.addEventListener("sliderdrag",function(a){this.displayClosestMarker(a)}.bind(this)),this.container.addEventListener("sliderchange",function(){this.hideTouchMarkers()}.bind(this)),this.displayClosestMarker=function(a){if("touchmove"===a.detail.type){var b=0,c=0,d=0,e=100;for(var f in this.markers){var g=this.markers[f].timeBegin/this.duration;g<a.detail.positionPercent&&g>c?(b=f,c=g):g>a.detail.positionPercent&&g<e&&(d=f,e=g)}a.detail.positionPercent-c>.05&&(b=null),e-a.detail.positionPercent>.05&&(d=null),b&&d?a.detail.positionPercent-c<e-a.detail.positionPercent?this.showTouchMarker(this.markers[b]):this.showTouchMarker(this.markers[d]):b?this.showTouchMarker(this.markers[b]):d?this.showTouchMarker(this.markers[d]):this.hideTouchMarkers()}},this.showTouchMarker=function(a){if(a)for(var b in this.markers)this.markers[b]===a?(this.markers[b].addClass("showing"),this.addClass("active"),this.mouseover(b,a)):this.markers[b].removeClass("showing")},this.hideTouchMarkers=function(){for(var a in this.markers)this.markers[a].removeClass("showing");this.removeClass("active")},this.click=function(a,b){c.detail.marker=this.markers[a],this.isBeingSelected=!1,this.view.dom.dispatchEvent(c),b.stopPropagation()},this.mouseover=function(a,c){var d=c&&c.firstChild,e=d&&d.firstChild;d&&(d.style.marginLeft=b(c,d,this.container)+"px",e&&(e.style.left=c.getBoundingClientRect().left-d.getBoundingClientRect().left-c.offsetWidth/2+"px"))},this.updateDuration=function(a){this.duration=a,this.markers&&this.markers.forEach(function(a,b){var c=a.timeBegin/this.duration;c>1?a.view.dom.style.display="none":(a.view.dom.style.display="",a.view.dom.style.left=100*c+"%")},this)},a.videoData&&a.videoData.markers&&this.addMarkers(a.videoData.markers),this.init=function(){this.updateDuration(this.duration)}}var e=c(134),f=c(109);d.prototype=Object.create(f.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){e.call(this,a),this.setClassName("chapter marker"),this.addSubWidgets({content:new e({className:"chapter-content marker-content",children:{arrow:new e({className:"marker-content-arrow arrow",type:"div"}),img:new e({className:"chapter-content-image",type:"img",properties:{src:a.model.imageUrl,onerror:function(){this.style.display="none"}}}),time:new e({className:"chapter-content-startTime",type:"span",properties:{textContent:f.formatTimeFromSeconds(a.model.timeBegin)}}),title:new e({className:"chapter-content-title",type:"h6",properties:{textContent:a.model.title}})}})}),a.model.text&&this.content.addSubWidget(new e({className:"chapter-content-title",type:"p",properties:{textContent:a.model.text}})),this.content.addSubWidget(new e({className:"bottom-hover-area",type:"div"})),this.timeBegin=a.model.timeBegin}var e=c(109),f=c(7);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a,b,c,d,h){function i(a){var b=this.mouseXPosition=f.getPointerPos(a,d).x/d.offsetWidth;this.setPos(b)}function j(a,b,c,d){var e=1e3*(b-c),f=1e3*b-d*b*1e3,g=a-f+e;return k(g)}function k(a){var b=new Date;return b.setTime(a),null==c?f.formatTime(b):g.formatTimeWithTimeZone(b,c)}e.call(this,{className:"timeindicator timeline-timeindicator",type:"span"}),this.duration=a,this.isLive=b,this.mouseXPosition=0,this.position=0,this.liveTime=0,d.addEventListener("mousemove",i.bind(this)),d.addEventListener("touchmove",i.bind(this)),this.setPos=function(a){a<0&&(a=0),a>1&&(a=1),this.view.dom.style.left=Math.max(Math.min(a*d.offsetWidth-this.view.dom.offsetWidth/2,d.offsetWidth-this.view.dom.offsetWidth),0)+"px",this.isLive?h?this.view.dom.textContent=f.formatTimeFromSeconds((a-1)*this.duration):this.view.dom.textContent=j(this.liveTime,this.duration,this.position,a):this.view.dom.textContent=f.formatTimeFromSeconds(a*this.duration)},this.updateLiveTimeIndicator=function(){this.setPos(this.mouseXPosition)},this.setTimeZoneOffset=function(a){c=a}}var e=c(109),f=c(7),g=c(60);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){e.call(this,a),this.addClass((a.vertical?"vertical-":"")+"progressbar"),this.addSubWidget({progress:new e({className:a.className+"-progress progress"})}),this.name=a.id,this.vertical=!!a.vertical,this.setProgress=function(a){return a<0&&(a=0),a>1&&(a=1),this.vertical?this.progress.view.dom.style.height=100*a+"%":this.progress.view.dom.style.width=100*a+"%",a}}var e=c(109);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){e.call(this,a),this.addClass("timedisplay"),this.addSubWidgets({ondemandtimedisplay:new e({className:"timedisplay-ondemand",children:{progress:new e({className:"timedisplay-progress",type:"span"}),separator:new e({className:"timedisplay-separator",type:"span",properties:{textContent:"/"}}),duration:new e({className:"timedisplay-duration",type:"span"})}}),livetimedisplay:new e({className:"timedisplay-live",children:{progress:new e({className:"timedisplay-progress",type:"span"})}})}),this.durationValue=a.duration?a.duration:0,this.startPositionValue=a.startPosition?a.startPosition:0,this.init=function(){this.setDuration(this.durationValue),this.setProgress(this.startPositionValue);var a=new Date;this.setLiveTime(a)},this.setProgress=function(b){this.ondemandtimedisplay.progress.view.dom.textContent=f.formatTimeFromSeconds(Math.max(b,0)),a.displayTimeshiftOffset&&(this.livetimedisplay.progress.view.dom.textContent=this.isAtLivePosition?"":f.formatTimeFromSeconds(b-this.duration,!0))},this.setDuration=function(a){this.duration=a,this.ondemandtimedisplay.duration.view.dom.textContent=a===1/0||isNaN(a)?"---":f.formatTimeFromSeconds(Math.max(a,0))},this.setTimeZoneOffset=function(b){a.timeZoneOffset=b},this.setLiveTime=function(b){a.displayTimeshiftOffset||(this.livetimedisplay.progress.view.dom.textContent=null==a.timeZoneOffset?f.formatTime(b):g.formatTimeWithTimeZone(b,a.timeZoneOffset))};var b;a.videoModel&&(a.videoModel.observe("position",function(a){b&&b.slider.isDragging||this.setProgress(a)}.bind(this)),a.videoModel.observe("absolutePosition",function(a){this.setLiveTime(a)}.bind(this)),a.displayTimeshiftOffset&&a.videoModel.observe("isAtLivePosition",function(a){this.isAtLivePosition=a}.bind(this)),a.videoModel.observe("duration",function(a){a>0&&a!==1/0&&!isNaN(a)&&this.setDuration(a)}.bind(this))),this.setTimeline=function(a){b=a}}var e=c(109),f=c(7),g=c(60);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){function b(a){return a.language&&a.kind?a.kind+"_"+a.language:a.language||a.kind}function c(a,b){if(a.kind&&b.kind){if(a.kind<b.kind)return-1;if(a.kind>b.kind)return 1}if(a.language&&b.language){if(a.language<b.language)return-1;if(a.language>b.language)return 1}return 0}function d(d){var e={};return e.none={label:a.strings.subtitles.no_subtitles||"No subtitles"},d.concat().sort(c).forEach(function(c){var d=b(c);e[d]={label:c.label||a.strings.subtitles[c.language]||"["+c.language+"]",kind:c.kind,language:c.language,track:c}}),e}f.call(this,a||{});var i={};this.addClass("subtitles-selector"),this.updateState=function(a){a&&a.length>0&&(""!==a[0].language||""!==a[0].label)?this.addClass("visible"):this.removeClass("visible")},this.addSubWidgets({toggle:new e({className:"subtitles-selector-toggle",titles:{on:a.strings.label,off:a.strings.label},classes:{on:"open",off:"closed"}}),choices:new g({className:"subtitle",choices:{none:"No subtitles"}})}),this.setItems=function(a){i=d(a),this.choices.updateChoices(i),this.updateState(a)},this.setSelected=function(a,c){var d=c?b({language:a,kind:c}):a;this.choices.setSelected(d)},a.videoModel&&(a.videoModel.observe("textTracks",function(b){this.setItems(b);try{for(var c,d=a.userSettings?a.userSettings.get("subtitlesLanguage")||"none":"en",e=a.userSettings?a.userSettings.get("subtitlesKind"):"",f=0;f<b.length;f++){var g=b[f];if("none"===d&&g.language===d){c=g;break}if(e){if(d===g.language&&e===g.kind){c=g;break}d===g.language?c=g:c||e!==g.kind||(c=g)}else if(g.language===d){c=g;break}}c&&(c.select(),this.setSelected(c.language,c.kind))}catch(a){h.error("Failed applying stored subtitles settings.",a)}}.bind(this)),this.listen({"subtitle.change":function(b){var c=b.detail&&b.detail.choice;if(c&&"none"===c.id)a.videoModel.textTracks.forEach(function(a){a.unselect()});else{var d=i[c.id]&&i[c.id].track;d&&d.select()}if(a.userSettings)if("none"===c.id)a.userSettings.set("subtitlesLanguage","none");else{var d=i[c.id]&&i[c.id].track;d&&(d.language&&a.userSettings.set("subtitlesLanguage",d.language),d.kind&&a.userSettings.set("subtitlesKind",d.kind))}}}))}var e=c(116),f=c(109),g=c(139),h=c(4).get("subtitleSelector");d.prototype=Object.create(f.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){a.children&&(this.children=a.children),this.choices=a.choices,this.chosen_id=a.default?a.default:Object.keys(this.choices)[0],this.enableMultipleSelection=!1,this.maximumSelectionCount=1/0,this.selectedChoices=[],f.call(this,a),this.addClass("choices");var b=new CustomEvent(a.className+".change",{detail:{},bubbles:!0});this.setChoices=function(a){this.removeAllSubWidgets(),this.choices={},this.selectedChoices.length=0,Object.getOwnPropertyNames(a).forEach(function(b){var c=e(a[b]);this.choices[b]=c,this.addSubWidget(c),a[b].isSelected&&(c.addClass("chosen"),this.setSelectedHtml(c),this.enableMultipleSelection&&this.selectedChoices.push(c))}.bind(this)),this.setSelectionHandlers()},this.click=function(a){var c=this.choices[a];if(c&&this.enableMultipleSelection)if(c.hasClass("chosen")){if(this.selectedChoices.length>1){var d=this.selectedChoices.indexOf(c);d>-1&&this.selectedChoices.splice(d,1),c.isSelected=!1,c.removeClass("chosen"),c.tick&&c.removeSubWidget(c.tick)}}else this.selectedChoices.length<this.maximumSelectionCount&&(c.addClass("chosen"),this.setSelectedHtml(c),this.selectedChoices.push(c),c.isSelected=!0,this.chosen_id=a);else this.choices[this.chosen_id].removeClass("chosen"),this.choices[a].addClass("chosen"),this.chosen_id=a;b.detail.choice={id:a,detail:this.choices[a]},this.view.dom.dispatchEvent(b)},this.setSelectedHtml=function(b){b&&a.content&&a.content.html&&b.addSubWidgets({tick:new f({type:"span",className:"selected-html",html:a.content.html})})},this.updateChoices=function(a){this.choices=a,this.setChoices(a),this.choices[this.chosen_id]&&this.choices[this.chosen_id].addClass("chosen"),this.setSelectionHandlers()},this.setSelected=function(a){this.choices[this.chosen_id].removeClass("chosen"),this.chosen_id=a,this.choices[this.chosen_id].addClass("chosen"),this.choices[this.chosen_id].isSelected=!0,this.enableMultipleSelection&&this.selectedChoices.indexOf(this.choices[this.chosen_id])<0&&this.selectedChoices.push(this.choices[this.chosen_id])},this.setSelectionHandlers=function(){Object.getOwnPropertyNames(this.choices).forEach(function(a){var b=this.choices[a];b.listen({click:function(b){this.click(a,b)}.bind(this)})}.bind(this))},this.init=function(){this.setSelectionHandlers(),this.chosen_id&&this.click(this.chosen_id)},this.setChoices(this.choices)}function e(a){var b=a.label||a,c=new f({properties:{textContent:b,title:a.description||""}});return"object"==typeof a&&Object.getOwnPropertyNames(a).forEach(function(b){c[b]=a[b]}),c}var f=c(109);d.prototype=Object.create(f.prototype),a.exports=d},function(a,b,c){"use strict";function d(a){function b(){B.countdown.update({countdown:y}),0!=y||A?A?window.clearTimeout(z):(y-=1,z=setTimeout(function(){b()},1e3)):(n.nextEpisode&&B.nextButton.emit("click"),window.clearTimeout(z))}function c(a){var b=Math.floor(a/3600);a%=3600;var c=Math.floor(a/60);return b>0?b+=" hr ":b="","("+b+c+" min)"}function d(){B.countdown.emit("stop.countdown"),A=!0,B.view.dom.parentNode.classList.add("hidden")}function j(a,b){var c={currentEpisode:null,nextEpisode:null};return a&&b&&b.seasons?(b.seasons.forEach(function(b,d){b.episodes&&b.episodes.forEach(function(e,f){e["@id"]!=a&&e.id!=a||(c.currentEpisode=e,b.episodes[f+1]?c.nextEpisode=b.episodes[f+1]:f==b.episodes.length-1&&m.seasons[d+1]&&(c.nextEpisode=m.seasons[d+1].episodes[0]))})}),c):c}e.call(this,a);var k=a.locale,l=a&&a.videoData&&a.videoData.id||null,m=a&&a.configuration&&a.configuration.getOptions().showData||null,n=j(l,m),o=n.nextEpisode,p=n.currentEpisode,q=m&&("string"==typeof m.title&&m.title||m.title&&m.title[k])||o&&o.categoryTitle||"",r=o&&o.metadata&&o.metadata.episode&&o.metadata.episode.$||o&&o.episodeNumber||null,s=o&&o.metadata&&o.metadata.season&&o.metadata.season.$||o&&o.seasonNumber||null,t=o&&(o.title[k]||o.title.en_US||o.metadata&&o.metadata.episode&&o.metadata.title.$)||null,u=q&&r&&t?q+"\nEpisode "+parseInt(r)+"\n"+t:"Play next episode",v=r?"E"+h.zeroPad(parseInt(r)):void 0,w=s?"S"+h.zeroPad(parseInt(s)):void 0,x=a.configuration&&a.configuration.getConfiguration().autoAdvance&&a.configuration.getConfiguration().autoAdvance.enableOverlay;this.nextButton=new f({className:x?"play-next-video-button":"playtonext-button",title:u}),this.closeButton=new f({className:x?"close-next-video-button":"close-playtonext-button",title:"Close"});var y,z,A,B=this;if(this.countdown=new g({className:"countdown-next-episode",template:"<h3>"+i.msg("nextepisode.countdowntext")+"</h3>",data:{countdown:y}}),m&&m.seasons&&n.nextEpisode&&x){this.countdown.listen({"start.countdown":function(c){y=a.configuration.getConfiguration().autoAdvance.countdown||15,c.detail&&c.detail.remainingDuration-1<=y&&(y=parseInt(c.detail.remainingDuration-1)),b(y)},"update.countdown":function(a){a.detail&&a.detail.remainingDuration-1<=y&&(y=parseInt(a.detail.remainingDuration-1))},"stop.countdown":function(a){z&&window.clearTimeout(z)}});var C,D=m&&m.show&&m.show.metadata&&m.show.metadata["image-pack"]&&m.show.metadata["image-pack"].$||null;C=D?"http://images.iflix.com/"+D+"_s_200x300":m&&m.imageUrl,this.addSubWidget({playToNext:new e({className:"auto-advance-container",children:{imageContainer:new e({className:"next-video-image",children:[new g({template:C&&'<img src="<%= data.src %>" />'||"",data:{src:C}})]}),metadata:new e({className:"next-video-metadata",children:{closeButton:this.closeButton,countdown:this.countdown,textContent:new e({className:"text-content",children:{videoTitle:new g({className:"next-video-title",template:"<h2><%= data.text %></h2>",data:{text:s&&r?"Season "+parseInt(s)+", Episode "+parseInt(r):q}}),nextButton:this.nextButton,videoSubtitle:new g({className:"next-video-subtitle",template:"<%= data.text %>",data:{text:t}}),videoDuration:new g({className:"next-video-duration",template:"<div><%= data.text %></div>",data:{text:o&&o.duration?c(o.duration):""}})}})}})}})})}this.nextButton.listen({click:function(){n.nextEpisode&&(this.emit("play.next.episode",{currentId:l,asset:p,nextId:n.nextEpisode["@id"]||n.nextEpisode.id,config:a.configuration}),z&&window.clearTimeout(z))}}),this.closeButton.listen({click:function(){d()}}),m&&m.seasons&&n.nextEpisode&&!x&&(this.addSubWidget({playToNext:new e({className:"playtonext-container",children:{closeButton:this.closeButton,titleContainer:new e({className:"title-container",children:{titleContainer:new g({className:"show-title",template:"<h3><%= data.title %></h3>",data:{title:q}})}}),contentContainer:new e({className:"content-container",children:{text:new g({className:"play-next-text",template:"<span><%= data.text %></span><%= data.number %><%= data.title %>",data:{text:i.msg("nextepisode.title"),number:w&&v?"<br/><span>"+w+" "+v+"</span>":"",title:t?": "+t:""}}),nextButton:this.nextButton}})}})}),x&&(this.playToNext.contentContainer.addClass("countdown-enabled"),this.playToNext.contentContainer.addSubWidget({countdown:this.countdown})))}var e=c(109),f=c(117),g=c(118),h=c(7),i=c(130);d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){(function(b){"use strict";function d(){this.templates={preroll:b.templates.adPlaybackMessage,postroll:b.templates.adPostrollPlaybackMessage},f.call(this,{className:"admessage",template:this.templates.preroll}),this.setMsgTemplate=function(a){this.setTemplate(this.templates[a]?this.templates[a]:this.templates.preroll)}}var e=c(109),f=c(118);d.prototype=Object.create(e.prototype),a.exports=d}).call(b,c(107))},function(a,b,c){"use strict";function d(a,b){function c(a){a.addSubWidgets({title:new e({type:"span",className:"title",properties:{textContent:i.title}}),publishDate:new e({type:"span",className:"publishDate",properties:{textContent:i.publishedDateTime}})})}function d(){this.image.view.dom.setAttribute("src",h)}e.call(this,{type:"span",className:"start-poster-widget"}),this.addSubWidget({image:new e({type:"img",className:"start-poster-image",properties:{src:a.background||h}}),link:new e({type:"a",properties:{href:a.url}})}),this.duration=a.duration?a.duration:1,this.image.listen({load:a.onload,error:d.bind(this)}),this.listen({click:a.onclick}),this.link.view.dom.style.cursor="pointer";var i={};switch(i.title=a.title,i.viewCount=a.viewCount,i.publishedDateTime=f.formatDateAndTime(a.localLiveStartTime),i.startTime=f.formatDate(a.localLiveStartTime),i.duration=f.formatTimeFromSeconds(a.duration||Math.max(a.onDemandTimeEnd-a.onDemandTimeBegin||0,0)),b){case"basic":c(this);break;case"default":a.isLive;break;case"summary":a.isLive?c(this):(c(this),this.addSubWidgets({duration:new e({type:"span",className:"duration",properties:{textContent:i.duration}}),viewCount:new e({type:"span",className:"view-count",properties:{textContent:i.viewCount}})}))}g.debug("templateName: "+b+", isLive: "+a.isLive)}var e=c(109),f=c(7),g=c(4),h=(g.get("poster"),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=");d.prototype=Object.create(e.prototype),a.exports=d},function(a,b,c){"use strict";function d(a,b){return function(c){return c?(a?a+"-":"vimond-player-")+c+(b?" "+b+"-"+c:""):""}}function e(a){return a?function(a){return a}:function(){}}function f(a,b,c,f,g,h){var i=d(),j=e(g),k=l.build("div",{className:i("poster-start"),style:j("position: relative; height: 100%; width: 100%; overflow: hidden;")});a||(a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=");var m=l.build("img",{src:a,className:"vimond-player-poster-image",style:j("display: block; width: 100%; position: relative; bottom: 0px;")});if(f&&(m.addEventListener("load",f),m.addEventListener("error",f)),h||null==c)return k(m);var n=l.build("a",{href:b,style:j("display: block; position: relative; border: 0px;")}).addEventListener("click",c);return k(n(m))}function g(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c].url){var d=b.buildResourceUrl(a[c].url);m.downloadFont(a[c].name,d)}}function h(a,b,c,d){function e(){u=!0}function f(){v=!0,w=!0}function g(){w=!1}function h(){(u||v||w)&&(v=!1,u=!1,x===!1&&(x=!0,l(x),A.invoke(q.useractive)),clearTimeout(s),s=setTimeout(function(){y?(x=!0,l(x),A.invoke(q.useractive)):u||(x=!1,l(x),A.invoke(q.userinactive))},b))}function i(a){y=!0}function j(a){y=!1}function l(b){n.removeClass(a,b?d:c),n.addClass(a,b?c:d)}function m(a){z||(n.notifyFullscreenChange(function(){y=!1}),z=!0),a.addEventListener("mouseenter",i),a.addEventListener("mouseleave",j)}function o(a){y=!1,a.removeEventListener("mouseenter",i),a.removeEventListener("mouseleave",j)}function p(){window.clearInterval(t),a&&(a.removeEventListener("mousemove",e),a.removeEventListener("touchstart",f),a.removeEventListener("touchend",g))}function r(){return x}var s,t,u=!1,v=!1,w=!1,x=!1,y=!1,z=!1,A=new k(a,q);return a.addEventListener("mousemove",e),a.addEventListener("touchstart",f),a.addEventListener("touchend",g),t=window.setInterval(h,250),x=!0,l(x),{nudge:e,isUserActive:r,stop:p,registerHotZone:m,unregisterHotZone:o,addEventListener:A.addEventListener,removeEventListener:A.removeEventListener}}function i(a,b,c,d,e,f){function g(a,b){c=a,b&&(i=f&&f.minScale||.1,j=f&&f.maxScale||2),h()}function h(){var d=Math.max(i,Math.min(j,b.clientWidth/c));if(p)k(d);else{var f="scale("+d+")";a.style.transform=f,a.style.webkitTransform=f,a.style.msTransform=f,a.style.mozTransform=f}e&&(a.style.width=Math.round(100/d)+"%")}var i=f&&f.minScale||.1,j=f&&f.maxScale||2;b=b.elm||b,a=a.elm||a;var k=function(b){a.style.zoom=b};if(d=d||"0% 0%",p&&d.indexOf("100%")>=0){var l=a.firstChild;"100% 0%"==d&&(k=function(b){a.firstChild.style.zoom=b;var c=-l.clientWidth*(1-b);a.style.right=c+"px"})}return a.style.transformOrigin=d,a.style.webkitTransformOrigin=d,a.style.msTransformOrigin=d,a.style.mozTransformOrigin=d,h.applyNewBaseSize=g,h}function j(a,b,c,d){function e(a,d){return c.filter(function(b){return a in b}).sort(function(b,c){return d?c[a]-b[a]:b[a]-c[a]}).map(function(c){return{threshold:c[a],className:b+a+"-"+c[a]}})}function f(){for(var c=a.clientWidth,d=[],e=0;e<k.length;e++){var f=k[e];if(!(c<f.threshold))break;d.push(f.className)}for(var g=0;g<l.length;g++){var h=l[g];if(!(c>h.threshold))break;d.push(h.className)}var m=a.className.split(" ").filter(function(a){return a.indexOf(b+i)<0&&a.indexOf(b+j)<0});a.className=m.concat(d).join(" ")}function g(){o.addResizeListener(a,f);var b=navigator.userAgent.toLowerCase();b.indexOf("safari")>0&&b.indexOf("chrome")<0&&f()}function h(){o.removeResizeListener(a,f)}b=b?b+"-":"";var i="max-width",j="min-width",k=e(i,!0),l=e(j);if(k.length+l.length!==c.length)throw new Error("Some of the width rules don't follow the { 'max-width': NNN } or { 'min-width': NNN } pattern.");return d||g(),{update:f,unobserve:h}}var k=c(34),l=c(144),m=c(145),n=c(7),o=c(146),p=navigator.userAgent.indexOf("MSIE 8")>0&&navigator.userAgent.indexOf("Trident")>0,q={useractive:"useractive",userinactive:"userinactive"};a.exports={isIe8:p,buildSimplePoster:f,prepareFonts:g,getStyler:e,getClassNamer:d,setupResizer:i,setupClassNamesFromWidthRules:j,maintainUserActivityState:h}},function(a,b){"use strict";function c(a,b,c){c&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c))}function d(a,b){var e=a.nodeName?a:document.createElement(a);for(var f in b)if(b.hasOwnProperty(f))if("id"==f)e.id=b[f];else if("className"==f)e.className=b[f];else if("style"==f){var g=b[f];g&&g.lastIndexOf(";")!=g.length-1&&(g+=";"),e.style.cssText=g}else e.setAttribute(f,b[f]);var h=function(a){if(null!=a||""!==a)if(a.elm)h(a.elm);else if(a.pop&&a.push)for(var b=0;b<a.length;b++)h(a[b]);else a.nodeType&&a.nodeName?e.appendChild(a):e.appendChild(document.createTextNode(a));return h};return h.elm=e,h.add=h,h.replace=function(a){for(;e.firstChild;)e.removeChild(e.firstChild);return h(a)},h.getFirst=function(a){var b=[];if(a.elementName&&(b=e.getElementsByTagName(a.elementName)),b.length>0)return d(b[0])},h.empty=function(){for(;e.firstChild;)e.removeChild(e.firstChild);return h},h.setStyle=function(a){a&&a.lastIndexOf(";")!=a.length-1&&(a+=";"),e.style.cssText=a},h.addEventListener=function(a,b){return c(e,a,b),h},h}function e(a){var b=document.createElement(a.type);return a.className&&(b.className=a.className),a.id&&(b.id=a.id),a.handlers&&Object.getOwnPropertyNames(a.handlers).forEach(function(c){b.addEventListener(c,a.handlers[c])}),a.attrs&&Object.getOwnPropertyNames(a.attrs).forEach(function(c){b.setAttribute(c,a.attrs[c])}),a.cssText&&(b.style.cssText=a.cssText),a.textContent&&(b.textContent=a.textContent),a.properties&&Object.getOwnPropertyNames(a.properties).forEach(function(c){b[c]=a.properties[c]}),b}a.exports={build:d,createElement:e}},function(a,b,c){"use strict";function d(a,b){var c=document.createElement("style");c.setAttribute("type","text/css"),b&&(c.id=b),document.getElementsByTagName("head")[0].appendChild(c),c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a))}function e(a,b,c){var e=c?g:"";e+="."+b+"#"+a+j;for(var f=0;f<h.length;f++)e+="."+b+"#"+a+" "+h[f],e+=f<h.length-1?", ":" ";e+=i,d(e)}var f=c(7),g="/* Local style reset for Vimond player HTML subtree */\n\n",h=["div","span","object","h1","h2","h3","h4","h5","h6","p","a","a:-webkit-any-link","img","dl","dt","dd","ol","ul","li","form","label","canvas","video"],i="{ \t    margin: 0; \t    padding: 0; \t    border: 0; \t    background: transparent none;  \t    font-style: normal; \t    font-variant: normal; \t    font-size: 100%; \t    font-family: sans-serif; \t    font-weight: normal; \t    text-align: left; \t    text-decoration: none; \t    text-indent: 0; \t    text-justify: none; \t    text-overflow: clip; \t    text-shadow: none; \t    text-spacing: none; \t    text-transform: none; \t    text-wrap: normal; \t    box-shadow: none; \t    box-sizing: content-box; \t    position: relative; \t    visibility: visible; \t    vertical-align: baseline; \t    letter-spacing: normal; \t    list-style: none; \t    white-space: normal; \t    overflow: visible; \t}\n\n",j=" a img { border: 0; }\n\n",k="@font-face {\t    font-family: '{fontName}';\t    src: url('{fontUrl}.eot'); /* IE9 Compat Modes */\t    src: url('{fontUrl}.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */\t        url('{fontUrl}.woff') format('woff'), /* Modern Browsers */\t        url('{fontUrl}.ttf')  format('truetype'), /* Safari, Android, iOS */\t        url('{fontUrl}.svg#svgFontName') format('svgv'); /* Legacy iOS */\t    font-weight: normal;\t    font-style: normal;\t}";a.exports={insertResetSheet:e,downloadFont:function(a,b){var c="style-"+a;if(!document.getElementById(c)){var e=f.format(k,{fontName:a,fontUrl:b});d(e,c)}}}},function(a,b){"use strict";function c(a){var b=a.__resizeTriggers__,c=b.firstElementChild,d=b.lastElementChild,e=c.firstElementChild;d.scrollLeft=d.scrollWidth,d.scrollTop=d.scrollHeight,e.style.width=c.offsetWidth+1+"px",
e.style.height=c.offsetHeight+1+"px",c.scrollLeft=c.scrollWidth,c.scrollTop=c.scrollHeight}function d(a){return a.offsetWidth!=a.__resizeLast__.width||a.offsetHeight!=a.__resizeLast__.height}function e(a){var b=this;c(this),this.__resizeRAF__&&k(this.__resizeRAF__),this.__resizeRAF__=j(function(){d(b)&&(b.__resizeLast__.width=b.offsetWidth,b.__resizeLast__.height=b.offsetHeight,b.__resizeListeners__.forEach(function(c){c.call(b,a)}))})}function f(){if(!i){var a=(v?v:"")+".resize-triggers { "+(w?w:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',b=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c),i=!0}}function g(a,b){a.__resizeTriggers__||("static"==getComputedStyle(a).position&&(a.style.position="relative"),f(),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=document.createElement("div")).className="resize-triggers",a.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',a.appendChild(a.__resizeTriggers__),c(a),a.addEventListener("scroll",e,!0),o&&a.__resizeTriggers__.addEventListener(o,function(b){b.animationName==u&&c(a)})),a.__resizeListeners__.push(b)}function h(a,b){a.__resizeListeners__.splice(a.__resizeListeners__.indexOf(b),1),a.__resizeListeners__.length||(a.removeEventListener("scroll",e),a.__resizeTriggers__=!a.removeChild(a.__resizeTriggers__))}var i=!1,j=function(){var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){return window.setTimeout(a,20)};return function(b){return a(b)}}(),k=function(){var a=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(b){return a(b)}}(),l=!1,m="animation",n="",o="animationstart",p="Webkit Moz O ms".split(" "),q="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),r="",s=document.createElement("fakeelement");if(void 0!==s.style.animationName&&(l=!0),l===!1)for(var t=0;t<p.length;t++)if(void 0!==s.style[p[t]+"AnimationName"]){r=p[t],m=r+"Animation",n="-"+r.toLowerCase()+"-",o=q[t],l=!0;break}var u="resizeanim",v="@"+n+"keyframes "+u+" { from { opacity: 0; } to { opacity: 0; } } ",w=n+"animation: 1ms "+u+"; ";a.exports={addResizeListener:g,removeResizeListener:h}},111,function(a,b,c){"use strict";function d(a,b){var c=new j(b);return a.api.setControlApi(c),c}function e(a,b){try{return a.model.trackerManager.attachForPlayback(b,a.model.configuration)}catch(a){return o.warn("Tracking setup failed, but playback start will resume.",a),n()}}function f(a,b){var c=a.getConfiguration(),d=a.getOptions(),e=a.getConfiguration().containerClassName,f=a.getEmbedContext(),g={dash:l(c.dash),silverlight:l(c.silverlight),htmlAdOverlay:{activeClassName:e+"-ads-active",inactiveClassName:e+"-ads-inactive"},html:{supportsAutoplay:!!b.videoElement||f.supportsAutoplay,enableLicenseAcquisition:c.html&&c.html.enableLicenseAcquisition,fairplay:c.html&&c.html.fairplay},subtitles:l(c.subtitles)};g.dash&&d.dash&&d.dash.manifestModifier&&(d.dash.manifestModifier.replacements&&(g.dash.manifestModifier=g.dash.manifestModifier||{},g.dash.manifestModifier.replacements=l(d.dash.manifestModifier.replacements)),d.dash.manifestModifier.presentationTimeOffsetFixPolicy&&(g.dash.manifestModifier=g.dash.manifestModifier||{},g.dash.manifestModifier.presentationTimeOffsetFixPolicy=d.dash.manifestModifier.presentationTimeOffsetFixPolicy));var h=e+"-video";return g.dash&&(g.dash.dashjs&&(g.dash.dashjs.libraryUrl=a.getLibraryUrl(g.dash.dashjs.libraryUrl),g.dash.dashjs.domClassName=h),g.dash.shaka&&(g.dash.shaka.libraryUrl=a.getLibraryUrl(g.dash.shaka.libraryUrl),g.dash.shaka.domClassName=h)),g.silverlight&&g.silverlight.core&&(g.silverlight.core.xapUrl=a.buildResourceUrl(g.silverlight.core.xapUrl),g.silverlight.core.domClassName=h),g.html.domClassName=h,g}function g(a,b,c){var g=h.applyContext({profiles:a.model.configuration.getEmbedContext().profiles},{streamLookupService:b}),j=a.appContainer.videoElement;return a.appContainer.clear(),g.resolve().then(function(g){return k.videoEngineFactory.applyContext(f(a.model.configuration,a.appContainer)).create(g,a.appContainer.innerContainer,j).then(function(f){o.debug("Inserted video engine",f.technologyName,"dash"===f.technologyName&&f.instance.implementationName);var g=d(a,f);return e(a,f).then(function(){return i.init(a,b,f,g,c)})})}).fail(function(a){throw o.error(a),a})}var h=c(149),i=c(150),j=c(168),k=c(24),l=c(170),m=c(4),n=c(23),o=m.get("playbackSetup");a.exports={setupPlayback:g}},function(a,b,c){"use strict";function d(a,b){function c(c){function d(){return g(c,f[i].streamSetup).then(function(a){if(a.length>0)return h.debug("Found matching streams for profile.",f[i]),f[i].implementation;if(i<f.length-1)return i++,d();throw new e("No streams matching available implementations found.")})}var f=a.profiles,g=b.streamLookupService.lookupStreams,i=0;return d()}return{resolve:c}}function e(a){this.message=a}var f=c(4),g=c(26),h=f.get("technologyResolution");e.prototype=new Error,e.prototype.constructor=e;var i=g(d,"legacyStreamLookupResolutionService");i.TechnologyResolutionError=e,a.exports=i},function(a,b,c){(function(b){"use strict";function d(a){a.api.setState(a.api.exposed.playerStates.ended),g(a)}function e(a,c){var d=a.model.configuration.getOptions().ads&&a.model.configuration.getOptions().ads.adDimensions||{},e={options:a.model.configuration.getOptions().ads,configuration:a.model.configuration.getConfiguration().ads,metadata:c,environment:{width:d.width||a.appContainer.innerContainer.clientWidth,height:d.height||a.appContainer.innerContainer.clientHeight}};return b.createSession(e,a.appContainer.appModel)}function f(a,b,c,f,g){function j(b){x=!1,a.api.setState(a.api.exposed.playerStates.playing),u=b;var d=b.metadata;if(v.updateMetadata(d),l.debug("Data received for playback.",d),"OK"===d.status){if(d.streamItem){if(g.isCancelled)return l.debug("Playback start was cancelled, dismissing right away.",g),g;l.debug("Not cancelled.",g),t=new i(a,c,b.toOverlayModel(),a.model.configuration),a.cleanupCurrentState=function(){s()},c.adVideoModel.observe("isAdClicked",function(a){l.debug("isAdClicked has changed.",a),a&&c.playbackScheduler.trackAdClick()}),a.model.sessionControlService&&a.model.sessionControlService.start();var f=c.playbackScheduler.schedule(b.toSource(),e(a,d));return f.done(k,n,r),f}a.model.trackerManager.notifyEvent({module:"playback",eventType:"unavailable",details:{status:"404"}}),s("rest.noplayback")}else l.error("Unfriendly playback status should have been catched when calling setupPlayback.",d.status),a.model.trackerManager.notifyEvent({module:"playback",eventType:"inaccessible",details:{status:status}}),s("rest."+d.status)}function k(){s(),a.model.configuration.getConfiguration().disableExitFullscreenOnContentEnd||a.appContainer.appModel.setIsFullscreen(!1),d(a)}function n(a){return l.error("Playback startup error",a),s(a),a}function o(b){l.warn("Stream failover solution not implemented. Giving up on first stream item.",b),a.model.trackerManager.notifyEvent({module:"playback",eventType:"streamError",details:{error:b}}),f.onError(b),s("playbackError")}function p(b){l.warn("Play start REST error",b),a.model.trackerManager.notifyEvent({module:"playback",eventType:"unavailable",details:{error:b}}),f.onError(b),s(b)}function q(){w&&(u.logPlayback(),w=!1)}function r(b){try{switch(v.notifyProgress(b),b.event){case m.waitingForUserInteraction:a.finished();break;case m.bufferingStarted:a.wait();break;case m.bufferingEnded:case m.adEnded:a.finished();break;case m.adStarted:q(),a.finished();break;case m.mainContentStarted:a.finished(),q();break;case m.streamError:a.finished(),o(b.error)}f.onProgressChange(b),l.debug("Progress: "+JSON.stringify(b,function(a,b){if("creatives"!==a&&"data"!==a)return b}))}catch(a){l.error("Progress failed.",a)}}function s(b){x||(v.cleanupAfterPlayback(b),t&&t.detachView(),a.model.sessionControlService&&a.model.sessionControlService.stop(),b?(a.appContainer.appModel.setIsFullscreen(!1),a.appContainer.showMessage(b)):(x=!0,c.playbackScheduler.stop()))}var t,u,v=a.model.trackerManager,w=!0,x=!1;return a.wait(),h.getPlaybackData(b,a.model.configuration).then(j,p).fail(function(a){l.error("Big fail",a)})}var g=(c(148),c(153)),h=(c(20),c(154)),i=c(156),j=c(4),k=c(24),l=j.get("playbackController"),m=k.scheduleEventTypes;a.exports={init:f}}).call(b,c(151))},function(a,b,c){(function(b){"use strict";function d(a){function c(a,b){return e({playItems:[]})}return{requestAds:c,interstitialSetup:b.getMidrollSetup()}}var e=c(23);a.exports={createSession:function(a){return new d(a)}}}).call(b,c(152))},function(a,b){"use strict";a.exports={getMidrollSetup:function(a){return{positions:[]}},mapMetadata:function(a){return{}}}},function(a,b,c){(function(b){"use strict";function d(a){var b=c(81),d=a.model.playbackSession.getStartParameters().original;b.init(a,d,{isCancelled:!1},!0,!0)}function e(a){var c,e=a.model.playbackSession,g=a.model.configuration.getConfiguration().containerClassName,h=a.appContainer.innerContainer;f.empty(h);var i=a.model.configuration.getOptions(),j=a.model.configuration.getConfiguration(),k=a.model.playbackSession.getPlayback()&&a.model.playbackSession.getPlayback().assetId||-1;return c=new b.endPoster({url:"#",background:e.getImageUrl(),prefix:g,videoData:i,assetId:k,assetPromise:a.model.playbackSession.getAsset(),configuration:j,onclick:function(){return d(a),evt.preventDefault&&evt.preventDefault(),!1}}),c.setPrefix(g),c.listen({"restart.click":function(b){return d(a),b.preventDefault&&b.preventDefault(),!1}}),c.listen({"nextepisode.click":function(b){a.appContainer.startSession(b.detail.asset["@id"])}}),c.listen({"exit.click":function(){a.appContainer.appModel.exit()}}),c.attach(h),c}var f=c(7);a.exports=e}).call(b,c(106))},function(a,b,c){(function(b){"use strict";function d(a){return a.subtitles.uri?new h.constructors.Track(a.subtitles.uri,a.subtitles.name,a.subtitles.contentType&&a.subtitles.contentType.trim(),a.subtitles.locale,"HEARING_IMPAIRED"===a.subtitles.type?"captions":"subtitles"):new h.constructors.Track(a.subtitles["@uri"],a.subtitles["@name"],a.subtitles["@contentType"]&&a.subtitles["@contentType"].trim(),a.subtitles["@locale"],"HEARING_IMPAIRED"===a.subtitles.type?"captions":"subtitles")}function e(a,c){var d=c.get("subtitles");return i.all([a.getAsset(),a.getPlayback(),a.getItems(),a.getStartItem(),a.getCategory(),a.getStreams(),a.getImageUrl()]).then(function(b){return{status:b[1].playbackStatus&&b[1].playbackStatus.toUpperCase(),asset:b[0],playback:b[1],items:b[2],startItem:b[3],category:b[4],streams:b[5],startPosition:a.getStartPosition(),posterImageUrl:b[6],subtitlesList:[]}}).then(function(b){return d&&d.loadSubtitlesForAsset?a.getSubtitlesList().then(function(a){return b.subtitlesList=a,b},function(a){return b}):b}).then(function(c){return b.getStreamTimingModel(a,c).then(function(a){return c.timingModel=a,c},function(a){return c})}).then(function(b){return new f(a,b,c)})}function f(a,b,c){var e=c.getOptions().useDemoStream&&c.getConfiguration().html.demoStream,f=c.getConfiguration().rest.enableFallbackStreams,i=0;0===b.startPosition&&b.startItem&&(b.startPosition=b.startItem.timeBegin),b.streamItem=b.streams[i],this.metadata=b,this.logPlayback=function(){a.logPlayback(b.streamItem,b.playback.logData)},this.toSource=function(){var a=b.streamItem,c=g.compileStreamUrl(a),i=a.license&&(a.license["@uri"]||a.license.uri),j=f?[]:null;return f&&b.streams&&b.streams.length>1&&b.streams.forEach(function(a,b){b>0&&j.push(a.url)}),new h.constructors.VideoSource(e||c,b.startPosition,b.asset.live,i,j,b.subtitlesList.map(d),b.timingModel,b)},this.toOverlayModel=function(){return{markers:b.items,duration:b.asset.accurateDuration||b.asset.duration,isLive:b.asset.live,title:b.asset.title,description:b.asset.description,time:b.asset.liveBroadcastTime,startPosition:b.startPosition,id:b.asset.id,metaData:b.asset.metadata,subtitle:b.asset.subtitle}}}var g=c(20),h=c(24),i=c(23);a.exports={getPlaybackData:e}}).call(b,c(155))},function(a,b,c){"use strict";var d=c(23);a.exports={getStreamTimingModel:function(){return d()}}},function(a,b,c){(function(b,d,e){"use strict";function f(a,b){return function(){a(b)}}function g(a,b){b.setVolume(a.get("volume")||1)}function h(a,b){a.volume&&b.setVolume(a.volume),a.muted&&b.setIsMuted(a.muted)}function i(a,c,i,r){var t,u,v,w,x,y,z,A,B=r.getConfiguration().html.playerControls,C=r.getConfiguration().html.userActivityZones,D=r.getConfiguration().keyboardShortcuts,E=[],F=r.getConfiguration().html.adOverlay,G=r.getConfiguration().containerClassName,H=r.get("className"),I=c.instance.domElement instanceof window.HTMLMediaElement&&c.instance.domElement,J=new o(r.getConfiguration()),K=p.getClassNamer(G+"-"+B.prefix,H+"-"+B.prefix),L=a.appContainer.innerContainer;L.className=L.className+" "+K("container"),this.detachView=function(){try{t&&t.detach(),u&&u.detach(),v&&v.detach(),x&&x.detach(),z&&z.cleanup&&z.cleanup(),A&&A.cleanup&&A.cleanup(),y&&y.detach(),E.forEach(function(a){a()})}catch(a){s.error(a)}};try{if(!B.enabled||B.notSupported.controls&&B.notSupported.controls.test(navigator.userAgent))throw"Controls not supported";t=new q({className:"overlays",prefix:G}),u=new q({className:"click-overlay"}),w=new l(a.appContainer,c.videoModel,c.adVideoModel,a.appContainer.appModel,u.view.dom),t.addSubWidgets({click:u});var M=new b.widgets(i,r);t.addSubWidgets(M);var N;F.enabled&&(N=new b.adoverlay,v=new q({className:"adoverlay",prefix:G,children:N}),t.addSubWidgets({adoverlay:v}),new j(c.adVideoModel,v),new k(v,c.videoModel,c.adVideoModel)),t.attach(L);var O=t.getComponents();if(g(J,c.videoModel),h(r.getOptions(),c.videoModel),z=new d(O,c.videoModel,c.adVideoModel,a.appContainer.appModel,a.appContainer,J),A=new e(O,c.videoModel,c.adVideoModel,a.appContainer.appModel,J,a.appContainer),D&&(y=new n(c.videoModel,a.appContainer.appModel,D,a.appContainer)),a.appContainer.userActivityStateMaintainer){if(C)for(var P=L.querySelectorAll(C),Q=0;Q<P.length;Q++)a.appContainer.userActivityStateMaintainer.registerHotZone(P[Q]),E.push(f(a.appContainer.userActivityStateMaintainer.unregisterHotZone,P[Q])),s.debug("Registering element as hot zone.",P[Q]);y&&y.setKeyResponseNotifier(a.appContainer.userActivityStateMaintainer.nudge),a.appContainer.userActivityStateMaintainer.nudge()}I&&(I.controls=!1),/(iPhone|iPod|iPad)/gi.test(navigator.userAgent)&&(I.addEventListener("webkitendfullscreen",function(){a.appContainer.appModel.update("isFullscreen",!1)}),I.addEventListener("webkitbeginfullscreen",function(){a.appContainer.appModel.update("isFullscreen",!0)}))}catch(b){this.detachView(),I&&(I.controls=!0,c.adVideoModel&&new m(I,c.adVideoModel)),w||(w=new l(a.appContainer,c.videoModel,a.appContainer.appModel,c.adVideoModel,L)),s.error("Error initializing custom player controls.",b)}}var j=c(162),k=c(163),l=c(164),m=c(165),n=c(166),o=c(167),p=c(143),q=c(109),r=c(4),s=r.get("PlayerControlsController");a.exports=i}).call(b,c(106),c(157),c(159))},function(a,b,c){"use strict";function d(a,b,c,d,f,g){var h=!1;f.userActivityStateMaintainer&&f.userActivityStateMaintainer.addEventListener("userinactive",function(){a.episodeselector.toggle.setOn(!1)}),b.observe("textTracks",function(c){var d=b.textTracks;a.subtitles_selector.setItems(c);var e=g.get("subtitlesLanguage");e&&d.forEach(function(b){b.language===e&&(b.select(),a.subtitles_selector.setSelected(b.language,b.kind))})});var i=a.centerOverlay&&a.centerOverlay.playToNext&&a.centerOverlay.playToNext.countdown,j=a.centerOverlay&&a.centerOverlay.playToNext&&a.centerOverlay.playToNext.getNextEpisodeOffset&&a.centerOverlay.playToNext.getNextEpisodeOffset();return b.observe("position",function(a){b.duration-a<(j||30)?h?i&&i.emit("update.countdown",{remainingDuration:b.duration-b.position}):(f.addPrefixedRootClass("episode-ending"),h=!0,i&&i.emit("start.countdown",{remainingDuration:b.duration-b.position})):(h&&i&&i.emit("stop.countdown"),h=!1,f.removePrefixedRootClass("episode-ending"))}),new e(a,b,c,d,f)}var e=c(158);a.exports=d},function(a,b,c){var d,e;d=[],e=function(){"use strict";function a(a,b,c,d,e,f,g){function h(a,b){g[a]&&e.removePrefixedRootClass(g[a]),g[a]=b,e.addPrefixedRootClass(b)}g||(g={}),b.observe("playState",function(b){switch(b){case"playing":a.playpause.setOn(!0);break;case"paused":a.playpause.setOn(!1)}h("playState",b)}),b.observe("playMode",function(c){switch(c){case"livedvr":a.timeline.slider.reattach(),a.livetoggle.reattach(),a.timeline.setProgress(b.duration);break;case"live":a.timeline.slider.detach(),a.livetoggle.detach(),a.timeline.setProgress(b.duration);break;case"ondemand":a.livetoggle.detach(),a.timeline.slider.reattach(),a.timeline.setProgress(0)}h("playMode",c)}),b.observe("position",function(b){a.timeline.slider.isDragging||(a.timeline.setSlider(b),a.timedisplay.setProgress(b),a.timeline.setProgress(b),a.timeline.setPosition(b))}),b.observe("absolutePosition",function(b){a.timeline.isLive&&(a.timedisplay.setLiveTime(b),a.timeline.setLiveTime(b),a.timeline.timeindicator.updateLiveTimeIndicator(b))}),b.observe("duration",function(c){c>0&&c!==1/0&&!isNaN(c)&&(a.timeline.setDuration(c),a.timeline.setProgress(b.position),a.timedisplay.setDuration(c))}),b.observe("volume",function(b){a.volume.slider.setThumbPos(b),b<=.33?h("volume","vol33"):b<=.66?h("volume","vol66"):h("volume","vol100"),a.volume.progressbar&&a.volume.progressbar.setProgress(b)}),d.observe("isFullscreen",function(b){a.fullscreen.setOn(b),h("fullscreenMode",b?"fullscreen":"")}),b.observe("isMuted",function(b){h("muteState",b?"muted":""),a.soundtoggle.setOn(b)}),b.observe("isAtLivePosition",function(b){a.livetoggle.setIsEnabled(!b),a.livetoggle.setOn(b)}),b.observe("isWaitingForUserTap",function(a){h("waitForUserState",a?"waitForUser":"")}),c.observe("isAdsPlaying",function(a){h("adState",a?"adplayback":"")}),c.observe("isAdClicked",function(a){h("adClickedState",a?"adclicked":"")}),this.cleanup=function(){Object.getOwnPropertyNames(g).forEach(function(a){e.removePrefixedRootClass(g[a])})}}return a}.apply(b,d),!(void 0!==e&&(a.exports=e))},function(a,b,c){"use strict";function d(a,b,c,d,g){return a.episodeselector.listen({select:function(a){b.pause(),d.changePlayback(a.detail["@id"]||a.detail.id)}}),a.bottomOverlay.skipback&&a.bottomOverlay.skipback.listen({click:function(a){b.position-15>0?b.setPosition(b.position-15):b.setPosition(0)}}),a.bottomOverlay.skipforward&&a.bottomOverlay.skipforward.listen({click:function(a){b.position+15<b.duration&&b.setPosition(b.position+15)}}),a.playToNext.nextButton.listen({"play.next.episode":function(a){if(a.detail.nextId){var c={assetId:a.detail&&a.detail.currentId||"",position:b.position,duration:b.duration,categoryId:a.detail&&a.detail.asset&&a.detail.asset["@categoryId"]||"N/A",categoryTitle:a.detail&&a.detail.asset&&a.detail.asset.categoryTitle||"N/A",assetTitle:a.detail&&a.detail.asset&&a.detail.asset.title||"N/A",video:b};b.pause(),d.changePlayback(a.detail.nextId),f.postEvent(a.detail.config,c,"next_episode")}}}),a.subtitles_selector.choices.listen({"subtitle.change":function(a){var c=a.detail&&a.detail.choice;c&&("none"===c.id?(b.textTracks.forEach(function(a){a.unselect()}),g.set("subtitlesLanguage","none")):(b.textTracks.forEach(function(a){a.language===c.detail.language&&a.kind===c.detail.kind&&a.select()}),g.set("subtitlesLanguage",c.detail.language)))}}),new e(a,b,c,d,g)}var e=c(160),f=c(161);a.exports=d},function(a,b){"use strict";function c(a,b,c,d,e){a.playpause&&a.playpause.listen({toggle:function(a){a.detail.newStateOn?b.play():b.pause()}}),a.fullscreen&&a.fullscreen.listen({toggle:function(a){d.setIsFullscreen(a.detail.newStateOn)}}),a.timeline&&a.timeline.listen({sliderchange:function(a){b.setPosition(a.detail.positionPercent*b.duration)},"sliderstart, sliderdrag":function(c){a.timedisplay.setProgress(c.detail.positionPercent*b.duration),a.timeline.setProgress(c.detail.positionPercent*b.duration)},"marker.click":function(a){b.setPosition(a.detail.marker.timeBegin)}}),a.livetoggle&&a.livetoggle.listen({toggle:function(a){a.detail.newStateOn&&b.gotoLive()}}),a.soundtoggle&&a.soundtoggle.listen({toggle:function(a){b.setIsMuted(a.detail.newStateOn),a.detail.newStateOn&&e.set("volume",0)}}),a.volume&&a.volume.listen({"sliderstart, sliderdrag, sliderchange":function(a){b.setVolume(a.detail.positionPercent),e.set("volume",a.detail.positionPercent)}}),a.closePlayer&&a.closePlayer.listen({click:function(a){d.exit(),a.stopPropagation()}})}a.exports=c},function(a,b,c){"use strict";function d(a,b,c){var d=a.getOptions(),g=a.getConfiguration(),h=d.tracking&&d.tracking.resume||{},i=g.tracking&&g.tracking.resume||{},j=g.deviceId&&g.deviceId.enabled,k={authorization:h.authorization||i.authorization,tenant:h.tenant||i.tenant,originatorId:h.originatorId||i.originatorId,baseUrl:h.baseUrl||i.baseUrl},l=j?f.getDeviceInfo(g):Q();return l.then(function(d){if(vimond&&vimond.followme)try{var f=vimond.followme.getService(k),h=vimond.followme.getSession(k),i=a.getEmbedContext(),j=k.authorization&&k.authorization.substring(k.authorization.indexOf(" ")+1),l=i&&i.platform||"web",m={eventName:c,originator:"player",versions:["1.0"],originatorId:k.originatorId,tenant:k.tenant,ssoToken:j,client:{clientDate:e.dateToIsoString(),userAgent:window.navigator.userAgent,"env.platform":"dash","env.version":"1.4.0-dev-vimond",buildVersion:g.framework.version,buildName:g.framework.name,platform:l,playerEvent:"play",playerState:b.video.paused?"pause":b.video.ended?"stop":"playing",pageurl:e.getPageUrl(window),viewingSession:h.getCurrentViewingSessionId(),deviceId:d?d.udid:void 0},progress:{title:b.assetTitle,assetId:b.assetId,category:{name:b.categoryTitle,id:b.categoryId},offset:{duration:Math.round(1e3*b.duration),pos:Math.round(1e3*b.position)}}};f.postEvent("player-events",m)}catch(a){console.error(a)}})}var e=c(7),f=c(22);a.exports.postEvent=d},function(a,b){"use strict";function c(a,b){b.skipbutton.listen({click:function(a){}})}a.exports=c},function(a,b,c){var d,e;d=[],e=function(){"use strict";function a(a,b,c){function d(){if(!c.remainingDuration)return"";var a=c.remainingDuration-b.position;return isNaN(a)?"":Math.max(Math.round(a),0)}function e(){a.message.update({adNumber:c.adNumber,adCount:c.adCount,countdown:d()})}c.observe("scheduleType",function(){a.message.setMsgTemplate(c.scheduleType)}),c.observe("isAdSkipEnabled",function(){c.isAdSkipEnabled?a.skipbutton.view.dom.style.display="block":a.skipbutton.view.dom.style.display="none"}),c.observe("adNumber",function(){e()}),b.observe("position",function(){c.isAdsPlaying&&e()})}return a}.apply(b,d),!(void 0!==e&&(a.exports=e))},function(a,b,c){"use strict";function d(a,b,c,d,e){function f(a){return"click"===a.type&&g?(clearTimeout(g),void(g=null)):("touchend"===a.type&&(clearTimeout(g),g=setTimeout(function(){g=null},3e3)),void(c.isAdsPlaying&&c.url&&!c.isAdClicked?(window.open(c.url),c.update("isAdClicked",!0),"playing"==b.playState&&b.pause()):"paused"==b.playState?b.play():"playing"==b.playState&&b.pause()))}e.addEventListener("click",f);var g,h=!1;e.addEventListener("touchmove",function(){h=!0}),e.addEventListener("touchend",function(d){h?h=!1:d.defaultPrevented||(c.isAdsPlaying&&!c.isAdClicked||!a.userActivityStateMaintainer||a.userActivityStateMaintainer.isUserActive()||"playing"!=b.playState?f(d):(clearTimeout(g),g=setTimeout(function(){g=null},3e3)))}),e.addEventListener("dblclick",function(a){d.setIsFullscreen(!d.isFullscreen)})}var e=c(4);e.get("videoAreaViewResponder"),a.exports=d},function(a,b,c){var d,e;d=[],e=function(){"use strict";function a(a,b){b.observe(b.props.isAdsPlaying,function(b){a.controls=!b}),b.observe(b.props.isAdClicked,function(b){a.controls=b})}return a}.apply(b,d),!(void 0!==e&&(a.exports=e))},function(a,b,c){"use strict";function d(a,b,c,d){function e(a){a&&Object.getOwnPropertyNames(a).forEach(function(b){Array.isArray(a[b])&&m[b]&&a[b].forEach(function(a){i[a]=m[b]})})}function g(a){var b=i[a.keyCode];if(b)try{b(a),f.debug("Keyboard shortcut executed."),h&&h(),a.preventDefault()}catch(b){f.error("Keyboard shortcut for code "+a.keyCode+" failed.",b)}}var h,i={},j=!1,k=c.eventName||"keyup",l="document"===c.scope?document:d.innerContainer,m={playpause:function(){a.playState!==a.playStates.inactive&&(a.isPaused?a.play():a.pause())},exit:function(){j||b.isFullscreen||(f.debug("wasFullscreen/isFullscreen",j,b.isFullscreen),b.exit())},fullscreen:function(){b.setIsFullscreen(!b.isFullscreen)},togglemute:function(){a.setIsMuted(!a.isMuted)},decreasevolume:function(){a.setVolume(Math.max(a.volume-.1,0))},increasevolume:function(){a.setVolume(Math.min(a.volume+.1,1))}};return e(c.playback),c.reserveEscapeDuringFullscreen&&a.observe("isFullscreen",function(){a.isFullscreen?(f.debug("Registering wasFullscreen"),j=!0):window.setTimeout(function(){f.debug("Delayed fullscreen state changed.",a.isFullscreen),j=!1},3e3)}),"document"!==c.scope&&l.setAttribute("tabindex","1"),l.addEventListener(k,g),{detach:function(){f.debug("Detaching keyboard listener."),l.removeEventListener(k,g)},setKeyResponseNotifier:function(a){h=a}}}var e=c(4),f=e.get("keyboardResponder");a.exports=d},function(a,b){"use strict";function c(a){function b(a){switch(e[a].policy){case"persistent":return f;case"session":return g;default:return null}}var c=a.appName&&("string"==typeof a.appName&&a.appName||a.appName.html)||"vup",d=c.replace(/ /g,""),e=a.settingsStoragePolicy||{},f=window.localStorage,g=window.sessionStorage;this.get=function(a){if(a in e){var c=b(a);return c&&c[d+"_"+a]||e[a].defaultValue}return null},this.set=function(a,c){if(a in e){var f=b(a);f&&(f[d+"_"+a]=c)}}}a.exports=c},function(a,b,c){"use strict";function d(a){function b(a){switch(a.event){case g.playlistEntryStarted:m[e.playbackEventTypes.playbackStarted]&&m[e.playbackEventTypes.playbackStarted]();break;case g.playlistEntryEnded:m[e.playbackEventTypes.playbackEnded]&&m[e.playbackEventTypes.playbackEnded]();break;case g.adStarted:o=!0;break;case g.mainContentInterrupted:n=a.position,r=a.duration,o=!0;break;case g.mainContentStarted:case g.mainContentResumed:p&&l.setPosition(n),p=!1,o=!1}}function c(a){m[e.playbackEventTypes.playbackFailed]&&m[e.playbackEventTypes.playbackFailed](a)}function d(){return o?n:l.position}function f(a){o?(n=a,p=!0):l.setPosition(a)}function h(){return o?l.absolutePosition:l.absolutePosition}function i(){return o?l.absoluteStartPosition:l.absoluteStartPosition}function f(a){o?(n=a,p=!0):l.setPosition(a)}function j(){return o?r:l.duration}function k(){switch(l.playState){case l.playStates.paused:return e.playStates.paused;case l.playStates.inactive:return e.playStates.stopped;default:return e.playStates.playing}}var l=a.videoModel,m={},n=0,o=(new Date,!1),p=!1,q=null,r=0;return l.observe(l.props.playState,function(){var a=k();m[e.playbackEventTypes.playStateChanged]&&a!==q&&(q=a,m[e.playbackEventTypes.playStateChanged](a))}),{play:function(){return l.play()},pause:function(){return l.pause()},stop:function(){return a.playbackScheduler.stop()},getPlayState:k,getPosition:function(){return d()},setPosition:function(a){return f(a)},getAbsolutePosition:function(){return h()},getAbsoluteStartPosition:function(){return i()},getDuration:function(){return j()},getVolume:function(){return l.volume},setVolume:function(a){l.setVolume(a)},isMuted:function(){return l.isMuted},mute:function(){return l.setIsMuted(!0)},unmute:function(){return l.setIsMuted(!1)},getTextTracks:function(){return l.textTracks},setCallbacks:function(a){m=a},onProgressChange:b,onError:c}}var e=c(169),f=c(24),g=f.scheduleEventTypes;a.exports=d},function(a,b,c){!(a.exports={playbackEventTypes:{playbackStarted:"playbackStarted",playbackEnded:"playbackEnded",playbackFailed:"playbackFailed",playStateChanged:"playStateChanged"},playerEventTypes:{stateChanged:"stateChanged",playerStateChanged:"playerStateChanged",playbackChanged:"playbackChanged",error:"error",exitRequested:"exitRequested",adError:"adError"},playerSessionStates:{unstarted:"unstarted",unstartedTransmission:"unstartedTransmisson",playing:"playing",ended:"ended"},playStates:{playing:"playing",paused:"paused",stopped:"stopped"}})},function(a,b,c){function d(a,b,c){return"function"==typeof b?e(a,!0,f(b,c,3)):e(a,!0)}var e=c(171),f=c(100);a.exports=d},function(a,b,c){(function(b){function d(a,b,c,f,n,p,r){var s;if(c&&(s=n?c(a,f,n):c(a)),void 0!==s)return s;if(!j(a))return a;var t=o(a);if(t){if(s=g(a),!b)return k(a,s)}else{var u=R.call(a),w=u==v;if(u!=y&&u!=q&&(!w||n))return O[u]?i(a,u,b):n?a:{};if(s=h(w?{}:a),!b)return m(s,a)}p||(p=[]),r||(r=[]);for(var x=p.length;x--;)if(p[x]==a)return r[x];return p.push(a),r.push(s),(t?l:e)(a,function(e,f){s[f]=d(e,b,c,f,a,p,r)}),s}function e(a,b){return n(a,b,p)}function f(a){var b=new S(a.byteLength),c=new T(b);return c.set(new T(a)),b}function g(a){var b=a.length,c=new a.constructor(b);return b&&"string"==typeof a[0]&&Q.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function h(a){var b=a.constructor;return"function"==typeof b&&b instanceof b||(b=Object),new b}function i(a,b,c){var d=a.constructor;switch(b){case D:return f(a);case s:case t:return new d(+a);case E:case F:case G:case H:case I:case J:case K:case L:case M:var e=a.buffer;return new d(c?f(e):e,a.byteOffset,a.length);case x:case B:return new d(a);case z:var g=new d(a.source,N.exec(a));g.lastIndex=a.lastIndex}return g}function j(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var k=c(172),l=c(173),m=c(112),n=c(174),o=c(89),p=c(92),q="[object Arguments]",r="[object Array]",s="[object Boolean]",t="[object Date]",u="[object Error]",v="[object Function]",w="[object Map]",x="[object Number]",y="[object Object]",z="[object RegExp]",A="[object Set]",B="[object String]",C="[object WeakMap]",D="[object ArrayBuffer]",E="[object Float32Array]",F="[object Float64Array]",G="[object Int8Array]",H="[object Int16Array]",I="[object Int32Array]",J="[object Uint8Array]",K="[object Uint8ClampedArray]",L="[object Uint16Array]",M="[object Uint32Array]",N=/\w*$/,O={};O[q]=O[r]=O[D]=O[s]=O[t]=O[E]=O[F]=O[G]=O[H]=O[I]=O[x]=O[y]=O[z]=O[B]=O[J]=O[K]=O[L]=O[M]=!0,O[u]=O[v]=O[w]=O[A]=O[C]=!1;var P=Object.prototype,Q=P.hasOwnProperty,R=P.toString,S=b.ArrayBuffer,T=b.Uint8Array;a.exports=d}).call(b,function(){return this}())},function(a,b){function c(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}a.exports=c},function(a,b){function c(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}a.exports=c},function(a,b){function c(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}var d=c();a.exports=d},function(a,b,c){"use strict";var d=c(23);a.exports={checkResume:function(){return d(0)}}},function(a,b,c){"use strict";function d(a,b){return a&&a.preload&&a.libraryUrl&&(null==a.preload.implementations||""===a.preload.implementations||a.preload.implementations.indexOf(b)>=0)?{libraryUrl:a.libraryUrl,libraryName:a.preload.libraryName}:null}function e(a,b){var c=[];if(f.isJson(a))for(var g in a)if(a.hasOwnProperty(g)){var h=d(a[g],b);h?c.push(h):c=c.concat(e(a[g],b))}return c}var f=c(7);a.exports={preloadScripts:function(a,b){for(var c=e(a,b),d=0;d<c.length;d++){var g=c[d];f.loadGlobalScript(g.libraryName,g.libraryUrl)}}}},function(a,b,c){"use strict";function d(a){f.init(a,a.model.playbackSession.getStartParameters().original,!0)}function e(a){return function(b){b.playback&&b.playback.playbackStatus?"NOT_STARTED"===b.playback.playbackStatus?d(a):a.appContainer.showMessage("rest."+b.playback.playbackStatus):b instanceof Error?b instanceof g.TechnologyResolutionError?a.appContainer.showMessage("noPlaybackTechnologies"):a.appContainer.showMessage(b):a.appContainer.showMessage("playbackError");
}}var f=c(81),g=c(149);a.exports={getPlaybackStartErrorHandler:e}},function(a,b,c){function d(a){return f.getMessage(a)}function e(a,b,c,d){var e={};"fatal"!=c&&d&&(e.proceed={label:f.getMessage("continue"),click:function(a){return d(),a.preventDefault&&a.preventDefault(),!1}}),g.get("dialog").render(a,b,e,c),a.finished()}var f=c(179),g=c(180);a.exports={init:function(a,b,c,f){var g=d(b,c);e(a,g,c,f)}}},function(a,b,c){"use strict";function d(a,b){try{return b?g.msg(a+"."+b):g.msg(a)}catch(a){j.error(a)}return null}var e=c(83),f=c(84),g=c(130),h=c(7),i=c(4),j=i.get("messageModel");a.exports={getMessage:function(a,b){var c;return a instanceof e.RestError?(c=d("rest",a.code),c||(c=d("rest",a.resourceType))):c=a instanceof f.RequestError?d("request",a.code):d(a instanceof Error?"generalError":a),c||(c=a.message||a),h.format(c,b||{})}}},function(a,b,c){"use strict";var d=c(105),e=c(153),f=c(181),g={startPoster:d,endPoster:e,dialog:f};a.exports={get:function(a){return g[a]}}},function(a,b,c){(function(b){"use strict";function d(a,c,d,f){"undefined"!=typeof b&&b.emitError(f,c);var g=a.model.configuration.get("applyBuiltInStyles"),h=e.build("div"),i=e.build("p",{className:"vimond-player-message",style:g?"color: white; text-align: center; margin: 30px;":null})(c),j=e.build("div",{style:g?"text-align: center":null});for(var k in d)if(d.hasOwnProperty(k)){var l=e.build("button",{style:g?"display: inline; margin: 20px; padding: 10px 30px; border: 0; background-color: #bbb; font-size: 13px; ":null})(d[k].label);l.addEventListener("click",d[k].click),j.add(l)}return h.add(i),h.add(j),h}var e=c(144);a.exports={buildDialog:d,render:function(a,b,c,e){return a.appContainer.insert(d(a,b,c,e).elm)}}}).call(b,c(182))},function(a,b){"use strict";var c="dashPlayer";a.exports.emitError=function(a,b){var d=document.querySelector("#"+c),e=new CustomEvent("playback_error",{detail:{type:a,message:b}});d.dispatchEvent(e)}},function(a,b,c){"use strict";function d(a,b){n.call(this),this.isFullscreen=a,this.setIsFullscreen=b}function e(a){function b(){i=[]}function c(){for(var a=0;a<i.length;a++)try{i[a]()}catch(a){f.warn("Resize handler failed.",a)}}function d(b){i.push(b),g&&(h.addResizeListener(a,c),g=!1)}function e(a){var b=i.indexOf(a);i.splice(b,1)}var f=l.get("ResizeManager"),g=!0,i=[];return{clear:b,addListener:d,removeListener:e}}function f(){var a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!a&&parseInt(a[2],10)}var g=c(145),h=c(146),i=c(184),j=c(143),k=c(7),l=c(4),m=c(34),n=c(29),o={fullscreenChange:"fullscreenChange",resize:"resize"};a.exports={instantiate:function(a,b,c){function h(){U.invoke(o.resize,[])}function n(a){p(),"string"==typeof a?J.innerHTML=a:(k.empty(J),J.appendChild(a))}function p(){H.clear(),H.addListener(h),k.empty(J)}function q(){return J===k.getFullscreenElement()}function r(a){if(a){if(!k.enterFullscreen(J)){var b=J.getElementsByTagName("video")[0];b&&b.webkitEnterFullscreen&&b.webkitEnterFullscreen()}}else k.exitFullscreen()}var s,t,u,v=b.get("applyBuiltInStyles"),w=b.getConfiguration().html.playerControls,x=b.get("applyLocalStyleReset"),y=b.getConfiguration().containerClassName,z=b.get("className"),A=j.getClassNamer(y,z),B=k.getUnusedId(y+"-");k.empty(a);var C=document.createElement("div"),D="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch?"-touch":"-no-touch",E="";if(w&&w.notSupported)for(var F in w.notSupported)w.notSupported[F].test(navigator.userAgent)&&(E+=y+"-no-"+F+" ");C.className=y+(z?" "+z:"")+" "+y+D+" "+E,C.id=B,f()>=43&&C.classList.add("modern-chrome"),b.getConfiguration().userInactivityInterval>=0&&(s=j.maintainUserActivityState(C,b.getConfiguration().userInactivityInterval,A("user-active"),A("user-inactive"))),x&&g.insertResetSheet(B,y,!0),C.style.position="relative",a.appendChild(C);var G,H=new e(C),I=b.getConfiguration().html&&b.getConfiguration().html.responsivity;I&&I.widthRules&&(G=j.setupClassNamesFromWidthRules(C,y,I.widthRules,I.noAutoRefresh));var J=k.wrapIn16by9FillContainer(C);J.className=y+"-container",v&&(J.style.background="black");var K,L,M=b.get("enableCssWaitingIndicator"),N=b.getResourceUrl("loadAnimationUrl");if(N)K=document.createElement("img"),K.className="waiting-indicator",K.src=N,K.style.display="none",v&&(K.style.position="absolute",K.style.left="0",K.style.right="0",K.style.top="0",K.style.bottom="160px",K.style.margin="auto"),C.appendChild(K);else{var O=document.createElement("div");O.style.cssText="display: -webkit-flex; display: flex;",O.style.alignItems="center",O.style.justifyContent="center",O.style.webkitJustifyContent="center",O.style.position="absolute",O.style.top="0",O.style.left="0",O.style.right="0",O.style.bottom="40px";var P=document.createElement("div");if(O.appendChild(P),C.appendChild(O),M){var Q=A("waiting-indicator"),R=A("app-waiting");P.className=Q,k.addClass(C,R),P.style.zIndex=2147483647,t=function(){O.style.display="flex",k.addClass(C,R)},u=function(){k.removeClass(C,R),O.style.display="none"}}else{var S={lines:11,length:6,width:3,radius:9,corners:1,rotate:0,direction:1,color:"#fff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2147483647,top:"auto",left:"auto"};L=new i(S).spin(P);var T=!0;t=function(){T||(O.style.display="flex",P.style.display="block",L.spin(P),T=!0)},u=function(){T&&(L.stop(),O.style.display="none",P.style.display="none",T=!1)}}}var U=new m(this,o),V=new d(q(),r);return k.notifyFullscreenChange(function(){var a=q();U.invoke(o.fullscreenChange,[a]),V.update("isFullscreen",a)}),H.addListener(h),{innerContainer:J,insert:n,clear:p,videoElement:c,remove:function(){H.clear(),H.addListener(h),k.empty(a),s&&s.stop()},refreshClassNamesFromWidthRules:function(){G&&G.update()},showWaitingIndicator:K?function(){K.style.display="block"}:t,hideWaitingIndicator:K?function(){K.style.display="none"}:u,showMessage:function(a){l.get("showMessage").log(a)},addResizeListener:function(a){H.addListener(a)},removeResizeListener:function(a){H.removeListener(a)},addEventListener:U.addEventListener,removeEventListener:U.removeEventListener,appModel:V,id:B,userActivityStateMaintainer:s,getFullscreenState:q,setFullscreenState:r,addPrefixedRootClass:function(a){return k.addClass(C,A(a))},removePrefixedRootClass:function(a){return k.removeClass(C,A(a))}}}}},function(a,b,c){!function(b,c){a.exports=c()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;if(void 0!==e[b])return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function h(a){return"undefined"==typeof this?new h(a):void(this.opts=f(a||{},h.defaults,n))}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:j+" "+j,coordorigin:-i+" "+-i}),{width:j,height:j})}function g(a,g,h){b(l,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~g}),b(e(c("roundrect",{arcsize:d.corners}),{width:i,height:d.width,left:d.radius,top:-d.width>>1,filter:h}),c("fill",{color:d.color,opacity:d.opacity}),c("stroke",{opacity:0}))))}var h,i=d.length+d.width,j=2*i,k=2*-(d.width+d.length)+"px",l=e(f(),{position:"absolute",top:k,left:k});if(d.shadow)for(h=1;h<=d.lines;h++)g(h,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(h=1;h<=d.lines;h++)g(h);return b(a,l)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c,d,f=this,h=f.opts,i=f.el=e(a(0,{className:h.className}),{position:h.position,width:0,zIndex:h.zIndex}),k=h.radius+h.length+h.width;if(b&&(b.insertBefore(i,b.firstChild||null),d=g(b),c=g(i),e(i,{left:("auto"==h.left?d.x-c.x+(b.offsetWidth>>1):parseInt(h.left,10)+k)+"px",top:("auto"==h.top?d.y-c.y+(b.offsetHeight>>1):parseInt(h.top,10)+k)+"px"})),i.setAttribute("role","progressbar"),f.lines(i,f.opts),!j){var l,m=0,n=(h.lines-1)*(1-h.direction)/2,o=h.fps,p=o/h.speed,q=(1-h.opacity)/(p*h.trail/100),r=p/h.lines;!function a(){m++;for(var b=0;b<h.lines;b++)l=Math.max(1-(m+(h.lines-b)*r)%p*q,h.opacity),f.opacity(i,b*h.direction+n,l,h);f.timeout=f.el&&setTimeout(a,~~(1e3/o))}()}return f},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function g(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*i+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var h,i=0,k=(f.lines-1)*(1-f.direction)/2;i<f.lines;i++)h=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,k+i*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(h,e(g("#000","0 0 4px #000"),{top:"2px"})),b(d,b(h,g(f.color,"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h})},function(a,b,c){"use strict";function d(a){var b,c,d=new e,j=new f(this,i.playerEventTypes),k=i.playerSessionStates.unstarted,l=function(){},m=function(){},n=function(){},o=function(){},p={};return{exposed:{changePlayback:function(b,c,d){c&&!d?a.mergeOptions(c):d&&a.setOptions(c),m(b)},start:function(){return n()},getPlayerState:function(){return k},playback:d.exposed,metadata:p,cease:function(){l(),d.setInstance()},addEventListener:j.addEventListener,removeEventListener:j.removeEventListener,playerEvents:i.playerEventTypes,playerStates:i.playerSessionStates,setLogHandler:function(a){h.setHandler(a)},refreshClassNamesFromSizeRules:function(){o()},getRestClient:function(b,d){return c||(c=g.get(b||a.getConfiguration().rest,d||a.getEmbedContext()))},version:a.getConfiguration().framework.version},setControlApi:d.setInstance,setState:function(a){k=a,j.invoke(i.playerEventTypes.stateChanged,[a]),j.invoke(i.playerEventTypes.playerStateChanged,[a])},invokeExitRequest:function(a){j.invoke(i.playerEventTypes.exitRequested,a)},handleAdError:function(a){j.invoke(i.playerEventTypes.adError,a)},updateAbsoluteStartDate:function(a){d&&d.updateStartDate(a)},setPlaybackSession:function(a){b=a,b.getAsset?(p.getAsset=b.getAsset,p.getItems=b.getItems,p.getCategory=b.getCategory):p.get=function(){return b.getStartParameters().original},j.invoke(i.playerEventTypes.playbackChanged)},registerRemover:function(a){l=a},registerPlaybackChanger:function(a){m=a},registerStarter:function(a){n=a},registerSizeClassNamesRefresher:function(a){o=a}}}function e(){var a,b,c=new f(this,i.playbackEventTypes);return{setInstance:function(b){if(a=b){var d={};d[i.playbackEventTypes.playbackStarted]=function(){c.invoke(i.playbackEventTypes.playbackStarted)},d[i.playbackEventTypes.playbackEnded]=function(){c.invoke(i.playbackEventTypes.playbackEnded)},d[i.playbackEventTypes.playbackFailed]=function(a){c.invoke(i.playbackEventTypes.playbackFailed,[a])},d[i.playbackEventTypes.playStateChanged]=function(a){c.invoke(i.playbackEventTypes.playStateChanged,[a])},a.setCallbacks(d)}},updateStartDate:function(a){b=a},exposed:{play:function(){return a&&a.play()},pause:function(){return a&&a.pause()},stop:function(){return a&&a.stop()},getPlayState:function(){return a&&a.getPlayState()||i.playStates.stopped},getPosition:function(){return a&&a.getPosition()||0},setPosition:function(b){return a&&a.setPosition(b)},getDuration:function(){return a&&a.getDuration()||0},getAbsolutePosition:function(){return a&&a.getAbsolutePosition()||new Date(1970,0,1)},setAbsolutePosition:function(b){return a&&a.setAbsolutePosition(b)},getAbsoluteStartPosition:function(){return a&&a.getAbsoluteStartPosition()||new Date(1970,0,1)},gotoNow:function(){return a&&a.gotoNow()},getVolume:function(){return a&&a.getVolume()||0},setVolume:function(b){return a&&a.setVolume(b)},isMuted:function(){return a&&a.isMuted()},mute:function(){return a&&a.mute()},unmute:function(){return a&&a.unmute()},getTextTracks:function(){return a&&a.getTextTracks&&a.getTextTracks()||[]},addEventListener:c.addEventListener,removeEventListener:c.removeEventListener,playbackEvents:i.playbackEventTypes,playStates:i.playStates}}}var f=c(34),g=c(83),h=c(4),i=c(169);a.exports=d},function(a,b,c){"use strict";function d(a,b,c){function d(){j.getAuthenticationStatus().then(function(a){a.response&&a.response.code&&"KICKED_SESSION"===a.response.code&&b()})}function g(){h(),i=window.setInterval(d,1e3*c),d()}function h(){i&&window.clearInterval(i),i=null}var i,j=e.get(a);c=c||f,this.start=g,this.stop=h}var e=c(83),f=55;a.exports=d},function(a,b){a.exports={_args:[["vimond-uniplayer-sdk@5.5.761","/Users/thomassorheimlund/projects/vimond/iflix-uniplayer"]],_from:"vimond-uniplayer-sdk@5.5.761",_id:"vimond-uniplayer-sdk@5.5.761",_inCache:!0,_installable:!0,_location:"/vimond-uniplayer-sdk",_phantomChildren:{"lodash._baseassign":"3.2.0","lodash._baseclone":"3.3.0","lodash._basefor":"3.0.3","lodash._bindcallback":"3.0.1","lodash._createassigner":"3.1.1","lodash.isarguments":"3.0.9","lodash.keys":"3.1.2","lodash.keysin":"3.0.8"},_requested:{name:"vimond-uniplayer-sdk",raw:"vimond-uniplayer-sdk@5.5.761",rawSpec:"5.5.761",scope:null,spec:"5.5.761",type:"version"},_requiredBy:["/"],_resolved:"http://vimond.artifactoryonline.com/vimond/api/npm/npm-virtual/vimond-uniplayer-sdk/-/vimond-uniplayer-sdk-5.5.761.tgz",_shasum:"e29e4e31b208ba4911b0e761c486d93d67013038",_shrinkwrap:null,_spec:"vimond-uniplayer-sdk@5.5.761",_where:"/Users/thomassorheimlund/projects/vimond/iflix-uniplayer",author:"",bugs:{url:"https://github.com/vimond/VimondUniPlayer/issues"},dependencies:{"detect-browser":"^1.3.3","js-logger":"^1.2.0","lodash.assign":"^3.2.0","lodash.clonedeep":"^3.0.2","lodash.isplainobject":"^3.2.0","lodash.template":"^3.6.2",q:"^1.4.1"},description:"Video SDK package for Vimond UniPlayer",devDependencies:{chai:"^3.3.0","condition-circle":"^1.2.0","custom-event-polyfill":"^0.2.1",gulp:"^3.9.0","gulp-concat":"^2.6.0","gulp-jsdoc-to-markdown":"^1.1.1","gulp-jshint":"^1.11.2","gulp-rename":"^1.2.2","gulp-util":"^3.0.6","jshint-stylish":"^2.0.1",karma:"^0.13.11","karma-chai":"^0.1.0","karma-coverage":"^0.5.2","karma-mocha":"^0.2.0","karma-mocha-reporter":"^1.1.1","karma-phantomjs-launcher":"^0.2.1","karma-webpack":"^1.7.0",mocha:"^2.3.3",phantomjs:"^1.9.18","phantomjs-polyfill":"0.0.1","semantic-release":"^4.3.5",webpack:"^1.12.2"},dist:{shasum:"e29e4e31b208ba4911b0e761c486d93d67013038",tarball:"http://vimond.artifactoryonline.com/vimond/api/npm/npm-virtual/vimond-uniplayer-sdk/-/vimond-uniplayer-sdk-5.5.761.tgz"},homepage:"https://github.com/vimond/VimondUniPlayer#readme",license:"LicenseRef-LICENSE",main:"",name:"vimond-uniplayer-sdk",optionalDependencies:{},publishConfig:{registry:"https://vimond.artifactoryonline.com/vimond/api/npm/npm-local/"},readme:"ERROR: No README data found!",release:{debug:!0},repository:{type:"git",url:"git+https://github.com/vimond/VimondUniPlayer.git"},scripts:{"semantic-release":"semantic-release pre && npm publish && semantic-release post",test:"gulp test"},version:"5.5.761"}},function(a,b){a.exports={name:"vimond-uniplayer-iflix",version:"4.0.19",description:"Vimond UniPlayer for iFlix",main:"",scripts:{test:"mocha -R nyan"},repository:{type:"git",url:"git+https://github.com/vimond/iflix-uniplayer.git"},author:"Vimond",license:"SEE LICENSE IN <file>",bugs:{url:"https://github.com/vimond/iflix-uniplayer/issues"},homepage:"https://github.com/vimond/iflix-uniplayer#readme",devDependencies:{"autoprefixer-loader":"^3.1.0",chai:"^3.3.0","css-loader":"^0.19.0","expose-loader":"*",express:"^4.13.3","file-loader":"^0.8.4",gulp:"^3.9.0","gulp-autoprefixer":"^3.0.2","gulp-nodemon":"^2.0.4","gulp-rename":"^1.2.2","gulp-replace":"^0.5.4","gulp-sass":"^2.0.4","gulp-sourcemaps":"^1.6.0","gulp-util":"^3.0.6","js-logger":"^1.2.0","json-loader":"^0.5.3",mocha:"^2.3.3","node-sass":"^3.3.3",request:"^2.65.0","sass-loader":"^3.0.0","style-loader":"^0.12.4","url-loader":"^0.5.6",webpack:"^1.12.2","webpack-dev-server":"^1.12.0"},dependencies:{"vimond-uniplayer-core":"^1.0.0","vimond-uniplayer-dashjs":"^1.6.0","vimond-uniplayer-lib":"^1.0.0","vimond-uniplayer-sdk":"^5.0.0","vimond-uniplayer-shaka":"^1.7.5"}}}])),function(){var a={};(function(a){function b(a,b){var c=a.split("."),d=cg;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a,b){function c(){}c.prototype=b.prototype,a.Yc=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Vc=function(a,c,d){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}}function d(){}function e(){}function f(){}function g(){}function h(){}function i(){}function j(){}function k(){}function l(){}function m(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}function n(a){eg[a]={wa:dg(),end:NaN}}function o(a){var b=eg[a];b&&(b.end=dg(),j(a+": "+(b.end-b.wa).toFixed(3)+"ms"))}function p(a){return(a=eg[a])&&a.end?a.end-a.wa:NaN}function q(a,b,c){this.id=a,this.bandwidth=b||0,this.lang=c||"unknown",this.active=!1}function r(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}function s(){this.fontSize="100%",this.fontColor=fg,this.fontOpacity=hg,this.backgroundColor=gg,this.backgroundOpacity=hg,this.fontEdge=ig}function t(a){var b=[];b.push("font-size: "+a.fontSize),b.push("color: "+u(a.fontColor,a.fontOpacity)),b.push("background-color: "+u(a.backgroundColor,a.backgroundOpacity));for(var c=[],e=0;e<a.fontEdge.length;++e){d(6==a.fontEdge[e].length);var f=a.fontEdge[e].slice(3,6);c.push(u(a.fontEdge[e].slice(0,3),a.fontOpacity)+" "+f.join("px ")+"px")}return b.push("text-shadow: "+c.join(",")),b.join("; ")}function u(a,b){return d(3==a.length),"rgba("+a.concat(b).join(",")+")"}function v(a,b){this.id=a,this.lang=b||"unknown",this.enabled=this.active=!1}function w(a,b,c,d){this.id=a,this.bandwidth=b||0,this.width=c||0,this.height=d||0,this.active=!1}function x(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}function y(){var b="CustomEvent"in a;if(b)try{new CustomEvent("")}catch(a){b=!1}b||(a.CustomEvent=z)}function z(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};return c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail),c}function A(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen,a=Document.prototype,a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen,"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}}),document.addEventListener("webkitfullscreenchange",B),document.addEventListener("webkitfullscreenerror",B),document.addEventListener("mozfullscreenchange",B),document.addEventListener("mozfullscreenerror",B),document.addEventListener("MSFullscreenChange",B),document.addEventListener("MSFullscreenError",B)}function B(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)}function C(){return j("PatchedMediaKeys.nop.requestMediaKeySystemAccess"),d(this instanceof Navigator),Promise.reject(Error("The key system specified is not supported."))}function D(a){return j("PatchedMediaKeys.nop.setMediaKeys"),d(this instanceof HTMLMediaElement),null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function E(){throw new TypeError("Illegal constructor.")}function F(){throw new TypeError("Illegal constructor.")}function G(a){if(this.c=[],this.b=[],this.ia=jg,a)try{a(this.oa.bind(this),this.a.bind(this))}catch(a){this.a(a)}}function H(){a.Promise?i("Using native Promises."):(i("Using Promises polyfill."),a.Promise=G,a.Promise.resolve=I,a.Promise.reject=J,a.Promise.all=K,a.Promise.race=L,a.setImmediate?(O=function(b){return a.setImmediate(b)},P=function(b){return a.clearImmediate(b)}):(O=function(b){return a.setTimeout(b,0)},P=function(b){return a.clearTimeout(b)}))}function I(a){var b=new G;return b.oa(a),b}function J(a){var b=new G;return b.a(a),b}function K(a){function b(a,b,c){d(1!=a.ia),a.ia==jg&&(f[b]=c,e++,e==f.length&&a.oa(f))}var c=new G;if(!a.length)return c.oa([]),c;for(var e=0,f=Array(a.length),g=c.a.bind(c),h=0;h<a.length;++h)a[h]&&a[h].then?a[h].then(b.bind(null,c,h),g):b(c,h,a[h]);return c}function L(a){for(var b=new G,c=b.oa.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e]&&a[e].then?a[e].then(c,d):c(a[e]);return b}function M(a,b,c){d(a.ia!=jg),lg.push(function(){if(c&&"function"==typeof c){try{var a=c(this.Wa)}catch(a){return void b.a(a)}a instanceof G?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.oa.bind(b),b.a.bind(b)):b.oa(a)}else 1==this.ia?b.oa(this.Wa):b.a(this.Wa)}.bind(a)),null==kg&&(kg=O(N))}function N(){for(;lg.length;){null!=kg&&(P(kg),kg=null);var a=lg;lg=[];for(var b=0;b<a.length;++b)a[b]()}}function O(){return 0}function P(){}function Q(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=R)}function R(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function S(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c}function T(){return(new Date).getTime()+ng}function U(a){this.b=a,this.c=0==og,this.a=0}function V(a){return a.a<a.b.byteLength}function W(a){var b=a.b.getUint8(a.a);return a.a+=1,b}function X(a){var b=a.b.getUint32(a.a,a.c);return a.a+=4,b}function Y(a){var b,c;if(a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1)),2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");return a.a+=8,c*Math.pow(2,32)+b}function Z(a){if(d(!0),a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);return a.a+=16,b}function $(a,b){if(d(0<=b),a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b}function _(a){this.b=a,this.a=new U(a),mg||(mg=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function aa(a){var b;if(b=ba(a),7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c,c=ba(a);a:{for(d=0;d<mg.length;d++)if(kb(c,mg[d])){d=!0;break a}d=!1}if(d)c=a.b.byteLength-a.a.a;else{if(8==c.length&&224&c[1])throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d}return c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a,d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c),$(a.a,c),new ca(b,d)}function ba(a){var b,c=W(a.a);for(b=1;8>=b&&!(c&1<<8-b);b++);if(8<b)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(b);for(d[0]=c,c=1;c<b;c++)d[c]=W(a.a);return d}function ca(a,b){this.id=a,this.a=b}function da(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&224&a.a.getUint8(0))throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b}function ea(a){var b=pg[a];return d(b||"usable"===a||"output-downscaled"===a||"status-pending"===a,"Unexpected key status value: "+a),b||null}function fa(a){d(0<a),this.c=Math.exp(Math.log(.5)/a),this.a=this.b=0}function ga(a){var b=1-Math.pow(a.c,a.a);return a.b/b}function ha(a){var b,c=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles});for(b in a)b in c?d(c[b]==a[b],"key = "+b):c[b]=a[b];return c}function ia(a){return d(null!=a),new CustomEvent("error",{detail:a,bubbles:!0})}function ja(a,b,c){return d(b==ka(b)),d(c==ka(c)),c==b||a>=qg&&c==b.split("-")[0]||a>=rg&&c.split("-")[0]==b.split("-")[0]}function ka(a){a=a.toLowerCase().split("-");var b=sg[a[0]];return b&&(a[0]=b),a.join("-")}function la(a){return Object.keys(a).map(function(b){return a[b]})}function ma(a,b){return pa(a,b,"boolean")}function na(a,b){var c=pa(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function oa(a,b){return pa(a,b,"string")}function pa(a,b,c){if(a=a[b],null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function qa(a,b,c){if(a=a[b],null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a}function ra(){this.a={}}function sa(a){var b,c=[];for(b in a.a)c.push.apply(c,a.a[b]);return c}function ta(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function ua(a){var b,c=[];for(b in a.a)c.push(b);return c}function va(){this.a=new ra}function wa(a,b,c,d){b=new ya(b,c,d),a.a.push(c,b)}function xa(a){for(var b=sa(a.a),c=0;c<b.length;++c)b[c].Ea();a.a.a={}}function ya(a,b,c){this.target=a,this.type=b,this.a=c,this.target.addEventListener(b,c,!1)}function za(a){this.Xa=new ra,this.K=a}function Aa(a,b){b.currentTarget=a;for(var c=a.Xa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(a){g("Uncaught exception in event handler",a)}}return a.K&&b.bubbles&&Aa(a.K,b),b.defaultPrevented}function Ba(){za.call(this,null),this.a=new fa(3),this.c=new fa(10),this.b=0}function Ca(){var a,b,c=new Promise(function(c,d){a=c,b=d});return c.resolve=a,c.reject=b,c.destroy=Ca.prototype.destroy,c}function Da(a){return a.split("").reduce(function(a,b,c){return a+(c&&0==c%4?" "+b:b)})}function Ea(){this.g=new Ca,this.f=!1,this.a=null,this.b=[],this.c=null}function Fa(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}function Ga(a,b){var c,e=a.b[0](b);e?(d(1==e.length||2==e.length),c=e[0],d(c),a.c=e[1]):(c=Promise.resolve(),a.c=null),c.then(Ia(a,function(a){this.a?(this.b=[],this.c=null,Ha(this)):(this.b.shift(),this.b.length?Ga(this,a):(this.g.resolve(a),this.c=null))})).catch(Ia(a,function(a){this.b=[],this.c=null,this.a?Ha(this):this.g.reject(a)}))}function Ha(b){d(b.g),d(b.a);var c=Error("Task aborted.");c.type="aborted",b.g.reject(c),a.setTimeout(function(){this.a.resolve(),this.a=null}.bind(b),5)}function Ia(a,b){return b.bind(a)}function Ja(a,b){d("readonly"==a||"readwrite"==a),za.call(this,b),this.a=null,this.h=a}function Ka(b){if(!a.indexedDB)return b=Error("Persistant storage requires IndexedDB support."),b.type="storage",Promise.reject(b);if(b.a)return b=Error("A database connection is already open."),b.type="storage",Promise.reject(b);var c=new Ca,d=a.indexedDB.open("content_database",1);return d.onupgradeneeded=Ia(b,function(a){this.a=a.target.result,Ma(this,"group_store",{keyPath:"group_id"}),Ma(this,"stream_index_store",{keyPath:"stream_id"}),a=Ma(this,"content_store",{autoIncrement:"true"}),a.createIndex("segment",["stream_id","segment_id"],{unique:!0}),a.createIndex("stream","stream_id",{unique:!1})}),d.onsuccess=Ia(b,function(a){this.a=a.target.result,c.resolve()}),d.onerror=function(){c.reject(d.error)},c}function La(a){a.a&&(a.a.close(),a.a=null)}function Ma(a,b,c){return a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b),a.a.createObjectStore(b,c)}function Na(a){return Qa(a,"content_store")}function Oa(a){return Qa(a,"stream_index_store")}function Pa(a){return Qa(a,"group_store")}function Qa(a,b){return d(a.a,"A database connection should be open."),a.a.transaction([b],a.h).objectStore(b)}function Ra(a,b){var c=new Ca,d=a.get(b);return d.onerror=function(){c.reject(d.error)},d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage",c.reject(a)}},c}function Sa(){Ja.call(this,"readonly",null)}function Ta(a){var b=new Ca,c=[],d=Pa(a).openCursor();return d.onerror=function(){b.reject(d.error)},d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)},b}function Ua(a,b){return Ra(Pa(a),b).then(Ia(a,function(a){return a.session_ids=S(a.session_ids),a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Va(this,a.stream_ids[0]).then(function(b){return a.duration=b.duration,a.key_system=b.key_system,a.license_server=b.license_server,a.with_credentials=b.with_credentials,a.distinctive_identifier=b.distinctive_identifier,a.audio_robustness=b.audio_robustness,a.video_robustness=b.video_robustness,Promise.resolve(a)})}))}function Va(a,b){return Ra(Oa(a),b)}function Wa(a,b,c){return Ra(Na(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})}function Xa(a,b,c){d("open"==a.readyState,"The MediaSource should be in the 'open' state."),d(0<b.length),d(MediaSource.isTypeSupported(b));var e=a.addSourceBuffer(b);d(e,"SourceBuffer should not be null."),this.h=a,this.c=e,this.s=c,this.l=new va,this.g=null,this.b=[],this.K=0,this.f=this.a=null,this.u=0,this.i=b.split(";")[0],d(0<this.i.length),wa(this.l,this.c,"updateend",this.C.bind(this))}function Ya(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-tg,f=c.end(d)+tg;if(b>=e&&b<=f)return c.end(d)-b}return 0}function Za(a,b,c,e){if(k(fb(a),"fetch"),d(!a.a),a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Ea,c!=a.c.timestampOffset&&(j(fb(a),"setting timestampOffset to",c),a.c.timestampOffset=c),b.url.Mb()&&!a.g&&(a.g=new Sa,Fa(a.a,function(){return[Ka(this.g)]}.bind(a))),e&&Fa(a.a,function(){return[db(this,e),this.j.bind(this)]}.bind(a)),Fa(a.a,function(){var a=b.a?b.a-b.startTime:1,c=new sd;return c.a=3,c.j=1e3*a,c.c=1e3*this.u,c.g=this.g,Lg&&(c.i=!0),[b.url.ea(c,this.s),yd.prototype.Pa.bind(b.url)]}.bind(a));var f;Fa(a.a,Ia(a,function(a){return f=this.h.duration,j("Estimated bandwidth:",(this.s.getBandwidth()/1e6).toFixed(2),"Mbps"),
[db(this,a),this.j.bind(this)]}));var g=0==a.c.buffered.length&&0==a.b.length,i=null;return Fa(a.a,function(){var a=this.h.duration;return a!=f&&h(fb(this),"appendBuffer() should not modify the MediaSource's duration:","before",f,"after",a,"delta",a-f),0==this.c.buffered.length?(a=Error("Failed to buffer segment ("+this.i+")."),a.type="stream",[Promise.reject(a)]):(g&&(d(0==this.b.length),a=b.startTime,i=this.c.buffered.start(0)-a),a=Jd(this.b,b.startTime),void(0<=a?this.b.splice(a+1,0,b):this.b.push(b)))}.bind(a)),cb(a).then(function(){return Promise.resolve(i)}.bind(a))}function $a(a){return k(fb(a),"clear"),d(!a.a),a.a?(a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a)):(a.a=new Ea,Fa(a.a,function(){var a;a:if(d(!this.f),0==this.c.buffered.length)k(fb(this),"nothing to clear."),d(0==this.b.length),a=Promise.resolve();else{try{this.c.remove(0,this.h.duration)}catch(b){a=Promise.reject(b);break a}this.b=[],a=this.f=new Ca}return[a,this.j.bind(this)]}.bind(a)),cb(a))}function _a(a,b){if(k(fb(a),"clearAfter"),d(!a.a),a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");return c.type="stream",Promise.reject(c)}return a.a=new Ea,Fa(a.a,function(){return[eb(this,b),this.j.bind(this)]}.bind(a)),cb(a)}function ab(a){return k(fb(a),"abort"),a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new Ca,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve(),a}function bb(a){return 1<a.c.buffered.length&&(g(fb(a),"multiple buffered ranges detected:","Either the content has gaps in it,","the content's segments are not aligned across bitrates,","or the browser has evicted the middle of the buffer."),!0)}function cb(a){return d(a.a),a.a.start(),a.a.g.then(Ia(a,function(){this.a=null})).catch(Ia(a,function(a){return k(fb(this),"task failed!"),this.a=null,Promise.reject(a)}))}function db(a,b){d(!a.f),d(a.a);try{a.c.appendBuffer(b)}catch(b){g(fb(a),"QuotaExceededError occurred:","Tried to remove a few secs of sourceBuffer to recover.");var c=a.c.buffered.start(0);a.c.remove(c,c+5)}return a.f=new Ca,a.f}function eb(a,b){if(d(!a.f),0==a.c.buffered.length)return k(fb(a),"nothing to clear."),d(0==a.b.length),Promise.resolve();var c=Jd(a.b,b);if(-1==c||c==a.b.length-1)return k(fb(a),"nothing to clear: no segments on or after timestamp."),Promise.resolve();try{a.c.remove(a.b[c+1].startTime,a.h.duration)}catch(a){return Promise.reject(a)}return a.b=a.b.slice(0,c+1),a.f=new Ca,a.f}function fb(a){return"SBM "+a.i+":"}function gb(a){return String.fromCharCode.apply(null,a)}function hb(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}function ib(b){return hb(a.atob(b.replace(/-/g,"+").replace(/_/g,"/")))}function jb(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d),b+=d}return b}function kb(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0}function lb(){this.h=this.a="",this.i=!1,this.u=this.s=null,this.l=this.g=!1,this.j=this.f="",this.c=null,this.b=[]}function mb(a){var b=new lb;if(!a)return b;var c=oa(a,"keySystem");if(null==c)throw Error("'keySystem' cannot be null.");b.a=c;var d=oa(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");if(c=ma(a,"withCredentials"),null!=c&&(b.i=c),c=qa(a,"licensePostProcessor",Function),null!=c&&(b.s=c),c=qa(a,"licensePreProcessor",Function),null!=c&&(b.u=c),c=ma(a,"distinctiveIdentifierRequired"),null!=c&&(b.g=c),c=ma(a,"persistentStateRequired"),null!=c&&(b.l=c),c=oa(a,"audioRobustness"),null!=c&&(b.f=c),c=oa(a,"videoRobustness"),null!=c&&(b.j=c),c=qa(a,"serverCertificate",Uint8Array),null!=c&&(b.c=c),c=qa(a,"initData",Object)){if(a=qa(c,"initData",Uint8Array),null==a)throw Error("'initData.initData' cannot be null.");if(c=oa(c,"initDataType"),null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}function nb(a,b){ob(a,b)||h("combine() should only be called with a compatible DrmInfo object:","this",a,"other",b);var c=new lb;return c.a=a.a,c.h=a.h,c.i=a.i,c.s=a.s,c.u=a.u,c.g=a.g,c.l=a.l,c.f=a.f,c.j=a.j,c.c=a.c?new Uint8Array(a.c.buffer):null,pb(c,a.b),pb(c,b.b),c}function ob(a,b){return a.a==b.a&&a.h==b.h&&a.i==b.i&&a.g==b.g&&a.l==b.l&&a.f==b.f&&a.j==b.j&&kb(a.c,b.c)}function pb(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=S(c,qb)}function qb(a,b){return a.initDataType==b.initDataType&&kb(a.initData,b.initData)}function rb(a,b){j("v01b.requestMediaKeySystemAccess"),d(this instanceof Navigator);try{var c=new tb(a,b);return Promise.resolve(c)}catch(a){return Promise.reject(a)}}function sb(a){j("v01b.setMediaKeys"),d(this instanceof HTMLMediaElement);var b=this.mediaKeys;return b&&b!=a&&(d(b instanceof ub),vb(b,null)),delete this.mediaKeys,(this.mediaKeys=a)&&(d(a instanceof ub),vb(a,this)),Promise.resolve()}function tb(a,b){j("v01b.MediaKeySystemAccess"),this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d,e=!1;d=document.getElementsByTagName("video"),d=d.length?d[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},i=!1;if(g.audioCapabilities)for(var k=0;k<g.audioCapabilities.length;++k){var l=g.audioCapabilities[k];l.contentType&&(i=!0,d.canPlayType(l.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(l),e=!0))}if(g.videoCapabilities)for(k=0;k<g.videoCapabilities.length;++k)l=g.videoCapabilities[k],l.contentType&&(i=!0,d.canPlayType(l.contentType,this.a)&&(h.videoCapabilities.push(l),e=!0));if(i||(e=d.canPlayType("video/mp4",this.a)||d.canPlayType("video/webm",this.a)),"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):e=!1),e)return void(this.b=h)}throw c="Unsupported keySystem","org.w3.clearkey"!=a&&"com.widevine.alpha"!=a||(c="None of the requested configurations were supported."),c=Error(c),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}function ub(a){j("v01b.MediaKeys"),this.g=a,this.b=null,this.a=new va,this.c=[],this.f={}}function vb(a,b){a.b=b,xa(a.a),b&&(wa(a.a,b,"webkitneedkey",a.Hc.bind(a)),wa(a.a,b,"webkitkeymessage",a.Gc.bind(a)),wa(a.a,b,"webkitkeyadded",a.Ec.bind(a)),wa(a.a,b,"webkitkeyerror",a.Fc.bind(a)))}function wb(a,b){var c=a.f[b];return c?(j("v01b.MediaKeys.findSession_",c),c):(c=a.c.shift())?(c.sessionId=b,a.f[b]=c,j("v01b.MediaKeys.findSession_",c),c):null}function xb(a,b,c){j("v01b.MediaKeySession"),za.call(this,null),this.g=a,this.h=!1,this.a=this.b=null,this.c=b,this.f=c,this.sessionId="",this.expiration=NaN,this.closed=new Ca,this.keyStatuses=new Ab}function yb(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var e;try{if("persistent-license"==a.f)if(c)e=hb("LOAD_SESSION|"+c);else{var f=new Uint8Array(b);e=hb("PERSISTENT|"+gb(f))}else d("temporary"==a.f),d(!c),e=new Uint8Array(b);d(e)}catch(a){return Promise.reject(a)}d(null==a.b),a.b=new Ca;try{a.g.webkitGenerateKeyRequest(a.c,e)}catch(b){if("InvalidStateError"!=b.name)return a.b=null,Promise.reject(b);setTimeout(function(){try{this.g.webkitGenerateKeyRequest(this.c,e)}catch(a){this.b.reject(a),this.b=null}}.bind(a),10)}return a.b}function zb(a,b){a.keyStatuses.qb(b);var c=ha({type:"keystatuseschange"});a.dispatchEvent(c)}function Ab(){this.size=0,this.a=void 0}function Bb(a){this.systemIds=[],this.cencKeyIds=[],this.a=[],a=new U(new DataView(a.buffer));try{for(;V(a);){var b=a.a,c=X(a),d=X(a);if(1==c?c=Y(a):0==c&&(c=a.b.byteLength-b),1886614376!=d)h("Non-PSSH box found!"),$(a,c-(a.a-b));else{var e=W(a);if(1<e)h("Unrecognized PSSH version found!"),$(a,c-(a.a-b));else{$(a,3);var f=jb(Z(a)),g=[];if(0<e)for(var i=X(a),j=0;j<i;++j){var k=jb(Z(a));g.push(k)}var l=X(a);$(a,l),this.cencKeyIds.push.apply(this.cencKeyIds,g),this.systemIds.push(f),this.a.push({start:b,end:a.a-1}),a.a!=b+c&&(h("Mismatch between box size and data size!"),$(a,c-(a.a-b)))}}}}catch(a){h("PSSH parse failure!  Some data may be missing or incorrect.")}}function Cb(a,b){j("PatchedMediaKeys.v20140218.requestMediaKeySystemAccess"),d(this instanceof Navigator);try{var c=new Db(a,b);return Promise.resolve(c)}catch(a){return Promise.reject(a)}}function Db(a,b){j("v20140218.MediaKeySystemAccess"),this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var i=e.audioCapabilities[h];if(i.contentType){var g=!0,k=i.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,k)&&(f.audioCapabilities.push(i),c=!0)}}if(e.videoCapabilities)for(h=0;h<e.videoCapabilities.length;++h)i=e.videoCapabilities[h],i.contentType&&(g=!0,k=i.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,k)&&(f.videoCapabilities.push(i),c=!0));if(g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]),c)return void(this.a=f)}throw c=Error("Unsupported keySystem"),c.name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c}function Eb(a){j("v20140218.setMediaKeys");var b=this.mediaKeys;return b&&b!=a&&(d(b instanceof Fb),Gb(b,null)),delete this.mediaKeys,(this.mediaKeys=a)?(d(a instanceof Fb),Gb(a,this)):Promise.resolve()}function Fb(a){j("v20140218.MediaKeys"),this.a=new MSMediaKeys(a),this.b=new va}function Gb(a,b){function c(){b.msSetMediaKeys(d.a),b.removeEventListener("loadedmetadata",c)}if(xa(a.b),!b)return Promise.resolve();wa(a.b,b,"msneedkey",Ib);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(a){return Promise.reject(a)}}function Hb(a){j("v20140218.MediaKeySession"),za.call(this,null),this.c=null,this.g=a,this.b=this.a=null,this.f=new va,this.sessionId="",this.expiration=NaN,this.closed=new Ca,this.keyStatuses=new Lb}function Ib(a){j("v20140218.onMsNeedKey_",a);var b=a.initData;if(b){var c=new Bb(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));for(b=S(d,Jb),a=c=0;a<b.length;a++)c+=b[a].length;for(c=new Uint8Array(c),a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=ha({type:"encrypted",initDataType:"cenc",initData:a}),this.dispatchEvent(a)}function Jb(a,b){return kb(a,b)}function Kb(a,b){a.keyStatuses.qb(b);var c=ha({type:"keystatuseschange"});a.dispatchEvent(c)}function Lb(){this.size=0,this.a=void 0}function Mb(){j("MediaKeys.install"),Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?i("Using native EME as-is."):HTMLMediaElement.prototype.webkitGenerateKeyRequest?(i("Using prefixed EME v0.1b."),j("v01b.install"),d(HTMLMediaElement.prototype.webkitGenerateKeyRequest),ug=new Uint8Array([0]).buffer,Navigator.prototype.requestMediaKeySystemAccess=rb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=sb,a.MediaKeys=ub,a.MediaKeySystemAccess=tb):a.MSMediaKeys?(i("Using EME v20140218"),j("PatchedMediaKeys.v20140218.install"),vg=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Eb,a.MediaKeys=Fb,a.MediaKeySystemAccess=Db,Navigator.prototype.requestMediaKeySystemAccess=Cb):(i("EME not available."),j("PatchedMediaKeys.nop.install"),Navigator.prototype.requestMediaKeySystemAccess=C,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=D,a.MediaKeys=E,a.MediaKeySystemAccess=F)}function Nb(){}function Ob(a,b){this.value=a,this.sign=b,this.R=!1}function Pb(a){this.value=a,this.sign=0>a,this.R=!0}function Qb(a){return-9007199254740992<a&&9007199254740992>a}function Rb(a){return 1e7>a?[a]:1e14>a?[a%1e7,Math.floor(a/1e7)]:[a%1e7,Math.floor(a/1e7)%1e7,Math.floor(a/1e14)]}function Sb(a){Tb(a);var b=a.length;if(4>b&&0>ic(a,wg))switch(b){case 0:return 0;case 1:return a[0];case 2:return a[0]+1e7*a[1];default:return a[0]+1e7*(a[1]+1e7*a[2])}return a}function Tb(a){for(var b=a.length;0===a[--b];);a.length=b+1}function Ub(a){for(var b=Array(a),c=-1;++c<a;)b[c]=0;return b}function Vb(a){return 0<a?Math.floor(a):Math.ceil(a)}function Wb(a,b){var c,d,e=a.length,f=b.length,g=Array(e),h=0;for(d=0;d<f;d++)c=a[d]+b[d]+h,h=1e7<=c?1:0,g[d]=c-1e7*h;for(;d<e;)c=a[d]+h,h=1e7===c?1:0,g[d++]=c-1e7*h;return 0<h&&g.push(h),g}function Xb(a,b){return a.length>=b.length?Wb(a,b):Wb(b,a)}function Yb(a,b){var c,d,e=a.length,f=Array(e);for(d=0;d<e;d++)c=a[d]-1e7+b,b=Math.floor(c/1e7),f[d]=c-1e7*b,b+=1;for(;0<b;)f[d++]=b%1e7,b=Math.floor(b/1e7);return f}function Zb(a,b){var c,d,e=a.length,f=b.length,g=Array(e),h=0;for(c=0;c<f;c++)d=a[c]-h-b[c],0>d?(d+=1e7,h=1):h=0,g[c]=d;for(c=f;c<e;c++){if(d=a[c]-h,!(0>d)){g[c++]=d;break}d+=1e7,g[c]=d}for(;c<e;c++)g[c]=a[c];return Tb(g),g}function $b(a,b,c){var d=a.length,e=Array(d);b=-b;var f,g;for(f=0;f<d;f++)g=a[f]+b,b=Math.floor(g/1e7),g%=1e7,e[f]=0>g?g+1e7:g;return e=Sb(e),"number"==typeof e?(c&&(e=-e),new Pb(e)):new Ob(e,c)}function _b(a,b){var c,d,e,f,g=a.length,h=b.length,i=Ub(g+h);for(e=0;e<g;++e){f=a[e];for(var j=0;j<h;++j)c=b[j],c=f*c+i[e+j],d=Math.floor(c/1e7),i[e+j]=c-1e7*d,i[e+j+1]+=d}return Tb(i),i}function ac(a,b){var c,d,e=a.length,f=Array(e),g=0;for(d=0;d<e;d++)c=a[d]*b+g,g=Math.floor(c/1e7),f[d]=c-1e7*g;for(;0<g;)f[d++]=g%1e7,g=Math.floor(g/1e7);return f}function bc(a,b){for(var c=[];0<b--;)c.push(0);return c.concat(a)}function cc(a,b){var c=Math.max(a.length,b.length);if(30>=c)return _b(a,b);var c=Math.ceil(c/2),d=a.slice(c),e=a.slice(0,c),f=b.slice(c),g=b.slice(0,c),h=cc(e,g),i=cc(d,f),d=cc(Xb(e,d),Xb(g,f)),c=Xb(Xb(h,bc(Zb(Zb(d,h),i),c)),bc(i,2*c));return Tb(c),c}function dc(a,b,c){return 1e7>a?new Ob(ac(b,a),c):new Ob(_b(b,Rb(a)),c)}function ec(a){var b,c,d,e,f=a.length,g=Ub(f+f);for(d=0;d<f;d++){e=a[d];for(var h=0;h<f;h++)b=a[h],b=e*b+g[d+h],c=Math.floor(b/1e7),g[d+h]=b-1e7*c,g[d+h+1]+=c}return Tb(g),g}function fc(a,b){var c,d,e=a.length,f=Ub(e);for(d=0,e-=1;0<=e;--e)d=1e7*d+a[e],c=Vb(d/b),d-=c*b,f[e]=0|c;return[f,0|d]}function gc(a,b){var c,d=pc(b),e=a.value;if(c=d.value,0===c)throw Error("Cannot divide by zero");if(a.R)return d.R?[new Pb(Vb(e/c)),new Pb(e%c)]:[Nb[0],a];if(d.R){if(1===c)return[a,Nb[0]];if(-1==c)return[a.na(),Nb[0]];if(c=Math.abs(c),1e7>c)return c=fc(e,c),e=Sb(c[0]),c=c[1],a.sign&&(c=-c),"number"==typeof e?(a.sign!==d.sign&&(e=-e),[new Pb(e),new Pb(c)]):[new Ob(e,a.sign!==d.sign),new Pb(c)];c=Rb(c)}var f=ic(e,c);if(-1===f)return[Nb[0],a];if(0===f)return[Nb[a.sign===d.sign?1:-1],Nb[0]];if(200>=e.length+c.length){var g=c,h=e.length;c=g.length;var i,j,k,l,m,n,f=Ub(g.length),o=g[c-1],p=Math.ceil(1e7/(2*o)),e=ac(e,p),g=ac(g,p);for(e.length<=h&&e.push(0),g.push(0),o=g[c-1],i=h-c;0<=i;i--){for(h=9999999,e[i+c]!==o&&(h=Math.floor((1e7*e[i+c]+e[i+c-1])/o)),k=j=0,m=g.length,l=0;l<m;l++)j+=h*g[l],n=Math.floor(j/1e7),k+=e[i+l]-(j-1e7*n),j=n,0>k?(e[i+l]=k+1e7,k=-1):(e[i+l]=k,k=0);for(;0!==k;){for(--h,l=j=0;l<m;l++)j+=e[i+l]-1e7+g[l],0>j?(e[i+l]=j+1e7,j=0):(e[i+l]=j,j=1);k+=j}f[i]=h}e=fc(e,p)[0],e=[Sb(f),Sb(e)]}else{for(f=e.length,o=c.length,p=[],g=[];f;)if(g.unshift(e[--f]),0>ic(g,c))p.push(0);else{h=g.length,i=1e7*g[h-1]+g[h-2],j=1e7*c[o-1]+c[o-2],h>o&&(i=1e7*(i+1)),h=Math.ceil(i/j);do{if(i=ac(c,h),0>=ic(i,g))break;h--}while(h);p.push(h),g=Zb(g,i)}p.reverse(),e=[Sb(p),Sb(g)]}return c=e,e=c[0],d=a.sign!==d.sign,c=c[1],f=a.sign,"number"==typeof e?(d&&(e=-e),e=new Pb(e)):e=new Ob(e,d),"number"==typeof c?(f&&(c=-c),c=new Pb(c)):c=new Ob(c,f),[e,c]}function hc(a,b){return gc(a,b)[0]}function ic(a,b){if(a.length!==b.length)return a.length>b.length?1:-1;for(var c=a.length-1;0<=c;c--)if(a[c]!==b[c])return a[c]>b[c]?1:-1;return 0}function jc(a){return("number"==typeof a||"string"==typeof a)&&1e7>=+Math.abs(a)||a instanceof Ob&&1>=a.value.length}function kc(a){return a=a.value,a="number"==typeof a?1073741824|a:a[0]+1e7*a[1]|1073758208,a&-a}function lc(a,b){return a=pc(a),b=pc(b),a.Ua(b)?a:b}function mc(a,b){return a=pc(a),b=pc(b),a.ib(b)?a:b}function nc(a,b){if(a=pc(a).abs(),b=pc(b).abs(),a.$a(b))return a;if(a.Ia())return b;if(b.Ia())return a;for(var c,d=Nb[1];a.xa()&&b.xa();)c=Math.min(kc(a),kc(b)),a=hc(a,c),b=hc(b,c),d=d.multiply(c);for(;a.xa();)a=hc(a,kc(a));do{for(;b.xa();)b=hc(b,kc(b));a.Ua(b)&&(c=b,b=a,a=c),b=b.ra(a)}while(!b.Ia());return d.Nb()?a:a.multiply(d)}function oc(a){if(Qb(+a)){var b=+a;if(b===Vb(b))return new Pb(b);throw"Invalid shaka.vimond.Integer: "+a}(b="-"===a[0])&&(a=a.slice(1));var c=a.split(/e/i);if(2<c.length)throw Error("Invalid shaka.vimond.Integer: "+c.join("e"));if(2===c.length){if(a=c[1],"+"===a[0]&&(a=a.slice(1)),a=+a,a!==Vb(a)||!Qb(a))throw Error("Invalid shaka.vimond.Integer: "+a+" is not a valid exponent.");var c=c[0],d=c.indexOf(".");if(0<=d&&(a-=c.length-d-1,c=c.slice(0,d)+c.slice(d+1)),0>a)throw Error("Cannot include negative exponent part for shaka.vimond.Integers");a=c+=Array(a+1).join("0")}if(!/^([0-9][0-9]*)$/.test(a))throw Error("Invalid shaka.vimond.Integer: "+a);for(var c=[],d=a.length,e=d-7;0<d;)c.push(+a.slice(e,d)),e-=7,0>e&&(e=0),d-=7;return Tb(c),new Ob(c,b)}function pc(a){if("number"==typeof a)if(Qb(a)){if(a!==Vb(a))throw Error(a+" is not an shaka.vimond.Integer.");a=new Pb(a)}else a=oc(a.toString());else a="string"==typeof a?oc(a):a;return a}function qc(a){this.a=a||null}function rc(a,b){if("string"==typeof b&&a.a){var c=a.a.c;c&&(b=c.reduce(function(a,b){var c=b.a instanceof RegExp?b.a:new RegExp(b.a.toString(),b.b),d=a.replace(c,b.ba);return d!==a?i("Manifest modifier in action: Replaced matches for %s with %s.",c,b.ba):i("Manifest modifier found nothing for pattern %s to be replaced with %s.",c,b.ba),d},b))}return b}function sc(a,b,c){d(0<a),this.f=Math.exp(Math.log(.5)/a),this.c=this.b=0,this.a=[],this.h=-Math.abs(b),this.i=c}function tc(a){var b=1-Math.pow(a.f,a.c);return j("Estimate / zeroFactor = output",(a.b/1e3).toFixed(2),b.toFixed(2),(a.b/b/1e3).toFixed(2)),a.b/b}function uc(a,b,c,d,e){za.call(this,null),this.a=new sc(c||4,a||.2,b||2e6),this.c=new sc(d||8,a||.2,b||2e6),this.f=e||5e5,this.b=0}function vc(){this.fa=this.$=null}function wc(a){if((a=a.split('"'))&&2<a.length)return a[a.length-2]}function xc(a,b){function c(a,b,c,e,f,g,h){if(!(b=b||c||e||f||g||h))return a;try{var i=Dg[b](d,a);return Object.getOwnPropertyNames(i.sa).forEach(function(a){d[a]=i.sa[a]}),i.ba}catch(b){return d.error=b,console.log("Error while finding replacement.",b),a}}var d={$:null,fa:null,Sa:1,Ra:0,Ja:b};if(Bg.test(a)){var e=a.replace(Cg,c),f=new vc;return f.$=d.$,f.fa=d.fa,new Zf(e,f)}return new Zf(a)}function yc(a){var b;a instanceof yc?(zc(this,a.ca),this.ta=a.ta,this.ha=a.ha,Ac(this,a.za),this.aa=a.aa,Bc(this,a.a.clone()),this.qa=a.qa):a&&(b=String(a).match(Eg))?(zc(this,b[1]||"",!0),this.ta=Cc(b[2]||""),this.ha=Cc(b[3]||"",!0),Ac(this,b[4]),this.aa=Cc(b[5]||"",!0),Bc(this,b[6]||"",!0),this.qa=Cc(b[7]||"")):this.a=new Fc(null)}function zc(a,b,c){a.ca=c?Cc(b,!0):b,a.ca&&(a.ca=a.ca.replace(/:$/,""))}function Ac(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.za=b}else a.za=null}function Bc(a,b,c){b instanceof Fc?a.a=b:(c||(b=Dc(b,Ig)),a.a=new Fc(b))}function Cc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Dc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Ec),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ec(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(15&a).toString(16)}function Fc(a){this.a=a||null}function Gc(a,b,c){return a=(new DOMParser).parseFromString(a,"text/xml"),a?dd({Rb:b,A:c},a,Hc):(g("Failed to parse MPD XML."),null)}function Hc(){this.id=this.url=null,this.type="static",this.c=this.l=this.A=this.Rb=null,this.i=5,this.f=this.j=this.b=this.h=null,this.g=10,this.a=[]}function Ic(){this.m=this.c=this.b=this.A=this.a=this.start=this.id=null,this.J=[]}function Jc(){this.g=this.a=this.height=this.width=this.contentType=this.lang=this.group=this.id=null,this.b=!1,this.m=this.f=this.c=this.A=null,this.h=[],this.I=[]}function Kc(){this.value=null}function Lc(){this.contentType=this.lang=this.id=null}function Mc(){this.m=this.a=this.b=this.A=this.g=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null,this.c=[]}function Nc(){this.b=this.a=this.c=this.f=null}function Oc(){this.parsedPssh=this.psshBox=null}function Pc(){this.url=null}function Qc(){this.url=null}function Rc(){this.A=null,this.v=1,this.c=this.b=this.a=this.D=null}function Sc(){this.a=this.url=null}function Tc(){this.a=this.url=null}function Uc(){this.A=null,this.v=1,this.b=this.D=null,this.f=1,this.c=null,this.a=[],this.B=null}function Vc(){this.a=this.b=null}function Wc(){this.v=1,this.a=this.D=null,this.g=1,this.B=this.f=this.b=this.c=null}function Xc(){this.P=[]}function Yc(){this.f=this.a=this.c=this.b=this.startTime=null}function Zc(a,b){this.wa=a,this.end=b}function $c(a,b,c,d){if(0!==a.a.length){var e=new Jc;e.contentType="text",e.lang=c||"en",e.b=!0,c=new Mc,c.bandwidth=0,c.f=d||"text/vtt",c.A=[new yc(b)],e.I.push(c),a.a[0].J.push(e),_c(a.a[0])}}function _c(a){for(var b=[],c=0;c<a.J.length;++c){var d=a.J[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.J.length;++c)if(d=a.J[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0,d.group=e}}function ad(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new yc(e)):(e=bd(a.slice(0,1),e),c.push(e[0]))}return c}function bd(a,b){if(!b)return a;var c=new yc(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function cd(a,b,c){var e=id(c);return d(e),(b=ed(b,c.constructor.TAG_NAME))&&e.parse(a,b),e}function dd(a,b,c){var d=null;return(b=ed(b,c.TAG_NAME))&&(d=new c,d.parse(a,b)),d}function ed(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function fd(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]),d.push(f)}return d}function gd(a){return a=a.firstChild,a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function hd(a){return a?a.map(function(a){return a.clone()}):null}function id(a){return a?a.clone():null}function jd(a,b,c,d){return a=c(a.getAttribute(b)),null!=a?a:void 0!==d?d:null}function kd(a){return a?(a=Date.parse(a),isNaN(a)?null:Math.floor(a/1e3)):null}function ld(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);if(!c)return h("Invalid duration string:",b),null;b=0;var d=pd(c[1]);return d&&(b+=31536e3*d),(d=pd(c[2]))&&(b+=2592e3*d),(d=pd(c[3]))&&(b+=86400*d),(d=pd(c[4]))&&(b+=3600*d),(d=pd(c[5]))&&(b+=60*d),c=a.parseFloat(c[6]),(c=isNaN(c)?null:c)&&(b+=c),b}function md(a){var b=/([0-9]+)-([0-9]+)/.exec(a);return b?(a=pd(b[1]),null==a?null:(b=pd(b[2]),null==b?null:new Zc(a,b))):null}function nd(b){return b=a.parseInt(b,10),isNaN(b)?null:b}function od(b){return b=a.parseInt(b,10),0<b?b:null}function pd(b){return b=a.parseInt(b,10),0<=b?b:null}function qd(a){return a}function rd(a,b){this.url=a,this.b=b||new sd,this.g=this.i=this.h=0,this.a=null,this.c=new Ca,this.f=null}function sd(){this.body=null,this.a=1,this.j=1e3,this.c=0,this.method="GET",this.h="arraybuffer",this.b={},this.f=this.i=!1,this.g=null}function td(a){ud(a),a.b.body=null,a.c.destroy(),a.c=null,a.f=null}function ud(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null),a.a=null}function vd(a){var b=a.url.split("/");d(4==b.length);var c=parseInt(b[2],10),b=parseInt(b[3],10);return d(!isNaN(c)),d(!isNaN(b)),d(a.b.g),Wa(a.b.g,c,b).then(Ia(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));return b.response=a,a=this.c,a.resolve(b),td(this),a})).catch(Ia(a,function(a){return td(this),Promise.reject(a)}))}function wd(a,b,c){return b=Error(b),b.type=c,b.status=a.a.status,b.url=a.url,b.method=a.b.method,b.body=a.b.body,b.xhr=a.a,b}function xd(b){ud(b),a.setTimeout(b.$b.bind(b),b.g*(1+.5*(2*Math.random()-1))),b.g*=2}function yd(a,b,c,e){d(b),d(0<b.length),this.a=b,this.g=c||0,this.h=null!=e?e:null,this.c=this.b=null,this.i=a,this.f=null}function zd(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function Ad(a,b,c,e){d(b<a.a.length);var f=a.a[b].toString();return a.i&&(f=a.i(f,c.b)||f),a.c=new rd(f,c),e&&(a.c.f=e),f=a.c.$b().then(Ia(a,function(a){return this.f=this.c=this.b=null,this.f=a.a?new yc(a.a):this.a[b],Promise.resolve(a.response)})),f=f.catch(Ia(a,function(a){return this.b&&b+1<this.a.length?(i("Trying fallback URL..."),this.b=Ad(this,b+1,c,e)):(this.b=this.c=null,Promise.reject(a))}))}function Bd(a,b){this.b=new sd,this.b.h="text",this.b.a=3,this.b.c=1e3*(null!=b?b:0),this.b.f=!0,this.i=a}function Cd(a,b,c,e){d(b.m),d(0<b.m.v),d(b.m.a),d(0<c);for(var f=b.m,g=[],h=0;h<e;++h){var i=h+c,j=(i-1)*f.a,k=j/f.v,l=(j+f.a)/f.v,i=Dd(a,b,f.g+i-1,j);if(!i)return null;g.push(new Hd(k,l,i))}return g}function Dd(a,b,c,e){if(d(b.m),!b.m)return null;var f=b.m.c;return f?(c=Ed(f,b.id,c,b.bandwidth,e))?(b=zd(b.A,c),new yd(a,b,0,null)):null:(h("The SegmentTemplate's media URL template is missing:","using the Representation's BaseURL instead.",b),b.A?new yd(a,b.A,0,null):null)}function Ed(b,c,e,f,g){var i={RepresentationID:c,Number:e,Bandwidth:f,Time:g};c=b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(c,e,f){if("$$"==c)return"$";var g=i[e];return d(void 0!==g),null==g?(h("URL template does not have an available substitution for identifier",'"'+e+'":',b),c):("RepresentationID"==e&&f&&(h("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),f=void 0),c=g.toString(),f=a.parseInt(f,10)||1,f=Math.max(0,f-c.length),Array(f+1).join("0")+c)});try{return new yc(c)}catch(a){if(a instanceof URIError)return h("URL template contains an illegal character:",b),null;throw a}}function Fd(a,b,c){d(a);var e=0;c*=b,a=a.P;for(var f,g=[],i=0;i<a.length;++i){if(!a[i].a){h('SegmentTimeline "S" element does not have a duration:','ignoring the remaining "S" elements.',a[i]);break}var j=a[i].startTime;a[i].b&&(f=Nb.a(a[i].b).ra(j));var j=null!=j?j:e,k=a[i].f||0;if(0>k)if(k=a[i].a,i+1===a.length)var l=a[0].startTime+c-j,k=Math.ceil(l/k)-1;else k=Math.ceil((a[i+1].startTime-j)/k)-1;for(0<g.length&&j!=e&&(l=j-e,.03125<=Math.abs(l/b)&&h("SegmentTimeline contains a large gap/overlap.","The content may have errors in it.",a[i]),g[g.length-1].end=j),l=0;l<=k;++l){var e=j+a[i].a,m={start:j,end:e};f&&(m.dc=f.add(j),m.Wc=f.add(e)),g.push(m),j=e}}return g}function Gd(a,b){d(!a||!b),this.a=a,this.b=b||null}function Hd(a,b,c){d(null==b||a<=b,"startTime should be <= endTime"),this.startTime=a,this.a=b,this.url=c}function Id(a,b,c){return new Hd(b,c,a.url)}function Jd(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.startTime&&(null==d.a||b<d.a))return c}return-1}function Kd(a,b){return a.map(function(a){return Id(a,a.startTime+b,null!=a.a?a.a+b:null)})}function Ld(a){for(var b=a[0],c=1;c<a.length;++c){var e=a[c],f=e.startTime>b.startTime&&e.startTime<=b.a&&(e.a&&e.a>=b.a||c==a.length-1);d(f,"SegmentReferences are not correct."),f||j("SegmentReferences should be sorted without gaps:","previous",b,"current",e),b=e}}function Md(){}function Nd(a){this.o=a,this.l=0}function Od(a){if(0==a.o.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.o[0]}function Pd(a,b){if(a.l!=b.l){var c=a.l-b.l;l("Shifting new SegmentReferences by",c,"seconds before merging."),b=new Nd(Kd(b.o,c))}if(0==a.length())a.o=b.o.slice(0),Ld(a.o);else if(0==b.length())j("Nothing to merge: new SegmentIndex is empty.");else if(null==a.F().a)j("Nothing to merge:","existing SegmentIndex ends at the end of the stream.");else if(null!=b.F().a&&b.F().a<a.F().a)j("Nothing to merge:","new SegmentIndex ends before the existing one ends.");else{if(a.F().a<=Od(b).startTime)c=Id(a.F(),a.F().startTime,Od(b).startTime),c=a.o.slice(0,-1).concat([c]);else{var e;for(e=0;e<a.o.length&&!(a.o[e].a>=Od(b).startTime);++e);d(e<a.o.length),a.o[e].startTime<Od(b).startTime?(c=Id(a.o[e],a.o[e].startTime,Od(b).startTime),c=a.o.slice(0,e).concat([c])):(d(Od(a).startTime>Od(b).startTime||a.o[e].startTime==Od(b).startTime),c=a.o.slice(0,e))}a.o=c.concat(b.o),Ld(a.o)}}function Qd(a,b,c,e){d(null!=b.b),d(null!=c.start),Nd.call(this,a),this.h=b,this.u=c,this.g=e,this.i=this.h.c||this.h.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0,this.a=this.f=this.b=null,Rd(this)}function Rd(a){if(d(null==a.b),d(null==a.f),d(null==a.a),Ud(a),0!=a.length()){d(0<a.length());var b=null!=a.F().a?a.F().a:a.F().startTime;if(a.h.b>a.g)h("The stream might not be available yet!",a.u),a.b=b;else{var c=a.g-(a.h.b+a.u.start);0>c?(h("The Period might not be available yet!",a.u),a.b=b):c<Math.max(a.F().startTime,a.F().a||0)?(h("@availabilityStartTime seems to be inaccurate;","some segments may not be available yet:","currentPresentationTime",c,"latestAvailableSegmentEndTime",a.F().a,"difference",a.F().a-c),a.b=b):a.b=c}b=a.h.g||0,a.f=a.F().startTime-b,a.a=Od(a).startTime,k("originalPresentationTime_",a.b),k("originalLiveEdge_",a.f),k("seekStartTime_",a.a),b=a.b+(T()/1e3-a.g),a.f>b&&g("The live-edge ("+a.f+")","should not be greater than","the current presentation time ("+b+")")}}function Sd(a,b){if(Td(a,b),null==a.b||null==a.f||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.i&&(c=a.i);var e=b-a.g,f=a.b+e;return null!=a.h.f&&(f-=a.a,d(0<=f),f-=a.h.f,0<f&&(a.a+=f)),a.a=Math.min(a.a,c),0<a.length()&&d(a.a>=Od(a).startTime,"The seek start time ("+a.a+")should not be less thanthe first segment's start time ("+Od(a).startTime+")"),e=a.f+e,e<a.a?{start:a.a,end:a.a}:(e=0<a.length()?null!=a.F().a?Math.min(e,a.F().a):e:a.a,a.a>e&&j("The seek start time ("+a.a+")","has surpassed the target seek end time ("+e+")"),e=Math.max(e,a.a),e=Math.min(e,c),{start:a.a,end:e})}function Td(a,b){if(Ud(a),null!=a.h.f)if(null==a.b)d(0==a.length());else{for(var c=a.b+(b-a.g),e=0,f=0;f<a.o.length;++f){var g=null;if(f<a.o.length-1?g=a.o[f+1].a:(g=a.o[f],g=null!=g.a?g.a+(g.a-g.startTime):null),!(null!=g&&g<c-a.h.f))break;++e}0<e&&(a.o.splice(0,e),j("Evicted",e,"SegmentReference(s),",a.o.length,"SegmentReference(s) remain."))}}function Ud(a){if(a.i){for(var b=0,c=a.o.length-1;0<=c&&a.o[c].startTime>a.i;--c)++b;0<b&&(a.o.splice(-b),h("Segments found after stream end, evicted",b,"SegmentReference(s),",a.o.length,"SegmentReference(s) remain."))}}function Vd(a,b,c,e,f){d(null!=a.b),d(null!=b.start),d(c.m),d(c.m.a),d(0<c.m.v);var i,l=1,m=0;if(d(null!=b.start),d(c.m),d(c.m.a),d(0<c.m.v),a.b>e)h("The stream is not available yet!",c),i=null;else{var n=a.g||0,o=a.f||0;i=c.m,i=i.a/i.v;var p=e-(a.b+b.start);0>p?(h("The Period is not available yet!",c),i=null):(o=p-2*i-o,0>o&&(k("The earliest available segment is not available yet.",c),o=0),o=Math.ceil(o/i)*i,p-=i,0>p?(g("The current segment is not available yet!",c),i=null):(n=Math.floor(p/i)*i-n,0>n&&(k("bestAvailableTimestamp < 0"),n=0),n=Math.floor(n/i)*i,n>=o?j("The best available segment is still available."):(n=o,j("The best available segment is no longer available.")),o=o/i+1,d(o==Math.round(o),"earliestSegmentNumber should be an integer."),i=n/i+1,d(i==Math.round(i),"currentSegmentNumber should be an integer."),k("earliestSegmentNumber",o),k("currentSegmentNumber",i),i={Hb:o,current:i}))}if(i&&(l=i.Hb,m=i.current-i.Hb+1),l=Cd(f,c,l,m),null==l)throw a=Error("Failed to generate SegmentReferences."),
a.type="stream",a;d(0==l.length||null!=l[l.length-1].a),Qd.call(this,l,a,b,e),this.K=c,this.c=0<this.length()?a.b+b.start+this.F().a:null,d(this.c<=e),this.j=this.c,this.s=i?i.current+1:null,this.C=f}function Wd(a,b){if(null!=a.c&&null!=a.j&&null!=a.s){var c=a.j+(b-a.g)-a.c;d(0<=c);var e=a.K.m,e=e.a/e.v,c=Math.floor(c/e);if(0!=c){var f=Cd(a.C,a.K,a.s,c);d(f),Array.prototype.push.apply(a.o,Kd(f,a.l)),Ld(a.o),a.c+=c*e,a.s+=c,j("Generated",c,"SegmentReference(s).")}}}function Xd(a,b,c,e,f){d(null!=b.start),d("dynamic"==a.type||null!=b.a),d(c.m),d(0<c.m.v),d(c.m.a),this.c=a,this.b=b,this.f=c,this.h=e,this.a=null,this.g=f}function Yd(a,b,c,e,f){d(c.a);var g=c.a.B;d(c.a.b||1==c.a.a.length||null!=g&&0<g.P.length),d(0<c.a.v),this.c=a,this.b=b,this.g=c,this.a=null,this.h=e,this.f=f}function Zd(a){this.b=a,this.a=null}function $d(){this.G=Mg++,this.id=this.O=this.S=null,this.f=0,this.height=this.width=this.bandwidth=null,this.c=this.a="",this.g=[],this.ga=!1,this.b=!0}function _d(a){return a.ga&&a.b}function ae(a){var b=a.a||"";return a.c&&(b+='; codecs="'+a.c+'"'),b}function be(){this.G=Ng++,this.id=null,this.contentType=this.lang="",this.b=!1,this.w=[],this.a=[]}function ce(a){for(var b=[],c=0;c<a.a.length;++c){var d=new fe;d.id=a.G,d.a=a.a[c],d.contentType=a.contentType,d.b=a.w.length?ae(a.w[0]):"",b.push(d)}return b}function de(){this.id=null,this.start=0,this.b=null,this.a=[]}function ee(){this.b=!1,this.h=this.g=this.f=null,this.c=0,this.a=[]}function fe(){this.id=0,this.a=null,this.b=this.contentType=""}function ge(a,b,c,e,f){za.call(this,a),this.j=b,this.a=new Xa(c,e,f),this.C=this.H=this.i=null,this.U=!1,this.b=null,this.f=!1,this.u=null,this.h=!1,this.s=new Ca,this.l=this.c=!1,this.L=0,this.Y=15,this.g=this.M=!1,this.T=e.split(";")[0],d(0<this.T.length)}function he(a,b,c){a.i&&!a.f&&(d(null!=a.b||a.g||a.h&&!a.c,"Unexpected call to resync_()."),d(!c||0<c),a.f=!0,ne(a),ab(a.a).then(Ia(a,function(){k(oe(this),"abort done."),d(null==this.b&&this.f),d(!this.g);var a=this.j.currentTime;return!b&&0<Ya(this.a,a)&&0<=Jd(this.a.b,a)?(j(oe(this),"no clear required."),Promise.resolve()):(j(oe(this),"clear required."),c?_a(this.a,this.j.currentTime+c):(j(oe(this),"nudge needed!"),this.M=!0,$a(this.a)))})).then(Ia(a,function(){d(null==this.b&&this.f),d(!this.g),this.f=!1,me(this,0)})).catch(Ia(a,function(a){d("aborted"!=a.type),this.f=!1,this.c?(a=ia(a),this.dispatchEvent(a)):this.s.reject(a)})))}function ie(a,b,c){a=a.a;var d=a.b.length;return a=0<d?a.b[d-1]:null,null!=a?null!=a.a?c.Ca(a.a):null:c.Ca(b)||(c.length()?c.F():null)}function je(a){if(!a.h&&null!=a.u){d(!a.c),d(!a.l),i(oe(a),"stream has started."),a.h=!0;var b=a.a,c=a.u,e=c-b.K;0!=e&&(b.b=Kd(b.b,e),b.K=c,j(fb(b),"applied timestamp correction of",c,"seconds to SourceBufferManager",b)),a.s.resolve(a.u)}}function ke(a,b){var c;c=b.a.split("/")[0],c=ha({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth}),a.dispatchEvent(c)}function le(a){d(a.l);var b=ha({type:"ended"});a.dispatchEvent(b)}function me(b,c){d(null==b.b),b.b=a.setTimeout(b.Dc.bind(b),c)}function ne(b){null!=b.b&&(a.clearTimeout(b.b),b.b=null)}function oe(a){return"Stream "+a.T+":"}function pe(a){this.b=a,this.a=null}function qe(a,b){za.call(this,a),this.b=b,this.g=!0,this.h=this.f=null,this.c=new Ca,this.a=null}function re(){}function se(a,b,c,e,f,g,h){d("webm"!=c||f),this.f=a,this.i=b,this.g=c,this.a=e,this.c=f,this.j=g,this.b=null,this.h=h}function te(){this.streamStats=null,this.droppedFrames=this.decodedFrames=NaN,this.bufferingTime=this.playTime=this.estimatedBandwidth=0,this.playbackLatency=NaN,this.bufferingHistory=[],this.bandwidthHistory=[],this.streamHistory=[]}function ue(a,b){var c=new ve(b);a.streamHistory.push(new we(c)),!c.videoHeight&&a.streamStats||(a.streamStats=c)}function ve(a){this.videoWidth=a.width,this.videoHeight=a.height,this.videoMimeType=a.a,this.videoBandwidth=a.bandwidth}function we(a){this.timestamp=T()/1e3,this.value=a}function xe(a,b){Ja.call(this,"readwrite",b),this.j=a,this.b=0}function ye(a,b){d(!isNaN(b)),a.b=b}function ze(a,b,c,d,e){for(var f=[],g=[],h=0,i=0,j=[],k=b.map(function(a){return a.S.create()}),k=Promise.all(k),l=b.map(function(a){return a.O.create()}),l=Promise.all(l),k=Promise.all([k,l]).then(function(a){f=a[0],g=a[1],h=f.reduce(function(a,b){return a+b.length()},0)}),l=0;l<b.length;++l)k=k.then(function(a){return Be(this,b[a],f[a],g[a],h,i)}.bind(a,l)),k=k.then(function(a,b){i+=f[a].length(),j.push(b)}.bind(a,l));return k.then(Ia(a,function(){return Ce(Pa(this))})).then(Ia(a,function(a){var b=new Ca;c=S(c);var f={group_id:a,stream_ids:j,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.i,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.j},g=Pa(this).put(f);return g.onsuccess=function(){b.resolve(a)},g.onerror=function(){b.reject(g.error)},b}))}function Ae(a,b){return Ra(Pa(a),b).then(Ia(a,function(a){var c,d=[];for(c in a.stream_ids)d.push(Ee(this,a.stream_ids[c]));return a=Pa(this),d.push(a.delete(b)),Promise.all(d)}))}function Be(a,b,c,d,e,f){var g=[Ce(Oa(a)),Ce(Na(a).index("stream"))],g=Promise.all(g).then(Ia(a,function(a){return{La:Math.max(a[0],a[1]),Aa:new ArrayBuffer(0),nb:0,o:[],ab:null,Oc:e,Sb:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function Ce(a){var b=new Ca,c=a.openCursor(null,"prev");return c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)},c.onerror=function(){b.reject(c.error)},b}function De(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);return c.set(new Uint8Array(a),0),c.set(new Uint8Array(b),a.byteLength),c.buffer}function Ee(a,b){var c=new Ca,d=Oa(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Na(a);return e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){(a=a.target.result)&&(e.delete(a.primaryKey),a.continue())},e.transaction.oncomplete=function(){c.resolve()},c}function Fe(a,b,c,e,f,g){d("GET"==c||"POST"==c),this.b=new yd(null,[new yc(a)]),this.a=new sd,this.a.body=b,this.a.method=c,this.a.a=3,this.a.i=e,this.a.c=1e3*(null!=g?g:0),a=f||{};for(var h in a)this.a.b[h]=a[h]}function Ge(a){return a.b.ea(a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})}function He(a,b,c){za.call(this,a),this.b=b,this.c=c,this.a=this.i=null,this.j=new va,this.f=[],this.g=[],this.s=0,this.h=new Ca,this.l=null,this.C=0,this.H=this.uc.bind(this),this.u=[],wa(this.j,this.b,"encrypted",this.H)}function Ie(b,c){return null==b.l&&(b.l=a.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage",this.h.reject(a)}.bind(b),c)),b.h}function Je(a){return Promise.all(a.g.map(function(a){return j("Removing session",a),a.remove()}))}function Ke(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));return a.c.ya()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.")})),c}function Le(b){return b.b?b.i?(d(b.b.src,"Video src must be set!"),b.b.setMediaKeys(b.i).then(Ia(b,function(){return this.b?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():Me()})).then(Ia(b,function(){return this.b?(d(this.b.mediaKeys),d(this.b.mediaKeys==this.i),void(0<this.c.Ta().length?Oe(this):(Ne(this),0==this.a.b.length&&("com.microsoft.playready"==this.a.a&&0<this.u.length&&a.setTimeout(function(){for(var a;a=this.u.shift();)j("Applying prematurely received encrypted event."),this.jb(a)}.bind(this),10),this.j.Ea(this.b,"encrypted"),wa(this.j,this.b,"encrypted",this.jb.bind(this)))))):Me()}))):Promise.resolve():Me()}function Me(){var a=Error("EmeManager destroyed");return a.type="destroy",Promise.reject(a)}function Ne(a){d(a.a);for(var b=0;b<a.a.b.length;++b){var c=a.a.b[b];a.jb({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}}function Oe(a){var b=a.c.Ta();d(0<b.length);for(var c=0;c<b.length;++c){var e=Pe(a),f=e.load(b[c]);a.g.push(e),f.then(Ia(a,function(){this.s++,this.s>=this.g.length&&this.h.resolve()})).catch(Ia(a,function(a){a=ia(a),this.dispatchEvent(a)}))}}function Pe(a){var b=null;if(a.c.ya())try{b=a.i.createSession("persistent-license")}catch(a){throw Error("Persistent licenses are not supported by this key system or platform.")}else b=a.i.createSession();return wa(a.j,b,"message",a.yc.bind(a)),wa(a.j,b,"keystatuseschange",a.mc.bind(a)),b}function Qe(a,b,c,d){j("requestLicense_",b,c,d),d=Re(c,d),Ge(new Fe(d.url,d.body,d.method,c.i,d.headers,a.C)).then(Ia(a,function(a){return i("onLicenseSuccess_",b),c.s&&(a=c.s(a)),b.update(a)})).then(Ia(a,function(){i("onSessionReady_",b);var a=ha({type:"sessionReady",detail:b});this.dispatchEvent(a),this.s++,this.s>=this.g.length&&this.h.resolve()})).catch(Ia(a,function(a){a.pb=b,a=ia(a),this.dispatchEvent(a)}))}function Re(b,c){var d={url:b.h,body:c.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===b.a){for(var e=String.fromCharCode.apply(null,new Uint16Array(d.body)),e=(new DOMParser).parseFromString(e,"application/xml"),f=e.getElementsByTagName("name"),g=e.getElementsByTagName("value"),h=0;h<f.length;h++)d.headers[f[h].childNodes[0].nodeValue]=g[h].childNodes[0].nodeValue;d.body=a.atob(e.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!b.u)return d;if(b.u(d),d.url=oa(d,"url"),null==d.url)throw Error("'url' cannot be null.");if(!(d.body instanceof ArrayBuffer||"string"==typeof d.body||null==d.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");if(d.method=oa(d,"method"),"GET"!=d.method&&"POST"!=d.method)throw Error("'method' must be either 'GET' or 'POST'.");if(d.headers=qa(d,"headers",Object),null==d.headers)throw Error("'headers' cannot be null.");return d}function Se(a,b){d(!isNaN(b)),a.C=b}function Te(a){za.call(this,null),this.a=a,this.b=null,this.f=new va,this.j=this.i=null,this.H=0,this.u=null,this.M=this.h=!1,this.g=new te,this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new r},this.s=1,this.L=null}function Ue(b){var c;return c="text/vtt"==b?!!a.VTTCue:MediaSource.isTypeSupported(b),i("+",b,c?"is":"is not","supported"),c}function Ve(){var a=Error("Player destroyed");return a.type="destroy",Promise.reject(a)}function We(b){b.j&&(a.clearTimeout(b.j),b.j=null)}function Xe(b){Ye(b),b.u=a.setTimeout(b.U.bind(b),100)}function Ye(b){b.u&&(a.clearTimeout(b.u),b.u=null)}function Ze(a){d(a.h),j("Buffering complete."),o("buffering");var b=a.g;b.bufferingTime+=p("buffering")/1e3,a.h=!1,a.dispatchEvent(ha({type:"bufferingEnd"}))}function $e(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.w.length;++g){var i=f.w[g];Ue(ae(i))||(h("Stream uses an unsupported MIME type.",i),f.w.splice(g,1),--g)}0==e.w.length&&(c.a.splice(d,1),--d)}}function _e(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].w.sort(af)}function af(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0}function bf(a){this.a=a}function cf(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.w}).reduce(b,[]);return a=c.map(function(a){return a.S.create()}),Promise.all(a).then(function(a){d(c.length==a.length);for(var b={},e=0;e<c.length;++e)b[c[e].G]=a[e];return Promise.resolve(b)})}function df(a,b,c,e,f){var g=new ra;a.a.forEach(function(a,b){g.push(a.id||""+b,a)});var i=new ra;for(b.a.forEach(function(a,b){i.push(a.id||""+b,a)}),a=ua(g),b=0;b<a.length;++b){var j=a[b],k=g.get(j);if(d(k&&0!=k.length),1<k.length)h("Cannot update Period "+j+" because more than one existing Period has the same ID.");else{var l=i.get(j);l&&0!=l.length&&(1==l.length?(ef(k[0],l[0],c,e,f),k[0].b=l[0].b):h("Cannot update Period "+j+" because more than one new Period has the same ID."))}}}function ef(a,b,c,e,f){var g=new ra;a.a.forEach(function(a,b){g.push(a.id||""+b,a)});var i=new ra;for(b.a.forEach(function(a,b){i.push(a.id||""+b,a)}),a=ua(g),b=0;b<a.length;++b){var j=a[b],k=g.get(j);if(d(k&&0!=k.length),1<k.length)h("Cannot update StreamSet "+j+" because more than one existing StreamSet has the same ID.");else{var l=i.get(j);l&&0!=l.length&&(1==l.length?ff(k[0],l[0],c,e,f):h("Cannot update StreamSet "+j+" because more than one new StreamSet has the same ID."))}}}function ff(a,b,c,e,f){var g=new ra;a.w.forEach(function(a,b){g.push(a.id||""+b,a)});var j=new ra;b.w.forEach(function(a,b){j.push(a.id||""+b,a)}),b={};for(var k=ua(g),l=0;l<k.length;++l){var m=k[l];b[m]=m;var n=g.get(m);if(d(n&&0!=n.length),1<n.length)h("Cannot update Stream "+m+" because more than one existing Stream has the same ID.");else{var o=j.get(m);o&&0!=o.length?1==o.length?(gf(n[0],o[0],c,e),n[0].O=o[0].O,o[0].O=null,n[0].f=o[0].f):h("Cannot update Stream "+m+" because more than one new Stream has the same ID."):(f.push(n[0]),a.w.splice(a.w.indexOf(n[0]),1))}}for(k=ua(j),l=0;l<k.length;++l)m=k[l],b[m]||(b[m]=m,o=j.get(m),d(o&&0!=o.length),1<o.length&&h("Cannot add Stream "+m+" because more than one new Stream has the same ID."),a.w.push(o[0]),i("Added Stream "+m+"."))}function gf(a,b,c,e){c=c[a.G],d(c),e=e[b.G],d(e);var f=c.length();c.gb(e)?i("Updated SegmentIndex",a.G+":",f,"->",c.length(),"SegmentReference(s)."):h("Failed to update SegmentIndex",b.G)}function hf(){this.a=this.b=null,this.f=new va,this.c=Number.POSITIVE_INFINITY,this.i=!0,this.g=!1}function jf(a){var b=a.a.Da();if(0==b.length)return null;b.sort(x);var c;a:{c=a.a.Ka();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0,a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth){var h=(f.bandwidth+c)/.95,g=(g.bandwidth+c)/.85;if(l("Bandwidth ranges:",((f.bandwidth+c)/1e6).toFixed(3),(h/1e6).toFixed(3),(g/1e6).toFixed(3)),a>=h&&a<=g&&(d=f,d.active))break}}return d}function kf(a,b,c){za.call(this,null),this.f=a,this.c=b,this.b=mb(c),this.a=null}function lf(a,b,c){za.call(this,null),this.a=a,this.Ya=null,this.pa=b,this.i=new va,this.g=new MediaSource,this.f=null,this.ka=0,this.b=new ra,this.Y=c,this.Y.initialize(b,this),this.M=!1,this.ja="en",this.va=!1,this.s=null,this.T=new Ca,this.h=new r,this.j=null,this.Eb=1,this.c={},this.ua=new Ca,this.Ab=0,this.Bb=15,this.L=null,this.yb=this.zb=!1,this.H={},this.N=this.la=this.u=null,this.U={}}function mf(b,c){if(null!=b.a.f){d(null==b.u);var e=Math.max(b.a.f,3),e=Math.max(e-c,0);j("updateInterval",e),b.u=a.setTimeout(b.Qb.bind(b,!1),1e3*e)}}function nf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.Ha()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.w}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return _d(a)});if(0==e.length)return g("The stream",b.id,"was removed but an alternate stream does not exist."),c=Error("All usable streams have been removed from the manifest."),c.type="app",c=ia(c),void a.dispatchEvent(c);a.H[c].vb==b&&delete a.H[c],d.Ma(e[0],!0),b.destroy()}i("Removed stream",b.id),b.destroy()}function of(a){if(d(a.a),d(a.M),a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var e=a.a.a[c],f=0;f<e.a.length;++f){var g=e.a[f];if("video"==g.contentType)for(var h=0;h<g.w.length;++h){var j=g.w[h],k=j.b;j.b=!0,a.h.maxWidth&&j.width>a.h.maxWidth&&(j.b=!1),a.h.maxHeight&&j.height>a.h.maxHeight&&(j.b=!1),a.h.minHeight&&j.height<a.h.minHeight&&(j.b=!1),a.h.maxBandwidth&&j.bandwidth>a.h.maxBandwidth&&(j.b=!1),a.h.minBandwidth&&j.bandwidth<a.h.minBandwidth&&(j.b=!1),k!=j.b&&(i(j.b?"Permitting":"Restricting","stream",j.id+".","The application has applied new video track restrictions."),b=!0)}}0!=sa(a.b).length&&b&&(pf(a),d(a.b.a.hasOwnProperty("video")),0<a.Da().length||(b=Error("The application has restricted all video tracks!"),b.type="app",b=ia(b),a.dispatchEvent(b)))}}function pf(a){var b=ha({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function qf(a,b,c,e,f){if(!a.b.a.hasOwnProperty(b))return h("Cannot select",b,"track",c,"because there are no",b,"tracks."),!1;if(!a.c[b])return h("Cannot select",b,"track",c,"because there are no",b,"streams yet."),!1;for(var g=a.b.get(b),i=0;i<g.length;++i)for(var j=g[i],k=0;k<j.w.length;++k){var l=j.w[k];if(l.G==c)return l.ga?l.b?"text"==b||a.yb?(d(a.s),ue(a.s,l),a.c[b].Ma(l,e,f),!0):(c=a.H[b],a.H[b]={vb:l,Fb:null!=c&&c.Fb||e,Gb:null!=c&&c.Gb||f},!0):(h("Cannot select",b,"track",c,"because the track is not allowed by the application."),!1):(h("Cannot select",b,"track",c,"because the track is not allowed by the key system."),!1)}return h("Cannot select",b,"track",c,"because it does not exist."),!1}function rf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(ja(c,a.ja,e.lang))return b.splice(d,1),void b.splice(0,0,e)}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1),b.splice(0,0,e);break}}function sf(b){for(var c=[],e=["audio","video","text"],f=0;f<e.length;++f){var g=e[f];b.b.a.hasOwnProperty(g)&&c.push(b.b.get(g)[0])}for(var i=tf(b,c),f=0;f<e.length;++f)if(g=e[f],b.b.a.hasOwnProperty(g)&&!i[g])return b=Error("Unable to select an initial "+g+" stream: all "+g+" streams have been restricted (by the application or by the key system)."),b.type="stream",Promise.reject(b);return c=la(i).map(function(a){return a.S.create()}),Promise.all(c).then(Ia(b,function(a){return a.every(function(a){return a.length()})?(a=Df(this,a))?uf(this,i)?(this.Y.start(),xf(this,i,a),Promise.resolve()):(a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a)):(a=Error("Some streams are not available."),a.type="stream",Promise.reject(a)):(j("At least one SegmentIndex is empty."),a=Error("Some streams are not available."),a.type="stream",Promise.reject(a))})).catch(Ia(b,function(b){if("aborted"!=b.type)return d(0==Object.keys(this.c).length),this.a.b?(h(b.message),T()<this.a.h?(d(!this.u),d(this.a.b),d(this.a.h),b=Math.max(this.a.h-(new Date).getTime()/1e3,3),j("updateLocalInterval",b),this.u=a.setTimeout(this.Qb.bind(this,!0),1e3*b)):mf(this,0),Promise.resolve()):Promise.reject(b)}))}function tf(a,b){for(var c={},e=0;e<b.length;++e){var f=b[e],g=null;if("video"==f.contentType){var h=a.Y.getInitialVideoTrackId();if(null==h){j("No initial video streams to select.");continue}if(g=f.w.filter(function(a){return a.G==h}),0==g.length){j("No initial video streams to select from the selected StreamSetInfo.");continue}d(1==g.length),d(_d(g[0])),g=g[0]}else if("audio"==f.contentType){if(g=f.w.filter(function(a){return _d(a)}),0==g.length){j("No initial audio streams to select.");continue}g=f.w[Math.floor(g.length/2)]}else 0<f.w.length&&(g=f.w[0]);d(g),c[f.contentType]=g}return c}function uf(a,b){var c,d={};for(c in b){var e=b[c],f="text"==c?wf(a):vf(a,e);if(!f)return g("Failed to create",ae(e),"stream."),la(d).forEach(function(a){a.destroy()}),!1;d[c]=f}return a.c=d,!0}function vf(a,b){d(a.f);var c=new ge(a,a.f,a.g,ae(b),a.pa);return c.N(a.U),c}function wf(a){return d(a.f),new qe(a,a.f)}function xf(a,b,c){a.Eb=a.f.playbackRate,a.f.playbackRate=0,zf(a,c);var e;a.N&&a.N<=c.end&&a.N>=c.start?e=a.N:a.N&&c.start>a.N?e=a.N+c.start:a.a.b?(d(c.end!=Number.POSITIVE_INFINITY),e=c.end,a.zb=!0):e=c.start,i("Starting each stream from",e),wa(a.i,a.f,"seeking",a.xc.bind(a)),a.f.currentTime!=e&&(a.f.currentTime=e,a.j=e,j("Ignoring pending seek to",a.j)),Af(a,c.start,c.end),c=[];for(var f in a.c){e=a.c[f],c.push(e.bc(a.ua)),wa(a.i,e,"ended",a.Ac.bind(a));var h=b[f];ue(a.s,h),e.Ma(h,!1)}Promise.all(c).then(a.ic.bind(a)).catch(Ia(a,function(a){d("aborted"!=a.type),a.hc=!0,"destroy"!=a.type&&(g("Stream startup failed!"),a=ia(a),this.dispatchEvent(a))})),a.rb(a.va)}function yf(a,b,c){j("beginPlayback_"),b=Df(a,b),d(b,"Stream limits should not be null."),b&&(zf(a,b),Af(a,b.start,b.end)),0!=c?(j("Adjusting video.currentTime by",c,"seconds."),c=a.f.currentTime+c,a.f.currentTime=c,a.j=c,j("Ignoring pending seek to",a.j)):c=a.f.currentTime,d(null!=c),b&&(a.a.b&&c<b.start-1e-5&&j("correctedCurrentTime ("+c+")","is outside of the stream limits before beginning playback!"),(!a.a.b&&c<b.start-1e-5||c>b.end+1e-5)&&g("correctedCurrentTime ("+c+")","should be within the stream limits",[b.start,b.end])),a.zb&&b&&(j("Jumping to live across",b.end-a.f.currentTime,"seconds"),a.f.currentTime=b.end),a.f.playbackRate=a.Eb,a.a.b&&null!=a.a.f&&(d(null==a.u),mf(a,0)),Ef(a),a.ua.resolve()}function zf(a,b){if(d("open"==a.g.readyState,"The MediaSource should be in the 'open' state."),a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592e3);else if(isNaN(a.g.duration)||b.end>a.g.duration){j("Setting MediaSource duration to",b.end),a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}function Af(a,b,c){var d=ha({type:"seekrangechanged",bubbles:!0,start:b,end:c});k("Seek range",[b,c],c-b),a.dispatchEvent(d)}function Bf(a,b,c,d){if(b>=c-.01)return!1;if(b=0,a.a.b){b=.5;for(var e in a.c)if(!a.c[e].Ub(c+b)){b=a.a.c;break}}return a.f.currentTime=Math.min(c+b,d),!0}function Cf(a){return la(a.c).map(function(a){return a.Lb()}).filter(function(a){return null!=a})}function Df(a,b){d(a.a);for(var c=0,e=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=0;g<b.length;++g){var h=b[g].cb(),c=Math.max(c,h.start);null!=h.end&&(e=Math.min(e,h.end)),b[g].length()&&(f=Math.min(f,b[g].F().a))}if(e==Number.POSITIVE_INFINITY){if(e=a.a.a[0],!e.b)return j("Failed to compute a stream end time."),null;e=(e.start||0)+e.b}return a.a.b&&(e=Math.max(e-a.a.c,c)),c>e?(j("The streams' media timelines do not intersect."),null):{start:c,end:e,F:f}}function Ef(b){b.a.b&&(d(null==b.la),b.la=a.setTimeout(b.Cc.bind(b),1e3))}function Ff(a){for(var b in a.c)a.c[b].N(a.U)}function Gf(a,b,c,d){this.s=b,this.l=c,this.u=d,this.a=[],this.g=0,this.c=this.b=this.h=null,this.j=a,this.f=null}function Hf(a,b,c,e,f){d(null!=b.start),d(c.m),d(c.m.c),d(0<c.m.v),d(c.m.B),this.b=a,this.c=b,this.f=c,this.h=e,this.a=null,this.g=f}function If(a){this.a=a}function Jf(a,b,c){for(var d=T()/1e3,e=0;e<b.a.length;++e)for(var g=b.a[e],j=0;j<g.J.length;++j){var k=g.J[j];if("text"!=k.contentType)for(var l=0;l<k.I.length;++l){var m=k.I[l],n=0,n=n+(m.b?1:0),n=n+(m.a?1:0),n=n+(m.m?1:0);0==n?(h("Representation does not contain any segment information:","the Representation must contain one of SegmentBase,","SegmentList, or SegmentTemplate.",m),k.I.splice(l,1),--l):1!=n&&(h("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",m),m.b?(i("Using SegmentBase by default."),m.a=null,m.m=null):m.a?(i("Using SegmentList by default."),m.m=null):f())}}for(Kf(b),e=0;e<b.a.length;++e)for(g=b.a[e],j=0;j<g.J.length;++j){for(l=k=g.J[j],m=null,n=0;n<l.I.length;++n){var o=l.I[n].f||"";m?o!=m&&(h("Representation does not have the same MIME type as other","Representations within its AdaptationSet.",l.I[n]),l.I.splice(n,1),--n):m=o}0==k.I.length&&(g.J.splice(j,1),--j)}for("dynamic"==b.type&&null==b.b&&(h("The MPD is 'dynamic' but @availabilityStartTime is not specified:","treating @availabilityStartTime as if it were the current time."),b.b=d),e=new ee,"dynamic"==b.type&&(e.b=!0,e.f=b.h,e.g=new yd(c,b.l||b.url),e.h=b.b),e.c=b.i||5,g=0;g<b.a.length;++g){if(j=b.a[g],null==j.start){h("Skipping Period",g+1,"and any subsequent Periods:","Period",g+1,"does not have a valid start time.",j);break}j=Lf(a,b,j,d,c),e.a.push(j)}return e}function Kf(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null),b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,e=!0,f=0;f<a.a.length;++f){var g=a.a[f-1],i=a.a[f],j=a.a[f+1]||{start:a.c};!b(i.start)&&g&&b(g.start)&&b(g.a)&&(i.start=g.start+g.a),!b(i.a)&&b(j.start)&&(i.a=j.start-i.start),null!=i.start&&null!=i.a?c+=i.a:e=!1}b(a.c)?a.c!=c&&h("@mediaPresentationDuration does not match the total duration of all","Periods."):(f=a.a[a.a.length-1],e?(d(b(f.start)&&b(f.a)),d(c==f.start+f.a),a.c=c):b(f.start)&&b(f.a)?(h("Some Periods may not have valid start times or durations."),a.c=f.start+f.a):"dynamic"!=a.type&&(h("Some Periods may not have valid start times or durations;","@mediaPresentationDuration may not include the duration of all","periods."),a.c=c))}}function Lf(a,b,c,e,f){d(null!=c.start);var g=new de;g.id=c.id,g.start=c.start,g.b=c.a;var h=new ra;c.J.forEach(function(a){h.push(a.contentType||"",a)});for(var i=ua(h),j=0;j<i.length;++j){var k=new ra;h.get(i[j]).forEach(function(a){k.push(a.group,a)});for(var l=ua(k),m=0;m<l.length;++m){var n=l[m];d(null!=n);var o=new ra;k.get(n).forEach(function(a){o.push(a.lang,a)});for(var n=ua(o),p=0;p<n.length;++p){var q=o.get(n[p]),q=Mf(a,b,c,q,e,f);g.a.push(q)}}}return g}function Mf(a,b,c,e,f,g){d(0<e.length),d(e.every(function(a){return a.group==e[0].group&&(a.lang||"")==(e[0].lang||"")&&(a.contentType||"")==(e[0].contentType||"")}));var i=new be,j=e.filter(function(a){return null!=a.id});j.length==e.length&&(i.id=j.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b})),i.lang=e[0].lang||"",i.contentType=e[0].contentType||"",i.b=e.some(function(a){return a.b});for(var j={},l=0;l<e.length;++l)for(var m=e[l],n=0;n<m.I.length;++n){var o=m.I[n],p=Pf(a,o),q=i.a.slice(0);Of(p,q),0==q.length&&0<i.a.length?h("Representation does not contain any ContentProtection elements","that are compatible with other Representations within its","AdaptationSet or AdaptationSet group.",o):(o=Rf(b,c,o,f,g))&&(i.w.push(o),i.a=q,j[o.G]=m)}if(i.a.some(function(a){return""==a.a}))return i.w.forEach(function(a){a.ga=!0}),i;for(a=Nf(e),l=0;l<i.w.length;++l)o=i.w[l],m=j[o.G],m==a&&(k("Assuming the key system can decrypt stream",o.id+"."),o.ga=!0);return i}function Nf(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.I.length;++f){var g=e.I[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);(null==b||g<b)&&(b=g,c=e)}return c}function Of(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e)if(ob(b[c],a[e])){d=!0,pb(b[c],a[e].b);break}d||(b.splice(c,1),--c)}}function Pf(a,b){var c=[];if(0==b.c.length)c.push(new lb);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Qf(a,b.c[d]));return c}function Qf(a,b){var c=[];if(2!=a.a.length)return g("You must use the new-style ContentProtection interpretation API.","See shaka.player.DashVideoSource.ContentProtectionCallback."),[];var d=a.a(b.c||"",b.f);if(!d)return[];if(!(d instanceof Array))return g("ContentProtection interpretation callback must return","an array of shaka.player.DrmInfo.Config objects."),[];for(var e=0;e<d.length;++e){var f=mb(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&pb(f,[{initData:b.a.psshBox,initDataType:"cenc"}]),c.push(f)}return c}function Rf(a,b,c,e,g){if(!c.A||0===c.A.length)return h("Representation does not contain sufficient segment information:","the Representation must contain a BaseURL.",c),null;var j=null,k=1,l=0,m=0;if(c.b)d(c.b),d(0<c.b.v),j=c.f.split("/")[1],"mp4"!=j&&"webm"!=j?(h("SegmentBase specifies an unsupported container type.",c),j=null):(k=c.b,"webm"!=j||k.c?k.a||k.b&&k.b.a?(l=k.b,l||(l=new Sc,l.url=c.A,l.a=k.a?k.a.clone():null),l=Tf(l,g),k=k.c?Tf(k.c,g):null,a=new se(a,b,j,l,k,e,g),b=new Gd(k),e=new $d,e.S=a,e.O=b,j=e):(h("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",k),j=null):(h("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",k),j=null)),k=c.b.v,l=c.b.D;else if(c.a)d(c.a),j=c.a,!j.b&&!j.B&&1<j.a.length?(h("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",j),j=null):j.b||b.a||j.B||1!=j.a.length?j.B&&0===j.B.P.length?(h("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",j),j=null):(j=j.c?Tf(j.c,g):null,a=new Yd(a,b,c,e,g),b=new Gd(j),e=new $d,e.S=a,e.O=b,j=e):(h("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",j),j=null),k=c.a.v,l=c.a.D;else if(c.m){a:if(d(c.m),j=c.m,k=0+(j.b?1:0),k+=j.B?1:0,k+=j.a?1:0,0==k?(h("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",j),k=!1):(1!=k&&(h("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",j),j.b?(i("Using the index URL template by default."),j.B=null,j.a=null):j.B?(i("Using the SegmentTimeline by default."),j.a=null):f()),k=!0),k){if(k=null,j.f&&(d(c.m),k=(j=c.m.f)?Sf(c,j,Tc):null,!k)){j=null;break a}j=k?Tf(k,g):null,d(c.m),k=c.m,k.b?(d(c.m),d(c.m.b),k=c.f.split("/")[1],"mp4"!=k&&"webm"!=k?(h("SegmentTemplate specifies an unsupported container type.",c),a=null):(l=c.m,"webm"!=k||j?Dd(g,c,1,0)?(d(c.m),(l=(l=c.m.b)?Sf(c,l,Sc):null)?(l=Tf(l,g),a=new se(a,b,k,l,j,e,g)):a=null):a=null:(h("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",l),a=null))):k.c?k.B?a=new Hf(a,b,c,e,g):k.a?"dynamic"!=a.type&&null==b.a?(h("SegmentTemplate does not contain sufficient segment information:","the Period's duration is not known.",c),a=null):a=new Xd(a,b,c,e,g):(f(),a=null):(h("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",c),a=null),a?(b=new Gd(j),e=new $d,e.S=a,e.O=b,j=e):j=null}else j=null;k=c.m.v,l=c.m.D,c.m.B&&c.m.B.P[0]&&c.m.B.P[0].c&&(m=c.m.B.P[0].c)}else"text"==c.f.split("/")[0]?(j=new $d,j.S=new pe(new yd(g,c.A))):f();if(!j)return null;for(j.id=c.id,m?(i("Applying timestamp offset from big integer workaround.",m),j.f=-1*m):l&&(j.f=-1*l/k),j.bandwidth=c.bandwidth,j.width=c.width,j.height=c.height,j.a=c.f||"",j.c=c.g||"",m=0;m<c.c.length;++m)a=c.c[m],a.b&&j.g.push(a.b);return j}function Sf(a,b,c){return d(a.m),(b=Ed(b,a.id,null,a.bandwidth,null))?(c=new c,c.url=zd(a.A,b),c):null}function Tf(a,b){var c=a.url,d=0,e=null;return a.a&&(d=a.a.wa,e=a.a.end),new yd(b,c,d,e)}function Uf(a,b,c,d){c||(c=new Ba),d||(d=new hf),lf.call(this,null,c,d),this.Na=a,this.W=null,this.C=b,this.V=[],this.Fa=[],this.Ga=[],this.l=null}function Vf(a,b,c){b||(b=new Ba),c||(c=new hf),lf.call(this,null,b,c),this.V=a,this.W=[],this.timeoutMs=3e4,this.C={},this.l=this.Z=null}function Wf(a,b,c,d){var e=new xe(a.pa,a);return null!=a.C.segmentRequestTimeout&&ye(e,Number(a.C.segmentRequestTimeout)),Ka(e).then(Ia(a,function(){return ze(e,b,this.W,d,c)})).then(function(a){return La(e),Promise.resolve(a)}).catch(function(a){return La(e),Promise.reject(a)})}function Xf(a){var b=new xe(null,null);return Ka(b).then(Ia(a,function(){return Ae(b,this.V)})).then(function(){return La(b),Promise.resolve()}).catch(function(a){return La(b),Promise.reject(a)})}function Yf(b){var c=document.createElement("video");c.src=a.URL.createObjectURL(b.g);var d=new He(null,c,b);return null!=b.C.licenseRequestTimeout&&Se(d,Number(b.C.licenseRequestTimeout)),b.da().then(function(){return d.initialize()}).then(Ia(b,function(){return Ie(d,this.timeoutMs)})).then(function(){return Je(d)}).then(Ia(b,function(){return d.destroy(),this.destroy(),Promise.resolve()})).catch(Ia(b,function(a){return d.destroy(),this.destroy(),Promise.reject(a)}))}function Zf(a,b){this.b=a,this.a=b}function $f(a,b,c,d){Bd.call(this,a,b),this.u=new qc(c),this.a=c||null,this.f=null,this.a&&this.a.a&&(this.f="highest"==this.a.a?this.l:"lowest"==this.a.a?this.s:this.j),
this.h=d,this.g=null}function _f(a,b){return"static"===b.type&&b.a&&a.f&&b.a.forEach(function(a){var b=this.f(a);try{0<b&&(i("Found missing presentationTimeOffset from segment start offset, based on the configured "+this.a.a+" policy.",b),a.J.forEach(function(a){a.m.D||(a.m.D=b*(a.m.v||1)),a.I&&a.I.forEach(function(a){a.m&&!a.m.D&&(a.m.D=b*(a.m.v||1))})}))}catch(b){h("Attempt of fixing presentationTimeOffset in manifest failed. Trying to continue anyway.",b,a)}}.bind(a)),i("MPD",b),b}function ag(a,b,c,d,e,f){Uf.call(this,a,b,c,d),this.Db=f||null,this.Oa=e,this.Z=null}var bg,cg=this;cg.COMPILED=!1,console.assert||(console.assert=function(){}),d=function(a,b){var c=b;if(!a&&!c)try{throw Error()}catch(a){c=a.stack.split("\n")[2]}console.assert(a,c)},e=console.assert.bind(console,!1,"Not implemented."),f=console.assert.bind(console,!1,"Unreachable reached."),m("error"),m("warn"),m("info"),m("log"),m("debug"),b("shaka.log.setLevel",function(a){function b(){}g=1<=a?console.error.bind(console):b,h=2<=a?console.warn.bind(console):b,i=3<=a?console.info.bind(console):b,j=4<=a?console.log.bind(console):b,k=5<=a?console.debug.bind(console):b,l=6<=a?console.debug.bind(console):b}),b("shaka.log.Level",{NONE:0,ERROR:1,Uc:2,Rc:3,Qc:4,Sc:5,Tc:6}),b("shaka.log.Level.NONE",0),b("shaka.log.Level.ERROR",1),b("shaka.log.Level.WARNING",2),b("shaka.log.Level.INFO",3),b("shaka.log.Level.DEBUG",4),b("shaka.log.Level.V1",5),b("shaka.log.Level.V2",6),g=console.error.bind(console),h=console.warn.bind(console),i=console.info.bind(console);var dg=a.performance&&a.performance.now?a.performance.now.bind(a.performance):function(){return(new Date).getTime()},eg={};b("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}),r.prototype.clone=function(){var a=new r;return a.maxHeight=this.maxHeight,a.minHeight=this.minHeight,a.maxWidth=this.maxWidth,a.maxBandwidth=this.maxBandwidth,a.minBandwidth=this.minBandwidth,a},b("shaka.player.Restrictions",r),b("shaka.player.TextStyle",s),s.prototype.a=function(){var b=a.localStorage.getItem("ShakaPlayerTextStyle");if(b){var c;try{c=JSON.parse(b)}catch(a){return void h("Loaded garbage from TextStyle storage!")}if(c&&"object"==typeof c){var d,b=c;for(d in b)d in this&&(this[d]=b[d])}else h("Loaded non-object from TextStyle storage!")}},s.prototype.load=s.prototype.a,s.prototype.b=function(){a.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))},s.prototype.store=s.prototype.b;var fg=[255,255,255],gg=[0,0,0];s.StandardColors={WHITE:fg,BLACK:gg,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var hg=1;s.StandardOpacities={OPAQUE:hg,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var ig=[];s.EdgeStyles={NONE:ig,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]},b("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0}),b("shaka.player.VideoTrack.compare",x),b("shaka.polyfill.CustomEvent.install",y),b("shaka.polyfill.Fullscreen.install",A),E.prototype.createSession=function(){},E.prototype.setServerCertificate=function(){},F.prototype.getConfiguration=function(){},F.prototype.createMediaKeys=function(){};var jg=0;b("shaka.polyfill.Promise.install",H),G.prototype.then=function(a,b){var c=new G;switch(this.ia){case 1:M(this,c,a);break;case 2:M(this,c,b);break;case jg:this.c.push({mb:c,Za:a}),this.b.push({mb:c,Za:b})}return c},G.prototype.then=G.prototype.then,G.prototype.catch=function(a){return this.then(void 0,a)},G.prototype.catch=G.prototype.catch,G.prototype.oa=function(a){if(this.ia==jg){for(this.Wa=a,this.ia=1,a=0;a<this.c.length;++a)M(this,this.c[a].mb,this.c[a].Za);this.c=[],this.b=[]}},G.prototype.a=function(a){if(this.ia==jg){for(this.Wa=a,this.ia=2,a=0;a<this.b.length;++a)M(this,this.b[a].mb,this.b[a].Za);this.c=[],this.b=[]}};var kg=null,lg=[];b("shaka.polyfill.VideoPlaybackQuality.install",Q);var mg,ng=0,og=1,pg={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};fa.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b,this.a+=a};var qg=1,rg=2,sg={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};ra.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]},ra.prototype.set=function(a,b){this.a[a]=b},ra.prototype.get=function(a){return(a=this.a[a])?a.slice():null},va.prototype.destroy=function(){xa(this),this.a=null},va.prototype.Ea=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.Ea(),ta(this.a,b,e))}},ya.prototype.Ea=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)},b("shaka.util.FakeEventTarget",za),za.prototype.addEventListener=function(a,b,c){d(!c),c||this.Xa.push(a,b)},za.prototype.removeEventListener=function(a,b,c){d(!c),c||ta(this.Xa,a,b)},za.prototype.dispatchEvent=function(a){if(a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}})),a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return Aa(this,a)},c(Ba,za),b("shaka.util.EWMABandwidthEstimator",Ba),Ba.prototype.sample=function(a,b){if(!(2e4>b)){a=Math.max(a,50);var c=8e3*b/a,d=a/1e3;this.a.sample(d,c),this.c.sample(d,c),this.dispatchEvent(ha({type:"bandwidth"})),this.b=(new Date).getTime()}},Ba.prototype.getBandwidth=function(){return.5>this.a.a?5e5:Math.min(ga(this.a),ga(this.c))},Ba.prototype.getDataAge=function(){return((new Date).getTime()-this.b)/1e3},Ba.prototype.supportsCaching=function(){return!1},Ca.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy",this.reject(a)},Ea.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0,this.b.unshift(function(){}),Ga(this,void 0)},Ea.prototype.end=function(){this.b.splice(1)},c(Ja,za),c(Sa,Ja);var tg=1/60;Xa.prototype.destroy=function(){ab(this).catch(function(){}),this.f&&this.f.destroy(),this.a=this.f=null,this.g&&(La(this.g),this.g=null),this.b=null,this.l.destroy(),this.h=this.c=this.l=null},Xa.prototype.j=function(){k(fb(this),"abort_"),this.f&&"open"==this.h.readyState&&this.c.abort()},Xa.prototype.C=function(){k(fb(this),"onSourceBufferUpdateEnd_"),this.f&&(d(!this.c.updating),this.f.resolve(),this.f=null)},b("shaka.util.Uint8ArrayUtils.toString",gb),b("shaka.util.Uint8ArrayUtils.fromString",hb),b("shaka.util.Uint8ArrayUtils.toBase64",function(b,c){var d=void 0==c||c,e=a.btoa(gb(b)).replace(/\+/g,"-").replace(/\//g,"_");return d?e:e.replace(/=*$/,"")}),b("shaka.util.Uint8ArrayUtils.fromBase64",ib),b("shaka.util.Uint8ArrayUtils.fromHex",function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=a.parseInt(b.substr(d,2),16);return c}),b("shaka.util.Uint8ArrayUtils.toHex",jb),tb.prototype.createMediaKeys=function(){j("v01b.MediaKeySystemAccess.createMediaKeys");var a=new ub(this.a);return Promise.resolve(a)},tb.prototype.getConfiguration=function(){return j("v01b.MediaKeySystemAccess.getConfiguration"),this.b},bg=ub.prototype,bg.createSession=function(a){j("v01b.MediaKeys.createSession");var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");return a=this.b||document.createElement("video"),a.src||(a.src="about:blank"),b=new xb(a,this.g,b),this.c.push(b),b},bg.setServerCertificate=function(){return j("v01b.MediaKeys.setServerCertificate"),Promise.reject(Error("setServerCertificate not supported on this platform."))},bg.Hc=function(a){j("v01b.onWebkitNeedKey_",a),d(this.b),a=ha({type:"encrypted",initDataType:"webm",initData:a.initData}),this.b.dispatchEvent(a)},bg.Gc=function(a){j("v01b.onWebkitKeyMessage_",a);var b=wb(this,a.sessionId);b?(a=ha({type:"message",messageType:void 0==b.keyStatuses.eb()?"licenserequest":"licenserenewal",message:a.message}),j("v01b.MediaKeySession.generated"),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a)):g("Session not found",a.sessionId)},bg.Ec=function(a){j("v01b.onWebkitKeyAdded_",a),a=wb(this,a.sessionId),d(a),a&&(j("v01b.MediaKeySession.ready"),zb(a,"usable"),a.a&&a.a.resolve(),a.a=null)},bg.Fc=function(a){j("v01b.onWebkitKeyError_",a);var b=wb(this,a.sessionId);if(d(b),b){j("v01b.MediaKeySession.handleError",a);var c=Error("EME v0.1b key error");c.errorCode=a.errorCode,c.errorCode.systemCode=a.systemCode,!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?zb(b,"output-restricted"):1==c?zb(b,"expired"):zb(b,"internal-error"))}},c(xb,za),bg=xb.prototype,bg.xb=function(a,b){if(this.a)this.a.then(this.xb.bind(this,a,b)).catch(this.xb.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=gb(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=ib(d.keys[0].k),d=ib(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.g.webkitAddKey(this.c,c,d,this.sessionId)}catch(a){this.a.reject(a),this.a=null}}},bg.generateRequest=function(a,b){return j("v01b.MediaKeySession.generateRequest"),yb(this,b,null)},bg.load=function(a){return j("v01b.MediaKeySession.load"),"persistent-license"==this.f?yb(this,null,a):Promise.reject(Error("Not a persistent session."))},bg.update=function(a){j("v01b.MediaKeySession.update",a),d(this.sessionId);var b=new Ca;return this.xb(b,a),b},bg.close=function(){if(j("v01b.MediaKeySession.close"),"persistent-license"!=this.f){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.g.webkitCancelKeyRequest(this.c,this.sessionId)}return this.closed.resolve(),this.closed},bg.remove=function(){return j("v01b.MediaKeySession.remove"),"persistent-license"!=this.f?Promise.reject(Error("Not a persistent session.")):this.close()};var ug;bg=Ab.prototype,bg.qb=function(a){this.size=void 0==a?0:1,this.a=a},bg.eb=function(){return this.a},bg.forEach=function(a){this.a&&a(ug,this.a)},bg.get=function(a){if(this.has(a))return this.a},bg.has=function(a){var b=ug;return!(!this.a||!kb(new Uint8Array(a),new Uint8Array(b)))},Db.prototype.createMediaKeys=function(){j("v20140218.MediaKeySystemAccess.createMediaKeys");var a=new Fb(this.keySystem);return Promise.resolve(a)},Db.prototype.getConfiguration=function(){return j("v20140218.MediaKeySystemAccess.getConfiguration"),this.a},Fb.prototype.createSession=function(a){if(j("v20140218.MediaKeys.createSession"),"temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Hb(this.a)},Fb.prototype.setServerCertificate=function(){return j("v20140218.MediaKeys.setServerCertificate"),Promise.reject(Error("setServerCertificate not supported on this platform."))},c(Hb,za),bg=Hb.prototype,bg.generateRequest=function(a,b){j("v20140218.MediaKeySession.generateRequest"),this.a=new Ca;try{this.c=this.g.createSession("video/mp4",new Uint8Array(b),null),wa(this.f,this.c,"mskeymessage",this.rc.bind(this)),wa(this.f,this.c,"mskeyadded",this.pc.bind(this)),wa(this.f,this.c,"mskeyerror",this.qc.bind(this)),Kb(this,"status-pending")}catch(a){this.a.reject(a)}return this.a},bg.load=function(){return j("v20140218.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},bg.update=function(a){j("v20140218.MediaKeySession.update"),this.b=new Ca;try{this.c.update(new Uint8Array(a))}catch(a){this.b.reject(a)}return this.b},bg.close=function(){j("v20140218.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),xa(this.f)}catch(a){this.closed.reject(a)}return this.closed},bg.remove=function(){return j("v20140218.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},bg.rc=function(a){j("v20140218.onMsKeyMessage_",a),d(this.a),this.a&&(this.a.resolve(),this.a=null),a=ha({type:"message",messageType:void 0==this.keyStatuses.eb()?"licenserequest":"licenserenewal",message:a.message.buffer}),this.dispatchEvent(a)},bg.pc=function(a){j("v20140218.onMsKeyAdded_",a),this.a?(j("Simulating completion for a PR persistent license."),d(null==this.b),this.a.resolve(),this.a=null):(d(null!=this.b),this.b&&(Kb(this,"usable"),this.b.resolve(),this.b=null))},bg.qc=function(a){if(j("v20140218.onMsKeyError_",a),a=Error("EME v20140218 key error"),a.errorCode=this.c.error,null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Kb(this,"output-not-allowed");default:Kb(this,"internal-error")}};var vg;bg=Lb.prototype,bg.qb=function(a){this.size=void 0==a?0:1,this.a=a},bg.eb=function(){return this.a},bg.forEach=function(a){this.a&&a(vg,this.a)},bg.get=function(a){if(this.has(a))return this.a},bg.has=function(a){var b=vg;return!(!this.a||!kb(new Uint8Array(a),new Uint8Array(b)))},b("shaka.polyfill.MediaKeys.install",Mb),b("shaka.polyfill.installAll",function(){y(),A(),Q(),H(),Mb()});var wg=Rb(9007199254740992);Math.log(9007199254740992),Nb.a=function(a){return"undefined"==typeof a?Nb[0]:pc(a)},Ob.prototype=Object.create(Nb.prototype),Pb.prototype=Object.create(Nb.prototype),Ob.prototype.add=function(a){if(a=pc(a),this.sign!==a.sign)return this.ra(a.na());var b=this.value,c=a.value;return a.R?new Ob(Yb(b,Math.abs(c)),this.sign):new Ob(Xb(b,c),this.sign)},Pb.prototype.add=function(a){a=pc(a);var b=this.value;if(0>b!==a.sign)return this.ra(a.na());var c=a.value;if(a.R){if(Qb(b+c))return new Pb(b+c);c=Rb(Math.abs(c))}return new Ob(Yb(c,Math.abs(b)),0>b)},Ob.prototype.ra=function(a){var b=pc(a);if(this.sign!==b.sign)return this.add(b.na());a=this.value;var c=b.value;return b.R?a=$b(a,Math.abs(c),this.sign):(b=this.sign,0<=ic(a,c)?a=Zb(a,c):(a=Zb(c,a),b=!b),a=Sb(a),"number"==typeof a?(b&&(a=-a),a=new Pb(a)):a=new Ob(a,b)),a},Pb.prototype.ra=function(a){a=pc(a);var b=this.value;if(0>b!==a.sign)return this.add(a.na());var c=a.value;return a.R?new Pb(b-c):$b(c,Math.abs(b),0<=b)},Ob.prototype.na=function(){return new Ob(this.value,!this.sign)},Pb.prototype.na=function(){var a=new Pb(-this.value);return a.sign=!this.sign,a},Ob.prototype.abs=function(){return new Ob(this.value,!1)},Pb.prototype.abs=function(){return new Pb(Math.abs(this.value))},Ob.prototype.multiply=function(a){var b=pc(a);a=this.value;var c=b.value,d=this.sign!==b.sign;if(b.R){if(0===c)return Nb[0];if(1===c)return this;if(-1===c)return this.na();if(c=Math.abs(c),1e7>c)return new Ob(ac(a,c),d);c=Rb(c)}var b=a.length,e=c.length;return 0<-.012*b-.012*e+15e-6*b*e?new Ob(cc(a,c),d):new Ob(_b(a,c),d)},Ob.prototype.cc=Ob.prototype.multiply,Pb.prototype.Cb=function(a){return Qb(a.value*this.value)?new Pb(a.value*this.value):dc(Math.abs(a.value),Rb(Math.abs(this.value)),this.sign!==a.sign)},Ob.prototype.Cb=function(a){return 0===a.value?Nb[0]:1===a.value?this:-1===a.value?this.na():dc(Math.abs(a.value),this.value,this.sign!==a.sign)},Pb.prototype.multiply=function(a){return pc(a).Cb(this)},Pb.prototype.cc=Pb.prototype.multiply,Ob.prototype.ac=function(){return new Ob(ec(this.value),!1)},Pb.prototype.ac=function(){var a=this.value*this.value;return Qb(a)?new Pb(a):new Ob(ec(Rb(Math.abs(this.value))),!1)},Ob.prototype.pow=function(a){var b=pc(a),c=this.value;a=b.value;var d;if(0===a)return Nb[1];if(0===c)return Nb[0];if(1===c)return Nb[1];if(-1===c)return b.xa()?Nb[1]:Nb[-1];if(b.sign)return Nb[0];if(!b.R)throw Error("The exponent "+b.toString()+" is too large.");if(this.R&&Qb(d=Math.pow(c,a)))return new Pb(Vb(d));for(d=this,b=Nb[1];1&a&&(b=b.cc(d),--a),0!==a;)a/=2,d=d.ac();return b},Pb.prototype.pow=Ob.prototype.pow,Ob.prototype.compare=function(a){return 1/0===a?-1:-(1/0)===a?1:(a=pc(a),this.sign!==a.sign?a.sign?1:-1:a.R?this.sign?-1:1:ic(this.value,a.value)*(this.sign?-1:1))},Pb.prototype.compare=function(a){if(1/0===a)return-1;if(-(1/0)===a)return 1;a=pc(a);var b=this.value,c=a.value;return a.R?b==c?0:b>c?1:-1:0>b!==a.sign?0>b?-1:1:0>b?1:-1},Ob.prototype.$a=function(a){return 0===this.compare(a)},Pb.prototype.$a=Ob.prototype.$a,Ob.prototype.Ua=function(a){return 0<this.compare(a)},Pb.prototype.Ua=Ob.prototype.Ua,Ob.prototype.ib=function(a){return 0>this.compare(a)},Pb.prototype.ib=Ob.prototype.ib,Ob.prototype.xa=function(){return 0===(1&this.value[0])},Pb.prototype.xa=function(){return 0===(1&this.value)},Ob.prototype.hb=function(){return this.sign},Pb.prototype.hb=function(){return 0>this.value},Ob.prototype.Nb=function(){return!1},Pb.prototype.Nb=function(){return 1===Math.abs(this.value)},Ob.prototype.Ia=function(){return!1},Pb.prototype.Ia=function(){return 0===this.value},Ob.prototype.next=function(){var a=this.value;return this.sign?$b(a,1,this.sign):new Ob(Yb(a,1),this.sign)},Pb.prototype.next=function(){var a=this.value;return 9007199254740992>a+1?new Pb(a+1):new Ob(wg,!1)},Ob.prototype.lb=function(){var a=this.value;return this.sign?new Ob(Yb(a,1),!0):$b(a,1,this.sign)},Pb.prototype.lb=function(){var a=this.value;return-9007199254740992<a-1?new Pb(a-1):new Ob(wg,!0)};for(var xg=[1];1e7>=xg[xg.length-1];)xg.push(2*xg[xg.length-1]);var yg=xg.length,zg=xg[yg-1];Ob.prototype.shiftLeft=function(a){if(!jc(a))throw Error(String(a)+" is too large for shifting.");if(a=+a,0>a)return this.ub(-a);for(var b=this;a>=yg;)b=b.multiply(zg),a-=yg-1;return b.multiply(xg[a])},Pb.prototype.shiftLeft=Ob.prototype.shiftLeft,Ob.prototype.ub=function(a){var b;if(!jc(a))throw Error(String(a)+" is too large for shifting.");if(a=+a,0>a)return this.shiftLeft(-a);for(b=this;a>=yg;){if(b.Ia())return b;b=gc(b,zg),b=b[1].hb()?b[0].lb():b[0],a-=yg-1}return b=gc(b,xg[a]),b[1].hb()?b[0].lb():b[0]},Pb.prototype.ub=Ob.prototype.ub,Ob.prototype.toString=function(){for(var a,b=this.value,c=b.length,d=String(b[--c]);0<=--c;)a=String(b[c]),d+="0000000".slice(a.length)+a;return(this.sign?"-":"")+d},Pb.prototype.toString=function(){return String(this.value)},Ob.prototype.valueOf=function(){return+this.toString()},Ob.prototype.wb=Ob.prototype.valueOf,Pb.prototype.valueOf=function(){return this.value},Pb.prototype.wb=Pb.prototype.valueOf;for(var Ag=0;1e3>Ag;Ag++)Nb[Ag]=new Pb(Ag),0<Ag&&(Nb[-Ag]=new Pb(-Ag));Nb.i=Nb[1],Nb.l=Nb[0],Nb.h=Nb[-1],Nb.max=lc,Nb.min=mc,Nb.b=nc,Nb.g=function(a,b){return a=pc(a).abs(),b=pc(b).abs(),hc(a,nc(a,b)).multiply(b)},Nb.f=Qb,Nb.c=function(a){return a instanceof Ob||a instanceof Pb},Nb.j=function(a,b){a=pc(a),b=pc(b);var c=mc(a,b),d=lc(a,b).ra(c);if(d.R)return c.add(Math.round(Math.random()*d));for(var e=[],f=!0,g=d.value.length-1;0<=g;g--){var h=f?d.value[g]:1e7,i=Vb(Math.random()*h);e.unshift(i),i<h&&(f=!1)}return e=Sb(e),c.add("number"==typeof e?new Pb(e):new Ob(e,!1))},b("shaka.vimond.dash.ManifestModificationSetup",function(a,b,c){this.c=a||null,this.b=c||null,this.a=b||null}),sc.prototype.sample=function(a,b){var c,d=Math.pow(this.f,a);this.a.push(b),c=b,3<this.a.length&&(b<this.i&&2<this.a.map(this.g).filter(this.j.bind(this)).length&&(i("Dramatic change in samples detected.",(this.a[0]/1e3).toFixed(2),(c/1e3).toFixed(2)),c=Math.min.apply(Math,this.a)),this.a.shift()),c!==b?this.b=c:this.b=b*(1-d)+d*this.b,this.c+=a},sc.prototype.g=function(a,b,c){return(a-c[0])/c[0]},sc.prototype.j=function(a){return a<this.h},c(uc,za),b("shaka.vimond.PessimisticBandwidthEstimator",uc),uc.prototype.sample=function(a,b){if(!(2e4>b)){a=Math.max(a,50);var c=8e3*b/a,d=a/1e3;this.a.sample(d,c),this.c.sample(d,c),this.dispatchEvent(ha({type:"bandwidth"})),this.b=Date.now()}},uc.prototype.getBandwidth=function(){return.5>this.a.c?this.f:Math.min(tc(this.a),tc(this.c))},uc.prototype.getDataAge=function(){return(Date.now()-this.b)/1e3},uc.prototype.supportsCaching=function(){return!1},b("shaka.vimond.dash.ReplacementRule",function(a,b,c){this.a=a,this.b=c||null,this.ba=b});var Bg=/((type="static"|availabilityStartTime="([A-Z]|[0-9]|-|\+|:|\.)+")((.|\n)*) t="[0-9]{16,}")/,Cg=/(type)="static"|(availabilityStartTime)="(?:.*?)"|<(SegmentTemplate) |(presentationTimeOffset)="[0-9]*?"|(timescale)="[0-9]*?"| (t)="[0-9]*?"/g,Dg={type:function(a,b){var c=100,d=c;return a.Ja&&a.Ja.$&&(c=a.Ja.$,d=a.Ja.fa,i("Switching to dynamic to static manifest. Applying big int workaround start offsets kept from live state.",a.Ja)),{sa:{Xc:!0,$:c,fa:d},ba:b}},availabilityStartTime:function(a,b){var c,d,e,f=b;try{c=wc(b),d=new Date(c).getTime()/1e3}catch(a){h("Parse date failed.",a)}return d&&(e=86400*(Math.floor(d/86400)-1),f='availabilityStartTime="'+new Date(1e3*e).toISOString()+'" _availabilityStartTime="'+c+'"'),{sa:{$:d,fa:e},ba:f}},SegmentTemplate:function(a,b){return{sa:{Sa:1,Ra:0},ba:b}},timescale:function(a,b){var c;try{c=parseInt(wc(b),10)}catch(a){h("Parse timescale failed.",a)}return{sa:{Sa:c},ba:b}},presentationTimeOffset:function(a,b){var c;try{c=parseInt(wc(b),10)}catch(a){h("Parse presentationTimeOffset failed.",a)}return{sa:{Ra:c},ba:'presentationTimeOffset="0"'}},t:function(a,b){var c=b;try{var d=wc(b)||0,e=Nb.a(d||0).ra(a.Ra||0).add((a.$-a.fa)*a.Sa).wb(),f=a.fa+hc(Nb.a(a.Ra),a.Sa).wb()-a.$,c=' t="'+e+'" _t="'+d+'" _timestampOffset="'+f.toString()+'"';i("Adjusting start offset to JS compatible integer, and keeping the old big one.",c),i("Original/adjusted availability start time",new Date(1e3*a.$),new Date(1e3*a.fa))}catch(a){h("Start offset adjustment failed.",a)}return{sa:{},ba:c}}},Eg=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;bg=yc.prototype,bg.ca="",bg.ta="",bg.ha="",bg.za=null,bg.aa="",bg.qa="",bg.toString=function(){var a=[],b=this.ca;if(b&&a.push(Dc(b,Fg,!0),":"),b=this.ha){a.push("//");var c=this.ta;c&&a.push(Dc(c,Fg,!0),"@"),a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.za,null!=b&&a.push(":",String(b))}return(b=this.aa)&&(this.ha&&"/"!=b.charAt(0)&&a.push("/"),a.push(Dc(b,"/"==b.charAt(0)?Hg:Gg,!0))),(b=this.a.toString())&&a.push("?",b),(b=this.qa)&&a.push("#",Dc(b,Jg)),a.join("")},bg.resolve=function(a){var b=this.clone();"data"===b.ca&&(b=new yc);var c=!!a.ca;c?zc(b,a.ca):c=!!a.ta,c?b.ta=a.ta:c=!!a.ha,c?b.ha=a.ha:c=null!=a.za;var d=a.aa;if(c)Ac(b,a.za);else if(c=!!a.aa){if("/"!=d.charAt(0))if(this.ha&&!this.aa)d="/"+d;else{var e=b.aa.lastIndexOf("/");-1!=e&&(d=b.aa.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}return c?b.aa=d:c=""!==a.a.toString(),c?Bc(b,a.a.clone()):c=!!a.qa,c&&(b.qa=a.qa),b},bg.clone=function(){return new yc(this)};var Fg=/[#\/\?@]/g,Gg=/[\#\?:]/g,Hg=/[\#\?]/g,Ig=/[\#\?@]/g,Jg=/#/g;bg=Fc.prototype,bg.X=null,bg.Qa=null,bg.add=function(a,b){if(!this.X&&(this.X={},this.Qa=0,this.a))for(var c=this.a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d],f=decodeURIComponent(f.replace(/\+/g," ")),g=g||"",this.add(f,decodeURIComponent(g.replace(/\+/g," ")))}return this.a=null,(c=this.X.hasOwnProperty(a)&&this.X[a])||(this.X[a]=c=[]),c.push(b),this.Qa++,this},bg.toString=function(){if(this.a)return this.a;if(!this.X)return"";var a,b=[];for(a in this.X)for(var c=encodeURIComponent(a),d=this.X[a],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e])),b.push(f)}return this.a=b.join("&")},bg.clone=function(){var a=new Fc;if(a.a=this.a,this.X){var b,c={};for(b in this.X)c[b]=this.X[b].concat();a.X=c,a.Qa=this.Qa}return a},Rc.prototype.clone=function(){var a=new Rc;return a.A=hd(this.A),a.v=this.v,a.D=this.D,a.a=id(this.a),a.b=id(this.b),a.c=id(this.c),a},Sc.prototype.clone=function(){var a=new Sc;return a.url=hd(this.url),a.a=id(this.a),a},Tc.prototype.clone=function(){var a=new Tc;return a.url=hd(this.url),a.a=id(this.a),a},Uc.prototype.clone=function(){var a=new Uc;return a.A=hd(this.A),a.v=this.v,a.D=this.D,a.b=this.b,a.f=this.f,a.c=id(this.c),a.a=hd(this.a)||[],a.B=id(this.B),a},Vc.prototype.clone=function(){var a=new Vc;return a.b=hd(this.b),a.a=id(this.a),a},Wc.prototype.clone=function(){var a=new Wc;return a.v=this.v,a.D=this.D,a.a=this.a,a.g=this.g,a.c=this.c,a.b=this.b,a.f=this.f,a.B=id(this.B),a},Xc.prototype.clone=function(){var a=new Xc;return a.P=hd(this.P)||[],a},Yc.prototype.clone=function(){var a=new Yc;return a.startTime=this.startTime,a.b=this.b,a.c=this.c,a.a=this.a,a.f=this.f,a},Zc.prototype.clone=function(){return new Zc(this.wa,this.end)},Hc.TAG_NAME="MPD",Ic.TAG_NAME="Period",Jc.TAG_NAME="AdaptationSet",Kc.TAG_NAME="Role",Lc.TAG_NAME="ContentComponent",Mc.TAG_NAME="Representation",Nc.TAG_NAME="ContentProtection",Oc.TAG_NAME="cenc:pssh",Pc.TAG_NAME="BaseURL",Qc.TAG_NAME="Location",Rc.TAG_NAME="SegmentBase",Sc.TAG_NAME="RepresentationIndex",Tc.TAG_NAME="Initialization",Uc.TAG_NAME="SegmentList",Vc.TAG_NAME="SegmentURL",Wc.TAG_NAME="SegmentTemplate",Xc.TAG_NAME="SegmentTimeline",Yc.TAG_NAME="S",Hc.prototype.parse=function(a,b){this.url=a.Rb,this.id=jd(b,"id",qd),this.type=jd(b,"type",qd)||"static",this.c=jd(b,"mediaPresentationDuration",ld),this.i=jd(b,"minBufferTime",ld,this.i),this.h=jd(b,"minimumUpdatePeriod",ld,this.h),this.b=jd(b,"availabilityStartTime",kd,this.b),this.j=jd(b,"_availabilityStartTime",kd,this.j),this.f=jd(b,"timeShiftBufferDepth",ld,this.f),this.g=jd(b,"suggestedPresentationDelay",ld,this.g);var c=a.A,d=fd(this,b,Pc);this.A=ad(c,d),(d=dd(this,b,Qc))&&(this.l=bd(c,d.url)),this.a=fd(this,b,Ic)},Ic.prototype.parse=function(a,b){this.id=jd(b,"id",qd),this.start=jd(b,"start",ld),this.a=jd(b,"duration",ld);var c=fd(this,b,Pc);this.A=ad(a.A,c),this.b=dd(this,b,Rc),this.c=dd(this,b,Uc),this.m=dd(this,b,Wc),this.J=fd(this,b,Jc),_c(this)},Jc.prototype.parse=function(a,b){var c=dd(this,b,Lc)||{},d=dd(this,b,Kc);this.id=jd(b,"id",qd),this.group=jd(b,"group",pd),this.lang=jd(b,"lang",qd,c.lang),this.contentType=jd(b,"contentType",qd,c.contentType),this.width=jd(b,"width",od),this.height=jd(b,"height",od),this.a=jd(b,"mimeType",qd),this.g=jd(b,"codecs",qd),this.b=d&&"main"==d.value,this.lang&&(this.lang=ka(this.lang)),c=fd(this,b,Pc),this.A=ad(a.A,c),this.h=fd(this,b,Nc),!this.contentType&&this.a&&(this.contentType=this.a.split("/")[0]),this.c=a.b?cd(this,b,a.b):dd(this,b,Rc),this.f=a.c?cd(this,b,a.c):dd(this,b,Uc),this.m=a.m?cd(this,b,a.m):dd(this,b,Wc),this.I=fd(this,b,Mc),!this.a&&this.I.length&&(this.a=this.I[0].f,!this.contentType&&this.a&&(this.contentType=this.a.split("/")[0]))},Kc.prototype.parse=function(a,b){this.value=jd(b,"value",qd)},Lc.prototype.parse=function(a,b){this.id=jd(b,"id",qd),this.lang=jd(b,"lang",qd),this.contentType=jd(b,"contentType",qd),this.lang&&(this.lang=ka(this.lang))},Mc.prototype.parse=function(a,b){this.id=jd(b,"id",qd),this.bandwidth=jd(b,"bandwidth",od),this.width=jd(b,"width",od,a.width),this.height=jd(b,"height",od,a.height),this.f=jd(b,"mimeType",qd,a.a),this.g=jd(b,"codecs",qd,a.g),this.lang=a.lang;var c=fd(this,b,Pc);this.A=ad(a.A,c),this.c=fd(this,b,Nc),this.b=a.c?cd(this,b,a.c):dd(this,b,Rc),this.a=a.f?cd(this,b,a.f):dd(this,b,Uc),this.m=a.m?cd(this,b,a.m):dd(this,b,Wc),this.c=this.c.concat(a.h)},Nc.prototype.parse=function(a,b){this.f=b,this.c=jd(b,"schemeIdUri",qd);var c=jd(b,"cenc:default_KID",qd);c&&(this.b=c.replace(/[-]/g,"")),this.a=dd(this,b,Oc)},Oc.prototype.parse=function(a,b){var c=gd(b);if(c){this.psshBox=ib(c);try{this.parsedPssh=new Bb(this.psshBox)}catch(a){if(!(a instanceof RangeError))throw a}}},Pc.prototype.parse=function(a,b){this.url=gd(b)},Qc.prototype.parse=function(a,b){this.url=gd(b)},Rc.prototype.parse=function(a,b){this.A=a.A||this.A,this.v=jd(b,"timescale",od,this.v),this.D=jd(b,"presentationTimeOffset",pd,this.D),this.a=jd(b,"indexRange",md,this.a),this.b=dd(this,b,Sc)||this.b,this.c=dd(this,b,Tc)||this.c},Sc.prototype.parse=function(a,b){var c=jd(b,"sourceURL",qd);this.url=bd(a.A,c),this.a=jd(b,"range",md,id(a.a))},Tc.prototype.parse=function(a,b){var c=jd(b,"sourceURL",qd);this.url=bd(a.A,c),this.a=jd(b,"range",md)},Uc.prototype.parse=function(a,b){this.A=a.A||this.A,this.v=jd(b,"timescale",od,this.v),this.D=jd(b,"presentationTimeOffset",pd,this.D),this.b=jd(b,"duration",od,this.b);var c=jd(b,"startNumber",od);null!=c&&(this.f=c),this.c=dd(this,b,Tc)||this.c,this.a=(c=fd(this,b,Vc))&&0<c.length?c:this.a,this.B=dd(this,b,Xc)||this.B},Vc.prototype.parse=function(a,b){var c=jd(b,"media",qd);this.b=bd(a.A,c),this.a=jd(b,"mediaRange",md)},Wc.prototype.parse=function(a,b){this.v=jd(b,"timescale",od,this.v),this.D=jd(b,"presentationTimeOffset",pd,this.D),this.a=jd(b,"duration",od,this.a);var c=jd(b,"startNumber",pd);null!=c&&(this.g=c),this.c=jd(b,"media",qd,this.c),this.b=jd(b,"index",qd,this.b),this.f=jd(b,"initialization",qd,this.f),this.B=dd(this,b,Xc)||this.B},Xc.prototype.parse=function(a,b){this.P=fd(this,b,Yc)},Yc.prototype.parse=function(a,b){this.startTime=jd(b,"t",pd),this.a=jd(b,"d",pd),this.f=jd(b,"r",nd),this.b=jd(b,"_t",qd),this.c=jd(b,"_timestampOffset",nd)};var Kg=!0,Lg=!1;bg=rd.prototype,bg.$b=function(){if(d(null==this.a),this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var b=this.url.split(":")[1].split(";").pop().split(","),c=b.pop(),c="base64"==b.pop()?a.atob(c.replace(/-/g,"+").replace(/_/g,"/")):a.decodeURIComponent(c);
return"arraybuffer"==this.b.h&&(c=hb(c).buffer),b=JSON.parse(JSON.stringify(new XMLHttpRequest)),b.response=c,b.responseText=c.toString(),c=this.c,c.resolve(b),td(this),c}if(0==this.url.lastIndexOf("idb:",0))return d(!0),vd(this);this.h++,this.i=(new Date).getTime(),this.g||(this.g=this.b.j),this.a=new XMLHttpRequest,b=this.url,Kg&&(this.f&&!this.f.supportsCaching()||this.b.f)&&(b=new yc(b),b.a.add("_",(new Date).getTime()),b=b.toString()),this.a.open(this.b.method,b,!0),this.a.responseType=this.b.h,this.a.timeout=this.b.c,this.a.withCredentials=this.b.i,this.a.onload=this.nc.bind(this),this.b.f&&(this.a.onreadystatechange=this.vc.bind(this)),this.a.onerror=this.Mc.bind(this),this.a.ontimeout=this.Bc.bind(this);for(c in this.b.b)this.a.setRequestHeader(c,this.b.b[c]);return this.a.send(this.b.body),this.c},bg.nc=function(a){d(a.target==this.a),this.f&&this.f.sample((new Date).getTime()-this.i,a.loaded),200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),td(this)):this.h<this.b.a&&404!=this.a.status?xd(this):(a=wd(this,"HTTP error.","net"),this.c.reject(a),td(this))},bg.vc=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){d(this.b.f);var a=Date.parse(this.a.getResponseHeader("Date"));a&&(ng=a-(new Date).getTime())}},bg.Mc=function(a){d(a.target==this.a),a=wd(this,"Network failure.","net"),this.c.reject(a),td(this)},bg.Bc=function(){if(this.h<this.b.a)xd(this);else{var a=wd(this,"Request timed out.","net");this.c.reject(a),td(this)}},bg=yd.prototype,bg.Mb=function(){return"idb"==this.a[0].ca},bg.ea=function(a,b){if(this.b)return this.b;var c=a||new sd;return(this.g||this.h)&&(c.b.Range="bytes="+(this.g+"-"+(null!=this.h?this.h:""))),d(!this.c),this.b=Ad(this,0,c,b)},bg.Pa=function(){if(this.c){this.b=null;var a=this.c;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){d(0!=a.a.readyState),a.a.abort();var b=wd(a,"Request aborted.","aborted");a.c.reject(b),td(a)}this.f=this.c=null}},bg.clone=function(){return new yd(this.i,this.a.map(function(a){return a.clone()}),this.g,this.h)},bg.toString=function(){return this.a[0].toString()},Bd.prototype.c=function(){var a=this.i;return a.ea(this.b).then(function(b){return(b=Gc(b,a.a,[a.f]))?Promise.resolve(b):(b=Error("MPD parse failure."),b.type="dash",Promise.reject(b))})},Gd.prototype.destroy=function(){this.a&&(this.a.Pa(),this.a=null),this.b=null},Gd.prototype.create=function(){return this.a?this.a.ea():Promise.resolve(this.b)},Md.prototype.parse=function(a,b,c,e){var f=null;try{a:{var h=[],i=new U(a),j=X(i);if(1936286840!=X(i))g('Invalid box type, expected "sidx".'),f=null;else{1==j&&(j=Y(i));var k=W(i);$(i,3),$(i,4);var l=X(i);if(d(0!=l),0==l)g("Invalid timescale."),f=null;else{var m,n;0==k?(m=X(i),n=X(i)):(m=Y(i),n=Y(i)),$(i,2);var o=i.b.getUint16(i.a,i.c);for(i.a+=2,a=m,b=b+j+n,j=0;j<o;j++){var p=X(i);n=(2147483648&p)>>>31;var k=2147483647&p,q=X(i);if(X(i),1==n){g("Heirarchical SIDXs are not supported."),f=null;break a}var r=new yd(e,c,b,b+k-1);h.push(new Hd(a/l,(a+q)/l,r)),a+=q,b+=k}f=h}}}}catch(a){if(!(a instanceof RangeError))throw a}return f},Nd.prototype.destroy=function(){this.o=null},bg=Nd.prototype,bg.length=function(){return this.o.length},bg.F=function(){if(0==this.o.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.o[this.o.length-1]},bg.get=function(a){if(0>a||a>=this.o.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.o[a]},bg.Ca=function(a){return a=Jd(this.o,a),0<=a?this.o[a]:null},bg.gb=function(a){return Pd(this,a),!0},bg.Ba=function(a){var b=a-this.l;return 0==b?(l("Already applied timestamp correction of",a,"seconds to",this),0):(this.o=Kd(this.o,b),Ld(this.o),this.l=a,j("Applied timestamp correction of",a,"seconds to SegmentIndex",this),b)},bg.cb=function(){return 0<this.length()?{start:Od(this).startTime,end:this.F().a}:{start:0,end:0}},c(Qd,Nd),Qd.prototype.destroy=function(){this.u=this.h=null,Nd.prototype.destroy.call(this)},Qd.prototype.Ca=function(a){return Td(this,T()/1e3),Nd.prototype.Ca.call(this,a)},Qd.prototype.gb=function(a){return a instanceof Qd?(Pd(this,a),this.i=Math.max(this.i,a.i),null==this.b?(this.g=a.g,Rd(this)):Ud(this),!0):(h("Cannot integrate SegmentIndex:","Only a LiveSegmentIndex can be integrated into","another LiveSegmentIndex.",this),!1)},Qd.prototype.Ba=function(a){var b=Nd.prototype.Ba.call(this,a),c=Math.min.apply(null,this.o.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.startTime}));return Math.abs(b)>c&&h("Timestamp correction ("+a+")","is unreasonably large for live content.","The content may have errors in it."),null!=this.b&&(d(null!=this.f),d(null!=this.a),this.f+=b,this.a+=b,this.b+=b,d(this.f<=this.b)),b},Qd.prototype.cb=function(){return Sd(this,T()/1e3)},c(Vd,Qd),Vd.prototype.destroy=function(){this.C=this.K=null,Qd.prototype.destroy.call(this)},Vd.prototype.Ca=function(a){var b=T()/1e3;return Wd(this,b),Td(this,b),Nd.prototype.Ca.call(this,a)},Vd.prototype.gb=function(a){return null!=this.c?(j("Ignoring SegmentIndex integration.",this),!1):a instanceof Vd?null!=a.c&&(this.c=a.c,this.j=a.j,this.s=a.s,this.g=a.g,this.i=a.i,Pd(this,a),Wd(this,T()/1e3),Rd(this),!0):(h("Cannot integrate SegmentIndex:","Only a DynamicLiveSegmentIndex can be integrated into","another DynamicLiveSegmentIndex.",this),!1)},Vd.prototype.Ba=function(a){return a=Qd.prototype.Ba.call(this,a),null!=this.c&&(d(null!=this.j),this.c+=a,this.j+=a),a},Vd.prototype.cb=function(){var a=T()/1e3;return Wd(this,a),Sd(this,a)},Xd.prototype.destroy=function(){this.g=this.f=this.b=this.c=null,this.a&&(this.a.destroy(),this.a=null)},Xd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.c.type)try{this.a=new Vd(this.c,this.b,this.f,this.h,this.g)}catch(a){return Promise.reject(a)}else{d("static"==this.c.type);var a;if(a=this.f.m,a=Cd(this.g,this.f,1,Math.ceil(this.b.a/(a.a/a.v)))){if(0<a.length){var b=a[a.length-1];d(b.startTime<=this.b.a),d(b.a>=this.b.a),a[a.length-1]=Id(b,b.startTime,this.b.a)}a=new Nd(a)}else a=null;if(this.a=a,!this.a)return a=Error("Failed to generate SegmentReferences"),a.type="stream",Promise.reject(a)}return Promise.resolve(this.a)},Yd.prototype.destroy=function(){this.f=this.g=this.b=this.c=null,this.a&&(this.a.destroy(),this.a=null)},Yd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.a,b=[];a.B&&(b=Fd(a.B,a.v||1,this.b.a||0));var c=0;a.b&&a.f?c=(a.f-1)*a.b:0<b.length&&(c=b[0].start-(a.D||0));var e=a.a.length;0<b.length&&b.length!=a.a.length&&(e=Math.min(b.length,a.a.length),h("The length of the segment timeline and segment","urls does not match, truncating",a.a.length,"to",e));for(var f=[],g=0;g<e;++g){var i=a.a[g];d(0<=c);var j=c/a.v,k=null,l=null;a.b?(k=c+a.b,l=k/a.v):0<b.length?(k=b[g].end-(a.D||0),l=k/a.v):(d(1==a.a.length),d(this.b.a),l=j+this.b.a,k=l*a.v);var c=k,k=0,m=null;i.a&&(k=i.a.wa,m=i.a.end),f.push(new Hd(j,l,new yd(this.f,i.b,k,m)))}return"dynamic"==this.c.type?this.a=new Qd(f,this.c,this.b,this.h):(d("static"==this.c.type),this.a=new Nd(f)),Promise.resolve(this.a)},Zd.prototype.destroy=function(){this.b=null,this.a&&(this.a.destroy(),this.a=null)},Zd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new Hd(c.start_time,c.end_time,new yd(null,[new yc(c.url)],c.start_byte,null)))}return this.b=null,this.a=new Nd(a),Promise.resolve(this.a)};var Mg=0;$d.prototype.destroy=function(){this.S&&(this.S.destroy(),this.S=null),this.O&&(this.O.destroy(),this.O=null)};var Ng=0;be.prototype.destroy=function(){for(var a=0;a<this.w.length;++a)this.w[a].destroy();this.a=this.w=null},de.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null},ee.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null},c(ge,za),ge.prototype.N=function(a){if(null!=a.initialStreamBufferSize&&(this.L=Number(a.initialStreamBufferSize)),null!=a.streamBufferSize&&(this.Y=Number(a.streamBufferSize)),null!=a.segmentRequestTimeout){var b=this.a;a=Number(a.segmentRequestTimeout),d(!isNaN(a)),b.u=a}},ge.prototype.destroy=function(){ne(this),this.s.destroy(),this.i=this.s=null,this.a.destroy(),this.K=this.j=this.a=null},bg=ge.prototype,bg.Ha=function(){return this.i},bg.Lb=function(){return this.H},bg.bc=function(a){return this.c||a.then(function(){d(this.h),d(!this.c),d(!this.l),j(oe(this),"proceeding..."),this.c=!0,this.b||me(this,0)}.bind(this)).catch(function(a){d("destroy"==a.type)}),this.s},bg.fb=function(){return this.l},bg.Ma=function(a,b,c){if(d(a.a==this.T,"The stream's type must match the Stream's SourceBuffer's type."),a==this.i)j(oe(this),"already using stream",a);else{var e=[a.S.create(),a.O.create()];Promise.all(e).then(Ia(this,function(e){if(this.j){var f=this.i;this.i=a,this.H=e[0],this.C=e[1],this.U=!0,this.f||(f?b?he(this,!0,c):d(null!=this.b||this.g):me(this,0))}})).catch(Ia(this,function(a){"aborted"!=a.type&&(this.c?(a=ia(a),this.dispatchEvent(a)):this.s.reject(a))}))}},bg.Tb=function(){return j(oe(this),"resync"),he(this,!1)},bg.Ub=function(a){return 0<Ya(this.a,a)&&0<=Jd(this.a.b,a)},bg.Va=function(){},bg.bb=function(){return!0},bg.Dc=function(){if(l(oe(this),"onUpdate_"),d(this.i),d(this.H),d(null!=this.b&&!this.f),d(!this.g),this.h&&!this.c)k(oe(this),"waiting to proceed..."),this.b=null;else if(this.c&&!this.l&&bb(this.a))he(this,!0);else{this.b=null;var a=this.i,b=this.H,c=this.j.currentTime;Ya(this.a,this.h?c:c+(this.u||0))>=(this.h?Math.max(this.L,this.Y):this.L)?(k(oe(this),"buffering goal reached."),je(this),me(this,1e3/(Math.abs(this.j.playbackRate)||1))):(b=ie(this,c,b))?(this.g=!0,this.C&&k(oe(this),"appending initialization data..."),k(oe(this),"fetching segment",b),b=Za(this.a,b,a.f,this.C),this.C=null,this.U&&(this.U=!1,ke(this,a)),this.l=!1,b.then(Ia(this,function(a){k(oe(this),"fetch done."),d(null==this.b&&!this.f),d(this.g),this.g=!1,null==this.u&&(d(!this.h),d(null!=a),this.u=a),this.M&&(.01>=this.j.currentTime||0<Ya(this.a,c))&&(j(oe(this),"applying nudge..."),this.M=!1,this.j.currentTime+=.001),me(this,0)})).catch(Ia(this,function(a){if(this.g=!1,"aborted"==a.type)k(oe(this),"fetch aborted."),d(!this.a||this.f);else{var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.xhr.status)&&this.i&&(i(oe(this),"retrying segment request in 5 seconds..."),me(this,5e3)),a=ia(a),this.dispatchEvent(a)}}))):(k(oe(this),"new segment is not needed or is not available."),je(this),this.c&&!this.l&&(d(this.h),j(oe(this),"stream has ended."),this.l=!0,le(this)),me(this,1e3))}},pe.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)},pe.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Hd(0,null,this.b);return this.a=new Nd([a]),Promise.resolve(this.a)},c(qe,za),qe.prototype.N=function(){},qe.prototype.destroy=function(){this.a&&this.b.removeChild(this.a),this.c.destroy(),this.K=this.b=this.f=this.h=this.a=this.c=null},bg=qe.prototype,bg.Ha=function(){return this.f},bg.Lb=function(){return this.h},bg.bc=function(){return this.c},bg.fb=function(){return!0},bg.Ma=function(a){i("Switching stream to",a),a.S.create().then(Ia(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a,this.h=b,b=Od(b).url.a[0].toString();var d=this.bb();this.a&&(this.Va(!1),this.b.removeChild(this.a)),this.a=document.createElement("track"),this.b.appendChild(this.a),this.a.src=b,this.Va(d),b=ha({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth}),this.dispatchEvent(b),c||this.c.resolve(0)}}))},bg.Tb=function(){},bg.Ub=function(){return!0},bg.Va=function(a){this.g=a,this.a&&(this.a.track.mode=a?"showing":"disabled")},bg.bb=function(){return this.a&&(this.g="showing"==this.a.track.mode),this.g},re.prototype.parse=function(a,b,c,e){var f=null;try{var i,j=new _(b);if(440786851!=aa(j).id)g("EBML element does not exist."),i=null;else{var k=aa(j);if(408125543!=k.id)g("Segment element does not exist."),i=null;else{var l,m=k.a.byteOffset,n=new _(k.a);for(b=null;V(n.a);){var o=aa(n);if(357149030==o.id){b=o;break}}if(b){for(var p=new _(b.a),n=1e6;V(p.a);){var q=aa(p);if(2807729==q.id){n=da(q);break}}l=n/1e9}else g("Info element does not exist."),l=null;i=l?{Jc:m,Nc:l}:null}}if(i){var r=aa(new _(a));if(475249515!=r.id)g("CuesElement does not exist."),f=null;else{var s=i.Jc,t=i.Nc;a=[];var u=new _(r.a);for(i=r=-1;V(u.a);){var v=aa(u);if(187==v.id){var w,x=new _(v.a),y=aa(x);if(179!=y.id)h("CueTime element does not exist."),w=null;else{var z=da(y),A=aa(x);if(183!=A.id)h("CueTrackPositions element does not exist."),w=null;else{for(var B=new _(A.a),m=0;V(B.a);){var C=aa(B);if(241==C.id){m=da(C);break}}w={Pc:z,Ic:m}}}if(w){var D=t*w.Pc,E=s+w.Ic;if(0<=r){d(0<=i);var F=new yd(e,c,i,E-1);a.push(new Hd(r,D,F))}r=D,i=E}}}0<=r&&(d(0<=i),F=new yd(e,c,i,null),a.push(new Hd(r,null,F))),f=a}}else f=null}catch(a){if(!(a instanceof RangeError))throw a}return f},se.prototype.destroy=function(){this.h=this.i=this.f=null,this.a.Pa(),this.a=null,this.c&&(this.c.Pa(),this.c=null),this.b=null},se.prototype.create=function(){if(this.b)return this.b;var a=[this.a.ea()];return"webm"==this.g&&a.push(this.c.ea()),this.b=Promise.all(a).then(Ia(this,function(a){var b=a[0];a=a[1]||null;var c=null;return"mp4"==this.g?(c=new Md,c=c.parse(new DataView(b),this.a.g,this.a.a,this.h)):"webm"==this.g?(d(a),c=new re,c=c.parse(new DataView(b),new DataView(a),this.a.a,this.h)):f(),c?("dynamic"==this.f.type?b=new Qd(c,this.f,this.i,this.j):(d("static"==this.f.type),b=new Nd(c)),Promise.resolve(b)):(b=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),b.type="stream",Promise.reject(b))}))},c(xe,Ja),xe.prototype.g=function(a,b,c){var d=new Ca;a={stream_id:c.La,mime_type:a.a,codecs:a.c,init_segment:b,references:c.o};var e=Oa(this).put(a);return e.onsuccess=function(){d.resolve(c.La)},e.onerror=function(){d.reject(e.error)},d},xe.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(Ia(this,function(a){return Ee(this,b.La),Promise.reject(a)}))},xe.prototype.c=function(a,b,c,d){var e=new Ca;0==b.Aa.byteLength&&(b.ab=a),b.Aa=De(b.Aa,d),b.Sb++;var f=ha({type:"progress",detail:b.Sb/b.Oc*100,bubbles:!0});if(1048576<=b.Aa.byteLength||c){c={stream_id:b.La,segment_id:b.nb,content:b.Aa};var g=Na(this).put(c);b.o.push({start_time:b.ab.startTime,start_byte:b.ab.url.g,end_time:a.a,url:"idb://"+b.La+"/"+b.nb}),b.nb++,b.Aa=new ArrayBuffer(0),g.onerror=function(){e.reject(g.error)},g.onsuccess=Ia(this,function(){this.dispatchEvent(f),e.resolve()})}else this.dispatchEvent(f),e.resolve();return e},xe.prototype.i=function(a){var b=new sd;return b.c=1e3*this.b,a.url.ea(b,this.j)},c(He,za),He.prototype.destroy=function(){this.K=null;for(var b=0;b<this.g.length;++b)this.g[b].close().catch(function(){});this.g=[],this.f=this.a=this.i=null,this.h.destroy(),this.h=null,this.j.destroy(),this.j=null,this.l&&(a.clearTimeout(this.l),this.l=null),this.b=this.c=null},He.prototype.initialize=function(){d(null==this.i),d(null==this.b.mediaKeys),d(null==this.a);for(var a=new ra,b=this.c.Kb(),c=0;c<b.length;++c){var e=b[c];d(null!=e.a),e.a.a||e.b&&!Ue(e.b)||a.push(e.contentType,e)}for(var c={},e=!1,f=0;f<b.length;++f){var g=b[f];if(d(null!=g.a),g.a.a&&!a.a.hasOwnProperty(g.contentType)){var h=g.a.a,j=c[h];if(j||(j=g.a,j={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:j.g?"required":"optional",persistentState:j.l||this.c.ya()?"required":"optional",sessionTypes:[this.c.ya()?"persistent-license":"temporary"]},c[h]=j),g.b&&(h=g.contentType+"Capabilities",h in j)){e=!0,j[h]||(j[h]=[]);var k;"audio"==g.contentType?k=g.a.f:"video"==g.contentType&&(k=g.a.j),j[h].push({contentType:g.b,robustness:k}),i("MKSC",j)}}}if(!e){if(!b.length)throw a=Error("No DrmInfo exists!"),a.type="drm",a;this.a=b[0].a}return 0==Object.keys(c).length?(this.c.ob(a),this.h.resolve(),Promise.resolve()):(k=new Ca,c=Ke(this,c,k),c=c.then(this.fc.bind(this,b,a)),k.reject(null),c)},bg=He.prototype,bg.fc=function(a,b,c){if(!this.b)return Me();for(var e=c.keySystem,f=c.getConfiguration(),g=["audio","video"],h=0;h<g.length;++h){var i=g[h];if(!b.a.hasOwnProperty(i)){var j=f[i+"Capabilities"];if(j){for(var j=j[0],k=[],l={},m=0;m<a.length;++m){var n=a[m],o=j?n.b==j.contentType:n.contentType==i;n.a.a!=e||!o||n.id in l||(k.push(n),l[n.id]=!0,this.a=this.a?nb(this.a,n.a):n.a)}d(k.length),b.set(i,k)}}}return this.c.ob(b),c.createMediaKeys().then(function(a){this.i=a}.bind(this))},bg.uc=function(a){j("Received premature encrypted event."),this.u.push(a)},bg.jb=function(a){d(a.initData);var b=new Uint8Array(a.initData);i("onEncrypted_",b,a);for(var c=0;c<this.f.length;++c)if(kb(b,this.f[c].data))return void j("License request already generated!");try{var e=Pe(this)}catch(a){return b=ia(a),this.dispatchEvent(b),void this.h.reject(a)}a=e.generateRequest(a.initDataType,a.initData),this.f.push({data:b,pb:e}),a.catch(Ia(this,function(a){if(this.b){for(var b=0;b<this.f.length;++b)if(this.f[b].pb==e){this.f.splice(b,1);break}b=ia(a),this.dispatchEvent(b),this.h.reject(a)}})),this.g.push(e)},bg.yc=function(a){i("onSessionMessage_",a),d(this.a),Qe(this,a.target,this.a,a.message)},bg.mc=function(a){j("onKeyStatusesChange_",a),a=a.target;var b={};if(a.keyStatuses.forEach(function(a,c){if("string"==typeof a){var d=a;a=c,c=d}if("com.microsoft.playready"==this.a.a&&16==a.byteLength){var d=new DataView(a),e=d.getUint32(0,!0),f=d.getUint16(4,!0),g=d.getUint16(6,!0);d.setUint32(0,e,!1),d.setUint16(4,f,!1),d.setUint16(6,g,!1)}d=jb(new Uint8Array(a)),b[d]=c}.bind(this)),a.expiration<(new Date).getTime()){j("Session has expired",a);for(var c=0;c<this.f.length;++c)if(this.f[c].pb==a){this.f.splice(c,1);break}a.close(),a=this.g.indexOf(a),d(0<=a),this.g.splice(a,1)}this.c.Ob(b)},c(Te,za),b("shaka.player.Player",Te),Te.version="vimond-uniplayer-shaka-1.7.5-14-g0ca3b13-dirty",Te.isBrowserSupported=function(){return!!(a.MediaSource&&a.MediaKeys&&a.navigator&&a.navigator.requestMediaKeySystemAccess&&a.MediaKeySystemAccess&&a.MediaKeySystemAccess.prototype.getConfiguration&&a.Promise&&Element.prototype.requestFullscreen&&document.exitFullscreen&&"fullscreenElement"in document&&a.Uint8Array)},Te.isTypeSupported=Ue,Te.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");for(b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b)),b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+t(a)+" }",0)},Te.prototype.destroy=function(){return this.l().then(Ia(this,function(){this.f.destroy(),this.a=this.f=null})).catch(function(){})},Te.prototype.destroy=Te.prototype.destroy,Te.prototype.l=function(){if(!this.b)return Promise.resolve();this.h&&Ze(this),this.a.pause(),xa(this.f),Ye(this),We(this),this.i&&(this.i.destroy(),this.i=null),this.a.src="";var a=this.a.setMediaKeys(null);return this.b&&(this.b.destroy(),this.b=null),this.h=!1,this.g=new te,a},Te.prototype.unload=Te.prototype.l,Te.prototype.pa=function(a){var b=this.l();return d(null==this.b),d(null==this.i),this.a.autoplay&&(n("load"),wa(this.f,this.a,"timeupdate",this.lc.bind(this))),a.ma(this.c),a.Yb(this.L),this.L=null,b=b.then(Ia(this,function(){return a.da()})),b.catch(Ia(this,function(b){return a.destroy(),Promise.reject(b)})),b.then(Ia(this,function(){return this.a?(this.b=a,wa(this.f,this.b,"seekrangechanged",this.wc.bind(this)),this.M&&wa(this.f,this.b,"error",this.zc.bind(this)),this.i=new He(this,this.a,this.b),this.i.initialize()):Ve()})).then(Ia(this,function(){return this.a?(wa(this.f,this.a,"error",this.Kc.bind(this)),wa(this.f,this.a,"playing",this.tc.bind(this)),wa(this.f,this.a,"pause",this.sc.bind(this)),this.b.Vb(this,this.a)):Ve()})).then(Ia(this,function(){return this.a?Le(this.i):Ve()})).then(Ia(this,function(){return this.a?void Xe(this):Ve()})).catch(Ia(this,function(a){if(!this.a)return Ve();if("destroy"!=a.type){var b=ia(a);this.dispatchEvent(b)}return this.l().then(function(){return Promise.reject(a)})}))},Te.prototype.load=Te.prototype.pa,bg=Te.prototype,bg.zc=function(a){!a.detail||"net"!=a.detail.type||a.detail.hc||!this.b.tb()||404!=a.detail.status&&403!=a.detail.status||(i("404 or 403 on live stream. Shutting down."),this.l(),a=ha({type:"ended"}),this.dispatchEvent(a))},bg.lc=function(){o("load"),this.g.playbackLatency=p("load")/1e3,this.f.Ea(this.a,"timeupdate")},bg.Kc=function(a){if(this.a.error){var b=this.a.error.code;b!=MediaError.MEDIA_ERR_ABORTED&&(j("onError_",a,b),a=Error(Og[b]||"Unknown playback error."),a.type="playback",a=ia(a),this.dispatchEvent(a))}else j("Uninterpretable error event!",a)},bg.tc=function(a){j("onPlaying_",a),n("playing"),!this.j&&0>this.s&&(this.a.playbackRate=0,this.C(this.a.currentTime,(new Date).getTime(),this.s)),this.h&&Ze(this)},bg.sc=function(a){if(j("onPause_",a),o("playing"),a=p("playing"),!isNaN(a)){var b=this.g;b.playTime+=a/1e3}We(this)},bg.wc=function(a){this.H=a.start},bg.Zb=function(){if(!this.a.paused){o("playing");var a=p("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1e3,n("playing")}}return a=this.g,b=this.a,b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames),this.g},Te.prototype.getStats=Te.prototype.Zb,Te.prototype.W=function(){return this.b?this.b.Da():[]},Te.prototype.getVideoTracks=Te.prototype.W,Te.prototype.la=function(){return this.b?this.b.Ka():[]},Te.prototype.getAudioTracks=Te.prototype.la,Te.prototype.V=function(){return this.b?this.b.sb():[]},Te.prototype.getTextTracks=Te.prototype.V,Te.prototype.selectVideoTrack=function(a,b){return!!this.b&&this.b.selectVideoTrack(a,void 0==b||b)},Te.prototype.selectVideoTrack=Te.prototype.selectVideoTrack,Te.prototype.Z=function(a,b,c){return!!this.b&&this.b.Wb(a,void 0==b||b,c)},Te.prototype.selectAudioTrack=Te.prototype.Z,Te.prototype.ua=function(a){return!!this.b&&this.b.Xb(a,!1)},Te.prototype.selectTextTrack=Te.prototype.ua,Te.prototype.ka=function(a){this.b&&this.b.rb(a)},Te.prototype.enableTextTrack=Te.prototype.ka,Te.prototype.Y=function(a){We(this),0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.C(this.a.currentTime,(new Date).getTime(),a)),this.s=a},Te.prototype.setPlaybackRate=Te.prototype.Y,Te.prototype.T=function(){return this.s},Te.prototype.getPlaybackRate=Te.prototype.T,Te.prototype.va=function(a){this.L=a},Te.prototype.setPlaybackStartTime=Te.prototype.va,Te.prototype.N=function(){return!!this.b&&this.b.tb()},Te.prototype.isLive=Te.prototype.N,Te.prototype.ja=function(a){if(a){var b=ma(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b),b=na(a,"streamBufferSize"),null!=b&&(this.c.streamBufferSize=b),b=na(a,"liveStreamEndTimeout"),null!=b&&(this.c.liveStreamEndTimeout=b),b=na(a,"licenseRequestTimeout"),null!=b&&(this.c.licenseRequestTimeout=b),b=na(a,"mpdRequestTimeout"),null!=b&&(this.c.mpdRequestTimeout=b),b=na(a,"segmentRequestTimeout"),null!=b&&(this.c.segmentRequestTimeout=b),b=oa(a,"preferredLanguage"),null!=b&&(this.c.preferredLanguage=b),b=qa(a,"restrictions",r),null!=b&&(this.c.restrictions=b.clone()),b=ma(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation"),null!=b&&(Kg=!b),(b=ma(a,"enableWithCredentialsOnHTTP"))&&(Lg=b),a=ma(a,"enableShutdownOnLiveError"),null!=a&&(this.M=a),this.b&&this.b.ma(this.c)}},Te.prototype.configure=Te.prototype.ja,Te.prototype.ma=function(){return this.c},Te.prototype.getConfiguration=Te.prototype.ma,Te.prototype.C=function(b,c,e){d(0>e),d(!this.a.paused),this.j=null;var f=((new Date).getTime()-c)/1e3*e;this.a.currentTime<this.H+(this.N()?1:.05)?this.a.pause():(f=Math.max(this.H,b+f),this.a.currentTime=f,this.j=a.setTimeout(this.C.bind(this,b,c,e),250))},Te.prototype.U=function(){if(Xe(this),!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;this.h?(c=this.b.Jb(),(b||a>c)&&(Ze(this),this.a.play())):!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(T()/1e3),n("buffering"),j("Buffering..."),this.dispatchEvent(ha({type:"bufferingStart"})))}};var Og={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};bf.prototype.destroy=function(){this.a.destroy(),this.a=null},bf.prototype.update=function(a){var b=cf(a),c=cf(this.a);return Promise.all([b,c]).then(Ia(this,function(b){var c=b[0];b=b[1];var d=this.a.a;return $e(d),_e(d),a.f=this.a.f,a.g=this.a.g?this.a.g.clone():null,a.c=this.a.c,d=[],df(a,this.a,c,b,d),c=a.a,$e(c),_e(c),Promise.resolve(d)}))},b("shaka.media.SimpleAbrManager",hf),hf.prototype.destroy=function(){this.f.destroy(),this.a=this.b=this.f=null},hf.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)},hf.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=(new Date).getTime()+4e3,wa(this.f,this.b,"bandwidth",this.l.bind(this)),wa(this.f,this.a,"adaptation",this.j.bind(this)),wa(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)},hf.prototype.enable=function(a){this.i=a},hf.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=jf(this);return a?a.id:null},hf.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)},hf.prototype.l=function(){(new Date).getTime()<this.c||this.h()},hf.prototype.h=function(){if(this.i){var a=jf(this);if(a){if(a.active)return void(this.c=(new Date).getTime()+3e3);i("Video adaptation:",a),this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}},hf.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=(new Date).getTime()+4e3)},c(kf,za),b("shaka.player.HttpVideoSource",kf),kf.prototype.ma=function(){},kf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null),this.K=this.b=null},bg=kf.prototype,bg.Vb=function(a,b){this.K=a;var c=b.mediaKeys;return b.src=this.f,c=b.setMediaKeys(c),this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing"),c},bg.da=function(){return Promise.resolve()},bg.Da=function(){return[]},bg.Ka=function(){return[]},bg.sb=function(){return[]},bg.Jb=function(){return 5},bg.Kb=function(){var a=new fe;return a.a=this.b,[a]},bg.ob=function(){},kf.prototype.selectVideoTrack=function(){return!1},bg=kf.prototype,bg.Wb=function(){return!1},bg.Xb=function(){return!1},bg.rb=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")},bg.Yb=function(){},bg.Ta=function(){return[]},bg.ya=function(){return!1},bg.tb=function(){return!1},bg.Ob=function(a){for(var b in a){var c=a[b],d=ea(c);if(d){var e=Da(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm",d.code=c,c=ia(d),this.dispatchEvent(c)}}},c(lf,za),b("shaka.player.StreamVideoSource",lf),lf.prototype.ma=function(a){null!=a.streamBufferSize&&(this.U.streamBufferSize=a.streamBufferSize),null!=a.segmentRequestTimeout&&(this.U.segmentRequestTimeout=a.segmentRequestTimeout),Ff(this),null!=a.enableAdaptation&&this.Y.enable(Boolean(a.enableAdaptation)),null!=a.mpdRequestTimeout&&(this.ka=Number(a.mpdRequestTimeout)),null!=a.liveStreamEndTimeout&&(this.Bb=Number(a.liveStreamEndTimeout)),null!=a.preferredLanguage&&(this.ja=ka(String(a.preferredLanguage))),null!=a.restrictions&&(this.h=a.restrictions,this.M&&of(this))},lf.prototype.destroy=function(){this.T.destroy(),this.ua.destroy(),this.ua=this.T=null,this.la&&(a.clearTimeout(this.la),this.la=null),this.u&&(a.clearTimeout(this.u),this.u=null),this.H=null,this.i.destroy(),this.i=null,la(this.c).forEach(function(a){a.destroy()}),this.b=this.c=null,this.a&&(this.a.destroy(),this.a=null),this.Y.destroy(),this.K=this.h=this.s=this.f=this.g=this.pa=this.Y=null},bg=lf.prototype,bg.Vb=function(b,c){if(!this.M){var d=Error("Cannot call attach() right now.");return d.type="app",Promise.reject(d)}return this.K=b,this.f=c,this.s=b.Zb(),wa(this.i,this.g,"sourceopen",this.oc.bind(this)),wa(this.i,this.pa,"bandwidth",this.Lc.bind(this)),this.a.b&&(wa(this.i,b,"bufferingStart",this.kc.bind(this)),wa(this.i,b,"bufferingEnd",this.jc.bind(this))),d=this.f.mediaKeys,this.f.src=a.URL.createObjectURL(this.g),d=this.f.setMediaKeys(d),Promise.all([this.T,d])},bg.da=function(){if(this.M){var a=Error("Cannot call load() right now.");return a.type="app",Promise.reject(a)}return this.a&&0!=this.a.a.length?(a=this.a.a,$e(a),_e(a),0==this.a.a.length||0==this.a.a[0].a.length?(a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a)):(this.M=!0,this.U.initialStreamBufferSize=this.a.c,Ff(this),of(this),Promise.resolve())):(a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a))},bg.Qb=function(a){d(this.M),d(null!=this.a.f),d(null!=this.a.g),i("Updating manifest...");var b=(new Date).getTime(),c=this.u=null,e=this.a.g;(a?this.Pb():this.kb(e)).then(Ia(this,function(a){return c=new bf(a),this.Ya=a.b,c.update(this.a)})).then(Ia(this,function(a){i("Manifest updated!"),c.destroy(),c=null;for(var d=0;d<a.length;++d)nf(this,a[d]);this.U.initialStreamBufferSize=this.a.c,Ff(this),of(this),0==Object.keys(this.c).length?sf(this):mf(this,((new Date).getTime()-b)/1e3)})).catch(Ia(this,function(a){c&&(c.destroy(),c=null),"aborted"!=a.type&&(a=ia(a),this.dispatchEvent(a),this.a&&mf(this,0))}))},bg.kb=function(){return e(),Promise.reject("Cannot update manifest with this VideoSource implementation.")},bg.Pb=function(){return e(),Promise.reject("Cannot update manifest with this VideoSource implementation.")},bg.Da=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.Ha():null)?a.G:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.w.length;++f){var g=e.w[f];if(_d(g)){var h=g.G,g=new w(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0),b.push(g)}}return b},lf.prototype.getVideoTracks=lf.prototype.Da,lf.prototype.Ka=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.Ha():null)?a.G:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.w.length;++g){var h=e.w[g];if(_d(h)){var i=h.G,h=new q(i,h.bandwidth,f);i==a&&(h.active=!0),b.push(h)}}return b},lf.prototype.getAudioTracks=lf.prototype.Ka,lf.prototype.sb=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.Ha():null,b=b?b.G:0,c=[],e=this.b.get("text"),f=0;f<e.length;++f)for(var g=e[f],h=g.lang,i=0;i<g.w.length;++i){var j=g.w[i].G,k=new v(j,h);j==b&&(k.active=!0,d(null!=a),k.enabled=a.bb()),c.push(k)}return c},lf.prototype.getTextTracks=lf.prototype.sb,lf.prototype.Jb=function(){return Number(this.U.initialStreamBufferSize)},lf.prototype.Kb=function(){var a;if(this.M){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,ce(a.a[c]));a=b}else a=[];return a},lf.prototype.ob=function(a){if(this.M){for(var b={},c=this.a.a[0],e=0;e<c.a.length;++e){var f=c.a[e];b[f.G]=f}for(this.b.a={},c=ua(a),d(c.length,"No configs were selected!"),e=0;e<c.length;++e){var f=c[e],g=a.get(f);if("video"==f){var i=g[0].id;this.b.push(f,b[i])}else if("audio"==f)for(var i=g[0].b.split(";")[0],j=0;j<g.length;++j){var k=g[j];k.b.split(";")[0]==i&&this.b.push(f,b[k.id])}else for(j=0;j<g.length;++j)i=g[j].id,this.b.push(f,b[i])}this.va=!0,(a=this.b.get("audio"))&&(rf(this,a),this.b.set("audio",a),a=a[0].lang||this.ja,ja(2,this.ja,a)&&(this.va=!1)),(a=this.b.get("text"))&&(rf(this,a),this.b.set("text",a),a=a[0].lang||this.ja,ja(2,this.ja,a)||(this.va=!1))}else h("Cannot call selectConfigurations() right now.")},lf.prototype.selectVideoTrack=function(a,b,c){return qf(this,"video",a,b,c);
},bg=lf.prototype,bg.Wb=function(a,b,c){return qf(this,"audio",a,b,c)},bg.Xb=function(a,b){return qf(this,"text",a,b)},bg.rb=function(a){var b=this.c.text;b&&b.Va(a)},bg.Yb=function(a){this.N=a},bg.Ta=function(){return[]},bg.ya=function(){return!1},bg.tb=function(){return null==this.Ya?this.a.b:this.Ya},bg.Ob=function(a){for(var b in a){var c=Da(b);j("Key status:",c+": "+a[b])}for(var d=!1,e=new ra,f=sa(this.b),c=0;c<f.length;++c)for(var g=f[c],k=0;k<g.w.length;++k){var l=g.w[k];l.g.forEach(function(a){e.push(a,l)})}for(b in a)if(f=ea(a[b]),g=e.get(b))for(c=0;c<g.length;++c)l=g[c],k=l.ga,l.ga=!f,k!=l.ga&&(i(l.ga?"Permitting":"Restricting","stream",l.id+".",f||""),d=!0);else c=Da(b),j("Key",c,"was not specified in the manifest."),f&&h("Key",c,"is not usable.",f);d&&(pf(this),b=this.Ka(),a=this.Da(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":"video tracks.")),a.type="drm",a=ia(a),this.dispatchEvent(a))},bg.oc=function(){this.i.Ea(this.g,"sourceopen"),sf(this).then(Ia(this,function(){this.T&&this.T.resolve()})).catch(Ia(this,function(a){this.T&&this.T.reject(a)}))},bg.ic=function(a){i("All Streams have completed startup!"),d(a&&a.length==Object.keys(this.c).length,"There should be a timestamp correction for each Stream.");for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,e=0;e<a.length;++e)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);for(i("Timestamp correction",c),0>b*c&&h("Some streams' media timestamps are ahead of their SegmentIndexes,","while other streams' timestamps are behind.","The content may have errors in it."),a=Cf(this),e=0;e<a.length;++e)a[e].Ba(c);yf(this,a,c),e=sa(this.b).map(function(a){return a.w}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.S.create()];return a.O&&b.push(a.O.create()),Promise.all(b)}),Promise.all(e).then(Ia(this,function(a){for(var b=0;b<a.length;++b)a[b][0].Ba(c);j("Created/fetched all SegmentIndexes and initialization segments!"),this.yb=!0;for(var e in this.H)a=this.H[e],b=this.c[e],d(b),d(this.s),ue(this.s,a.vb),b.Ma(a.vb,a.Fb,a.Gb);this.H={}})).catch(Ia(this,function(a){"aborted"!=a.type&&(a=ia(a),this.dispatchEvent(a))}))},bg.Cc=function(){this.la=null,Ef(this);var b=Df(this,Cf(this));if(d(b,"Stream limits should not be null."),b&&(this.a.b&&this.Ab!=b.F&&(this.Ab=b.F,null!=this.L&&(j("Not the end of the live stream."),a.clearTimeout(this.L),this.L=null)),Af(this,b.start,b.end),!this.f.paused)){var c=this.f.currentTime,e=b.start,b=b.end;Bf(this,c,e,b)&&h("Playhead is outside of the seekable range:","seekable",[e,b],"attempted",c,"Adjusting...")}},bg.xc=function(a){if(k("onSeeking_",a),a=this.f.currentTime,null!=this.j){if(a>=this.j-.01&&a<=this.j+.01)return j("Ignored seek to",this.j),void(this.j=null);this.j=null}var b=Df(this,Cf(this));if(d(b,"Stream limits should not be null."),b){var c,e=b.start,b=b.end;if((c=Bf(this,a,e,b))||(a<=b+.01?c=!1:(this.f.currentTime=b,c=!0)),c)h("Playhead has been moved outside of the seekable range:","seekable",[e,b],"attempted",a,"Adjusting...");else for(var f in this.c)this.c[f].Tb()}},bg.Ac=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].fb())return;this.Ib()}},bg.kc=function(){d(this.a.b),la(this.c).every(function(a){return a.fb()})&&(i("Possible end of live stream."),this.L=a.setTimeout(this.Ib.bind(this),1e3*this.Bb))},bg.jc=function(){d(this.a.b),null!=this.L&&(j("Not the end of the live stream."),a.clearTimeout(this.L),this.L=null)},bg.Lc=function(){d(this.s);var a=this.s,b=this.pa.getBandwidth();a.estimatedBandwidth=b,a.bandwidthHistory.push(new we(b))},bg.Ib=function(){d("open"==this.g.readyState,"The MediaSource should be in the 'open' state.");var a,b=this.g.duration;for(i("Signalling end-of-stream."),this.L=null,this.g.endOfStream(),a=this.g.duration,a!=b&&h("endOfStream() should not modify the MediaSource's duration:","before",b,"after",a,"delta",a-b),b=!1,a=0;a<this.g.sourceBuffers.length;++a)b=this.g.sourceBuffers[a].updating;d(!b,"endOfStream() should not trigger the duration change algorithm.")},c(Gf,yd),Gf.prototype.ea=function(a,b){return this.a.push(Dd(this.j,this.s,this.l,this.u).a[0]),yd.prototype.ea.call(this,a,b)},Gf.prototype.Mb=function(){return!1},Hf.prototype.destroy=function(){this.g=this.f=this.c=this.b=null,this.a&&(this.a.destroy(),this.a=null)},Hf.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.m,b=Fd(a.B,a.v||1,this.c.a||0),c=[],e=0;e<b.length;++e){var f=b[e].start,g=b[e].dc,h=(a.D||0)/a.v;c.push(new Hd(f/a.v-h,b[e].end/a.v-h,new Gf(this.g,this.f,e+a.g,g?g.toString():f)))}return"dynamic"==this.b.type?this.a=new Qd(c,this.b,this.c,this.h):(d("static"==this.b.type),this.a=new Nd(c)),Promise.resolve(this.a)},c(Uf,lf),b("shaka.player.DashVideoSource",Uf),Uf.prototype.ec=function(a,b,c){this.V.push(a),this.Fa.push(b||""),this.Ga.push(c||"")},Uf.prototype.addExternalCaptions=Uf.prototype.ec,Uf.prototype.gc=function(a){this.l=a},Uf.prototype.setNetworkCallback=Uf.prototype.gc,Uf.prototype.destroy=function(){this.W=this.l=this.C=null,lf.prototype.destroy.call(this)},Uf.prototype.da=function(){var a=new yd(this.l,[new yc(this.Na)]);return new Bd(a,this.ka).c().then(Ia(this,function(a){this.W=a;for(var b=0;b<this.V.length;b++)$c(a,this.V[b],this.Fa[b],this.Ga[b]);return this.a=Jf(new If(this.C),a,this.l),lf.prototype.da.call(this)}))},Uf.prototype.kb=function(a){return new Bd(a,this.ka).c().then(Ia(this,function(a){return this.W=a,a=Jf(new If(this.C),a,this.l),Promise.resolve(a)}))},Uf.prototype.Pb=function(){d(this.W);var a=Jf(new If(this.C),this.W,this.l);return Promise.resolve(a)},c(Vf,lf),b("shaka.player.OfflineVideoSource",Vf),Vf.prototype.ma=function(a){null!=a.licenseRequestTimeout&&(this.C.licenseRequestTimeout=a.licenseRequestTimeout),null!=a.segmentRequestTimeout&&(this.C.segmentRequestTimeout=a.segmentRequestTimeout),lf.prototype.ma.call(this,a)},b("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Sa,b=Ka(a).then(function(){return Ta(a)});return b.then(function(){La(a)}).catch(function(){La(a)}),b}),Vf.prototype.Na=function(b,c,e,f){var i,j=null,k={},l=[];return b=new yd(this.Z,[new yc(b)]),new Bd(b,this.ka).c().then(Ia(this,function(a){return this.a=Jf(new If(e),a,this.Z),this.a.b?(a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a)):(this.ma({preferredLanguage:c}),lf.prototype.da.call(this))})).then(Ia(this,function(){var b=document.createElement("video");return b.src=a.URL.createObjectURL(this.g),i=new He(null,b,this),null!=this.C.licenseRequestTimeout&&Se(i,Number(this.C.licenseRequestTimeout)),wa(this.i,i,"sessionReady",this.Fa.bind(this)),wa(this.i,i,"error",function(a){j=a}),i.initialize()})).then(Ia(this,function(){for(var a=sa(this.b),b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.w.length;++d){var e=c.w[d];k[e.G]=e}return f()})).then(Ia(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=k[c];if(!d)return Promise.reject(Error("Invalid stream ID chosen: "+c));l.push(d)}var e=["audio","video"];return l=l.filter(function(a){return!(0>e.indexOf(a.a.split("/")[0]))||(h("Ignoring track ID "+a.G+" due to unsupported type: "+a.a.split("/")[0]),!1)}),a=l.map(function(a){return a.O.create()}),Promise.all(a)})).then(Ia(this,function(a){var b=l;d(b.length==a.length);for(var c=[],e=0;e<b.length;++e)try{c[e]=this.g.addSourceBuffer(ae(b[e]))}catch(a){g("addSourceBuffer() failed",a)}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(e=0;e<a.length;++e)(b=a[e])&&c[e].appendBuffer(b);a=Promise.resolve()}return a})).then(Ia(this,function(){return Ie(i,this.timeoutMs)})).then(Ia(this,function(){if(j)return Promise.reject(j);var a=i.a,b=this.a.a[0].b;return b||h("The duration of the stream being stored is null."),d(b!=Number.POSITIVE_INFINITY),Wf(this,l,a,b)})).then(Ia(this,function(a){return this.V=a,j?(Xf(this),Promise.reject(j)):Promise.resolve(a)}))},b("shaka.player.OfflineVideoSource.prototype.store",Vf.prototype.Na),Vf.prototype.Oa=function(a){this.Z=a},Vf.prototype.setNetworkCallback=Vf.prototype.Oa,Vf.prototype.Fa=function(a){this.W.push(a.detail.sessionId)},Vf.prototype.da=function(){d(0<=this.V);var a,b,c=new Sa;return Ka(c).then(Ia(this,function(){return Ua(c,this.V)})).then(Ia(this,function(d){var e=[];this.W=d.session_ids,a=d.duration,b={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Va(c,d.stream_ids[f]));return Promise.all(e)})).then(Ia(this,function(c){var d=a,e=b,f=new ee;f.c=5;for(var g=new de,h=0;h<c.length;++h){var i=c[h],j=new $d,k=new Zd(i.references),l=new Gd(null,i.init_segment);j.S=k,j.O=l,j.a=i.mime_type,j.c=i.codecs,j.ga=!0,this.l&&(null!=this.l.licenseServerUrl&&(e.licenseServerUrl=this.l.licenseServerUrl),null!=this.l.withCredentials&&(e.withCredentials=this.l.withCredentials),e.licensePostProcessor=this.l.licensePostProcessor,e.licensePreProcessor=this.l.licensePreProcessor,e.serverCertificate=this.l.serverCertificate),i=mb(e),k=new be,k.w.push(j),k.a.push(i),k.contentType=j.a.split("/")[0],g.a.push(k),g.b=d}return f.a.push(g),this.a=f,lf.prototype.da.call(this)})).then(function(){return La(c),Promise.resolve()}).catch(function(a){return La(c),Promise.reject(a)})},Vf.prototype.Ga=function(a,b){d(0<=this.V),a&&(this.l={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return Yf(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(Ia(this,function(){return Xf(this)})).then(function(){return Promise.resolve(c)})},Vf.prototype.deleteGroup=Vf.prototype.Ga,Vf.prototype.Ta=function(){return this.W},Vf.prototype.ya=function(){return!0},c($f,Bd),$f.prototype.c=function(){var a=this.i;return a.ea(this.b).then(function(b){return b=rc(this.u,b),this.a&&this.a.b?(i("Previous state",this.h),b=xc(b,this.h)):b=new Zf(b),b.a&&i("Big int processed state.",b.a),this.g=b.a,(b=Gc(b.b,a.a,[a.f]))?Promise.resolve(_f(this,b)):(b=Error("MPD parse failure."),b.type="dash",Promise.reject(b))}.bind(this))},$f.prototype.j=function(a){var b=0;try{a.J.forEach(function(a){var c=a.m;if(c&&!c.D){var d=c.B&&c.B.P&&c.B.P[0];d.startTime&&(c=d.startTime/(c.v||1),"video"===a.contentType&&(b=c))}})}catch(a){return h("Error when searching for start offset snapping to video segment start.",a),0}return b},$f.prototype.s=function(a){var b=0;try{a.J.forEach(function(a){if((a=a.m)&&!a.D){var c=a.B&&a.B.P&&a.B.P[0];c.startTime&&(a=c.startTime/(a.v||1),b=0===b?a:Math.min(b,a))}})}catch(a){return h("Error when searching for lowest start offset.",a),0}return b},$f.prototype.l=function(a){var b=0;try{a.J.forEach(function(a){if((a=a.m)&&!a.D){var c=a.B&&a.B.P&&a.B.P[0];c.startTime&&(b=Math.max(b,c.startTime/(a.v||1)))}})}catch(a){return h("Error when searching for highest start offset.",a),0}return b},c(ag,Uf),b("shaka.vimond.player.ModifyableDashVideoSource",ag),ag.prototype.da=function(){var a=new yd(this.l,[new yc(this.Na)]),b=new $f(a,this.ka,this.Db,this.Z);return b.c().then(Ia(this,function(a){this.Z=b.g;for(var c=0;c<this.V.length;c++)$c(a,this.V[c],this.Fa[c],this.Ga[c]);this.a=Jf(new If(this.C),a,this.l),c=lf.prototype.da.call(this);try{this.Oa&&a.b&&this.Oa(a.b)}catch(a){h("mpdReady callback failed.",a)}return c}))},ag.prototype.kb=function(a){var b=new $f(a,this.ka,this.Db,this.Z);return b.c().then(Ia(this,function(a){return this.Z=b.g,a=Jf(new If(this.C),a,this.l),Promise.resolve(a)}))}}).bind(a,this)(),this.shaka=a.shaka}(),function(a){"use strict";var b={VERSION:"0.5.3"};b.System=function(){this._mappings={},this._outlets={},this._handlers={},this.strictInjections=!0,this.autoMapOutlets=!1,this.postInjectionHook="setup"},b.System.prototype={_createAndSetupInstance:function(a,b){var c=new b;return this.injectInto(c,a),c},_retrieveFromCacheOrCreate:function(a,b){"undefined"==typeof b&&(b=!1);var c;if(!this._mappings.hasOwnProperty(a))throw new Error(1e3);var d=this._mappings[a];return!b&&d.isSingleton?(null==d.object&&(d.object=this._createAndSetupInstance(a,d.clazz)),c=d.object):c=d.clazz?this._createAndSetupInstance(a,d.clazz):d.object,c},mapOutlet:function(a,b,c){if("undefined"==typeof a)throw new Error(1010);return b=b||"global",c=c||a,this._outlets.hasOwnProperty(b)||(this._outlets[b]={}),this._outlets[b][c]=a,this},getObject:function(a){if("undefined"==typeof a)throw new Error(1020);return this._retrieveFromCacheOrCreate(a)},mapValue:function(a,b){if("undefined"==typeof a)throw new Error(1030);return this._mappings[a]={clazz:null,object:b,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(a),this.hasMapping(a)&&this.injectInto(b,a),this},hasMapping:function(a){if("undefined"==typeof a)throw new Error(1040);return this._mappings.hasOwnProperty(a)},mapClass:function(a,b){if("undefined"==typeof a)throw new Error(1050);if("undefined"==typeof b)throw new Error(1051);return this._mappings[a]={clazz:b,object:null,isSingleton:!1},this.autoMapOutlets&&this.mapOutlet(a),this},mapSingleton:function(a,b){if("undefined"==typeof a)throw new Error(1060);if("undefined"==typeof b)throw new Error(1061);return this._mappings[a]={clazz:b,object:null,isSingleton:!0},this.autoMapOutlets&&this.mapOutlet(a),this},instantiate:function(a){if("undefined"==typeof a)throw new Error(1070);return this._retrieveFromCacheOrCreate(a,!0)},injectInto:function(a,b){if("undefined"==typeof a)throw new Error(1080);if("object"==typeof a){var c=[];this._outlets.hasOwnProperty("global")&&c.push(this._outlets.global),"undefined"!=typeof b&&this._outlets.hasOwnProperty(b)&&c.push(this._outlets[b]);for(var d in c){var e=c[d];for(var f in e){var g=e[f];(!this.strictInjections||f in a)&&(a[f]=this.getObject(g))}}"setup"in a&&a.setup.call(a)}return this},unmap:function(a){if("undefined"==typeof a)throw new Error(1090);return delete this._mappings[a],this},unmapOutlet:function(a,b){if("undefined"==typeof a)throw new Error(1100);if("undefined"==typeof b)throw new Error(1101);return delete this._outlets[a][b],this},mapHandler:function(a,b,c,d,e){if("undefined"==typeof a)throw new Error(1110);return b=b||"global",c=c||a,"undefined"==typeof d&&(d=!1),"undefined"==typeof e&&(e=!1),this._handlers.hasOwnProperty(a)||(this._handlers[a]={}),this._handlers[a].hasOwnProperty(b)||(this._handlers[a][b]=[]),this._handlers[a][b].push({handler:c,oneShot:d,passEvent:e}),this},unmapHandler:function(a,b,c){if("undefined"==typeof a)throw new Error(1120);if(b=b||"global",c=c||a,this._handlers.hasOwnProperty(a)&&this._handlers[a].hasOwnProperty(b)){var d=this._handlers[a][b];for(var e in d){var f=d[e];if(f.handler===c){d.splice(e,1);break}}}return this},notify:function(a){if("undefined"==typeof a)throw new Error(1130);var b=Array.prototype.slice.call(arguments),c=b.slice(1);if(this._handlers.hasOwnProperty(a)){var d=this._handlers[a];for(var e in d){var f,g=d[e];"global"!==e&&(f=this.getObject(e));var h,i,j=[];for(h=0,i=g.length;h<i;h++){var k,l=g[h];k=f&&"string"==typeof l.handler?f[l.handler]:l.handler,l.oneShot&&j.unshift(h),l.passEvent?k.apply(f,b):k.apply(f,c)}for(h=0,i=j.length;h<i;h++)g.splice(j[h],1)}}return this}},a.dijon=b}(this),"undefined"==typeof utils)var utils={};"undefined"==typeof utils.Math&&(utils.Math={}),utils.Math.to64BitNumber=function(a,b){var c,d,e;return c=new goog.math.Long(0,b),d=new goog.math.Long(a,0),e=c.add(d),e.toNumber()},goog={},goog.math={},goog.math.Long=function(a,b){this.low_=0|a,this.high_=0|b},goog.math.Long.IntCache_={},goog.math.Long.fromInt=function(a){if(-128<=a&&a<128){var b=goog.math.Long.IntCache_[a];if(b)return b}var c=new goog.math.Long(0|a,a<0?-1:0);return-128<=a&&a<128&&(goog.math.Long.IntCache_[a]=c),c},goog.math.Long.fromNumber=function(a){return isNaN(a)||!isFinite(a)?goog.math.Long.ZERO:a<=-goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MIN_VALUE:a+1>=goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MAX_VALUE:a<0?goog.math.Long.fromNumber(-a).negate():new goog.math.Long(a%goog.math.Long.TWO_PWR_32_DBL_|0,a/goog.math.Long.TWO_PWR_32_DBL_|0)},goog.math.Long.fromBits=function(a,b){return new goog.math.Long(a,b)},goog.math.Long.fromString=function(a,b){if(0==a.length)throw Error("number format error: empty string");var c=b||10;if(c<2||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return goog.math.Long.fromString(a.substring(1),c).negate();if(a.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+a);for(var d=goog.math.Long.fromNumber(Math.pow(c,8)),e=goog.math.Long.ZERO,f=0;f<a.length;f+=8){var g=Math.min(8,a.length-f),h=parseInt(a.substring(f,f+g),c);if(g<8){var i=goog.math.Long.fromNumber(Math.pow(c,g));e=e.multiply(i).add(goog.math.Long.fromNumber(h))}else e=e.multiply(d),e=e.add(goog.math.Long.fromNumber(h))}return e},goog.math.Long.TWO_PWR_16_DBL_=65536,goog.math.Long.TWO_PWR_24_DBL_=1<<24,goog.math.Long.TWO_PWR_32_DBL_=goog.math.Long.TWO_PWR_16_DBL_*goog.math.Long.TWO_PWR_16_DBL_,goog.math.Long.TWO_PWR_31_DBL_=goog.math.Long.TWO_PWR_32_DBL_/2,goog.math.Long.TWO_PWR_48_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_16_DBL_,goog.math.Long.TWO_PWR_64_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_32_DBL_,goog.math.Long.TWO_PWR_63_DBL_=goog.math.Long.TWO_PWR_64_DBL_/2,goog.math.Long.ZERO=goog.math.Long.fromInt(0),goog.math.Long.ONE=goog.math.Long.fromInt(1),goog.math.Long.NEG_ONE=goog.math.Long.fromInt(-1),goog.math.Long.MAX_VALUE=goog.math.Long.fromBits(-1,2147483647),goog.math.Long.MIN_VALUE=goog.math.Long.fromBits(0,-2147483648),goog.math.Long.TWO_PWR_24_=goog.math.Long.fromInt(1<<24),goog.math.Long.prototype.toInt=function(){return this.low_},goog.math.Long.prototype.toNumber=function(){return this.high_*goog.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},goog.math.Long.prototype.toString=function(a){var b=a||10;if(b<2||36<b)throw Error("radix out of range: "+b);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){var c=goog.math.Long.fromNumber(b),d=this.div(c),e=d.multiply(c).subtract(this);return d.toString(b)+e.toInt().toString(b)}return"-"+this.negate().toString(b)}for(var f=goog.math.Long.fromNumber(Math.pow(b,6)),e=this,g="";;){var h=e.div(f),i=e.subtract(h.multiply(f)).toInt(),j=i.toString(b);if(e=h,e.isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},goog.math.Long.prototype.getHighBits=function(){return this.high_},goog.math.Long.prototype.getLowBits=function(){return this.low_},goog.math.Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:goog.math.Long.TWO_PWR_32_DBL_+this.low_},goog.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(goog.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high_?this.high_:this.low_,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high_?b+33:b+1},goog.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_},goog.math.Long.prototype.isNegative=function(){return this.high_<0},goog.math.Long.prototype.isOdd=function(){return 1==(1&this.low_)},goog.math.Long.prototype.equals=function(a){return this.high_==a.high_&&this.low_==a.low_},goog.math.Long.prototype.notEquals=function(a){return this.high_!=a.high_||this.low_!=a.low_},goog.math.Long.prototype.lessThan=function(a){return this.compare(a)<0},goog.math.Long.prototype.lessThanOrEqual=function(a){return this.compare(a)<=0},goog.math.Long.prototype.greaterThan=function(a){return this.compare(a)>0},goog.math.Long.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0},goog.math.Long.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.subtract(a).isNegative()?-1:1},goog.math.Long.prototype.negate=function(){return this.equals(goog.math.Long.MIN_VALUE)?goog.math.Long.MIN_VALUE:this.not().add(goog.math.Long.ONE)},goog.math.Long.prototype.add=function(a){var b=this.high_>>>16,c=65535&this.high_,d=this.low_>>>16,e=65535&this.low_,f=a.high_>>>16,g=65535&a.high_,h=a.low_>>>16,i=65535&a.low_,j=0,k=0,l=0,m=0;return m+=e+i,l+=m>>>16,m&=65535,l+=d+h,k+=l>>>16,l&=65535,k+=c+g,j+=k>>>16,k&=65535,j+=b+f,j&=65535,goog.math.Long.fromBits(l<<16|m,j<<16|k)},goog.math.Long.prototype.subtract=function(a){return this.add(a.negate())},goog.math.Long.prototype.multiply=function(a){if(this.isZero())return goog.math.Long.ZERO;if(a.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE))return a.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(a.equals(goog.math.Long.MIN_VALUE))return this.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(goog.math.Long.TWO_PWR_24_)&&a.lessThan(goog.math.Long.TWO_PWR_24_))return goog.math.Long.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16,c=65535&this.high_,d=this.low_>>>16,e=65535&this.low_,f=a.high_>>>16,g=65535&a.high_,h=a.low_>>>16,i=65535&a.low_,j=0,k=0,l=0,m=0;return m+=e*i,l+=m>>>16,m&=65535,l+=d*i,k+=l>>>16,l&=65535,l+=e*h,k+=l>>>16,l&=65535,k+=c*i,j+=k>>>16,k&=65535,k+=d*h,j+=k>>>16,k&=65535,k+=e*g,j+=k>>>16,k&=65535,j+=b*i+c*h+d*g+e*f,j&=65535,goog.math.Long.fromBits(l<<16|m,j<<16|k)},goog.math.Long.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE)){if(a.equals(goog.math.Long.ONE)||a.equals(goog.math.Long.NEG_ONE))return goog.math.Long.MIN_VALUE;if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ONE;var b=this.shiftRight(1),c=b.div(a).shiftLeft(1);if(c.equals(goog.math.Long.ZERO))return a.isNegative()?goog.math.Long.ONE:goog.math.Long.NEG_ONE;var d=this.subtract(a.multiply(c)),e=c.add(d.div(a));return e}if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(var f=goog.math.Long.ZERO,d=this;d.greaterThanOrEqual(a);){for(var c=Math.max(1,Math.floor(d.toNumber()/a.toNumber())),g=Math.ceil(Math.log(c)/Math.LN2),h=g<=48?1:Math.pow(2,g-48),i=goog.math.Long.fromNumber(c),j=i.multiply(a);j.isNegative()||j.greaterThan(d);)c-=h,i=goog.math.Long.fromNumber(c),j=i.multiply(a);i.isZero()&&(i=goog.math.Long.ONE),f=f.add(i),d=d.subtract(j)}return f},goog.math.Long.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))},goog.math.Long.prototype.not=function(){return goog.math.Long.fromBits(~this.low_,~this.high_)},goog.math.Long.prototype.and=function(a){return goog.math.Long.fromBits(this.low_&a.low_,this.high_&a.high_)},goog.math.Long.prototype.or=function(a){return goog.math.Long.fromBits(this.low_|a.low_,this.high_|a.high_)},goog.math.Long.prototype.xor=function(a){return goog.math.Long.fromBits(this.low_^a.low_,this.high_^a.high_)},goog.math.Long.prototype.shiftLeft=function(a){if(a&=63,0==a)return this;var b=this.low_;if(a<32){var c=this.high_;return goog.math.Long.fromBits(b<<a,c<<a|b>>>32-a)}return goog.math.Long.fromBits(0,b<<a-32)},goog.math.Long.prototype.shiftRight=function(a){if(a&=63,0==a)return this;var b=this.high_;if(a<32){var c=this.low_;return goog.math.Long.fromBits(c>>>a|b<<32-a,b>>a)}return goog.math.Long.fromBits(b>>a-32,b>=0?0:-1)},goog.math.Long.prototype.shiftRightUnsigned=function(a){if(a&=63,0==a)return this;var b=this.high_;if(a<32){var c=this.low_;return goog.math.Long.fromBits(c>>>a|b<<32-a,b>>>a)}return 32==a?goog.math.Long.fromBits(b,0):goog.math.Long.fromBits(b>>>a-32,0)};var UTF8={};UTF8.encode=function(a){for(var b=[],c=0;c<a.length;++c){var d=a.charCodeAt(c);d<128?b.push(d):d<2048?(b.push(192|d>>6),b.push(128|63&d)):d<65536?(b.push(224|d>>12),b.push(128|63&d>>6),b.push(128|63&d)):(b.push(240|d>>18),b.push(128|63&d>>12),b.push(128|63&d>>6),b.push(128|63&d))}return b},UTF8.decode=function(a){for(var b=[],c=0;c<a.length;){var d=a[c++];d<128||(d<224?(d=(31&d)<<6,d|=63&a[c++]):d<240?(d=(15&d)<<12,d|=(63&a[c++])<<6,d|=63&a[c++]):(d=(7&d)<<18,d|=(63&a[c++])<<12,d|=(63&a[c++])<<6,d|=63&a[c++])),b.push(String.fromCharCode(d))}return b.join("")};var BASE64={};if(function(b){var c=function(a){for(var c=0,d=[],e=0|a.length/3;0<e--;){var f=(a[c]<<16)+(a[c+1]<<8)+a[c+2];c+=3,d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push(b.charAt(63&f))}if(2==a.length-c){var f=(a[c]<<16)+(a[c+1]<<8);d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push(b.charAt(63&f>>6)),d.push("=")}else if(1==a.length-c){var f=a[c]<<16;d.push(b.charAt(63&f>>18)),d.push(b.charAt(63&f>>12)),d.push("==")}return d.join("")},d=function(){for(var a=[],c=0;c<b.length;++c)a[b.charCodeAt(c)]=c;return a["=".charCodeAt(0)]=0,a}(),e=function(a){for(var b=0,c=[],e=0|a.length/4;0<e--;){var f=(d[a.charCodeAt(b)]<<18)+(d[a.charCodeAt(b+1)]<<12)+(d[a.charCodeAt(b+2)]<<6)+d[a.charCodeAt(b+3)];c.push(255&f>>16),c.push(255&f>>8),c.push(255&f),b+=4}return c&&("="==a.charAt(b-2)?(c.pop(),c.pop()):"="==a.charAt(b-1)&&c.pop()),c},f={};f.encode=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b},f.decode=function(b){for(var c=0;c<s.length;++c)a[c]=String.fromCharCode(a[c]);return a.join("")},BASE64.decodeArray=function(a){var b=e(a);return new Uint8Array(b)},BASE64.encodeASCII=function(a){var b=f.encode(a);return c(b)},BASE64.decodeASCII=function(a){var b=e(a);return f.decode(b)},BASE64.encode=function(a){var b=UTF8.encode(a);return c(b)},BASE64.decode=function(a){var b=e(a);return UTF8.decode(b)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),void 0===btoa)var btoa=BASE64.encode;if(void 0===atob)var atob=BASE64.decode;MediaPlayer=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n="1.4.0-dev-vimond",o=null,p=!1,q=!1,r=!0,s=!1,t=MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED,u=function(){return!!d&&!!e},v=function(){if(!p)throw"MediaPlayer not initialized!";if(!this.capabilities.supportsMediaSource())return void this.errHandler.capabilityError("mediasource");if(!d||!e)throw"Missing view or source.";q=!0,this.debug.log("Playback initiated!"),f=b.getObject("streamController"),i.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,f),i.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,f),i.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY,f),i.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,f),f.initialize(),f.setAutoPlay(r),f.setProtectionData(o),m.checkInitialBitrate(),"string"==typeof e?f.load(e):f.loadWithManifest(h),b.mapValue("scheduleWhilePaused",s),b.mapOutlet("scheduleWhilePaused","stream"),b.mapOutlet("scheduleWhilePaused","scheduleController"),b.mapValue("bufferMax",t),b.mapOutlet("bufferMax","bufferController"),g.initialize()},w=function(){u()&&v.call(this)},x=function(){var a=k.getReadOnlyMetricsFor("video")||k.getReadOnlyMetricsFor("audio");return j.getCurrentDVRInfo(a)},y=function(){return x.call(this).manifestInfo.DVRWindowSize},z=function(a){var b=x.call(this),c=b.range.start+a;return c>b.range.end&&(c=b.range.end),c},A=function(a){this.getVideoModel().getElement().currentTime=this.getDVRSeekOffset(a)},B=function(){var a=x.call(this);return null===a?0:this.duration()-(a.range.end-a.time)},C=function(){var a,b=x.call(this);return null===b?0:(a=b.range.end-b.range.start,a<b.manifestInfo.DVRWindowSize?a:b.manifestInfo.DVRWindowSize)},D=function(a){var b,c,d=x.call(this);return null===d?0:(b=d.manifestInfo.availableFrom.getTime()/1e3,c=a+(b+d.range.start))},E=function(){return D.call(this,this.time())},F=function(){return D.call(this,this.duration())},G=function(a,b,c){var d=new Date(1e3*a),e=d.toLocaleDateString(b),f=d.toLocaleTimeString(b,{hour12:c});return f+" "+e},H=function(a){a=Math.max(a,0);var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.floor(a%3600%60);return(0===b?"":b<10?"0"+b.toString()+":":b.toString()+":")+(c<10?"0"+c.toString():c.toString())+":"+(d<10?"0"+d.toString():d.toString())},I=function(a,b,c){b&&void 0!==a&&null!==a&&(c?g.setRules(a,b):g.addRules(a,b))},J=function(){q&&f&&(i.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,f),i.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,f),i.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY,f),i.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,f),f.reset(),c.reset(),g.reset(),i.reset(),f=null,q=!1)},K=dijon.System.prototype.getObject;return dijon.System.prototype.getObject=function(a){var b=K.call(this,a);return"object"!=typeof b||b.getName||(b.getName=function(){return a},b.setMediaType=function(a){b.mediaType=a},b.getMediaType=function(){return b.mediaType}),b},b=new dijon.System,b.mapValue("system",b),b.mapOutlet("system"),b.injectInto(a),{notifier:void 0,debug:void 0,eventBus:void 0,capabilities:void 0,adapter:void 0,errHandler:void 0,uriQueryFragModel:void 0,videoElementExt:void 0,setup:function(){j=b.getObject("metricsExt"),c=b.getObject("abrController"),g=b.getObject("rulesController"),k=b.getObject("metricsModel"),m=b.getObject("DOMStorage"),i=b.getObject("playbackController")},addEventListener:function(a,b,c){a=a.toLowerCase(),this.eventBus.addEventListener(a,b,c)},removeEventListener:function(a,b,c){a=a.toLowerCase(),this.eventBus.removeEventListener(a,b,c)},getVersion:function(){return n},startup:function(){p||(b.injectInto(this),p=!0)},getDebug:function(){return this.debug},getVideoModel:function(){return l},enableLastBitrateCaching:function(a,b){m.enableLastBitrateCaching(a,b)},setMaxAllowedBitrateFor:function(a,b){c.setMaxAllowedBitrateFor(a,b)},getMaxAllowedBitrateFor:function(a){return c.getMaxAllowedBitrateFor(a)},setAutoPlay:function(a){r=a},getAutoPlay:function(){return r},setScheduleWhilePaused:function(a){s=a},getScheduleWhilePaused:function(){return s},setBufferMax:function(a){t=a},getBufferMax:function(){return t},getMetricsExt:function(){return j},getMetricsFor:function(a){return k.getReadOnlyMetricsFor(a)},getQualityFor:function(a){return c.getQualityFor(a,f.getActiveStreamInfo())},setQualityFor:function(a,b){c.setPlaybackQuality(a,f.getActiveStreamInfo(),b)},getBitrateInfoListFor:function(a){var b=f.getActiveStreamInfo(),c=f.getStreamById(b.id);return c.getBitrateListFor(a)},setInitialBitrateFor:function(a,b){c.setInitialBitrateFor(a,b)},getInitialBitrateFor:function(a){return c.getInitialBitrateFor(a)},getAutoSwitchQuality:function(){return c.getAutoSwitchBitrate()},setAutoSwitchQuality:function(a){c.setAutoSwitchBitrate(a)},setSchedulingRules:function(a){I.call(this,g.SCHEDULING_RULE,a,!0)},addSchedulingRules:function(a){I.call(this,g.SCHEDULING_RULE,a,!1)},setABRRules:function(a){I.call(this,g.ABR_RULE,a,!0)},addABRRules:function(a){I.call(this,g.ABR_RULE,a,!1)},attachView:function(a){if(!p)throw"MediaPlayer not initialized!";d=a,l=null,d&&(l=b.getObject("videoModel"),l.setElement(d)),J.call(this),u.call(this)&&w.call(this)},attachSource:function(a){if(!p)throw"MediaPlayer not initialized!";"string"==typeof a?(this.uriQueryFragModel.reset(),e=this.uriQueryFragModel.parseURI(a)):e=a,J.call(this),u.call(this)&&w.call(this)},attachManifest:function(a){h=a},attachProtectionData:function(a){o=a},reset:function(){this.attachSource(null),this.attachView(null),h=null},play:v,isReady:u,seek:A,time:B,duration:C,timeAsUTC:E,durationAsUTC:F,getDVRWindowSize:y,getDVRSeekOffset:z,
formatUTC:G,convertToTimeCode:H}},MediaPlayer.prototype={constructor:MediaPlayer},MediaPlayer.dependencies={},MediaPlayer.dependencies.protection={},MediaPlayer.utils={},MediaPlayer.models={},MediaPlayer.vo={},MediaPlayer.vo.metrics={},MediaPlayer.vo.protection={},MediaPlayer.rules={},MediaPlayer.di={},MediaPlayer.events={METRICS_CHANGED:"metricschanged",METRIC_CHANGED:"metricchanged",METRIC_UPDATED:"metricupdated",METRIC_ADDED:"metricadded",MANIFEST_LOADED:"manifestloaded",STREAM_SWITCH_STARTED:"streamswitchstarted",STREAM_SWITCH_COMPLETED:"streamswitchcompleted",STREAM_INITIALIZED:"streaminitialized",TEXT_TRACK_ADDED:"texttrackadded",BUFFER_LOADED:"bufferloaded",BUFFER_EMPTY:"bufferstalled",ERROR:"error",LOG:"log"},MediaPlayer.di.Context=function(){"use strict";var a=function(){var a=document.createElement("video");if(MediaPlayer.models.ProtectionModel_21Jan2015.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_21Jan2015);else if(MediaPlayer.models.ProtectionModel_3Feb2014.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_3Feb2014);else if(MediaPlayer.models.ProtectionModel_01b.detect(a))this.system.mapClass("protectionModel",MediaPlayer.models.ProtectionModel_01b);else{var b=this.system.getObject("debug");b.log("No supported version of EME detected on this user agent!"),b.log("Attempts to play encrypted content will fail!")}};return{system:void 0,setup:function(){this.system.autoMapOutlets=!0,this.system.mapSingleton("debug",MediaPlayer.utils.Debug),this.system.mapSingleton("eventBus",MediaPlayer.utils.EventBus),this.system.mapSingleton("capabilities",MediaPlayer.utils.Capabilities),this.system.mapSingleton("DOMStorage",MediaPlayer.utils.DOMStorage),this.system.mapClass("customTimeRanges",MediaPlayer.utils.CustomTimeRanges),this.system.mapSingleton("virtualBuffer",MediaPlayer.utils.VirtualBuffer),this.system.mapSingleton("textTrackExtensions",MediaPlayer.utils.TextTrackExtensions),this.system.mapSingleton("vttParser",MediaPlayer.utils.VTTParser),this.system.mapSingleton("ttmlParser",MediaPlayer.utils.TTMLParser),this.system.mapSingleton("videoModel",MediaPlayer.models.VideoModel),this.system.mapSingleton("manifestModel",MediaPlayer.models.ManifestModel),this.system.mapSingleton("metricsModel",MediaPlayer.models.MetricsModel),this.system.mapSingleton("uriQueryFragModel",MediaPlayer.models.URIQueryAndFragmentModel),this.system.mapSingleton("ksPlayReady",MediaPlayer.dependencies.protection.KeySystem_PlayReady),this.system.mapSingleton("ksWidevine",MediaPlayer.dependencies.protection.KeySystem_Widevine),this.system.mapSingleton("ksClearKey",MediaPlayer.dependencies.protection.KeySystem_ClearKey),this.system.mapSingleton("requestModifierExt",MediaPlayer.dependencies.RequestModifierExtensions),this.system.mapSingleton("textSourceBuffer",MediaPlayer.dependencies.TextSourceBuffer),this.system.mapSingleton("mediaSourceExt",MediaPlayer.dependencies.MediaSourceExtensions),this.system.mapSingleton("sourceBufferExt",MediaPlayer.dependencies.SourceBufferExtensions),this.system.mapSingleton("abrController",MediaPlayer.dependencies.AbrController),this.system.mapSingleton("errHandler",MediaPlayer.dependencies.ErrorHandler),this.system.mapSingleton("videoExt",MediaPlayer.dependencies.VideoModelExtensions),this.system.mapSingleton("protectionExt",MediaPlayer.dependencies.ProtectionExtensions),this.system.mapClass("protectionController",MediaPlayer.dependencies.ProtectionController),this.system.mapSingleton("playbackController",MediaPlayer.dependencies.PlaybackController),a.call(this),this.system.mapSingleton("liveEdgeFinder",MediaPlayer.dependencies.LiveEdgeFinder),this.system.mapClass("metrics",MediaPlayer.models.MetricsList),this.system.mapClass("insufficientBufferRule",MediaPlayer.rules.InsufficientBufferRule),this.system.mapClass("bufferOccupancyRule",MediaPlayer.rules.BufferOccupancyRule),this.system.mapClass("throughputRule",MediaPlayer.rules.ThroughputRule),this.system.mapSingleton("abrRulesCollection",MediaPlayer.rules.ABRRulesCollection),this.system.mapSingleton("rulesController",MediaPlayer.rules.RulesController),this.system.mapClass("bufferLevelRule",MediaPlayer.rules.BufferLevelRule),this.system.mapClass("pendingRequestsRule",MediaPlayer.rules.PendingRequestsRule),this.system.mapClass("playbackTimeRule",MediaPlayer.rules.PlaybackTimeRule),this.system.mapClass("sameTimeRequestRule",MediaPlayer.rules.SameTimeRequestRule),this.system.mapSingleton("scheduleRulesCollection",MediaPlayer.rules.ScheduleRulesCollection),this.system.mapClass("liveEdgeBinarySearchRule",MediaPlayer.rules.LiveEdgeBinarySearchRule),this.system.mapClass("liveEdgeWithTimeSynchronizationRule",MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule),this.system.mapSingleton("synchronizationRulesCollection",MediaPlayer.rules.SynchronizationRulesCollection),this.system.mapSingleton("xlinkController",MediaPlayer.dependencies.XlinkController),this.system.mapSingleton("xlinkLoader",MediaPlayer.dependencies.XlinkLoader),this.system.mapClass("streamProcessor",MediaPlayer.dependencies.StreamProcessor),this.system.mapClass("eventController",MediaPlayer.dependencies.EventController),this.system.mapClass("textController",MediaPlayer.dependencies.TextController),this.system.mapClass("bufferController",MediaPlayer.dependencies.BufferController),this.system.mapClass("manifestLoader",MediaPlayer.dependencies.ManifestLoader),this.system.mapSingleton("manifestUpdater",MediaPlayer.dependencies.ManifestUpdater),this.system.mapClass("fragmentController",MediaPlayer.dependencies.FragmentController),this.system.mapClass("fragmentLoader",MediaPlayer.dependencies.FragmentLoader),this.system.mapClass("fragmentModel",MediaPlayer.dependencies.FragmentModel),this.system.mapSingleton("streamController",MediaPlayer.dependencies.StreamController),this.system.mapClass("stream",MediaPlayer.dependencies.Stream),this.system.mapClass("scheduleController",MediaPlayer.dependencies.ScheduleController),this.system.mapSingleton("timeSyncController",MediaPlayer.dependencies.TimeSyncController),this.system.mapSingleton("notifier",MediaPlayer.dependencies.Notifier)}}},Dash=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}(),Dash.di.DashContext=function(){"use strict";return{system:void 0,setup:function(){Dash.di.DashContext.prototype.setup.call(this),this.system.mapClass("parser",Dash.dependencies.DashParser),this.system.mapClass("indexHandler",Dash.dependencies.DashHandler),this.system.mapSingleton("baseURLExt",Dash.dependencies.BaseURLExtensions),this.system.mapClass("fragmentExt",Dash.dependencies.FragmentExtensions),this.system.mapClass("trackController",Dash.dependencies.RepresentationController),this.system.mapSingleton("manifestExt",Dash.dependencies.DashManifestExtensions),this.system.mapSingleton("metricsExt",Dash.dependencies.DashMetricsExtensions),this.system.mapSingleton("timelineConverter",Dash.dependencies.TimelineConverter),this.system.mapSingleton("adapter",Dash.dependencies.DashAdapter)}}},Dash.di.DashContext.prototype=new MediaPlayer.di.Context,Dash.di.DashContext.prototype.constructor=Dash.di.DashContext,Dash.dependencies.DashAdapter=function(){"use strict";var a=[],b={},c=function(a,b){return b.getRepresentationForQuality(a.quality)},d=function(a){return b[a.streamInfo.id][a.index]},e=function(b){var c,d=a.length,e=0;for(e;e<d;e+=1)if(c=a[e],b.id===c.id)return c;return null},f=function(a,b){var c=new MediaPlayer.vo.TrackInfo,d=b.adaptation.period.mpd.manifest.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index],e=this.manifestExt.getRepresentationFor(b.index,d);return c.id=b.id,c.quality=b.index,c.bandwidth=this.manifestExt.getBandwidth(e),c.DVRWindow=b.segmentAvailabilityRange,c.fragmentDuration=b.segmentDuration||(b.segments&&b.segments.length>0?b.segments[0].duration:NaN),c.MSETimeOffset=b.MSETimeOffset,c.useCalculatedLiveEdgeTime=b.useCalculatedLiveEdgeTime,c.mediaInfo=g.call(this,a,b.adaptation),c},g=function(a,b){var c=new MediaPlayer.vo.MediaInfo,d=this,e=b.period.mpd.manifest.Period_asArray[b.period.index].AdaptationSet_asArray[b.index];return c.id=b.id,c.index=b.index,c.type=b.type,c.streamInfo=h.call(this,a,b.period),c.trackCount=this.manifestExt.getRepresentationCount(e),c.lang=this.manifestExt.getLanguageForAdaptation(e),c.codec=this.manifestExt.getCodec(e),c.mimeType=this.manifestExt.getMimeType(e),c.contentProtection=this.manifestExt.getContentProtectionData(e),c.bitrateList=this.manifestExt.getBitrateListForAdaptation(e),c.contentProtection&&c.contentProtection.forEach(function(a){a.KID=d.manifestExt.getKID(a)}),c.isText=this.manifestExt.getIsTextTrack(c.mimeType),c},h=function(a,b){var c=new MediaPlayer.vo.StreamInfo,d=1;return c.id=b.id,c.index=b.index,c.start=b.start,c.duration=b.duration,c.manifestInfo=i.call(this,a,b.mpd),c.isLast=Math.abs(c.start+c.duration-c.manifestInfo.duration)<d,c},i=function(a,b){var c=new MediaPlayer.vo.ManifestInfo;return c.DVRWindowSize=b.timeShiftBufferDepth,c.loadedTime=b.manifest.loadedTime,c.availableFrom=b.availabilityStartTime,c.minBufferTime=b.manifest.minBufferTime,c.maxFragmentDuration=b.maxSegmentDuration,c.duration=this.manifestExt.getDuration(a),c.isDynamic=this.manifestExt.getIsDynamic(a),c},j=function(a,c,d){var f,h=e(c),i=h.id,j=this.manifestExt.getAdaptationForType(a,c.index,d);return j?(f=this.manifestExt.getIndexForAdaptation(j,a,c.index),b[i]=b[i]||this.manifestExt.getAdaptationsForPeriod(a,h),g.call(this,a,b[i][f])):null},k=function(c){var d,e,f,g=[];if(!c)return null;for(d=this.manifestExt.getMpd(c),a=this.manifestExt.getRegularPeriods(c,d),b={},e=a.length,f=0;f<e;f+=1)g.push(h.call(this,c,a[f]));return g},l=function(a){var b=this.manifestExt.getMpd(a);return i.call(this,a,b)},m=function(a,b){var c=a.trackController.getRepresentationForQuality(b);return a.indexHandler.getInitRequest(c)},n=function(a,b){var d=c(b,a.trackController);return a.indexHandler.getNextSegmentRequest(d)},o=function(a,b,d,e){var f=c(b,a.trackController);return a.indexHandler.getSegmentRequestForTime(f,d,e)},p=function(a,b,d){var e=c(b,a.trackController);return a.indexHandler.generateSegmentRequestForTime(e,d)},q=function(a){return a.indexHandler.getCurrentTime()},r=function(a,b){return a.indexHandler.setCurrentTime(b)},s=function(a,b){var c,f,g=e(b.getStreamInfo()),h=b.getMediaInfo(),i=d(h),j=b.getType();c=h.id,f=c?this.manifestExt.getAdaptationForId(c,a,g.index):this.manifestExt.getAdaptationForIndex(h.index,a,g.index),b.trackController.updateData(f,i,j)},t=function(a,b,c){var d=b.getRepresentationForQuality(c);return d?f.call(this,a,d):null},u=function(a,b){var c=b.getCurrentRepresentation();return c?f.call(this,a,c):null},v=function(a,b,c){var d=new Dash.vo.Event,e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=c*g+h;return b[e]?(d.eventStream=b[e],d.eventStream.value=f,d.eventStream.timescale=g,d.duration=i,d.id=j,d.presentationTime=l,d.messageData=k,d.presentationTimeDelta=h,d):null},w=function(a,b,f){var g=[];return b instanceof MediaPlayer.vo.StreamInfo?g=this.manifestExt.getEventsForPeriod(a,e(b)):b instanceof MediaPlayer.vo.MediaInfo?g=this.manifestExt.getEventStreamForAdaptationSet(a,d(b)):b instanceof MediaPlayer.vo.TrackInfo&&(g=this.manifestExt.getEventStreamForRepresentation(a,c(b,f.trackController))),g};return{system:void 0,manifestExt:void 0,timelineConverter:void 0,metricsList:{TCP_CONNECTION:"TcpConnection",HTTP_REQUEST:"HttpRequest",HTTP_REQUEST_TRACE:"HttpRequestTrace",TRACK_SWITCH:"RepresentationSwitch",BUFFER_LEVEL:"BufferLevel",BUFFER_STATE:"BufferState",DVR_INFO:"DVRInfo",DROPPED_FRAMES:"DroppedFrames",SCHEDULING_INFO:"SchedulingInfo",MANIFEST_UPDATE:"ManifestUpdate",MANIFEST_UPDATE_STREAM_INFO:"ManifestUpdatePeriodInfo",MANIFEST_UPDATE_TRACK_INFO:"ManifestUpdateRepresentationInfo",PLAY_LIST:"PlayList",PLAY_LIST_TRACE:"PlayListTrace"},convertDataToTrack:f,convertDataToMedia:g,convertDataToStream:h,getDataForTrack:c,getDataForMedia:d,getDataForStream:e,getStreamsInfo:k,getManifestInfo:l,getMediaInfoForType:j,getCurrentTrackInfo:u,getTrackInfoForQuality:t,updateData:s,getInitRequest:m,getNextFragmentRequest:n,getFragmentRequestForTime:o,generateFragmentRequestForTime:p,getIndexHandlerTime:q,setIndexHandlerTime:r,getEventsFor:w,getEvent:v,reset:function(){a=[],b={}}}},Dash.dependencies.DashAdapter.prototype={constructor:Dash.dependencies.DashAdapter},Dash.create=function(a,b,c){if("undefined"==typeof a||"VIDEO"!=a.nodeName)return null;var d,e=a.id||a.name||"video element";return c=c||new Dash.di.DashContext,b=b||[].slice.call(a.querySelectorAll("source")).filter(function(a){return a.type==Dash.supportedManifestMimeTypes.mimeType})[0],d=new MediaPlayer(c),d.startup(),d.attachView(a),d.setAutoPlay(a.autoplay),d.attachSource(b.src),d.getDebug().log("Converted "+e+" to dash.js player and added content: "+b.src),d},Dash.createAll=function(a,b,c){var d=[];a=a||".dashjs-player",b=b||document,c=c||new Dash.di.DashContext;for(var e=b.querySelectorAll(a),f=0;f<e.length;f++){var g=Dash.create(e[f],void 0,c);d.push(g)}return d},Dash.supportedManifestMimeTypes={mimeType:"application/dash+xml"},Dash.dependencies.DashHandler=function(){"use strict";var a,b,c,d=-1,e=0,f=new RegExp("^(?:(?:[a-z]+:)?/)?/","i"),g=function(a,b){for(;a.length<b;)a="0"+a;return a},h=function(a,b,c){for(var d,e,f,h,i,j,k=b.length,l="%0",m=l.length;;){if(d=a.indexOf("$"+b),d<0)return a;if(e=a.indexOf("$",d+k),e<0)return a;if(f=a.indexOf(l,d+k),f>d&&f<e)switch(h=a.charAt(e-1),i=parseInt(a.substring(f+m,e-1),10),h){case"d":case"i":case"u":j=g(c.toString(),i);break;case"x":j=g(c.toString(16),i);break;case"X":j=g(c.toString(16),i).toUpperCase();break;case"o":j=g(c.toString(8),i);break;default:return this.log("Unsupported/invalid IEEE 1003.1 format identifier string in URL"),a}else j=c;a=a.substring(0,d)+j+a.substring(e+1)}},i=function(a){return a.split("$$").join("$")},j=function(a,b){if(null===b||a.indexOf("$RepresentationID$")===-1)return a;var c=b.toString();return a.split("$RepresentationID$").join(c)},k=function(a,b){return a.representation.startNumber+b},l=function(a,b){var c,d=b.adaptation.period.mpd.manifest.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].BaseURL;return c=a===d?a:f.test(a)?a:d+a},m=function(a,c){var d,e,f=this,g=new MediaPlayer.vo.FragmentRequest;return d=a.adaptation.period,g.mediaType=c,g.type="Initialization Segment",g.url=l(a.initialization,a),g.range=a.range,e=d.start,g.availabilityStartTime=f.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(e,a.adaptation.period.mpd,b),g.availabilityEndTime=f.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(e+d.duration,d.mpd,b),g.quality=a.index,g},n=function(a){var b,d=this;return a?b=m.call(d,a,c):null},o=function(a){var c,e,f,g=a.adaptation.period,h=!1;return b?h=!1:d<0?h=!1:d<a.availableSegmentsNumber?(e=B(d,a),e&&(f=e.presentationStartTime-g.start,c=a.adaptation.period.duration,this.log(a.segmentInfoType+": "+f+" / "+c),h=f>=c)):h=!0,h},p=function(a,c){var d,e,f,g,h=this;return e=a.segmentDuration,isNaN(e)&&(e=a.adaptation.period.duration),f=a.adaptation.period.start+c*e,g=f+e,d=new Dash.vo.Segment,d.representation=a,d.duration=e,d.presentationStartTime=f,d.mediaStartTime=h.timelineConverter.calcMediaTimeFromPresentationTime(d.presentationStartTime,a),d.availabilityStartTime=h.timelineConverter.calcAvailabilityStartTimeFromPresentationTime(d.presentationStartTime,a.adaptation.period.mpd,b),d.availabilityEndTime=h.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(g,a.adaptation.period.mpd,b),d.wallStartTime=h.timelineConverter.calcWallTimeForSegment(d,b),d.replacementNumber=k(d,c),d.availabilityIdx=c,d},q=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=b.adaptation.period.mpd.manifest.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].SegmentTemplate,s=r.SegmentTimeline,v=b.availableSegmentsNumber>0,w=10,x=[],y=0,z=0,A=-1,B=function(a){return u.call(q,b,y,a.d,p,r.media,a.mediaRange,A)};for(p=b.timescale,c=s.S_asArray,k=t.call(q,b),k?(n=k.start,o=k.end):m=q.timelineConverter.calcMediaTimeFromPresentationTime(a||0,b),e=0,f=c.length;e<f;e+=1)if(d=c[e],h=0,d.hasOwnProperty("r")&&(h=d.r),d.hasOwnProperty("t")&&(y=d.t,z=y/p),h<0&&(j=c[e+1],j&&j.hasOwnProperty("t")?i=j.t/p:(i=q.timelineConverter.calcMediaTimeFromPresentationTime(b.segmentAvailabilityRange.end,b),b.segmentDuration=d.d/p),h=Math.ceil((i-z)/(d.d/p))-1),l){if(v)break;A+=h+1}else for(g=0;g<=h;g+=1){if(A+=1,k){if(A>o){if(l=!0,v)break;continue}A>=n&&x.push(B.call(q,d))}else{if(x.length>w){if(l=!0,v)break;continue}z>=m-d.d/p&&x.push(B.call(q,d))}y+=d.d,z=y/p}return v||(b.availableSegmentsNumber=A+1),x},r=function(a){var c,d,e,f,g,i=[],j=this,k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].SegmentTemplate,l=a.segmentDuration,m=a.segmentAvailabilityRange,n=null,o=null;for(g=a.startNumber,c=isNaN(l)&&!b?{start:g,end:g}:s.call(j,a),e=c.start,f=c.end,d=e;d<=f;d+=1)n=p.call(j,a,d),n.replacementTime=(g+d-1)*a.segmentDuration,o=k.media,o=h(o,"Number",n.replacementNumber),o=h(o,"Time",n.replacementTime),n.media=o,i.push(n),n=null;return isNaN(l)?a.availableSegmentsNumber=1:a.availableSegmentsNumber=Math.ceil((m.end-m.start)/l),i},s=function(c){var e,f,g,h=this,i=c.segmentDuration,j=c.adaptation.period.mpd.manifest.minBufferTime,k=c.segmentAvailabilityRange,l={start:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,k.start),end:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,k.end)},m=NaN,n=null,o=c.segments,p=2*i,q=Math.max(2*j,10*i);return l||(l=h.timelineConverter.calcSegmentAvailabilityRange(c,b)),b&&!h.timelineConverter.isTimeSyncCompleted()?(e=Math.floor(l.start/i),f=Math.floor(l.end/i),g={start:e,end:f}):(o&&o.length>0?(n=B(d,c),m=n?h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,n.presentationStartTime):d>0?d*i:h.timelineConverter.calcPeriodRelativeTimeFromMpdRelativeTime(c,a||o[0].presentationStartTime)):m=d>0?d*i:b?l.end:l.start,e=Math.floor(Math.max(m-p,l.start)/i),f=Math.floor(Math.min(e+q/i,l.end/i)),g={start:e,end:f})},t=function(){var c,e,f,g=2,h=10,i=0,j=Number.POSITIVE_INFINITY;return b&&!this.timelineConverter.isTimeSyncCompleted()?f={start:i,end:j}:!b&&a||d<0?null:(c=Math.max(d-g,i),e=Math.min(d+h,j),f={start:c,end:e})},u=function(a,c,d,e,f,g,i){var j,l,m,n=this,o=c/e,p=Math.min(d/e,a.adaptation.period.mpd.maxSegmentDuration);return j=n.timelineConverter.calcPresentationTimeFromMediaTime(o,a),l=j+p,m=new Dash.vo.Segment,m.representation=a,m.duration=p,m.mediaStartTime=o,m.presentationStartTime=j,m.availabilityStartTime=a.adaptation.period.mpd.manifest.loadedTime,m.availabilityEndTime=n.timelineConverter.calcAvailabilityEndTimeFromPresentationTime(l,a.adaptation.period.mpd,b),m.wallStartTime=n.timelineConverter.calcWallTimeForSegment(m,b),m.replacementTime=c,m.replacementNumber=k(m,i),f=h(f,"Number",m.replacementNumber),f=h(f,"Time",m.replacementTime),m.media=f,m.mediaRange=g,m.availabilityIdx=i,m},v=function(a){var b,c,d,e,f,g,h,i=this,j=[],k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].SegmentList,l=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,m=k.SegmentURL_asArray.length;for(h=a.startNumber,e=s.call(i,a),f=Math.max(e.start,0),g=Math.min(e.end,k.SegmentURL_asArray.length-1),b=f;b<=g;b+=1)d=k.SegmentURL_asArray[b],c=p.call(i,a,b),c.replacementTime=(h+b-1)*a.segmentDuration,c.media=d.media?d.media:l,c.mediaRange=d.mediaRange,c.index=d.index,c.indexRange=d.indexRange,j.push(c),c=null;return a.availableSegmentsNumber=m,j},w=function(a){var b,c=this,d=a.segmentInfoType;return"SegmentBase"!==d&&"BaseURL"!==d&&C.call(c,a)?("SegmentTimeline"===d?b=q.call(c,a):"SegmentTemplate"===d?b=r.call(c,a):"SegmentList"===d&&(b=v.call(c,a)),x.call(c,a,b)):b=a.segments,b},x=function(a,c){var d,e,f,g;a.segments=c,d=c.length-1,b&&isNaN(this.timelineConverter.getExpectedLiveEdge())&&(g=c[d],e=g.presentationStartTime-g.duration/2,f=this.metricsModel.getMetricsFor("stream"),this.timelineConverter.setExpectedLiveEdge(e),this.metricsModel.updateManifestUpdateInfo(this.metricsExt.getCurrentManifestUpdate(f),{presentationStartTime:e}))},y=function(a){var b=this;if(!a)throw new Error("no representation");return a.segments=null,w.call(b,a),a},z=function(a,e){var f,g=this,h=a.initialization,i="BaseURL"!==a.segmentInfoType&&"SegmentBase"!==a.segmentInfoType;return a.segmentAvailabilityRange=null,a.segmentAvailabilityRange=g.timelineConverter.calcSegmentAvailabilityRange(a,b),a.segmentAvailabilityRange.end<a.segmentAvailabilityRange.start&&!a.useCalculatedLiveEdgeTime?(f=new MediaPlayer.vo.Error(Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE,"no segments are available yet",{availabilityDelay:Math.abs(a.segmentAvailabilityRange.end)}),void g.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:a},f)):(e||(d=-1),y.call(g,a),h||g.baseURLExt.loadInitialization(a),i||g.baseURLExt.loadSegments(a,c,a.indexRange),void(h&&i&&g.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:a})))},A=function(a,b,c){var d,e,f,g,h,i=b.segments,j=i?i.length:null,k=-1;if(i&&j>0)for(h=0;h<j;h+=1)if(e=i[h],f=e.presentationStartTime,g=e.duration,d=void 0===c||null===c?g/2:c,a+d>=f&&a-d<f+g){k=e.availabilityIdx;break}return k},B=function(a,b){if(!b||!b.segments)return null;var c,d,e=b.segments.length;for(d=0;d<e;d+=1)if(c=b.segments[d],c.availabilityIdx===a)return c;return null},C=function(a){var b,c,e=!1,f=a.segments;return f&&0!==f.length?(c=f[0].availabilityIdx,b=f[f.length-1].availabilityIdx,e=d<c||d>b):e=!0,e},D=function(a){if(null===a||void 0===a)return null;var b,d=new MediaPlayer.vo.FragmentRequest,e=a.representation,f=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].bandwidth;return b=l(a.media,e),b=h(b,"Number",a.replacementNumber),b=h(b,"Time",a.replacementTime),b=h(b,"Bandwidth",f),b=j(b,e.id),b=i(b),d.mediaType=c,d.type="Media Segment",d.url=b,d.range=a.mediaRange,d.startTime=a.presentationStartTime,d.duration=a.duration,d.timescale=e.timescale,d.availabilityStartTime=a.availabilityStartTime,d.availabilityEndTime=a.availabilityEndTime,d.wallStartTime=a.wallStartTime,d.quality=e.index,d.index=a.availabilityIdx,d},E=function(b,e,f){var g,h,i,j=d,k=!!f&&f.keepIdx,l=f?f.timeThreshold:null,m=this;return b?(a=e,m.log("Getting the request for time: "+e),d=A.call(m,e,b,l),w.call(m,b),d<0&&(d=A.call(m,e,b,l)),m.log("Index for time "+e+" is "+d),i=o.call(m,b),i?(g=new MediaPlayer.vo.FragmentRequest,g.action=g.ACTION_COMPLETE,g.index=d,g.mediaType=c,m.log("Signal complete."),m.log(g)):(h=B(d,b),g=D.call(m,h)),k&&(d=j),g):null},F=function(a,b){var c=(a.segmentAvailabilityRange.end-a.segmentAvailabilityRange.start)/2;return a.segments=null,a.segmentAvailabilityRange={start:b-c,end:b+c},E.call(this,a,b,{keepIdx:!1})},G=function(b){var e,f,g,h,i=this;if(!b)return null;if(d===-1)throw"You must call getSegmentRequestForTime first.";return a=null,d+=1,h=d,g=o.call(i,b),g?(e=new MediaPlayer.vo.FragmentRequest,e.action=e.ACTION_COMPLETE,e.index=h,e.mediaType=c,i.log("Signal complete.")):(w.call(i,b),f=B(h,b),e=D.call(i,f)),e},H=function(a){var b=a.data.representation;b.segments&&this.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:b})},I=function(a){if(!a.error&&c===a.data.mediaType){var b,d,e,f,g=this,h=a.data.segments,i=a.data.representation,j=[],k=0;for(b=0,d=h.length;b<d;b+=1)e=h[b],f=u.call(g,i,e.startTime,e.duration,e.timescale,e.media,e.mediaRange,k),j.push(f),f=null,k+=1;i.segmentAvailabilityRange={start:j[0].presentationStartTime,end:j[d-1].presentationStartTime},i.availableSegmentsNumber=d,x.call(g,i,j),i.initialization&&this.notify(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,{representation:i})}};return{log:void 0,baseURLExt:void 0,timelineConverter:void 0,metricsModel:void 0,metricsExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED]=H,this[Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED]=I},initialize:function(a){this.subscribe(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,a.trackController),c=a.getType(),this.setMediaType(c),b=a.isDynamic(),this.streamProcessor=a},getType:function(){return c},setType:function(a){c=a},getIsDynamic:function(){return b},setIsDynamic:function(a){b=a},setCurrentTime:function(a){e=a},getCurrentTime:function(){return e},reset:function(){e=0,a=void 0,d=-1,b=void 0,this.unsubscribe(Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED,this.streamProcessor.trackController)},getInitRequest:n,getSegmentRequestForTime:E,getNextSegmentRequest:G,generateSegmentRequestForTime:F,updateRepresentation:z}},Dash.dependencies.DashHandler.prototype={constructor:Dash.dependencies.DashHandler},Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE=1,Dash.dependencies.DashHandler.eventList={ENAME_REPRESENTATION_UPDATED:"representationUpdated"},Dash.dependencies.DashParser=function(){"use strict";var a=31536e3,b=2592e3,c=86400,d=3600,e=60,f=60,g=1e3,h=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,j=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,k=[{type:"duration",test:function(a){for(var b=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],c=b.length,d=0;d<c;d++)if(a.nodeName===b[d])return h.test(a.value);return!1},converter:function(f){var g=h.exec(f),i=parseFloat(g[2]||0)*a+parseFloat(g[4]||0)*b+parseFloat(g[6]||0)*c+parseFloat(g[8]||0)*d+parseFloat(g[10]||0)*e+parseFloat(g[12]||0);return void 0!==g[1]&&(i=-i),i}},{type:"datetime",test:function(a){return i.test(a.value)},converter:function(a){var b,c=i.exec(a);if(b=Date.UTC(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10),parseInt(c[4],10),parseInt(c[5],10),c[6]&&parseInt(c[6],10)||0,c[7]&&parseFloat(c[7])*g||0),c[9]&&c[10]){var d=parseInt(c[9],10)*f+parseInt(c[10],10);b+=("+"===c[8]?-1:1)*d*e*g}return new Date(b)}},{type:"numeric",test:function(a){return j.test(a.value)},converter:function(a){return parseFloat(a)}}],l=function(){var a,b,c,d;return d=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],a={},a.name="AdaptationSet",a.isRoot=!1,a.isArray=!0,a.parent=null,a.children=[],a.properties=d,b={},b.name="Representation",b.isRoot=!1,b.isArray=!0,b.parent=a,b.children=[],b.properties=d,a.children.push(b),c={},c.name="SubRepresentation",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=d,b.children.push(c),a},m=function(){var a,b,c,d;return d=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],a={},a.name="Period",a.isRoot=!1,a.isArray=!0,a.parent=null,a.children=[],a.properties=d,b={},b.name="AdaptationSet",b.isRoot=!1,b.isArray=!0,b.parent=a,b.children=[],b.properties=d,a.children.push(b),c={},c.name="Representation",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=d,b.children.push(c),a},n=function(){var a,b,c,d,e;return e=[{name:"BaseURL",merge:!0,mergeFunction:function(a,b){var c;return c=0===b.indexOf("http://")?b:a+b}}],a={},a.name="mpd",a.isRoot=!0,a.isArray=!0,a.parent=null,a.children=[],a.properties=e,b={},b.name="Period",b.isRoot=!1,b.isArray=!0,b.parent=null,b.children=[],b.properties=e,a.children.push(b),c={},c.name="AdaptationSet",c.isRoot=!1,c.isArray=!0,c.parent=b,c.children=[],c.properties=e,b.children.push(c),d={},d.name="Representation",d.isRoot=!1,d.isArray=!0,d.parent=c,d.children=[],d.properties=e,c.children.push(d),a},o=function(){var a=[];return a.push(l()),a.push(m()),a.push(n()),a},p=function(a,b){var c,d=new X2JS(k,"",!0),e=new ObjectIron(o()),f=new Date,g=null,h=null;try{c=d.xml_str2json(a),g=new Date,c.hasOwnProperty("BaseURL")?(c.BaseURL=c.BaseURL_asArray[0],0!==c.BaseURL.toString().indexOf("http")&&(c.BaseURL=b+c.BaseURL)):c.BaseURL=b,c.hasOwnProperty("Location")&&(c.Location=c.Location_asArray[0]),e.run(c),h=new Date,this.xlinkController.setMatchers(k),this.xlinkController.setIron(e),this.log("Parsing complete: ( xml2json: "+(g.getTime()-f.getTime())+"ms, objectiron: "+(h.getTime()-g.getTime())+"ms, total: "+(h.getTime()-f.getTime())/1e3+"s)")}catch(b){return this.errHandler.manifestError("parsing the manifest failed","parse",a),null}return c};return{log:void 0,errHandler:void 0,xlinkController:void 0,parse:p}},Dash.dependencies.DashParser.prototype={constructor:Dash.dependencies.DashParser},Dash.dependencies.TimelineConverter=function(){"use strict";var a=0,b=!1,c=NaN,d=function(b,c,d,e){var f=NaN;return f=e?d&&c.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(c.availabilityStartTime.getTime()+1e3*(b+c.timeShiftBufferDepth)):c.availabilityEndTime:d?new Date(c.availabilityStartTime.getTime()+1e3*(b-a)):c.availabilityStartTime},e=function(a,b,c){return d.call(this,a,b,c)},f=function(a,b,c){return d.call(this,a,b,c,!0)},g=function(b,c){return(b.getTime()-c.mpd.availabilityStartTime.getTime()+1e3*a)/1e3},h=function(a,b){var c=b.adaptation.period.start,d=b.presentationTimeOffset;return a+(c-d)},i=function(a,b){var c=b.adaptation.period.start,d=b.presentationTimeOffset;return a-c+d},j=function(a,b){var c,d,e;return b&&(c=a.representation.adaptation.period.mpd.suggestedPresentationDelay,d=a.presentationStartTime+c,e=new Date(a.availabilityStartTime.getTime()+1e3*d)),e},k=function(a,c){var d,e,f=a.adaptation.period.start,h=f+a.adaptation.period.duration,i={start:f,end:h};return c?!b&&a.segmentAvailabilityRange?a.segmentAvailabilityRange:(d=a.adaptation.period.mpd.checkTime,e=g(new Date,a.adaptation.period),f=Math.max(e-a.adaptation.period.mpd.timeShiftBufferDepth,0),h=isNaN(d)?e:Math.min(d,e),i={start:f,end:h}):i},l=function(a,b){var c=a.adaptation.period.start;return b-c},m=function(a,b){var c=a.adaptation.period.start;return b+c},n=function(d){b||d.error||(a=d.data.liveEdge-(c+d.data.searchTime),b=!0)},o=function(c){b||c.error||(a=c.data.offset/1e3,b=!0)},p=function(a){var b=a.presentationTimeOffset,c=a.adaptation.period.start;return c-b},q=function(){a=0,b=!1,c=NaN};return{setup:function(){this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=n,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=o},calcAvailabilityStartTimeFromPresentationTime:e,calcAvailabilityEndTimeFromPresentationTime:f,calcPresentationTimeFromWallTime:g,calcPresentationTimeFromMediaTime:h,calcPeriodRelativeTimeFromMpdRelativeTime:l,calcMpdRelativeTimeFromPeriodRelativeTime:m,calcMediaTimeFromPresentationTime:i,calcSegmentAvailabilityRange:k,calcWallTimeForSegment:j,calcMSETimeOffset:p,reset:q,isTimeSyncCompleted:function(){return b},getClientTimeOffset:function(){return a},getExpectedLiveEdge:function(){
return c},setExpectedLiveEdge:function(a){c=a}}},Dash.dependencies.TimelineConverter.prototype={constructor:Dash.dependencies.TimelineConverter},Dash.dependencies.RepresentationController=function(){"use strict";var a,b=null,c=-1,d=!0,e=[],f=function(c,f,g){var h,j=this,k=null,m=j.streamProcessor.getStreamInfo(),n=j.abrController.getTopQualityIndexFor(g,m.id);if(d=!0,j.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED),e=l.call(j,f),null===b?(k=j.abrController.getInitialBitrateFor(g,m),h=j.abrController.getQualityForBitrate(j.streamProcessor.getMediaInfo(),k)):h=j.abrController.getQualityFor(g,m),h>n&&(h=n),a=i.call(j,h),b=c,"video"!==g&&"audio"!==g&&"fragmentedText"!==g)return d=!1,void j.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a});for(var o=0;o<e.length;o+=1)j.indexHandler.updateRepresentation(e[o],!0)},g=function(){var a=new Date,b=this.getCurrentRepresentation(),c=this.streamProcessor.playbackController.getTime();this.metricsModel.addTrackSwitch(b.adaptation.type,a,c,b.id)},h=function(){var b=this.streamProcessor,c=this.timelineConverter.calcSegmentAvailabilityRange(a,b.isDynamic());this.metricsModel.addDVRInfo(b.getType(),b.playbackController.getTime(),b.getStreamInfo().manifestInfo,c)},i=function(a){return e[a]},j=function(a){return e.indexOf(a)},k=function(){for(var a=0,b=e.length;a<b;a+=1){var c=e[a].segmentInfoType;if(null===e[a].segmentAvailabilityRange||null===e[a].initialization||("SegmentBase"===c||"BaseURL"===c)&&!e[a].segments)return!1}return!0},l=function(a){var d,e=this,f=e.manifestModel.getValue();return c=e.manifestExt.getIndexForAdaptation(b,f,a.period.index),d=e.manifestExt.getRepresentationsForAdaptation(f,a)},m=function(a){for(var b,c=this,d=0,f=e.length;d<f;d+=1)b=e[d],b.segmentAvailabilityRange=c.timelineConverter.calcSegmentAvailabilityRange(b,a)},n=function(b){var c=this,f=1e3*(b+3*a.segmentDuration),g=function(){if(!this.isUpdating()){d=!0,c.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED);for(var a=0;a<e.length;a+=1)c.indexHandler.updateRepresentation(e[a],!0)}};d=!1,setTimeout(g.bind(this),f)},o=function(c){if(this.isUpdating()){var e,f,g=this,i=c.data.representation,l=g.metricsModel.getMetricsFor("stream"),m=g.metricsExt.getCurrentManifestUpdate(l),o=!1;if(c.error&&c.error.code===Dash.dependencies.DashHandler.SEGMENTS_UNAVAILABLE_ERROR_CODE)return h.call(this),n.call(this,c.error.data.availabilityDelay),f=new MediaPlayer.vo.Error(Dash.dependencies.RepresentationController.SEGMENTS_UPDATE_FAILED_ERROR_CODE,"Segments update failed",null),void this.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a},f);for(var p=0;p<m.trackInfo.length;p+=1)if(e=m.trackInfo[p],e.index===i.index&&e.mediaType===g.streamProcessor.getType()){o=!0;break}o||g.metricsModel.addManifestUpdateTrackInfo(m,i.id,i.index,i.adaptation.period.index,g.streamProcessor.getType(),i.presentationTimeOffset,i.startNumber,i.segmentInfoType),k()&&(d=!1,g.abrController.setPlaybackQuality(g.streamProcessor.getType(),g.streamProcessor.getStreamInfo(),j.call(this,a)),g.metricsModel.updateManifestUpdateInfo(m,{latency:a.segmentAvailabilityRange.end-g.streamProcessor.playbackController.getTime()}),this.notify(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,{data:b,currentRepresentation:a}))}},p=function(a){m.call(this,a.data.isDynamic)},q=function(b){if(!b.error){m.call(this,!0),this.indexHandler.updateRepresentation(a,!1);var c=this.manifestModel.getValue();a.adaptation.period.mpd.checkTime=this.manifestExt.getCheckTime(c,a.adaptation.period)}},r=function(){h.call(this)},s=function(b){var c=this;b.data.mediaType===c.streamProcessor.getType()&&c.streamProcessor.getStreamInfo().id===b.data.streamInfo.id&&(a=c.getRepresentationForQuality(b.data.newQuality),t.call(c,b.data.mediaType,a.bandwidth),g.call(c))},t=function(a,b){!this.DOMStorage.isSupported(MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL)||"video"!==a&&"audio"!==a||localStorage.setItem(MediaPlayer.utils.DOMStorage["LOCAL_STORAGE_"+a.toUpperCase()+"_BITRATE_KEY"],JSON.stringify({bitrate:b/1e3,timestamp:(new Date).getTime()}))};return{system:void 0,log:void 0,manifestExt:void 0,manifestModel:void 0,metricsModel:void 0,metricsExt:void 0,abrController:void 0,timelineConverter:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,DOMStorage:void 0,setup:function(){this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=s,this[Dash.dependencies.DashHandler.eventList.ENAME_REPRESENTATION_UPDATED]=o,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=p,this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=q,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED]=r},initialize:function(a){this.streamProcessor=a,this.indexHandler=a.indexHandler},getData:function(){return b},getDataIndex:function(){return c},isUpdating:function(){return d},updateData:f,getRepresentationForQuality:i,getCurrentRepresentation:function(){return a}}},Dash.dependencies.RepresentationController.prototype={constructor:Dash.dependencies.RepresentationController},Dash.dependencies.RepresentationController.SEGMENTS_UPDATE_FAILED_ERROR_CODE=1,Dash.dependencies.RepresentationController.eventList={ENAME_DATA_UPDATE_COMPLETED:"dataUpdateCompleted",ENAME_DATA_UPDATE_STARTED:"dataUpdateStarted"},Dash.dependencies.BaseURLExtensions=function(){"use strict";var a=function(a,b){for(var c,d,e,f,g,h,i,j,k,l,m=new DataView(a),n={},o=0;"sidx"!==j&&o<m.byteLength;){for(k=m.getUint32(o),o+=4,j="",f=0;f<4;f+=1)l=m.getInt8(o),j+=String.fromCharCode(l),o+=1;"moof"!==j&&"traf"!==j&&"sidx"!==j?o+=k-8:"sidx"===j&&(o-=8)}if(e=m.getUint32(o,!1)+o,e>a.byteLength)throw"sidx terminates after array buffer";for(n.version=m.getUint8(o+8),o+=12,n.timescale=m.getUint32(o+4,!1),o+=8,0===n.version?(n.earliest_presentation_time=m.getUint32(o,!1),n.first_offset=m.getUint32(o+4,!1),o+=8):(n.earliest_presentation_time=utils.Math.to64BitNumber(m.getUint32(o+4,!1),m.getUint32(o,!1)),n.first_offset=(m.getUint32(o+8,!1)<<32)+m.getUint32(o+12,!1),o+=16),n.first_offset+=e+(b||0),n.reference_count=m.getUint16(o+2,!1),o+=4,n.references=[],c=n.first_offset,d=n.earliest_presentation_time,f=0;f<n.reference_count;f+=1)h=m.getUint32(o,!1),g=h>>>31,h=2147483647&h,i=m.getUint32(o+4,!1),o+=12,n.references.push({size:h,type:g,offset:c,duration:i,time:d,timescale:n.timescale}),c+=h,d+=i;if(o!==e)throw"Error: final pos "+o+" differs from SIDX end "+e;return n},b=function(b,c,d){var e,f,g,h,i,j,k,l;for(e=a.call(this,b,d),f=e.references,g=[],i=0,j=f.length;i<j;i+=1)h=new Dash.vo.Segment,h.duration=f[i].duration,h.media=c,h.startTime=f[i].time,h.timescale=f[i].timescale,k=f[i].offset,l=f[i].offset+f[i].size-1,h.mediaRange=k+"-"+l,g.push(h);return this.log("Parsed SIDX box: "+g.length+" segments."),g},c=function(a,b,d){var e,f,h,i,j,k,l,m,n=new DataView(a),o=0,p="",q=0,r=!1,s=this;for(s.log("Searching for initialization.");"moov"!==p&&o<n.byteLength;){for(q=n.getUint32(o),o+=4,p="",j=0;j<4;j+=1)k=n.getInt8(o),p+=String.fromCharCode(k),o+=1;"ftyp"===p&&(e=o-8),"moov"===p&&(f=o-8),"moov"!==p&&(o+=q-8)}"moov"!==p?(s.log("Loading more bytes to find initialization."),b.range.start=0,b.range.end=b.bytesLoaded+b.bytesToLoad,l=new XMLHttpRequest,l.onloadend=function(){r||d.call(s,null,new Error("Error loading initialization."))},l.onload=function(){r=!0,b.bytesLoaded=b.range.end,c.call(s,l.response,function(a){d.call(s,a)})},l.onerror=function(){d.call(s,null,new Error("Error loading initialization."))},g.call(s,l,b)):(h=void 0===e?f:e,i=f+q-1,m=h+"-"+i,s.log("Found the initialization.  Range: "+m),d.call(s,m))},d=function(a){var b=new XMLHttpRequest,d=!0,e=this,f=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,h={url:f,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:b};e.log("Start searching for initialization."),h.range.start=0,h.range.end=h.bytesToLoad,b.onload=function(){b.status<200||b.status>299||(d=!1,h.bytesLoaded=h.range.end,c.call(e,b.response,h,function(b){a.range=b,a.initialization=f,e.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,{representation:a})}))},b.onloadend=b.onerror=function(){d&&(d=!1,e.errHandler.downloadError("initialization",h.url,b),e.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,{representation:a}))},g.call(e,b,h),e.log("Perform init search: "+h.url)},e=function(a,c,d,h){var i,j,k,l,m,n,o,p,q,r=new DataView(a),s=new XMLHttpRequest,t=0,u="",v=0,w=!0,x=!1,y=this;for(y.log("Searching for SIDX box."),y.log(c.bytesLoaded+" bytes loaded.");"sidx"!==u&&t<r.byteLength;){for(v=r.getUint32(t),t+=4,u="",n=0;n<4;n+=1)o=r.getInt8(t),u+=String.fromCharCode(o),t+=1;"sidx"!==u&&(t+=v-8)}if(j=r.byteLength-t,"sidx"!==u)h.call(y);else if(j<v-8)y.log("Found SIDX but we don't have all of it."),c.range.start=0,c.range.end=c.bytesLoaded+(v-j),s.onload=function(){s.status<200||s.status>299||(w=!1,c.bytesLoaded=c.range.end,e.call(y,s.response,c,d,h))},s.onloadend=s.onerror=function(){w&&(w=!1,y.errHandler.downloadError("SIDX",c.url,s),h.call(y))},g.call(y,s,c);else if(c.range.start=t-8,c.range.end=c.range.start+v,y.log("Found the SIDX box.  Start: "+c.range.start+" | End: "+c.range.end),k=new ArrayBuffer(c.range.end-c.range.start),m=new Uint8Array(k),l=new Uint8Array(a,c.range.start,c.range.end-c.range.start),m.set(l),p=this.parseSIDX.call(this,k,c.range.start),q=p.references,null!==q&&void 0!==q&&q.length>0&&(x=1===q[0].type),x){y.log("Initiate multiple SIDX load.");var z,A,B,C,D,E=[],F=0,G=function(a){a?(E=E.concat(a),F+=1,F>=A&&h.call(y,E)):h.call(y)};for(z=0,A=q.length;z<A;z+=1)B=q[z].offset,C=q[z].offset+q[z].size-1,D=B+"-"+C,f.call(y,d,null,D,G)}else y.log("Parsing segments from SIDX."),i=b.call(y,k,c.url,c.range.start),h.call(y,i)},f=function(a,c,d,f){var h,i,j=new XMLHttpRequest,k=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].BaseURL,l=!0,m=this,n={url:k,range:{},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:j};null===d?(m.log("No known range for SIDX request."),n.searching=!0,n.range.start=0,n.range.end=n.bytesToLoad):(i=d.split("-"),n.range.start=parseFloat(i[0]),n.range.end=parseFloat(i[1])),j.onload=function(){j.status<200||j.status>299||(l=!1,n.searching?(n.bytesLoaded=n.range.end,e.call(m,j.response,n,a,function(b){b&&f.call(m,b,a,c)})):(h=b.call(m,j.response,n.url,n.range.start),f.call(m,h,a,c)))},j.onloadend=j.onerror=function(){l&&(l=!1,m.errHandler.downloadError("SIDX",n.url,j),f.call(m,null,a,c))},g.call(m,j,n),m.log("Perform SIDX load: "+n.url)},g=function(a,b){a.open("GET",this.requestModifierExt.modifyRequestURL(b.url)),a.responseType="arraybuffer",a.setRequestHeader("Range","bytes="+b.range.start+"-"+b.range.end),a=this.requestModifierExt.modifyRequestHeader(a),a.send(null)},h=function(a,b,c){var d=this;a?d.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,{segments:a,representation:b,mediaType:c}):d.notify(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,{segments:null,representation:b,mediaType:c},new MediaPlayer.vo.Error(null,"error loading segments",null))};return{log:void 0,errHandler:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,loadSegments:function(a,b,c){f.call(this,a,b,c,h.bind(this))},loadInitialization:d,parseSegments:b,parseSIDX:a,findSIDX:e}},Dash.dependencies.BaseURLExtensions.prototype={constructor:Dash.dependencies.BaseURLExtensions},Dash.dependencies.BaseURLExtensions.eventList={ENAME_INITIALIZATION_LOADED:"initializationLoaded",ENAME_SEGMENTS_LOADED:"segmentsLoaded"},Dash.dependencies.DashManifestExtensions=function(){"use strict";this.timelineConverter=void 0},Dash.dependencies.DashManifestExtensions.prototype={constructor:Dash.dependencies.DashManifestExtensions,getIsTypeOf:function(a,b){"use strict";var c,d,e,f=a.ContentComponent_asArray,g="text"!==b?new RegExp(b):new RegExp("(vtt|ttml)"),h=!1,i=!1;if(a.Representation_asArray.length>0&&a.Representation_asArray[0].hasOwnProperty("codecs")&&"stpp"==a.Representation_asArray[0].codecs)return"fragmentedText"==b;if(f)for(c=0,d=f.length;c<d;c+=1)f[c].contentType===b&&(h=!0,i=!0);if(a.hasOwnProperty("mimeType")&&(h=g.test(a.mimeType),i=!0),!i)for(c=0,d=a.Representation_asArray.length;!i&&c<d;)e=a.Representation_asArray[c],e.hasOwnProperty("mimeType")&&(h=g.test(e.mimeType),i=!0),c+=1;return h},getIsAudio:function(a){"use strict";return this.getIsTypeOf(a,"audio")},getIsVideo:function(a){"use strict";return this.getIsTypeOf(a,"video")},getIsFragmentedText:function(a){"use strict";return this.getIsTypeOf(a,"fragmentedText")},getIsText:function(a){"use strict";return this.getIsTypeOf(a,"text")},getIsTextTrack:function(a){return"text/vtt"===a||"application/ttml+xml"===a},getLanguageForAdaptation:function(a){var b="";return a.hasOwnProperty("lang")&&(b=a.lang),b},getIsMain:function(){"use strict";return!1},processAdaptation:function(a){"use strict";return void 0!==a.Representation_asArray&&null!==a.Representation_asArray&&a.Representation_asArray.sort(function(a,b){return a.bandwidth-b.bandwidth}),a},getAdaptationForId:function(a,b,c){"use strict";var d,e,f=b.Period_asArray[c].AdaptationSet_asArray;for(d=0,e=f.length;d<e;d+=1)if(f[d].hasOwnProperty("id")&&f[d].id===a)return f[d];return null},getAdaptationForIndex:function(a,b,c){"use strict";var d=b.Period_asArray[c].AdaptationSet_asArray;return d[a]},getIndexForAdaptation:function(a,b,c){"use strict";var d,e,f=b.Period_asArray[c].AdaptationSet_asArray;for(d=0,e=f.length;d<e;d+=1)if(f[d]===a)return d;return-1},getAdaptationsForType:function(a,b,c){"use strict";var d,e,f=this,g=a.Period_asArray[b].AdaptationSet_asArray,h=[];for(d=0,e=g.length;d<e;d+=1)this.getIsTypeOf(g[d],c)&&h.push(f.processAdaptation(g[d]));return h},getAdaptationForType:function(a,b,c){"use strict";var d,e,f,g=this;if(f=this.getAdaptationsForType(a,b,c),!f||0===f.length)return null;for(d=0,e=f.length;d<e;d+=1)if(g.getIsMain(f[d]))return f[d];return f[0]},getCodec:function(a){"use strict";var b=a.Representation_asArray[0];return b.mimeType+';codecs="'+b.codecs+'"'},getMimeType:function(a){"use strict";return a.Representation_asArray[0].mimeType},getKID:function(a){"use strict";return a&&a.hasOwnProperty("cenc:default_KID")?a["cenc:default_KID"]:null},getContentProtectionData:function(a){"use strict";return a&&a.hasOwnProperty("ContentProtection_asArray")&&0!==a.ContentProtection_asArray.length?a.ContentProtection_asArray:null},getIsDynamic:function(a){"use strict";var b=!1,c="dynamic";return a.hasOwnProperty("type")&&(b=a.type===c),b},getIsDVR:function(a){"use strict";var b,c,d=this.getIsDynamic(a);return b=!isNaN(a.timeShiftBufferDepth),c=d&&b},getIsOnDemand:function(a){"use strict";var b=!1;return a.profiles&&a.profiles.length>0&&(b=a.profiles.indexOf("urn:mpeg:dash:profile:isoff-on-demand:2011")!==-1),b},getDuration:function(a){var b;return b=a.hasOwnProperty("mediaPresentationDuration")?a.mediaPresentationDuration:Number.MAX_VALUE},getBandwidth:function(a){"use strict";return a.bandwidth},getRefreshDelay:function(a){"use strict";var b=NaN,c=2;return a.hasOwnProperty("minimumUpdatePeriod")&&(b=Math.max(parseFloat(a.minimumUpdatePeriod),c)),b},getRepresentationCount:function(a){"use strict";return a.Representation_asArray.length},getBitrateListForAdaptation:function(a){if(!a||!a.Representation_asArray||!a.Representation_asArray.length)return null;for(var b=this.processAdaptation(a),c=b.Representation_asArray,d=c.length,e=[],f=0;f<d;f+=1)e.push(c[f].bandwidth);return e},getRepresentationFor:function(a,b){"use strict";return b.Representation_asArray[a]},getRepresentationsForAdaptation:function(a,b){for(var c,d,e,f,g,h=this,i=h.processAdaptation(a.Period_asArray[b.period.index].AdaptationSet_asArray[b.index]),j=[],k=0;k<i.Representation_asArray.length;k+=1){if(f=i.Representation_asArray[k],c=new Dash.vo.Representation,c.index=k,c.adaptation=b,f.hasOwnProperty("id")&&(c.id=f.id),f.hasOwnProperty("bandwidth")&&(c.bandwidth=f.bandwidth),f.hasOwnProperty("SegmentBase")?(e=f.SegmentBase,c.segmentInfoType="SegmentBase"):f.hasOwnProperty("SegmentList")?(e=f.SegmentList,c.segmentInfoType="SegmentList",c.useCalculatedLiveEdgeTime=!0):f.hasOwnProperty("SegmentTemplate")?(e=f.SegmentTemplate,e.hasOwnProperty("SegmentTimeline")?(c.segmentInfoType="SegmentTimeline",g=e.SegmentTimeline.S_asArray[e.SegmentTimeline.S_asArray.length-1],(!g.hasOwnProperty("r")||g.r>=0)&&(c.useCalculatedLiveEdgeTime=!0)):c.segmentInfoType="SegmentTemplate",e.hasOwnProperty("initialization")&&(c.initialization=e.initialization.split("$Bandwidth$").join(f.bandwidth).split("$RepresentationID$").join(f.id))):(e=f.BaseURL,c.segmentInfoType="BaseURL"),e.hasOwnProperty("Initialization")?(d=e.Initialization,d.hasOwnProperty("sourceURL")?c.initialization=d.sourceURL:d.hasOwnProperty("range")&&(c.initialization=f.BaseURL,c.range=d.range)):f.hasOwnProperty("mimeType")&&h.getIsTextTrack(f.mimeType)&&(c.initialization=f.BaseURL,c.range=0),e.hasOwnProperty("timescale")&&(c.timescale=e.timescale),e.hasOwnProperty("duration")&&(c.segmentDuration=e.duration/c.timescale),e.hasOwnProperty("startNumber")&&(c.startNumber=e.startNumber),e.hasOwnProperty("indexRange")&&(c.indexRange=e.indexRange),e.hasOwnProperty("presentationTimeOffset"))c.presentationTimeOffset=e.presentationTimeOffset/c.timescale;else if("dynamic"!==a.type&&e.hasOwnProperty("SegmentTimeline")&&e.SegmentTimeline.S_asArray){var l=e.SegmentTimeline.S_asArray[0],m=l&&l.t;m&&(c.presentationTimeOffset=m/c.timescale)}c.MSETimeOffset=h.timelineConverter.calcMSETimeOffset(c),j.push(c)}return j},getAdaptationsForPeriod:function(a,b){for(var c,d,e=a.Period_asArray[b.index],f=[],g=0;g<e.AdaptationSet_asArray.length;g+=1)d=e.AdaptationSet_asArray[g],c=new Dash.vo.AdaptationSet,d.hasOwnProperty("id")&&(c.id=d.id),c.index=g,c.period=b,this.getIsAudio(d)?c.type="audio":this.getIsVideo(d)?c.type="video":this.getIsFragmentedText(d)?c.type="fragmentedText":c.type="text",f.push(c);return f},getRegularPeriods:function(a,b){var c,d,e=this,f=[],g=e.getIsDynamic(a),h=null,i=null,j=null,k=null;for(c=0,d=a.Period_asArray.length;c<d;c+=1)i=a.Period_asArray[c],i.hasOwnProperty("start")?(k=new Dash.vo.Period,k.start=i.start):null!==h&&i.hasOwnProperty("duration")&&null!==j?(k=new Dash.vo.Period,k.start=j.start+j.duration,k.duration=i.duration):0!==c||g||(k=new Dash.vo.Period,k.start=0),null!==j&&isNaN(j.duration)&&(j.duration=k.start-j.start),null!==k&&i.hasOwnProperty("id")&&(k.id=i.id),null!==k&&i.hasOwnProperty("duration")&&(k.duration=i.duration),null!==k&&(k.index=c,k.mpd=b,f.push(k),h=i,j=k),i=null,k=null;return 0===f.length?f:(b.checkTime=e.getCheckTime(a,f[0]),null!==j&&isNaN(j.duration)&&(j.duration=e.getEndTimeForLastPeriod(b)-j.start),f)},getMpd:function(a){var b=new Dash.vo.Mpd;return b.manifest=a,a.hasOwnProperty("availabilityStartTime")?b.availabilityStartTime=new Date(a.availabilityStartTime.getTime()):b.availabilityStartTime=new Date(a.loadedTime.getTime()),a.hasOwnProperty("availabilityEndTime")&&(b.availabilityEndTime=new Date(a.availabilityEndTime.getTime())),a.hasOwnProperty("suggestedPresentationDelay")&&(b.suggestedPresentationDelay=a.suggestedPresentationDelay),a.hasOwnProperty("timeShiftBufferDepth")&&(b.timeShiftBufferDepth=a.timeShiftBufferDepth),a.hasOwnProperty("maxSegmentDuration")&&(b.maxSegmentDuration=a.maxSegmentDuration),b},getFetchTime:function(a,b){return this.timelineConverter.calcPresentationTimeFromWallTime(a.loadedTime,b)},getCheckTime:function(a,b){var c,d=this,e=NaN;return a.hasOwnProperty("minimumUpdatePeriod")&&(c=d.getFetchTime(a,b),e=c+a.minimumUpdatePeriod),e},getEndTimeForLastPeriod:function(a){var b;if(a.manifest.mediaPresentationDuration)b=a.manifest.mediaPresentationDuration;else{if(isNaN(a.checkTime))throw new Error("Must have @mediaPresentationDuration or @minimumUpdatePeriod on MPD or an explicit @duration on the last period.");b=a.checkTime}return b},getEventsForPeriod:function(a,b){var c=a.Period_asArray,d=c[b.index].EventStream_asArray,e=[];if(d)for(var f=0;f<d.length;f+=1){var g=new Dash.vo.EventStream;if(g.period=b,g.timescale=1,!d[f].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";g.schemeIdUri=d[f].schemeIdUri,d[f].hasOwnProperty("timescale")&&(g.timescale=d[f].timescale),d[f].hasOwnProperty("value")&&(g.value=d[f].value);for(var h=0;h<d[f].Event_asArray.length;h+=1){var i=new Dash.vo.Event;i.presentationTime=0,i.eventStream=g,d[f].Event_asArray[h].hasOwnProperty("presentationTime")&&(i.presentationTime=d[f].Event_asArray[h].presentationTime),d[f].Event_asArray[h].hasOwnProperty("duration")&&(i.duration=d[f].Event_asArray[h].duration),d[f].Event_asArray[h].hasOwnProperty("id")&&(i.id=d[f].Event_asArray[h].id),e.push(i)}}return e},getEventStreams:function(a,b){var c=[];if(!a)return c;for(var d=0;d<a.length;d++){var e=new Dash.vo.EventStream;if(e.timescale=1,e.representation=b,!a[d].hasOwnProperty("schemeIdUri"))throw"Invalid EventStream. SchemeIdUri has to be set";e.schemeIdUri=a[d].schemeIdUri,a[d].hasOwnProperty("timescale")&&(e.timescale=a[d].timescale),a[d].hasOwnProperty("value")&&(e.value=a[d].value),c.push(e)}return c},getEventStreamForAdaptationSet:function(a,b){var c=a.Period_asArray[b.period.index].AdaptationSet_asArray[b.index].InbandEventStream_asArray;return this.getEventStreams(c,null)},getEventStreamForRepresentation:function(a,b){var c=a.Period_asArray[b.adaptation.period.index].AdaptationSet_asArray[b.adaptation.index].Representation_asArray[b.index].InbandEventStream_asArray;return this.getEventStreams(c,b)},getUTCTimingSources:function(a){"use strict";var b=this,c=b.getIsDynamic(a),d=a.hasOwnProperty("availabilityStartTime"),e=a.UTCTiming_asArray,f=[];return(c||d)&&e&&e.forEach(function(a){var b=new Dash.vo.UTCTiming;a.hasOwnProperty("schemeIdUri")&&(b.schemeIdUri=a.schemeIdUri,a.hasOwnProperty("value")&&(b.value=a.value.toString(),f.push(b)))}),f}},Dash.dependencies.DashMetricsExtensions=function(){"use strict";var a=function(a,b){var c,d,e,f,g,h;for(d=a.AdaptationSet_asArray,g=0;g<d.length;g+=1)for(c=d[g],f=c.Representation_asArray,h=0;h<f.length;h+=1)if(e=f[h],b===e.id)return h;return-1},b=function(a,b){var c,d,e,f,g,h;for(d=a.AdaptationSet_asArray,g=0;g<d.length;g+=1)for(c=d[g],f=c.Representation_asArray,h=0;h<f.length;h+=1)if(e=f[h],b===e.id)return e;return null},c=function(a,b){return this.manifestExt.getIsTypeOf(a,b)},d=function(a,b){var d,e,f,g;if(!a||!b)return-1;for(e=a.AdaptationSet_asArray,g=0;g<e.length;g+=1)if(d=e[g],f=d.Representation_asArray,c.call(this,d,b))return f.length;return-1},e=function(a,c){var d,e=this,f=e.manifestModel.getValue(),g=f.Period_asArray[c];return d=b.call(e,g,a),null===d?null:d.bandwidth},f=function(b,c){var d,e=this,f=e.manifestModel.getValue(),g=f.Period_asArray[c];return d=a.call(e,g,b)},g=function(a,b){var c,e=this,f=e.manifestModel.getValue(),g=f.Period_asArray[b];return c=d.call(this,g,a)},h=function(a,b){var c=this.system.getObject("abrController"),d=0;return c&&(d=c.getTopQualityIndexFor(a,b)),d},i=function(a){if(null===a)return null;var b,c,d,e=a.RepSwitchList;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},j=function(a){if(null===a)return null;var b,c,d,e=a.BufferLevel;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},k=function(a){if(null===a)return null;var b,c,d=a.PlayList;return null===d||d.length<=0?null:(b=d[d.length-1].trace,null===b||b.length<=0?null:c=b[b.length-1].playbackspeed)},l=function(a){if(null===a)return null;var b,c,d=a.HttpList,e=null;if(null===d||d.length<=0)return null;for(b=d.length,c=b-1;c>=0;){if(d[c].responsecode){e=d[c];break}c-=1}return e},m=function(a){return null===a?[]:a.HttpList?a.HttpList:[]},n=function(a){if(null===a)return null;var b,c,d,e=a.DroppedFrames;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},o=function(a){if(null===a)return null;var b,c,d,e=a.SchedulingInfo;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},p=function(a){if(null===a)return null;var b,c,d,e=a.ManifestUpdate;return null===e||e.length<=0?null:(b=e.length,c=b-1,d=e[c])},q=function(a){if(null===a)return null;var b,c,d=a.DVRInfo;return null===d||d.length<=0?null:(b=d.length-1,c=d[b])},r=function(a,b){if(null===a)return null;var c,d=m(a),e=d[d.length-1];return"MPD"===e.type&&(c=t(e.responseHeaders)),void 0===c[b]?null:c[b]},s=function(a,b){if(null===a)return null;var c,d=l(a);return null===d||null===d.responseHeaders?null:(c=t(d.responseHeaders),void 0===c[b]?null:c[b])},t=function(a){var b={};if(!a)return b;for(var c=a.split("\r\n"),d=0,e=c.length;d<e;d++){var f=c[d],g=f.indexOf(": ");g>0&&(b[f.substring(0,g)]=f.substring(g+2))}return b};return{manifestModel:void 0,manifestExt:void 0,system:void 0,getBandwidthForRepresentation:e,getIndexForRepresentation:f,getMaxIndexForBufferType:g,getMaxAllowedIndexForBufferType:h,getCurrentRepresentationSwitch:i,getCurrentBufferLevel:j,getCurrentPlaybackRate:k,getCurrentHttpRequest:l,getHttpRequests:m,getCurrentDroppedFrames:n,getCurrentSchedulingInfo:o,getCurrentDVRInfo:q,getCurrentManifestUpdate:p,getLatestFragmentRequestHeaderValueByID:s,getLatestMPDRequestHeaderValueByID:r}},Dash.dependencies.DashMetricsExtensions.prototype={constructor:Dash.dependencies.DashMetricsExtensions},Dash.dependencies.FragmentExtensions=function(){"use strict";var a=0,b=1,c=3,d=4,e=5,f=0,g=2,h=8,i=9,j=10,k=11,l=function(a){for(var b,c,d,e,f,g,h=new DataView(a),i=0;"tfdt"!==e&&i<h.byteLength;){for(d=h.getUint32(i),i+=4,e="",f=0;f<4;f+=1)g=h.getInt8(i),e+=String.fromCharCode(g),i+=1;"moof"!==e&&"traf"!==e&&"tfdt"!==e&&(i+=d-8)}if(i===h.byteLength)throw"Error finding live offset.";return c=h.getUint8(i),0===c?(i+=4,b=h.getUint32(i,!1)):(i+=d-16,b=utils.Math.to64BitNumber(h.getUint32(i+4,!1),h.getUint32(i,!1))),{version:c,base_media_decode_time:b}},m=function(a){for(var b,c,d,e,f,g,h,i=new DataView(a),j=0;"sidx"!==f&&j<i.byteLength;){for(g=i.getUint32(j),j+=4,f="",e=0;e<4;e+=1)h=i.getInt8(j),f+=String.fromCharCode(h),j+=1;"moof"!==f&&"traf"!==f&&"sidx"!==f?j+=g-8:"sidx"===f&&(j-=8)}return b=i.getUint8(j+8),j+=12,c=i.getUint32(j+4,!1),j+=8,d=0===b?i.getUint32(j,!1):utils.Math.to64BitNumber(i.getUint32(j+4,!1),i.getUint32(j,!1)),{earliestPresentationTime:d,timescale:c}},n=function(f){for(var g,h,i,j,k,l,m,n=new DataView(f),o=0;"tfhd"!==h&&o<n.byteLength;){for(g=n.getUint32(o),o+=4,h="",l=0;l<4;l+=1)m=n.getInt8(o),h+=String.fromCharCode(m),o+=1;"moof"!==h&&"traf"!==h&&"tfhd"!==h&&(o+=g-8)}if(o===n.byteLength)throw"Error finding live offset.";return k={baseDataOffset:0,descriptionIndex:0,sampleDuration:0,sampleSize:0,defaultSampleFlags:0},o+=1,o+=2,i=n.getUint8(o),o+=1,j=intTobitArray(i,8),o+=4,j[a]&&(k.baseDataOffset=utils.Math.to64BitNumber(n.getUint32(o+4,!1),n.getUint32(o,!1)),o+=8),j[b]&&(k.descriptionIndex=n.getUint32(o),o+=4),j[c]&&(k.sampleDuration=n.getUint32(o),o+=4),j[d]&&(k.sampleSize=n.getUint32(o),o+=4),j[e]&&(k.defaultSampleFlags=n.getUint32(o),o+=4),k},o=function(a){for(var b,c,d,e,f,g=new DataView(a),h=0;"mdhd"!==d&&h<g.byteLength;){for(c=g.getUint32(h),h+=4,d="",e=0;e<4;e+=1)f=g.getInt8(h),d+=String.fromCharCode(f),h+=1;"moov"!==d&&"trak"!==d&&"mdia"!==d&&"mdhd"!==d&&(h+=c-8)}if(h===g.byteLength)throw"Error finding live offset.";return b=g.getUint8(h),h+=12,1==b&&(h+=8),g.getUint32(h,!1)},p=function(a){var b,c,d,e,m,o,p,q,r,s,t,u,v,w,x,y,z=new DataView(a),A=0;for(w=n(a),x=l(a);"trun"!==c&&A<z.byteLength;){for(b=z.getUint32(A),A+=4,c="",t=0;t<4;t+=1)u=z.getInt8(A),c+=String.fromCharCode(u),A+=1;"moof"!==c&&"traf"!==c&&"trun"!==c&&(A+=b-8),"moof"==c&&(v=A-8)}if(A===z.byteLength)throw"Error finding live offset.";for(A+=1,A+=1,r=z.getUint16(A),A+=2,s=intTobitArray(r,16),m=z.getUint32(A),A+=4,p=x.base_media_decode_time,s[f]?(y=z.getUint32(A)+w.baseDataOffset,A+=4):y=w.baseDataOffset,s[g]&&(A+=4),q=[],t=0;t<m;t++)s[h]?(d=z.getUint32(A),A+=4):d=w.sampleDuration,s[i]?(o=z.getUint32(A),A+=4):o=w.sampleSize,s[j]&&(A+=4),s[k]?(e=z.getUint32(A),A+=4):e=0,q.push({dts:p,cts:p+e,duration:d,offset:v+y,size:o}),y+=o,p+=d;return q},q=function(a){var b,c=this,d=new XMLHttpRequest,e=a,f=!1,g="Error loading fragment: "+e,h=new MediaPlayer.vo.Error(null,g,null);d.onloadend=function(){f||(g="Error loading fragment: "+e,c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:null},h))},d.onload=function(){f=!0,b=l(d.response),c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:b})},d.onerror=function(){g="Error loading fragment: "+e,c.notify(Dash.dependencies.FragmentExtensions.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{fragment:null},h)},d.responseType="arraybuffer",d.open("GET",e),d.send(null)};return{log:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,loadFragment:q,parseTFDT:l,parseSIDX:m,getSamplesInfo:p,getMediaTimescaleFromMoov:o}},Dash.dependencies.FragmentExtensions.prototype={constructor:Dash.dependencies.FragmentExtensions},Dash.dependencies.FragmentExtensions.eventList={ENAME_FRAGMENT_LOADING_COMPLETED:"fragmentLoadingCompleted"},Dash.vo.AdaptationSet=function(){"use strict";this.period=null,this.index=-1,this.type=null},Dash.vo.AdaptationSet.prototype={constructor:Dash.vo.AdaptationSet},Dash.vo.Event=function(){"use strict";this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},Dash.vo.Event.prototype={constructor:Dash.vo.Event},Dash.vo.EventStream=function(){"use strict";this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},Dash.vo.EventStream.prototype={constructor:Dash.vo.EventStream},Dash.vo.Mpd=function(){"use strict";this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.checkTime=NaN,this.clientServerTimeShift=0,this.isClientServerTimeSyncCompleted=!1},Dash.vo.Mpd.prototype={constructor:Dash.vo.Mpd},Dash.vo.Period=function(){"use strict";this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null},Dash.vo.Period.prototype={constructor:Dash.vo.Period},Dash.vo.Representation=function(){"use strict";this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN},Dash.vo.Representation.prototype={constructor:Dash.vo.Representation},Dash.vo.Segment=function(){"use strict";this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null},Dash.vo.Segment.prototype={constructor:Dash.vo.Segment},Dash.vo.UTCTiming=function(){"use strict";this.schemeIdUri="",this.value=""},Dash.vo.UTCTiming.prototype={constructor:Dash.vo.UTCTiming},MediaPlayer.dependencies.ErrorHandler=function(){"use strict";var a=MediaPlayer.events.ERROR;return{eventBus:void 0,capabilityError:function(b){this.eventBus.dispatchEvent({type:a,error:"capability",event:b})},downloadError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"download",event:{id:b,url:c,
request:d}})},manifestError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"manifestError",event:{message:b,id:c,manifest:d}})},closedCaptionsError:function(b,c,d){this.eventBus.dispatchEvent({type:a,error:"cc",event:{message:b,id:c,cc:d}})},mediaSourceError:function(b){this.eventBus.dispatchEvent({type:a,error:"mediasource",event:b})},mediaKeySessionError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_session",event:b})},mediaKeyMessageError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_message",event:b})},mediaKeySystemSelectionError:function(b){this.eventBus.dispatchEvent({type:a,error:"key_system_selection",event:b})},licenseRequestError:function(b){this.eventBus.dispatchEvent({type:a,error:"download",event:b})}}},MediaPlayer.dependencies.ErrorHandler.prototype={constructor:MediaPlayer.dependencies.ErrorHandler},MediaPlayer.dependencies.FragmentLoader=function(){"use strict";var a=3,b=500,c=[],d=function(a,e){var f=new XMLHttpRequest,g=null,h=!0,i=!0,j=null,k=this,l=function(a,b){i=!1;var c,d,e=new Date,h=f.response;a.firstByteDate||(a.firstByteDate=a.requestStartDate),a.requestEndDate=e,c=a.firstByteDate.getTime()-a.requestStartDate.getTime(),d=a.requestEndDate.getTime()-a.firstByteDate.getTime(),k.log((b?"loaded ":"failed ")+a.mediaType+":"+a.type+":"+a.startTime+" ("+f.status+", "+c+"ms, "+d+"ms)"),g.tresponse=a.firstByteDate,g.tfinish=a.requestEndDate,g.responsecode=f.status,g.responseHeaders=f.getAllResponseHeaders(),k.metricsModel.appendHttpTrace(g,e,e.getTime()-j.getTime(),[h?h.byteLength:0]),j=e};/(^|;)\s*userId=/.test(document.cookie)?f.withCredentials=!0:f.withCredentials=!1,c.push(f),a.requestStartDate=new Date,g=k.metricsModel.addHttpRequest(a.mediaType,null,a.type,a.url,null,a.range,a.requestStartDate,null,null,null,null,a.duration,null),k.metricsModel.appendHttpTrace(g,a.requestStartDate,a.requestStartDate.getTime()-a.requestStartDate.getTime(),[0]),j=a.requestStartDate,f.open("GET",k.requestModifierExt.modifyRequestURL(a.url),!0),f.responseType="arraybuffer",f=k.requestModifierExt.modifyRequestHeader(f),a.range&&f.setRequestHeader("Range","bytes="+a.range),f.onprogress=function(b){var c=new Date;h&&(h=!1,(!b.lengthComputable||b.lengthComputable&&b.total!=b.loaded)&&(a.firstByteDate=c,g.tresponse=c)),k.metricsModel.appendHttpTrace(g,c,c.getTime()-j.getTime(),[f.response?f.response.byteLength:0]),j=c},f.onload=function(){f.status<200||f.status>299||(l(a,!0),k.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:a,response:f.response}))},f.onloadend=f.onerror=function(){c.indexOf(f)!==-1&&(c.splice(c.indexOf(f),1),i&&(l(a,!1),e>0?(k.log("Failed loading fragment: "+a.mediaType+":"+a.type+":"+a.startTime+", retry in "+b+"ms attempts: "+e),e--,setTimeout(function(){d.call(k,a,e)},b)):(k.log("Failed loading fragment: "+a.mediaType+":"+a.type+":"+a.startTime+" no retry attempts left"),k.errHandler.downloadError("content",a.url,f),k.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:a,bytes:null},new MediaPlayer.vo.Error(null,"failed loading fragment",null)))))},f.send()},e=function(a){var b=this,c=new XMLHttpRequest,d=!1;c.open("HEAD",a.url,!0),c.onload=function(){c.status<200||c.status>299||(d=!0,b.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!0}))},c.onloadend=c.onerror=function(){d||b.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!1})},c.send()};return{metricsModel:void 0,errHandler:void 0,log:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,load:function(b){b?d.call(this,b,a):this.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,{request:b,bytes:null},new MediaPlayer.vo.Error(null,"request is null",null))},checkForExistence:function(a){return a?void e.call(this,a):void this.notify(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,{request:a,exists:!1})},abort:function(){var a,b,d=c.length;for(a=0;a<d;a+=1)b=c[a],c[a]=null,b.abort(),b=null;c=[]}}},MediaPlayer.dependencies.FragmentLoader.prototype={constructor:MediaPlayer.dependencies.FragmentLoader},MediaPlayer.dependencies.FragmentLoader.eventList={ENAME_LOADING_COMPLETED:"loadingCompleted",ENAME_CHECK_FOR_EXISTENCE_COMPLETED:"checkForExistenceCompleted"},MediaPlayer.dependencies.LiveEdgeFinder=function(){"use strict";var a,b=!1,c=NaN,d=MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES,e=function(a){var b=a.value,d=((new Date).getTime()-c)/1e3;this.notify(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,{liveEdge:b,searchTime:d},null===b?new MediaPlayer.vo.Error(MediaPlayer.dependencies.LiveEdgeFinder.LIVE_EDGE_NOT_FOUND_ERROR_CODE,"live edge has not been found",null):null)},f=function(f){var g=this;!g.streamProcessor.isDynamic()||b||f.error||(a=g.synchronizationRulesCollection.getRules(d),b=!0,c=(new Date).getTime(),g.rulesController.applyRules(a,g.streamProcessor,e.bind(g),null,function(a,b){return b}))},g=function(a){d=a.error?MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES:MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES};return{system:void 0,synchronizationRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=f,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=g},initialize:function(a){this.streamProcessor=a,this.fragmentLoader=a.fragmentLoader},abortSearch:function(){b=!1,c=NaN}}},MediaPlayer.dependencies.LiveEdgeFinder.prototype={constructor:MediaPlayer.dependencies.LiveEdgeFinder},MediaPlayer.dependencies.LiveEdgeFinder.eventList={ENAME_LIVE_EDGE_SEARCH_COMPLETED:"liveEdgeFound"},MediaPlayer.dependencies.LiveEdgeFinder.LIVE_EDGE_NOT_FOUND_ERROR_CODE=1,MediaPlayer.dependencies.ManifestLoader=function(){"use strict";var a=3,b=500,c=function(a){var b=null;return a.indexOf("/")!==-1&&(a.indexOf("?")!==-1&&(a=a.substring(0,a.indexOf("?"))),b=a.substring(0,a.lastIndexOf("/")+1)),b},d=function(a,e){var f,g,h,i=c(a),j=new XMLHttpRequest,k=new Date,l=null,m=!0,n=this;g=function(){j.status<200||j.status>299||(m=!1,l=new Date,n.metricsModel.addHttpRequest("stream",null,"MPD",a,null,null,k,l,null,j.status,null,null,j.getAllResponseHeaders()),f=n.parser.parse(j.responseText,i),f?(f.url=a,f.loadedTime=l,n.metricsModel.addManifestUpdate("stream",f.type,k,l,f.availabilityStartTime),n.xlinkController.resolveManifestOnLoad(f)):n.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,{manifest:null},new MediaPlayer.vo.Error(null,"Failed loading manifest: "+a,null)))},h=function(){m&&(m=!1,n.metricsModel.addHttpRequest("stream",null,"MPD",a,null,null,k,new Date,j.status,null,null,j.getAllResponseHeaders()),e>0?(n.log("Failed loading manifest: "+a+", retry in "+b+"ms attempts: "+e),e--,setTimeout(function(){d.call(n,a,e)},b)):(n.log("Failed loading manifest: "+a+" no retry attempts left"),n.errHandler.downloadError("manifest",a,j),n.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,null,new Error("Failed loading manifest: "+a+" no retry attempts left"))))};try{j.onload=g,j.onloadend=h,j.onerror=h,j.open("GET",n.requestModifierExt.modifyRequestURL(a),!0),j.send()}catch(a){j.onerror()}},e=function(a){this.notify(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,{manifest:a.data.manifest})};return{log:void 0,parser:void 0,errHandler:void 0,metricsModel:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,xlinkController:void 0,load:function(b){d.call(this,b,a)},setup:function(){e=e.bind(this),this.xlinkController.subscribe(MediaPlayer.dependencies.XlinkController.eventList.ENAME_XLINK_READY,this,e)}}},MediaPlayer.dependencies.ManifestLoader.prototype={constructor:MediaPlayer.dependencies.ManifestLoader},MediaPlayer.dependencies.ManifestLoader.eventList={ENAME_MANIFEST_LOADED:"manifestLoaded"},MediaPlayer.dependencies.ManifestUpdater=function(){"use strict";var a,b,c,d=NaN,e=null,f=function(){null!==e&&(clearInterval(e),e=null)},g=function(){f.call(this),isNaN(d)||(this.log("Refresh manifest in "+d+" seconds."),e=setTimeout(i.bind(this),Math.min(1e3*d,Math.pow(2,31)-1),this))},h=function(b){var c,e;this.manifestModel.setValue(b),this.log("Manifest has been refreshed."),c=this.manifestExt.getRefreshDelay(b),e=((new Date).getTime()-b.loadedTime.getTime())/1e3,d=Math.max(c-e,0),this.notify(MediaPlayer.dependencies.ManifestUpdater.eventList.ENAME_MANIFEST_UPDATED,{manifest:b}),a||g.call(this)},i=function(){var d,e,f=this;a||b||(b=!0,d=f.manifestModel.getValue(),e=d.url,d.hasOwnProperty("Location")&&(e=d.Location),c.load(e))},j=function(a){a.error||h.call(this,a.data.manifest)},k=function(){a=!1,g.call(this)},l=function(){a=!0,f.call(this)},m=function(){b=!1};return{log:void 0,system:void 0,subscribe:void 0,unsubscribe:void 0,notify:void 0,manifestModel:void 0,manifestExt:void 0,setup:function(){this[MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED]=m,this[MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED]=j,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED]=k,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED]=l},initialize:function(d){b=!1,a=!0,c=d,c.subscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,this)},setManifest:function(a){h.call(this,a)},getManifestLoader:function(){return c},reset:function(){a=!0,f.call(this),c.unsubscribe(MediaPlayer.dependencies.ManifestLoader.eventList.ENAME_MANIFEST_LOADED,this)}}},MediaPlayer.dependencies.ManifestUpdater.prototype={constructor:MediaPlayer.dependencies.ManifestUpdater},MediaPlayer.dependencies.ManifestUpdater.eventList={ENAME_MANIFEST_UPDATED:"manifestUpdated"},MediaPlayer.dependencies.Notifier=function(){"use strict";var a,b="observableId",c=0,d=function(){return this[b]||(c+=1,this[b]="_id_"+c),this[b]};return{system:void 0,setup:function(){a=this.system,a.mapValue("notify",this.notify),a.mapValue("subscribe",this.subscribe),a.mapValue("unsubscribe",this.unsubscribe)},notify:function(){var b=arguments[0]+d.call(this),c=new MediaPlayer.vo.Event;c.sender=this,c.type=arguments[0],c.data=arguments[1],c.error=arguments[2],c.timestamp=(new Date).getTime(),a.notify.call(a,b,c)},subscribe:function(b,c,e,f){if(!e&&c[b]&&(e=c[b]=c[b].bind(c)),!c)throw"observer object cannot be null or undefined";if(!e)throw"event handler cannot be null or undefined";b+=d.call(this),a.mapHandler(b,void 0,e,f)},unsubscribe:function(b,c,e){e=e||c[b],b+=d.call(this),a.unmapHandler(b,void 0,e)}}},MediaPlayer.dependencies.Notifier.prototype={constructor:MediaPlayer.dependencies.Notifier},MediaPlayer.dependencies.Stream=function(){"use strict";var a=[],b=!1,c=!1,d=null,e=null,f={},g=null,h=[],i=null,j=function(a){this.errHandler.mediaKeySessionError(a),this.log(a),this.reset()},k=function(a){var b=MediaPlayer.dependencies.protection.CommonEncryption.getPSSHForKeySystem(i,a);if(b)try{this.protectionController.createKeySession(b,"temporary")}catch(a){j.call(this,"Error creating key session! "+a.message)}else j.call(this,"Selected key system is "+i.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!")},l=function(a){if("cenc"!==a.data.initDataType)return void this.log("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+a.data.initDataType);var b=a.data.initData;if(ArrayBuffer.isView(b)&&(b=b.buffer),i)k.call(this,b);else if(void 0===i){i=null,h.push(b);try{this.protectionExt.autoSelectKeySystem(this.protectionExt.getSupportedKeySystems(b),this.protectionModel,this.protectionController,w.call(this,"video"),w.call(this,"audio"))}catch(a){j.call(this,a.message)}}else h.push(b)},m=function(){i||(i=this.protectionModel.keySystem);for(var a=0;a<h.length;a++)k.call(this,h[a]);h=[]},n=function(a){a.error?j.call(this,a.error):this.log("DRM: License server certificate successfully updated.")},o=function(a){a.error?j.call(this,a.error):this.log("DRM: Session created.  SessionID = "+a.data.getSessionID())},p=function(){this.log("DRM: Key added.")},q=function(a){var b,c=a.data.sessionToken;b="DRM: MediaKeyError - sessionId: "+c.getSessionID()+".  "+a.data.error,j.call(this,b)},r=function(a){a.error?this.log(a.data.error):this.log("DRM: Session closed.  SessionID = "+a.data)},s=function(a){a.error?this.log(a.data.error):this.log("DRM: Session removed.  SessionID = "+a.data)},t=function(b,c){var d,f,h=this,i=null,j=h.manifestModel.getValue(),k=function(a){return a.codec},l=h.adapter.getMediaInfoForType(j,e,b);if("text"===b&&(k=function(a){return i=a.mimeType}),null!==l){var m,n=k.call(h,l);if("text"!==b&&"fragmentedText"!==b)if(d=n,h.log(b+" codec: "+d),m=l.contentProtection,m&&!h.capabilities.supportsEncryptedMedia())h.errHandler.capabilityError("encryptedmedia");else if(!h.capabilities.supportsCodec(h.videoModel.getElement(),d)){var o=b+"Codec ("+d+") is not supported.";return h.errHandler.manifestError(o,"codec",j),void h.log(o)}f=h.system.getObject("streamProcessor"),a.push(f),f.initialize(i||b,h.fragmentController,c,h,g),h.abrController.updateTopQualityIndex(l),f.updateMediaInfo(j,l)}else h.log("No "+b+" data.")},u=function(b){var d,f=this,h=f.manifestModel.getValue();if(g=f.system.getObject("eventController"),d=f.adapter.getEventsFor(e),g.addInlineEvents(d),t.call(f,"video",b),t.call(f,"audio",b),t.call(f,"text",b),t.call(f,"fragmentedText",b),x.call(f),c=!0,0===a.length){var i="No streams to play.";f.errHandler.manifestError(i,"nostreams",h),f.log(i)}else f.liveEdgeFinder.initialize(a[0]),f.liveEdgeFinder.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,f.playbackController);v.call(this)},v=function(){var d=this,g=a.length,h=!!f.audio||!!f.video,i=h?new MediaPlayer.vo.Error(MediaPlayer.dependencies.Stream.DATA_UPDATE_FAILED_ERROR_CODE,"Data update failed",null):null,j=0;if(c&&!b){for(j;j<g;j+=1)if(a[j].isUpdating())return;b=!0,d.eventBus.dispatchEvent({type:MediaPlayer.events.STREAM_INITIALIZED,data:{streamInfo:e}}),d.notify(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,null,i)}},w=function(b){for(var c=a.length,d=null,e=0;e<c;e+=1)if(d=a[e],d.getType()===b)return d.getMediaInfo();return null},x=function(){for(var b=0,c=a.length;b<c;b+=1)a[b].createBuffer()},y=function(){var a=A(),b=a.length,c=0;for(c;c<b;c+=1)if(!a[c].isBufferingCompleted())return;this.notify(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_BUFFERING_COMPLETED,{streamInfo:e})},z=function(a){var b=a.sender.streamProcessor.getType();f[b]=a.error,v.call(this)},A=function(){var b,c,d=[],e=0,f=a.length;for(e;e<f;e+=1)c=a[e],b=c.getType(),"audio"!==b&&"video"!==b||d.push(c);return d},B=function(c){var d,f,h,i=this,j=a.length,k=i.manifestModel.getValue(),l=0;for(b=!1,e=c,i.log("Manifest updated... set new data on buffers."),g&&(f=i.adapter.getEventsFor(e),g.addInlineEvents(f)),l;l<j;l+=1)h=a[l],d=i.adapter.getMediaInfoForType(k,e,h.getType()),this.abrController.updateTopQualityIndex(d),h.updateMediaInfo(k,d)};return{system:void 0,eventBus:void 0,manifestModel:void 0,sourceBufferExt:void 0,adapter:void 0,videoModel:void 0,fragmentController:void 0,playbackController:void 0,protectionExt:void 0,capabilities:void 0,log:void 0,errHandler:void 0,liveEdgeFinder:void 0,abrController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED]=y,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=z,this[MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY]=l.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=m.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED]=n.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED]=p.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR]=q.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED]=o.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED]=r.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED]=s.bind(this),i=void 0},initProtection:function(){if(this.capabilities.supportsEncryptedMedia()){this.protectionModel=this.system.getObject("protectionModel"),this.protectionModel.init(this.videoModel),this.protectionModel.setMediaElement(this.videoModel.getElement()),this.protectionController=this.system.getObject("protectionController"),this.protectionController.init(this.protectionModel),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this);var a=this.manifestModel.getValue(),b=this.adapter.getMediaInfoForType(a,e,"audio"),c=this.adapter.getMediaInfoForType(a,e,"video"),d=c?c:b,f=this.protectionExt.getSupportedKeySystemsFromContentProtection(d.contentProtection);if(f&&f.length>0){var g={},h=this;g[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=function(a){if(a.error)h.debug.log("DRM: Could not select key system from ContentProtection elements!  Falling back to needkey mechanism..."),h.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,h),h.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,h);else{i=h.protectionModel.keySystem;for(var b=0;b<f.length;b++)if(i===f[b].ks){k.call(h,f[b].initData);break}}h.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,g)},i=null,this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,g),this.protectionExt.autoSelectKeySystem(f,this.protectionModel,this.protectionController,c,b)}else this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this)}},activate:function(a){b?x.call(this):u.call(this,a)},deactivate:function(){var d=a.length,e=0;for(e;e<d;e+=1)a[e].reset();a=[],b=!1,c=!1,this.resetEventController()},reset:function(e){this.playbackController.pause(),this.protectionModel&&(this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,this),i=void 0,this.protectionController.teardown(),this.protectionModel.teardown(),this.protectionController=void 0,this.protectionModel=void 0);var h,j=a.length,k=0;for(k;k<j;k+=1)h=a[k],h.reset(e),h=null;g&&g.reset(),a=[],d=null,this.fragmentController&&this.fragmentController.reset(),this.fragmentController=void 0,this.liveEdgeFinder.abortSearch(),this.liveEdgeFinder.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.playbackController),c=!1,b=!1,f={}},getDuration:function(){return e.duration},getStartTime:function(){return e.start},getStreamIndex:function(){return e.index},getId:function(){return e.id},setStreamInfo:function(a){e=a},getStreamInfo:function(){return e},getBitrateListFor:function(a){var b=w.call(this,a);return this.abrController.getBitrateList(b)},startEventController:function(){g.start()},resetEventController:function(){g.reset()},isActivated:function(){return b},updateData:B}},MediaPlayer.dependencies.Stream.prototype={constructor:MediaPlayer.dependencies.Stream},MediaPlayer.dependencies.Stream.DATA_UPDATE_FAILED_ERROR_CODE=1,MediaPlayer.dependencies.Stream.eventList={ENAME_STREAM_UPDATED:"streamUpdated",ENAME_STREAM_BUFFERING_COMPLETED:"streamBufferingCompleted"},MediaPlayer.dependencies.StreamProcessor=function(){"use strict";var a,b=null,c=null,d=null,e=null,f=function(a){var b=this,c="video"===a||"audio"===a||"fragmentedText"===a?"bufferController":"textController";return b.system.getObject(c)};return{system:void 0,videoModel:void 0,indexHandler:void 0,liveEdgeFinder:void 0,timelineConverter:void 0,abrController:void 0,playbackController:void 0,baseURLExt:void 0,adapter:void 0,manifestModel:void 0,initialize:function(c,g,h,i,j){var k,l=this,m=l.system.getObject("trackController"),n=l.system.getObject("scheduleController"),o=l.liveEdgeFinder,p=l.abrController,q=l.indexHandler,r=l.baseURLExt,s=l.playbackController,t=this.system.getObject("fragmentLoader"),u=f.call(l,c);b=i,d=c,e=j,a=b.getStreamInfo().manifestInfo.isDynamic,l.bufferController=u,l.scheduleController=n,l.trackController=m,l.fragmentController=g,l.fragmentLoader=t,m.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,u),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED,u),m.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,b),"video"===d||"audio"===d||"fragmentedText"===d?(p.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,u),p.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,m),p.subscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,n),o.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.timelineConverter),o.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,m),o.subscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,n),m.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED,n),m.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,n),b.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,n),m.subscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,s),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED,u),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,n),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,n),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,u),g.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,n.scheduleRulesCollection.bufferLevelRule),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,s),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,m),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED,b),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,n),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,n.scheduleRulesCollection.bufferLevelRule),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,n.scheduleRulesCollection.bufferLevelRule),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,s),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,u),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,u),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,u),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,n),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,u),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,n),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,n),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,n.scheduleRulesCollection.playbackTimeRule),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,p.abrRulesCollection.insufficientBufferRule),a&&s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,m),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,u),s.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,n),r.subscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,q),r.subscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,q)):u.subscribe(MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,n),q.initialize(this),q.setCurrentTime(s.getStreamStartTime(this.getStreamInfo())),u.initialize(d,h,l),n.initialize(d,this),p.initialize(d,this),k=this.getFragmentModel(),k.setLoader(t),k.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,g),k.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,g),k.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,g),k.subscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,n),t.subscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,k),"video"!==d&&"audio"!==d&&"fragmentedText"!==d||(u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,k),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,k),u.subscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,k)),m.initialize(this)},isUpdating:function(){return this.trackController.isUpdating()},getType:function(){return d},getFragmentLoader:function(){return this.fragmentLoader},getFragmentModel:function(){return this.scheduleController.getFragmentModel()},getStreamInfo:function(){return b.getStreamInfo()},updateMediaInfo:function(a,b){b===c||b&&c&&b.type!==c.type||(c=b),this.adapter.updateData(a,this)},getMediaInfo:function(){return c},getScheduleController:function(){return this.scheduleController},getEventController:function(){return e},start:function(){this.scheduleController.start()},stop:function(){this.scheduleController.stop()},getCurrentTrack:function(){return this.adapter.getCurrentTrackInfo(this.manifestModel.getValue(),this.trackController)},getTrackForQuality:function(a){return this.adapter.getTrackInfoForQuality(this.manifestModel.getValue(),this.trackController,a)},isBufferingCompleted:function(){return this.bufferController.isBufferingCompleted()},createBuffer:function(){return this.bufferController.getBuffer()||this.bufferController.createBuffer(c)},isDynamic:function(){return a},reset:function(f){var g=this,h=g.bufferController,i=g.trackController,j=g.scheduleController,k=g.liveEdgeFinder,l=g.fragmentController,m=g.abrController,n=g.playbackController,o=this.indexHandler,p=this.baseURLExt,q=this.getFragmentModel(),r=this.fragmentLoader;m.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,h),m.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,i),m.unsubscribe(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,j),k.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,this.timelineConverter),k.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,j),k.unsubscribe(MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED,i),i.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED,j),i.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,h),i.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,j),i.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,b),i.unsubscribe(Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED,n),b.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,j),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED,h),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED,h),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,j),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,j),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,h),l.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,j.scheduleRulesCollection.bufferLevelRule),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,n),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,i),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED,b),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,j),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,j.scheduleRulesCollection.bufferLevelRule),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,j.scheduleRulesCollection.bufferLevelRule),
h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,n),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,h),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,h),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,h),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED,j),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,h),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,j),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,j),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,i),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,h),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,j),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,j.scheduleRulesCollection.playbackTimeRule),n.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,m.abrRulesCollection.insufficientBufferRule),p.unsubscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_INITIALIZATION_LOADED,o),p.unsubscribe(Dash.dependencies.BaseURLExtensions.eventList.ENAME_SEGMENTS_LOADED,o),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,q),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,q),h.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,q),q.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,l),q.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,l),q.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,l),q.unsubscribe(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,j),r.unsubscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED,q),q.reset(),o.reset(),this.bufferController.reset(f),this.scheduleController.reset(),this.bufferController=null,this.scheduleController=null,this.trackController=null,this.videoModel=null,this.fragmentController=null,a=void 0,b=null,c=null,d=null,e=null}}},MediaPlayer.dependencies.StreamProcessor.prototype={constructor:MediaPlayer.dependencies.StreamProcessor},MediaPlayer.utils.TTMLParser=function(){"use strict";var a,b=3600,c=60,d=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])((\.[0-9][0-9][0-9])|(:[0-9][0-9]))$/,e=function(e){var f,g,h,i=d.test(e);if(!i)return NaN;if(f=e.split(":"),g=parseFloat(f[0])*b+parseFloat(f[1])*c+parseFloat(f[2]),f[3]){if(h=a.tt.frameRate,!h||isNaN(h))return NaN;g+=parseFloat(f[3])/h}return g},f=function(){var b=!1,c=a.hasOwnProperty("tt"),d=!!c&&a.tt.hasOwnProperty("head"),e=!!d&&a.tt.head.hasOwnProperty("layout"),f=!!d&&a.tt.head.hasOwnProperty("styling"),g=!!c&&a.tt.hasOwnProperty("body");return c&&d&&e&&f&&g&&(b=!0),b},g=function(a,b){var c=Object.keys(a).filter(function(c){return"xmlns"===c.split(":")[0]&&a[c]===b}).map(function(a){return a.split(":")[1]});return 1!=c.length?null:c[0]},h=function(b){var c,d,h,i,j,k,l,m,n,o=[],p=new X2JS([],"",!1);if(a=p.xml_str2json(b),!f())throw c="TTML document has incorrect structure";if(k=g(a.tt,"http://www.w3.org/ns/ttml#parameter"),a.tt.hasOwnProperty(k+":frameRate")&&(a.tt.frameRate=parseInt(a.tt[k+":frameRate"],10)),d=a.tt.body.div_asArray?a.tt.body.div_asArray[0].p_asArray:a.tt.body.p_asArray,!d||0===d.length)throw c="TTML document does not contain any cues";for(m=0;m<d.length;m+=1){if(h=d[m],i=e(h.begin),j=e(h.end),isNaN(i)||isNaN(j))throw c="TTML document has incorrect timing value";if(void 0!==h["smpte:backgroundImage"]){var q=a.tt.head.metadata.image_asArray;for(n=0;n<q.length;n+=1)"#"+q[n]["xml:id"]==h["smpte:backgroundImage"]&&o.push({start:i,end:j,id:q[n]["xml:id"],data:"data:image/"+q[n].imagetype.toLowerCase()+";base64, "+q[n].__text,type:"image"})}else l=h.span_asArray?h.span_asArray[0].__text:h.__text,o.push({start:i,end:j,data:l,type:"text"})}return o};return{parse:h}},MediaPlayer.dependencies.TextSourceBuffer=function(){var a,b;return{system:void 0,videoModel:void 0,eventBus:void 0,errHandler:void 0,initialize:function(c,d){b=c,a=d.streamProcessor.getCurrentTrack().mediaInfo,this.buffered=this.system.getObject("customTimeRanges"),this.initializationSegmentReceived=!1,this.timescale=9e4},append:function(c,d){var e,f,g,h,i,j,k=this;if("fragmentedText"==b){var l;if(this.initializationSegmentReceived)for(l=k.system.getObject("fragmentExt"),h=l.getSamplesInfo(c.buffer),i=0;i<h.length;i++){this.firstSubtitleStart||(this.firstSubtitleStart=h[0].cts-d.startTime*this.timescale),h[i].cts-=this.firstSubtitleStart,this.buffered.add(h[i].cts/this.timescale,(h[i].cts+h[i].duration)/this.timescale),j=window.UTF8.decode(new Uint8Array(c.buffer.slice(h[i].offset,h[i].offset+h[i].size)));var m=this.system.getObject("ttmlParser");try{e=m.parse(j),this.textTrackExtensions.addCaptions(this.firstSubtitleStart/this.timescale,e)}catch(a){}}else this.initializationSegmentReceived=!0,f=a.id,g=a.lang,this.textTrackExtensions=k.getTextTrackExtensions(),this.textTrackExtensions.addTextTrack(k.videoModel.getElement(),e,f,g,!0),k.eventBus.dispatchEvent({type:MediaPlayer.events.TEXT_TRACK_ADDED}),l=k.system.getObject("fragmentExt"),this.timescale=l.getMediaTimescaleFromMoov(c.buffer)}else{j=window.UTF8.decode(c);try{e=k.getParser().parse(j),f=a.id,g=a.lang,k.getTextTrackExtensions().addTextTrack(k.videoModel.getElement(),e,f,g,!0),k.eventBus.dispatchEvent({type:MediaPlayer.events.TEXT_TRACK_ADDED})}catch(a){k.errHandler.closedCaptionsError(a,"parse",j)}}},abort:function(){this.getTextTrackExtensions().deleteCues(this.videoModel.getElement())},getParser:function(){var a;return"text/vtt"===b?a=this.system.getObject("vttParser"):"application/ttml+xml"===b&&(a=this.system.getObject("ttmlParser")),a},getTextTrackExtensions:function(){return this.system.getObject("textTrackExtensions")},addEventListener:function(a,b,c){this.eventBus.addEventListener(a,b,c)},removeEventListener:function(a,b,c){this.eventBus.removeEventListener(a,b,c)}}},MediaPlayer.dependencies.TextSourceBuffer.prototype={constructor:MediaPlayer.dependencies.TextSourceBuffer},MediaPlayer.dependencies.TimeSyncController=function(){"use strict";var a=5e3,b=0,c=!1,d=!1,e=function(a){c=a},f=function(){return c},g=function(a){d=a},h=function(a){b=a},i=function(){return b},j=function(a){var b,c,d=60,e=60,f=1e3,g=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,h=g.exec(a);return b=Date.UTC(parseInt(h[1],10),parseInt(h[2],10)-1,parseInt(h[3],10),parseInt(h[4],10),parseInt(h[5],10),h[6]&&(parseInt(h[6],10)||0),h[7]&&parseFloat(h[7])*f||0),h[9]&&h[10]&&(c=parseInt(h[9],10)*e+parseInt(h[10],10),b+=("+"===h[8]?-1:1)*c*d*f),new Date(b).getTime()},k=function(a){var b=Date.parse(a);return isNaN(b)&&(b=j(a)),b},l=function(a){return Date.parse(a)},m=function(a){return Date.parse(a)},n=function(a,b,c){c()},o=function(a,b,c){var d=k(a);return isNaN(d)?void c():void b(d)},p=function(b,c,d,e,f){var g,h,i=!1,j=new XMLHttpRequest,k=f?"HEAD":"GET",l=c.match(/\S+/g);c=l.shift(),g=function(){i||(i=!0,l.length?p(b,l.join(" "),d,e,f):e())},h=function(){var a,c;200===j.status&&(a=f?j.getResponseHeader("Date"):j.response,c=b(a),isNaN(c)||(d(c),i=!0))},j.open(k,c),j.timeout=a||0,j.onload=h,j.onloadend=g,j.send()},q=function(a,b,c){p.call(this,m,a,b,c,!0)},r={"urn:mpeg:dash:utc:http-head:2014":q,"urn:mpeg:dash:utc:http-xsdate:2014":p.bind(null,k),"urn:mpeg:dash:utc:http-iso:2014":p.bind(null,l),"urn:mpeg:dash:utc:direct:2014":o,"urn:mpeg:dash:utc:http-head:2012":q,"urn:mpeg:dash:utc:http-xsdate:2012":p.bind(null,k),"urn:mpeg:dash:utc:http-iso:2012":p.bind(null,l),"urn:mpeg:dash:utc:direct:2012":o,"urn:mpeg:dash:utc:http-ntp:2014":n,"urn:mpeg:dash:utc:ntp:2014":n,"urn:mpeg:dash:utc:sntp:2014":n},s=function(a,b){var c=this,d=b||0,f=a[d],g=function(a,b){var d=!a||!b;e(!1),c.notify(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,{time:a,offset:b},d?new MediaPlayer.vo.Error(MediaPlayer.dependencies.TimeSyncController.TIME_SYNC_FAILED_ERROR_CODE):null)};e(!0),f?r.hasOwnProperty(f.schemeIdUri)?r[f.schemeIdUri](f.value,function(a){var b=(new Date).getTime(),d=a-b;h(d),c.log("Local time:      "+new Date(b)),c.log("Server time:     "+new Date(a)),c.log("Difference (ms): "+d),g.call(c,a,d)},function(){s.call(c,a,d+1)}):s.call(c,a,d+1):(h(0),g.call(c))};return{log:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,getOffsetToDeviceTimeMs:function(){return i()},initialize:function(a){f()||(s.call(this,a),g(!0))},reset:function(){g(!1),e(!1)}}},MediaPlayer.dependencies.TimeSyncController.prototype={constructor:MediaPlayer.dependencies.TimeSyncController},MediaPlayer.dependencies.TimeSyncController.eventList={ENAME_TIME_SYNCHRONIZATION_COMPLETED:"timeSynchronizationComplete"},MediaPlayer.dependencies.TimeSyncController.TIME_SYNC_FAILED_ERROR_CODE=1,MediaPlayer.utils.VTTParser=function(){"use strict";var a=/(?:\r\n|\r|\n)/gm,b=/-->/,c=/(^[\s]+|[\s]+$)/g,d=/\s\b/g,e=function(a){var b=a.split(":"),c=b.length-1;return a=60*parseInt(b[c-1],10)+parseFloat(b[c]),2===c&&(a+=3600*parseInt(b[0],10)),a},f=function(a){var c=a.split(b),e=c[1].split(d);return e.shift(),c[1]=e[0],e.shift(),{cuePoints:c,styles:g(e)}},g=function(a){var b={};return a.forEach(function(a){(a.match(/align/)||a.match(/A/))&&(b.align=a.split(/:/)[1]),(a.match(/line/)||a.match(/L/))&&(b.line=a.split(/:/)[1].replace(/%/,"")),(a.match(/position/)||a.match(/P/))&&(b.position=a.split(/:/)[1].replace(/%/,"")),(a.match(/size/)||a.match(/S/))&&(b.size=a.split(/:/)[1].replace(/%/,""))}),b},h=function(a,b){for(var c,d=b,e="";""!==a[d]&&d<a.length;)d++;if(c=d-b,c>1)for(var f=0;f<c;f++)e+=a[b+f],f!==c-1&&(e+="\n");else e=a[b];return decodeURI(e)};return{parse:function(d){var g,i=[];d=d.split(a),g=d.length;for(var j=0;j<g;j++){var k=d[j];if(k.length>0&&"WEBVTT"!==k&&k.match(b)){var l=f(k),m=l.cuePoints,n=l.styles,o=h(d,j+1);i.push({start:e(m[0].replace(c,"")),end:e(m[1].replace(c,"")),data:o,styles:n})}}return i}}},MediaPlayer.dependencies.XlinkLoader=function(){"use strict";var a=1,b=500,c="urn:mpeg:dash:resolve-to-zero:2013",d=function(a,c,e,f){var g,h,i,j=new XMLHttpRequest,k=this,l=null,m=!0,n=new Date;h=function(){j.status<200||j.status>299||(m=!1,k.metricsModel.addHttpRequest("stream",null,"XLink",a,null,null,n,l,null,j.status,null,null,j.getAllResponseHeaders()),i=j.responseText,c.resolved=!0,i?(c.resolvedContent=i,k.notify(MediaPlayer.dependencies.XlinkLoader.eventList.ENAME_XLINKELEMENT_LOADED,{element:c,resolveObject:e})):(c.resolvedContent=null,k.notify(MediaPlayer.dependencies.XlinkLoader.eventList.ENAME_XLINKELEMENT_LOADED,{element:c,resolveObject:e},new MediaPlayer.vo.Error(null,"Failed loading Xlink element: "+a,null))))},g=function(){m&&(m=!1,k.metricsModel.addHttpRequest("stream",null,"xlink",a,null,null,n,new Date,j.status,null,null,j.getAllResponseHeaders()),f>0?(console.log("Failed loading xLink content: "+a+", retry in "+b+"ms attempts: "+f),f--,setTimeout(function(){d.call(k,a,c,e,f)},b)):(console.log("Failed loading Xlink content: "+a+" no retry attempts left"),k.errHandler.downloadError("xlink",a,j),c.resolvedContent=null,k.notify(MediaPlayer.dependencies.XlinkLoader.eventList.ENAME_XLINKELEMENT_LOADED,{element:c,resolveObject:e},new Error("Failed loading xlink Element: "+a+" no retry attempts left"))))};try{j.onload=h,j.onloadend=g,j.onerror=g,j.open("GET",k.requestModifierExt.modifyRequestURL(a),!0),j.send()}catch(a){console.log("Error"),j.onerror()}};return{errHandler:void 0,metricsModel:void 0,requestModifierExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,load:function(b,e,f){b===c?(e.resolvedContent=null,e.resolved=!0,this.notify(MediaPlayer.dependencies.XlinkLoader.eventList.ENAME_XLINKELEMENT_LOADED,{element:e,resolveObject:f})):d.call(this,b,e,f,a)}}},MediaPlayer.dependencies.XlinkLoader.prototype={constructor:MediaPlayer.dependencies.XlinkLoader},MediaPlayer.dependencies.XlinkLoader.eventList={ENAME_XLINKELEMENT_LOADED:"xlinkElementLoaded"},MediaPlayer.dependencies.AbrController=function(){"use strict";var a=!0,b={},c={},d={},e={},f={},g=function(a,b){var d;return c[b]=c[b]||{},c[b].hasOwnProperty(a)||(c[b][a]=0),d=c[b][a]},h=function(a,b,d){c[b]=c[b]||{},c[b][a]=d},i=function(a,b){var c;return d[b]=d[b]||{},d[b].hasOwnProperty(a)||(d[b][a]=0),c=d[b][a]},j=function(a,b,c){d[b]=d[b]||{},d[b][a]=c},k=function(a,c,d){b[c]=b[c]||{},b[c][a]=d},l=function(a){return e[a]},m=function(a,b){e[a]=b},n=function(a){return e.hasOwnProperty("max")&&e.max.hasOwnProperty(a)?e.max[a]:NaN},o=function(a,b){e.max=e.max||{},e.max[a]=b},p=function(a,c){var d;return b[c]=b[c]||{},b[c].hasOwnProperty(a)||(b[c][a]=0),d=q.call(this,b[c][a],a)},q=function(a,b){var c=n(b);if(isNaN(c))return a;var d=this.getQualityForBitrate(f[b].getMediaInfo(),c);return Math.min(a,d)};return{log:void 0,abrRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,initialize:function(a,b){f[a]=b},getAutoSwitchBitrate:function(){return a},setAutoSwitchBitrate:function(b){a=b},getPlaybackQuality:function(b){var c,d,e,f,k=this,l=b.getType(),m=b.getStreamInfo().id,n=function(a){var e=p.call(k,l,m);c=a.value,f=a.confidence,c<0&&(c=0),c>e&&(c=e),d=g(l,m),c!==d&&(h(l,m,c),j(l,m,f),k.notify(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,{mediaType:l,streamInfo:b.getStreamInfo(),oldQuality:d,newQuality:c}))};c=g(l,m),f=i(l,m),a&&(e=k.abrRulesCollection.getRules(MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES),k.rulesController.applyRules(e,b,n.bind(k),c,function(a,b){return a=a===MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE?0:a,Math.max(a,b)}))},setPlaybackQuality:function(a,b,c){var d=b.id,e=g(a,d),f=null!==c&&!isNaN(c)&&c%1===0;if(!f)throw"argument is not an integer";c!==e&&c>=0&&c<=p.call(this,a,d)&&(h(a,b.id,c),this.notify(MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED,{mediaType:a,streamInfo:b,oldQuality:e,newQuality:c}))},getQualityFor:function(a,b){return g(a,b.id)},getConfidenceFor:function(a,b){return i(a,b.id)},setInitialBitrateFor:function(a,b){m(a,b)},getInitialBitrateFor:function(a){return l(a)},setMaxAllowedBitrateFor:function(a,b){o(a,b)},getMaxAllowedBitrateFor:function(a){return n(a)},getQualityForBitrate:function(a,b){for(var c,d=this.getBitrateList(a),e=d.length,f=0;f<e;f+=1)if(c=d[f],1e3*b<=c.bitrate)return f;return e-1},getBitrateList:function(a){if(!a||!a.bitrateList)return null;for(var b,c=a.bitrateList,d=a.type,e=[],f=0,g=c.length;f<g;f+=1)b=new MediaPlayer.vo.BitrateInfo,b.mediaType=d,b.qualityIndex=f,b.bitrate=c[f],e.push(b);return e},updateTopQualityIndex:function(a){var b,c=a.type,d=a.streamInfo.id;return b=a.trackCount-1,k(c,d,b),b},isPlayingAtTopQuality:function(a){var b,c=this,d=a.id,e=c.getQualityFor("audio",a),f=c.getQualityFor("video",a);return b=e===p.call(this,"audio",d)&&f===p.call(this,"video",d)},getTopQualityIndexFor:p,reset:function(){a=!0,b={},c={},d={},f={}}}},MediaPlayer.dependencies.AbrController.prototype={constructor:MediaPlayer.dependencies.AbrController},MediaPlayer.dependencies.AbrController.eventList={ENAME_QUALITY_CHANGED:"qualityChanged"},MediaPlayer.dependencies.AbrController.DEFAULT_VIDEO_BITRATE=1e3,MediaPlayer.dependencies.AbrController.DEFAULT_AUDIO_BITRATE=100,MediaPlayer.dependencies.BufferController=function(){"use strict";var a,b,c,d,e=.5,f=0,g=-1,h=!1,i=0,j=0,k=Number.POSITIVE_INFINITY,l=-1,m=-1,n=null,o=null,p=!1,q=!1,r=!1,s=function(c){if(!c||!a||!this.streamProcessor)return null;var d=null;try{d=this.sourceBufferExt.createSourceBuffer(a,c)}catch(a){this.errHandler.mediaSourceError("Error creating "+b+" source buffer.")}return this.setBuffer(d),M.call(this,this.streamProcessor.getTrackForQuality(f).MSETimeOffset),d},t=function(){var a=this.streamProcessor.getStreamInfo().id,b=this.streamController.getActiveStreamInfo().id;return a===b},u=function(){var a=this.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING}),c=Q.call(this),d=this.virtualBuffer.getChunks({streamId:c,mediaType:b,segmentType:MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE,quality:g});return!(g>f&&(v(d,g)||v(a,g)))&&g!==f},v=function(a,b){var c=0,d=a.length;for(c;c<d;c+=1)if(a[c].quality===b)return!0;return!1},w=function(a){var b,c=this;a.data.fragmentModel===c.streamProcessor.getFragmentModel()&&(c.log("Initialization finished loading"),b=a.data.chunk,this.virtualBuffer.append(b),b.quality===f&&u.call(c)&&$.call(c))},x=function(a){if(a.data.fragmentModel===this.streamProcessor.getFragmentModel()){var b,c=a.data.chunk,d=c.bytes,e=c.quality,f=c.index,g=this.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,quality:e,index:f})[0],h=this.streamProcessor.getTrackForQuality(e),i=this.manifestModel.getValue(),j=this.adapter.getEventsFor(i,h.mediaInfo,this.streamProcessor),k=this.adapter.getEventsFor(i,h,this.streamProcessor);(j.length>0||k.length>0)&&(b=B.call(this,d,g,j,k),this.streamProcessor.getEventController().addInbandEvents(b)),c.bytes=C.call(this,d),this.virtualBuffer.append(c),O.call(this)}},y=function(a){q=!0,d=a;var b=this,c=a.quality,e=isNaN(a.index);return c!==f&&e||c!==g&&!e?void S.call(b,c,a.index):void b.sourceBufferExt.append(n,a.bytes)},z=function(b){if(n===b.data.buffer){this.isBufferingCompleted()&&this.streamProcessor.getStreamInfo().isLast&&this.mediaSourceExt.signalEndOfStream(a);var c,e=this;if(b.error)return b.error.code===MediaPlayer.dependencies.SourceBufferExtensions.QUOTA_EXCEEDED_ERROR_CODE&&(e.virtualBuffer.append(d),k=.8*e.sourceBufferExt.getTotalBufferedTime(n),e.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,{criticalBufferLevel:k}),G.call(e)),void(q=!1);if(A.call(e),F.call(e)||(e.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED,{criticalBufferLevel:k}),G.call(e)),c=e.sourceBufferExt.getAllRanges(n),c&&c.length>0){var f,g;for(f=0,g=c.length;f<g;f+=1)e.log("Buffered Range: "+c.start(f)+" - "+c.end(f))}R.call(e,d.quality,d.index),e.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED,{quality:d.quality,index:d.index,bufferedRanges:c})}},A=function(){var a=this,b=a.playbackController.getTime();return i=a.sourceBufferExt.getBufferLength(n,b),a.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED,{bufferLevel:i}),D.call(a),J.call(a),i<e&&L.call(a,!1),!0},B=function(a,b,c,d){var e,f,g,h,i=[],j=0,k=Math.pow(256,2),l=Math.pow(256,3),m=Math.max(isNaN(b.startTime)?0:b.startTime,0),n=[];r=!1,h=c.concat(d);for(var o=0;o<h.length;o++)n[h[o].schemeIdUri]=h[o];for(;j<a.length&&(e=String.fromCharCode(a[j+4],a[j+5],a[j+6],a[j+7]),f=a[j]*l+a[j+1]*k+256*a[j+2]+1*a[j+3],"moov"!=e&&"moof"!=e);){if("emsg"==e){r=!0;for(var p=["","",0,0,0,0,""],q=0,s=j+12;s<f+j;)0===q||1==q||6==q?(0!==a[s]?p[q]+=String.fromCharCode(a[s]):q+=1,s+=1):(p[q]=a[s]*l+a[s+1]*k+256*a[s+2]+1*a[s+3],s+=4,q+=1);g=this.adapter.getEvent(p,n,m),g&&i.push(g)}j+=f}return i},C=function(a){if(!r)return a;for(var b,c,d=a.length,e=0,f=0,g=Math.pow(256,2),h=Math.pow(256,3),i=new Uint8Array(a.length);e<d;){if(b=String.fromCharCode(a[e+4],a[e+5],a[e+6],a[e+7]),c=a[e]*h+a[e+1]*g+256*a[e+2]+1*a[e+3],"emsg"!=b)for(var j=e;j<e+c;j++)i[f]=a[j],f+=1;e+=c}return i.subarray(0,f)},D=function(){var a=E.call(this),b=2*c,d=i-a;d>=b&&!p?(p=!0,this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN)):d<b/2&&p&&(this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED),p=!1,O.call(this))},E=function(){var a=this.metricsModel.getReadOnlyMetricsFor("video"),b=this.metricsExt.getCurrentBufferLevel(a),c=this.metricsModel.getReadOnlyMetricsFor("audio"),d=this.metricsExt.getCurrentBufferLevel(c),e=null;return e=null===b||null===d?null!==d?d.level:null!==b?b.level:null:Math.min(d.level,b.level)},F=function(){var a=this,b=a.sourceBufferExt.getTotalBufferedTime(n);return b<k},G=function(){var b,c,d,e,f,g=this;n&&(b=g.playbackController.getTime(),f=g.streamProcessor.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,time:b})[0],d=f&&!isNaN(f.startTime)?f.startTime:Math.floor(b),e=g.sourceBufferExt.getBufferRange(n,b),null===e&&n.buffered.length>0&&(d=n.buffered.end(n.buffered.length-1)),c=n.buffered.start(0),g.sourceBufferExt.remove(n,c,d,a))},H=function(a){n===a.data.buffer&&(A.call(this),this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED,{from:a.data.from,to:a.data.to,hasEnoughSpaceToAppend:F.call(this)}),F.call(this)||setTimeout(G.bind(this),1e3*c))},I=function(){var a=l===m-1;a&&!h&&(h=!0,this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFERING_COMPLETED))},J=function(){var a=this.playbackController.getTimeToStreamEnd();i<e&&c<a||c>=a&&!h?L.call(this,!1):L.call(this,!0)},K=function(){return o?MediaPlayer.dependencies.BufferController.BUFFER_LOADED:MediaPlayer.dependencies.BufferController.BUFFER_EMPTY},L=function(a){if(o!==a){o=a;var c=K(),d=c===MediaPlayer.dependencies.BufferController.BUFFER_LOADED?MediaPlayer.events.BUFFER_LOADED:MediaPlayer.events.BUFFER_EMPTY;P.call(this),this.eventBus.dispatchEvent({type:d,data:{bufferType:b}}),this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED,{hasSufficientBuffer:a}),this.log(o?"Got enough buffer to start.":"Waiting for more buffer before starting playback.")}},M=function(a){n&&n.timestampOffset!==a&&!isNaN(a)&&(n.timestampOffset=a)},N=function(){if(n){var a=this,b=this.streamProcessor.getScheduleController().getFragmentToLoadCount(),c=this.streamProcessor.getCurrentTrack().fragmentDuration;A.call(a),j=b>0?b*c+i:j,P.call(this),O.call(a)}},O=function(){u.call(this)?$.call(this):V.call(this)},P=function(){if(t.call(this)){this.metricsModel.addBufferState(b,K(),j);var a,c=i;a=this.virtualBuffer.getTotalBufferLevel(this.streamProcessor.getMediaInfo()),a&&(c+=a),this.metricsModel.addBufferLevel(b,new Date,c)}},Q=function(){return this.streamProcessor.getStreamInfo().id},R=function(a,b){q=!1,isNaN(b)?T.call(this,a):U.call(this,b),O.call(this)},S=function(a,b){q=!1,this.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED,{quality:a,index:b}),O.call(this)},T=function(a){g=a},U=function(a){l=Math.max(a,l),I.call(this)},V=function(){var a,c=Q.call(this);!n||p||q||u.call(this)||!F.call(this)||(a=this.virtualBuffer.extract({streamId:c,mediaType:b,segmentType:MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE,limit:1})[0],a&&y.call(this,a))},W=function(a){if(!a.error){var b,d=this;M.call(d,a.data.currentRepresentation.MSETimeOffset),b=d.streamProcessor.getStreamInfo().manifestInfo.minBufferTime,c!==b&&(d.setMinBufferTime(b),d.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_MIN_BUFFER_TIME_UPDATED,{minBufferTime:b}))}},X=function(a){var b=this;a.data.fragmentModel===b.streamProcessor.getFragmentModel()&&(m=a.data.request.index,I.call(b))},Y=function(a){if(b===a.data.mediaType&&this.streamProcessor.getStreamInfo().id===a.data.streamInfo.id){var c=this,d=a.data.newQuality;f!==d&&(M.call(c,c.streamProcessor.getTrackForQuality(d).MSETimeOffset),f=d,u.call(c)&&$.call(c))}},Z=function(){P.call(this)},$=function(){var a=this,c=Q.call(a),d={streamId:c,mediaType:b,segmentType:MediaPlayer.vo.metrics.HTTPRequest.INIT_SEGMENT_TYPE,quality:f},e=a.virtualBuffer.getChunks(d)[0];if(e){if(q||!n)return;y.call(a,e)}else a.notify(MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED,{requiredQuality:f})},_=function(){O.call(this)},aa=function(){J.call(this)};return{sourceBufferExt:void 0,eventBus:void 0,bufferMax:void 0,manifestModel:void 0,errHandler:void 0,mediaSourceExt:void 0,metricsModel:void 0,metricsExt:void 0,streamController:void 0,playbackController:void 0,adapter:void 0,log:void 0,abrController:void 0,system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,virtualBuffer:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=W,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED]=w,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED]=x,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=X,this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=Y,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS]=N,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=N,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED]=N,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED]=aa,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=_,z=z.bind(this),H=H.bind(this),Z=Z.bind(this),this.sourceBufferExt.subscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,this,z),this.sourceBufferExt.subscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,this,H),this.virtualBuffer.subscribe(MediaPlayer.utils.VirtualBuffer.eventList.CHUNK_APPENDED,this,Z)},initialize:function(a,c,d){var e=this;b=a,e.setMediaType(b),e.setMediaSource(c),e.streamProcessor=d,e.fragmentController=d.fragmentController,e.scheduleController=d.scheduleController,f=e.abrController.getQualityFor(b,d.getStreamInfo())},createBuffer:s,getStreamProcessor:function(){return this.streamProcessor},setStreamProcessor:function(a){this.streamProcessor=a},getBuffer:function(){return n},setBuffer:function(a){n=a},getBufferLevel:function(){return i},getMinBufferTime:function(){return c},setMinBufferTime:function(a){c=a},getCriticalBufferLevel:function(){return k},setMediaSource:function(b){a=b},isBufferingCompleted:function(){return h},reset:function(b){var e=this;k=Number.POSITIVE_INFINITY,o=null,c=null,g=-1,m=-1,l=-1,f=0,e.sourceBufferExt.unsubscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,e,z),e.sourceBufferExt.unsubscribe(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,e,H),d=null,this.virtualBuffer.unsubscribe(MediaPlayer.utils.VirtualBuffer.eventList.CHUNK_APPENDED,e,Z),p=!1,q=!1,b||(e.sourceBufferExt.abort(a,n),e.sourceBufferExt.removeSourceBuffer(a,n)),n=null}}},MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED="required",MediaPlayer.dependencies.BufferController.BUFFER_SIZE_MIN="min",MediaPlayer.dependencies.BufferController.BUFFER_SIZE_INFINITY="infinity",MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME=12,MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD=4,MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY=30,MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=300,MediaPlayer.dependencies.BufferController.LONG_FORM_CONTENT_DURATION_THRESHOLD=600,MediaPlayer.dependencies.BufferController.RICH_BUFFER_THRESHOLD=20,MediaPlayer.dependencies.BufferController.BUFFER_LOADED="bufferLoaded",MediaPlayer.dependencies.BufferController.BUFFER_EMPTY="bufferStalled",MediaPlayer.dependencies.BufferController.prototype={constructor:MediaPlayer.dependencies.BufferController},MediaPlayer.dependencies.BufferController.eventList={ENAME_BUFFER_LEVEL_STATE_CHANGED:"bufferLevelStateChanged",ENAME_BUFFER_LEVEL_UPDATED:"bufferLevelUpdated",ENAME_QUOTA_EXCEEDED:"quotaExceeded",ENAME_BYTES_APPENDED:"bytesAppended",ENAME_BYTES_REJECTED:"bytesRejected",ENAME_BUFFERING_COMPLETED:"bufferingCompleted",ENAME_BUFFER_CLEARED:"bufferCleared",ENAME_INIT_REQUESTED:"initRequested",ENAME_BUFFER_LEVEL_OUTRUN:"bufferLevelOutrun",ENAME_BUFFER_LEVEL_BALANCED:"bufferLevelBalanced",ENAME_MIN_BUFFER_TIME_UPDATED:"minBufferTimeUpdated"},MediaPlayer.dependencies.EventController=function(){"use strict";var a=[],b=[],c=[],d=null,e=100,f=e/1e3,g="urn:mpeg:dash:event:2012",h=1,i=function(){j(),a=null,b=null,c=null},j=function(){null!==d&&(clearInterval(d),d=null)},k=function(){var a=this;a.log("Start Event Controller"),isNaN(e)||(d=setInterval(n.bind(this),e))},l=function(b){var c=this;a=[],b&&b.length>0&&(a=b),c.log("Added "+b.length+" inline events")},m=function(a){for(var c=this,d=0;d<a.length;d++){var e=a[d];b[e.id]=e,c.log("Add inband event with id "+e.id)}},n=function(){o.call(this,b),o.call(this,a),p.call(this)},o=function(a){var b,d=this,e=this.videoModel.getCurrentTime();if(a)for(var i=0;i<a.length;i++){var j=a[i];void 0!==j&&(b=j.presentationTime/j.eventStream.timescale,(0===b||b<=e&&b+f>e)&&(d.log("Start Event at "+e),j.duration>0&&c.push(j),j.eventStream.schemeIdUri==g&&j.eventStream.value==h&&q.call(this),a.splice(i,1)))}},p=function(){var a=this;if(c)for(var b=this.videoModel.getCurrentTime(),d=0;d<c.length;d++){var e=c[d];null!==e&&(e.duration+e.presentationTime)/e.eventStream.timescale<b&&(a.log("Remove Event at time "+b),e=null,c.splice(d,1))}},q=function(){var a=this.manifestModel.getValue(),b=a.url;a.hasOwnProperty("Location")&&(b=a.Location),this.log("Refresh manifest @ "+b),this.manifestUpdater.getManifestLoader().load(b)};return{manifestModel:void 0,manifestUpdater:void 0,log:void 0,system:void 0,videoModel:void 0,addInlineEvents:l,addInbandEvents:m,reset:i,clear:j,start:k}},MediaPlayer.dependencies.EventController.prototype={constructor:MediaPlayer.dependencies.EventController},MediaPlayer.dependencies.FragmentController=function(){"use strict";var a=[],b=!1,c=function(b){for(var c=a.length,d=0;d<c;d++)if(a[d].getContext()==b)return a[d];return null},d=function(b,c){var d=this,e=a[0].getContext().streamProcessor,f=e.getStreamInfo().id,g=d.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES);g.indexOf(this.scheduleRulesCollection.sameTimeRequestRule)!==-1&&this.scheduleRulesCollection.sameTimeRequestRule.setFragmentModels(a,f),d.rulesController.applyRules(g,e,c,b,function(a,b){return b})},e=function(a,b,c){var d=new MediaPlayer.vo.DataChunk;return d.streamId=c,d.mediaType=b.mediaType,d.segmentType=b.type,d.start=b.startTime,d.duration=b.duration,d.end=d.start+d.duration,d.bytes=a,d.index=b.index,d.quality=b.quality,d},f=function(a){var b=this,c=a.data.request;b.isInitializationRequest(c)?b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADING_START,{request:c,fragmentModel:a.sender}):b.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START,{request:c,fragmentModel:a.sender})},g=function(a){var b,c=this,d=a.data.request,f=c.process(a.data.response),g=a.sender.getContext().streamProcessor.getStreamInfo().id,h=this.isInitializationRequest(d),i=h?MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED:MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADED;return null===f?void c.log("No "+d.mediaType+" bytes to push."):(b=e.call(this,f,d,g),c.notify(i,{chunk:b,fragmentModel:a.sender}),void k.call(this))},h=function(a){this.notify(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,{request:a.data.request,fragmentModel:a.sender})},i=function(){k.call(this)},j=function(c){var d,e,f,g,h,i=c.value;for(g=0;g<i.length;g+=1)if(e=i[g])for(h=0;h<a.length;h+=1)f=a[h],d=f.getContext().streamProcessor.getType(),
e.mediaType===d&&(e instanceof MediaPlayer.vo.FragmentRequest||(e=f.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:e.startTime})[0]),f.executeRequest(e));b=!1},k=function(a){b||(b=!0,d.call(this,a,j.bind(this)))};return{system:void 0,log:void 0,scheduleRulesCollection:void 0,rulesController:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED]=f,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED]=g,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED]=h,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=i,this.scheduleRulesCollection.sameTimeRequestRule&&this.subscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,this.scheduleRulesCollection.sameTimeRequestRule)},process:function(a){var b=null;return null!==a&&void 0!==a&&a.byteLength>0&&(b=new Uint8Array(a)),b},getModel:function(b){if(!b)return null;var d=c(b);return d||(d=this.system.getObject("fragmentModel"),d.setContext(b),a.push(d)),d},detachModel:function(b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},isInitializationRequest:function(a){return a&&a.type&&a.type===MediaPlayer.vo.metrics.HTTPRequest.INIT_SEGMENT_TYPE},prepareFragmentForLoading:function(a,b){a&&b&&a.addRequest(b)&&k.call(this,b)},executePendingRequests:function(){k.call(this)},reset:function(){a=[],this.scheduleRulesCollection.sameTimeRequestRule&&this.unsubscribe(MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED,this.scheduleRulesCollection.sameTimeRequestRule)}}},MediaPlayer.dependencies.FragmentController.prototype={constructor:MediaPlayer.dependencies.FragmentController},MediaPlayer.dependencies.FragmentController.eventList={ENAME_STREAM_COMPLETED:"streamCompleted",ENAME_INIT_FRAGMENT_LOADING_START:"initFragmentLoadingStart",ENAME_MEDIA_FRAGMENT_LOADING_START:"mediaFragmentLoadingStart",ENAME_INIT_FRAGMENT_LOADED:"initFragmentLoaded",ENAME_MEDIA_FRAGMENT_LOADED:"mediaFragmentLoaded"},MediaPlayer.dependencies.PlaybackController=function(){"use strict";var a,b,c,d=1e3,e=0,f=NaN,g=null,h={},i={},j=function(a){var b,d=parseInt(this.uriQueryFragModel.getURIFragmentData().s);return c?(!isNaN(d)&&d>1262304e3&&(b=d-a.manifestInfo.availableFrom.getTime()/1e3,(b>f||b<f-a.manifestInfo.DVRWindowSize)&&(b=null)),b=b||f):b=!isNaN(d)&&d<a.duration&&d>=0?d:a.start,b},k=function(b){var c,d=this,e=d.metricsModel.getReadOnlyMetricsFor("video")||d.metricsModel.getReadOnlyMetricsFor("audio"),f=d.metricsExt.getCurrentDVRInfo(e),g=f?f.range:null;return g?b>=g.start&&b<=g.end?b:c=Math.max(g.end-2*a.manifestInfo.minBufferTime,g.start):NaN},l=function(){if(null===g){var a=this,b=function(){E.call(a)};g=setInterval(b,d)}},m=function(){clearInterval(g),g=null},n=function(){if(!i[a.id]&&!this.isSeeking()){var b=j.call(this,a);this.log("Starting playback at offset: "+b),this.seek(b)}},o=function(){if(!this.isPaused()&&c){var a=this.getTime(),b=k.call(this,a),d=!isNaN(b)&&b!==a;d&&this.seek(b)}},p=function(b){if(!b.error){var c=this.adapter.convertDataToTrack(this.manifestModel.getValue(),b.data.currentRepresentation),d=c.mediaInfo.streamInfo;a.id===d.id&&(a=c.mediaInfo.streamInfo,o.call(this))}},q=function(a){a.error||0===b.getElement().readyState||n.call(this)},r=function(){b&&(b.unlisten("play",t),b.unlisten("playing",u),b.unlisten("pause",v),b.unlisten("error",D),b.unlisten("seeking",w),b.unlisten("seeked",x),b.unlisten("timeupdate",y),b.unlisten("progress",z),b.unlisten("ratechange",A),b.unlisten("loadedmetadata",B),b.unlisten("ended",C))},s=function(){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY)},t=function(){this.log("<video> play"),o.call(this),l.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,{startTime:this.getTime()})},u=function(){this.log("<video> playing"),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PLAYING,{playingTime:this.getTime()})},v=function(){this.log("<video> pause"),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED)},w=function(){this.log("<video> seek"),l.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING,{seekTime:this.getTime()})},x=function(){this.log("<video> seeked"),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKED)},y=function(){var a=this.getTime();a!==e&&(e=a,this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED,{timeToEnd:this.getTimeToStreamEnd()}))},z=function(){var c,d,e,f=b.getElement().buffered;f.length&&(c=f.length-1,d=f.end(c),e=j.call(this,a)+a.duration-d),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PROGRESS,{bufferedRanges:b.getElement().buffered,remainingUnbufferedDuration:e})},A=function(){this.log("<video> ratechange: ",this.getPlaybackRate()),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED)},B=function(){this.log("<video> loadedmetadata"),c&&!this.timelineConverter.isTimeSyncCompleted()||n.call(this),this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_METADATA_LOADED),l.call(this)},C=function(){this.log("<video> ended"),m.call(this)},D=function(a){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR,{error:a.srcElement.error})},E=function(){this.notify(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED,{isDynamic:c,time:new Date})},F=function(b){var c,d=b.data.bufferedRanges,e=a.id,f=this.getTime(),g=h[e];0===b.data.index&&(i[e]=!0),d&&d.length&&(c=d.start(0),h[e]=void 0===h[e]?c:Math.max(h[e],c),h[e]>10||g===h[e]||!i[e]||f>h[e]||this.seek(h[e]))},G=function(c){var d=c.sender.streamProcessor.getType(),e=c.sender.streamProcessor.getStreamInfo();e.id===a.id&&b.setStallState(d,!c.data.hasSufficientBuffer)},H=function(){b.listen("canplay",s),b.listen("play",t),b.listen("playing",u),b.listen("pause",v),b.listen("error",D),b.listen("seeking",w),b.listen("seeked",x),b.listen("timeupdate",y),b.listen("progress",z),b.listen("ratechange",A),b.listen("loadedmetadata",B),b.listen("ended",C)};return{log:void 0,timelineConverter:void 0,uriQueryFragModel:void 0,metricsModel:void 0,metricsExt:void 0,manifestModel:void 0,videoModel:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,adapter:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=p,this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=q,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED]=F,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED]=G,s=s.bind(this),t=t.bind(this),u=u.bind(this),v=v.bind(this),D=D.bind(this),w=w.bind(this),x=x.bind(this),y=y.bind(this),z=z.bind(this),A=A.bind(this),B=B.bind(this),C=C.bind(this)},initialize:function(d){b=this.videoModel,a=d,h={},r.call(this),H.call(this),c=a.manifestInfo.isDynamic},getStreamStartTime:j,getTimeToStreamEnd:function(){var c=b.getCurrentTime();return j.call(this,a)+a.duration-c},getStreamId:function(){return a.id},getStreamDuration:function(){return a.duration},getTime:function(){return b.getCurrentTime()},getPlaybackRate:function(){return b.getPlaybackRate()},getPlayedRanges:function(){return b.getElement().played},setLiveStartTime:function(a){f=a},getLiveStartTime:function(){return f},start:function(){b.play()},isPaused:function(){return b.isPaused()},pause:function(){b&&b.pause()},isSeeking:function(){return b.getElement().seeking},seek:function(a){b&&a!==this.getTime()&&(this.log("Do seek: "+a),b.setCurrentTime(a))},reset:function(){m.call(this),r.call(this),b=null,a=null,e=0,f=NaN,h={},i={},c=void 0}}},MediaPlayer.dependencies.PlaybackController.prototype={constructor:MediaPlayer.dependencies.PlaybackController},MediaPlayer.dependencies.PlaybackController.eventList={ENAME_CAN_PLAY:"canPlay",ENAME_PLAYBACK_STARTED:"playbackStarted",ENAME_PLAYBACK_PLAYING:"playbackPlaying",ENAME_PLAYBACK_STOPPED:"playbackStopped",ENAME_PLAYBACK_PAUSED:"playbackPaused",ENAME_PLAYBACK_SEEKING:"playbackSeeking",ENAME_PLAYBACK_SEEKED:"playbackSeeked",ENAME_PLAYBACK_TIME_UPDATED:"playbackTimeUpdated",ENAME_PLAYBACK_PROGRESS:"playbackProgress",ENAME_PLAYBACK_RATE_CHANGED:"playbackRateChanged",ENAME_PLAYBACK_METADATA_LOADED:"playbackMetaDataLoaded",ENAME_PLAYBACK_ERROR:"playbackError",ENAME_WALLCLOCK_TIME_UPDATED:"wallclockTimeUpdated"},MediaPlayer.dependencies.ProtectionController=function(){"use strict";var a=null,b=function(a){if(a.error)this.log(a.error);else{var b=a.data;this.protectionModel.keySystem.doLicenseRequest(b.message,b.defaultURL,b.sessionToken)}},c=function(a){a.error?this.log("DRM: License request failed! -- "+a.error):(this.log("DRM: License request successful.  Session ID = "+a.data.requestData.getSessionID()),this.updateKeySession(a.data.requestData,a.data.message))},d=function(){this.protectionModel.keySystem.subscribe(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,this)};return{system:void 0,log:void 0,protectionExt:void 0,setup:function(){this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE]=b.bind(this),this[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED]=d.bind(this),this[MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE]=c.bind(this)},init:function(b){this.protectionModel=b,a=this.protectionExt.getKeySystems(),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this)},teardown:function(){this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,this),this.protectionModel.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,this),this.protectionModel.keySystem&&this.protectionModel.keySystem.unsubscribe(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,this)},requestKeySystemAccess:function(a){this.protectionModel.requestKeySystemAccess(a)},selectKeySystem:function(a){if(this.protectionModel.keySystem)throw new Error("DRM: KeySystem already selected!");this.protectionModel.selectKeySystem(a)},createKeySession:function(a,b){this.protectionModel.createKeySession(a,b)},updateKeySession:function(a,b){this.protectionModel.updateKeySession(a,b)},loadKeySession:function(a){this.protectionModel.loadKeySession(a)},removeKeySession:function(a){this.protectionModel.removeKeySession(a)},closeKeySession:function(a){this.protectionModel.closeKeySession(a)},setServerCertificate:function(a){this.protectionModel.setServerCertificate(a)}}},MediaPlayer.dependencies.ProtectionController.prototype={constructor:MediaPlayer.dependencies.ProtectionController},MediaPlayer.dependencies.ScheduleController=function(){"use strict";var a,b,c,d,e,f=0,g=!0,h=null,i=!1,j=null,k=null,l=!0,m=function(a,b){var c=0,d=null;l===!1&&(d=k.start,c=a.getTime()-d.getTime(),k.duration=c,k.stopreason=b,l=!0)},n=function(){b&&(i=!1,g&&(g=!1),this.log("start"),w.call(this))},o=function(){g&&(r.call(this,e.quality),K.call(this,MediaPlayer.vo.metrics.PlayList.INITIAL_PLAY_START_REASON)),n.call(this)},p=function(a){i||(i=!0,this.log("stop"),a&&c.cancelPendingRequests(),m(new Date,MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON))},q=function(a){var b=this,c=b.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES);b.rulesController.applyRules(c,b.streamProcessor,a,null,function(a,b){return b})},r=function(a){var b,d=this;return b=d.adapter.getInitRequest(d.streamProcessor,a),null!==b&&d.fragmentController.prepareFragmentForLoading(c,b),b},s=function(a){var b=this,c=b.scheduleRulesCollection.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES);b.rulesController.applyRules(c,b.streamProcessor,a,f,function(a,b){return a=a===MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE?0:a,Math.max(a,b)})},t=function(a){var b,d,f,g=a.length,h=.1;for(f=0;f<g;f+=1)b=a[f],d=b.startTime+b.duration/2+h,b=this.adapter.getFragmentRequestForTime(this.streamProcessor,e,d,{timeThreshold:0}),this.fragmentController.prepareFragmentForLoading(c,b)},u=function(a){var b=this;return f=a.value,f<=0?void b.fragmentController.executePendingRequests():void q.call(b,v.bind(b))},v=function(a){var b=a.value;null===b||b instanceof MediaPlayer.vo.FragmentRequest||(b=this.adapter.getFragmentRequestForTime(this.streamProcessor,e,b.startTime)),b?(f--,this.fragmentController.prepareFragmentForLoading(c,b)):this.fragmentController.executePendingRequests()},w=function(){var a=(new Date).getTime(),b=!h||a-h>c.getLoadingTime();this.abrController.getPlaybackQuality(this.streamProcessor),!b||i||this.playbackController.isPaused()&&this.playbackController.getPlayedRanges().length>0&&(!this.scheduleWhilePaused||d)||(h=a,s.call(this,u.bind(this)))},x=function(a){a.error||(e=this.adapter.convertDataToTrack(this.manifestModel.getValue(),a.data.currentRepresentation))},y=function(a){a.error||(e=this.streamProcessor.getCurrentTrack(),d||(b=!0),b&&o.call(this))},z=function(a){a.data.fragmentModel===this.streamProcessor.getFragmentModel()&&(this.log("Stream is complete"),m(new Date,MediaPlayer.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON))},A=function(a){var b=this;a.data.fragmentModel===b.streamProcessor.getFragmentModel()&&w.call(b)},B=function(a){a.error&&p.call(this)},C=function(){L.call(this)},D=function(){p.call(this,!1)},E=function(a){r.call(this,a.data.requiredQuality)},F=function(a){c.removeExecutedRequestsBeforeTime(a.data.to),a.data.hasEnoughSpaceToAppend&&n.call(this)},G=function(a){var b=this;a.data.hasSufficientBuffer||b.playbackController.isSeeking()||(b.log("Stalling Buffer"),m(new Date,MediaPlayer.vo.metrics.PlayList.Trace.REBUFFERING_REASON))},H=function(){w.call(this)},I=function(){p.call(this,!1)},J=function(b){if(a===b.data.mediaType&&this.streamProcessor.getStreamInfo().id===b.data.streamInfo.id){var d,f=this;if(d=c.cancelPendingRequests(b.data.oldQuality),e=f.streamProcessor.getTrackForQuality(b.data.newQuality),null===e||void 0===e)throw"Unexpected error!";t.call(f,d),m(new Date,MediaPlayer.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON)}},K=function(b){var c=new Date,d=this.playbackController.getTime();m(c,MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON),j=this.metricsModel.addPlayList(a,c,d,b)},L=function(){var a=this,b=a.playbackController.getTime(),c=a.playbackController.getPlaybackRate(),d=new Date;l===!0&&e&&j&&(l=!1,k=a.metricsModel.appendPlayListTrace(j,e.id,null,d,b,null,c,null))},M=function(a){var b=this,d=r.call(b,a.data.CCIndex);c.executeRequest(d)},N=function(){n.call(this)},O=function(a){g||c.cancelPendingRequests();var b=this.metricsModel.getMetricsFor("stream"),d=this.metricsExt.getCurrentManifestUpdate(b);this.log("seek: "+a.data.seekTime),K.call(this,MediaPlayer.vo.metrics.PlayList.SEEK_START_REASON),this.metricsModel.updateManifestUpdateInfo(d,{latency:e.DVRWindow.end-this.playbackController.getTime()})},P=function(){L.call(this)},Q=function(){w.call(this)},R=function(a){if(!a.error){var c,d,f=this,g=a.data.liveEdge,h=e.mediaInfo.streamInfo.manifestInfo,i=g-Math.min(2*h.minBufferTime,h.DVRWindowSize/2),j=f.metricsModel.getMetricsFor("stream"),k=f.metricsExt.getCurrentManifestUpdate(j),l=f.playbackController.getLiveStartTime();c=f.adapter.getFragmentRequestForTime(f.streamProcessor,e,i),d=c.startTime,(isNaN(l)||d>l)&&f.playbackController.setLiveStartTime(d),f.metricsModel.updateManifestUpdateInfo(k,{currentTime:d,presentationStartTime:g,latency:g-d,clientTimeOffset:f.timelineConverter.getClientTimeOffset()}),b=!0,e&&o.call(f)}};return{log:void 0,system:void 0,metricsModel:void 0,manifestModel:void 0,metricsExt:void 0,scheduleWhilePaused:void 0,timelineConverter:void 0,abrController:void 0,playbackController:void 0,adapter:void 0,scheduleRulesCollection:void 0,rulesController:void 0,setup:function(){this[MediaPlayer.dependencies.LiveEdgeFinder.eventList.ENAME_LIVE_EDGE_SEARCH_COMPLETED]=R,this[MediaPlayer.dependencies.AbrController.eventList.ENAME_QUALITY_CHANGED]=J,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_STARTED]=D,this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=x,this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=y,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_MEDIA_FRAGMENT_LOADING_START]=A,this[MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED]=B,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=z,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_CLEARED]=F,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_APPENDED]=C,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_STATE_CHANGED]=G,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_UPDATED]=H,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_INIT_REQUESTED]=E,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_QUOTA_EXCEEDED]=I,this[MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED]=M,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED]=N,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=O,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_RATE_CHANGED]=P,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_WALLCLOCK_TIME_UPDATED]=Q},initialize:function(b,e){var f=this;a=b,f.setMediaType(a),f.streamProcessor=e,f.fragmentController=e.fragmentController,f.liveEdgeFinder=e.liveEdgeFinder,f.bufferController=e.bufferController,d=e.isDynamic(),c=this.fragmentController.getModel(this),f.scheduleRulesCollection.bufferLevelRule&&f.scheduleRulesCollection.bufferLevelRule.setScheduleController(f),f.scheduleRulesCollection.pendingRequestsRule&&f.scheduleRulesCollection.pendingRequestsRule.setScheduleController(f),f.scheduleRulesCollection.playbackTimeRule&&f.scheduleRulesCollection.playbackTimeRule.setScheduleController(f)},getFragmentModel:function(){return c},getFragmentToLoadCount:function(){return f},reset:function(){var a=this;p.call(a,!0),a.bufferController.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN,a.scheduleRulesCollection.bufferLevelRule),a.bufferController.unsubscribe(MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED,a.scheduleRulesCollection.bufferLevelRule),c.abortRequests(),a.fragmentController.detachModel(c),f=0},start:n,stop:p}},MediaPlayer.dependencies.ScheduleController.prototype={constructor:MediaPlayer.dependencies.ScheduleController},MediaPlayer.dependencies.StreamController=function(){"use strict";var a,b,c=[],d=.2,e=!0,f=!1,g=!1,h=!1,i=function(a){a.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,this.liveEdgeFinder),a.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_BUFFERING_COMPLETED,this)},j=function(a){a.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,this.liveEdgeFinder),a.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_BUFFERING_COMPLETED,this)},k=function(a,b,c){this.eventBus.dispatchEvent({type:a,data:{fromStreamInfo:b?b.getStreamInfo():null,toStreamInfo:c.getStreamInfo()}})},l=function(){a.isActivated()&&f&&0===a.getStreamInfo().index&&(a.startEventController(),e&&this.playbackController.start())},m=function(){f=!0,l.call(this)},n=function(a){var b=a.data.error.code,c="";if(b!==-1){switch(b){case 1:c="MEDIA_ERR_ABORTED";break;case 2:c="MEDIA_ERR_NETWORK";break;case 3:c="MEDIA_ERR_DECODE";break;case 4:c="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:c="MEDIA_ERR_ENCRYPTED"}h=!0,this.log("Video Element Error: "+c),this.log(a.error),this.errHandler.mediaSourceError(c),this.reset()}},o=function(b){var c=this,e=c.videoExt.getPlaybackQuality(c.videoModel.getElement());e&&c.metricsModel.addDroppedFrames("video",e),c.playbackController.isSeeking()||b.data.timeToEnd<d&&t.call(this,a,r())},p=function(b){var c=s(b.data.seekTime);c&&c!==a&&t.call(this,a,c,b.data.seekTime)},q=function(a){var c=r(),d=a.data.streamInfo.isLast;b&&d&&this.mediaSourceExt.signalEndOfStream(b),c&&c.activate(b)},r=function(){var b=a.getStreamIndex()+1;return b<c.length?c[b]:null},s=function(a){var b=0,d=null,e=c.length;e>0&&(b+=c[0].getStartTime());for(var f=0;f<e;f++)if(d=c[f],b+=d.getDuration(),a<b)return d;return null},t=function(b,c,d){if(!g&&b&&c&&b!==c){k.call(this,MediaPlayer.events.STREAM_SWITCH_STARTED,b,c),g=!0;var e=this,f=function(){void 0!==d&&e.playbackController.seek(d),e.playbackController.start(),a.startEventController(),g=!1,k.call(e,MediaPlayer.events.STREAM_SWITCH_COMPLETED,b,c)};setTimeout(function(){j.call(e,b),b.deactivate(),a=c,i.call(e,c),e.playbackController.initialize(a.getStreamInfo()),u.call(e,f)},0)}},u=function(c){var d,e=this,f=function(g){e.log("MediaSource is open!"),e.log(g),window.URL.revokeObjectURL(d),b.removeEventListener("sourceopen",f),b.removeEventListener("webkitsourceopen",f),v.call(e),a.activate(b),c&&c()};b?e.mediaSourceExt.detachMediaSource(e.videoModel):b=e.mediaSourceExt.createMediaSource(),b.addEventListener("sourceopen",f,!1),b.addEventListener("webkitsourceopen",f,!1),d=e.mediaSourceExt.attachMediaSource(b,e.videoModel)},v=function(){var c,d,e=this;c=a.getStreamInfo().manifestInfo.duration,d=e.mediaSourceExt.setDuration(b,c),e.log("Duration successfully set to: "+d)},w=function(){var d,e,f,g,h,j,l,m=this,n=m.manifestModel.getValue(),o=m.metricsModel.getMetricsFor("stream"),p=m.metricsExt.getCurrentManifestUpdate(o);if(n){j=m.adapter.getStreamsInfo(n);try{if(0===j.length)throw new Error("There are no streams");for(m.metricsModel.updateManifestUpdateInfo(p,{currentTime:m.videoModel.getCurrentTime(),buffered:m.videoModel.getElement().buffered,presentationStartTime:j[0].start,clientTimeOffset:m.timelineConverter.getClientTimeOffset()}),g=0,e=j.length;g<e;g+=1){for(d=j[g],h=0,f=c.length;h<f;h+=1)c[h].getId()===d.id&&(l=c[h],l.updateData(d));l||(l=m.system.getObject("stream"),l.setStreamInfo(d),l.initProtection(),l.subscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,m),c.push(l)),m.metricsModel.addManifestUpdateStreamInfo(p,d.id,d.index,d.start,d.duration),l=null}a||(a=c[0],k.call(m,MediaPlayer.events.STREAM_SWITCH_STARTED,null,a),m.playbackController.initialize(a.getStreamInfo()),i.call(m,a),k.call(m,MediaPlayer.events.STREAM_SWITCH_COMPLETED,null,a)),b||u.call(this)}catch(a){m.errHandler.manifestError(a.message,"nostreamscomposed",n),m.reset()}}},x=function(){var a=this,b=c.length,d=0;for(l.call(this),d;d<b;d+=1)if(!c[d].isActivated())return;a.notify(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED)},y=function(){w.call(this)},z=function(a){a.error?this.reset():(this.log("Manifest has loaded."),this.timeSyncController.initialize(this.manifestExt.getUTCTimingSources(a.data.manifest)))};return{system:void 0,videoModel:void 0,manifestUpdater:void 0,manifestLoader:void 0,manifestModel:void 0,manifestExt:void 0,adapter:void 0,playbackController:void 0,log:void 0,metricsModel:void 0,metricsExt:void 0,videoExt:void 0,liveEdgeFinder:void 0,mediaSourceExt:void 0,timelineConverter:void 0,protectionExt:void 0,timeSyncController:void 0,virtualBuffer:void 0,errHandler:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.ManifestUpdater.eventList.ENAME_MANIFEST_UPDATED]=z,this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED]=x,this[MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_BUFFERING_COMPLETED]=q,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=p,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_TIME_UPDATED]=o,this[MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED]=y,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_CAN_PLAY]=m,this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_ERROR]=n},setAutoPlay:function(a){e=a},getAutoPlay:function(){return e},setProtectionData:function(a){this.protectionExt.init(a)},getActiveStreamInfo:function(){return a?a.getStreamInfo():null},isStreamActive:function(b){return a.getId()===b.id},getStreamById:function(a){return c.filter(function(b){return b.getId()===a})[0]},initialize:function(){this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.timelineConverter),this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.liveEdgeFinder),this.timeSyncController.subscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this),this.playbackController.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,this.manifestUpdater),this.playbackController.subscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED,this.manifestUpdater),this.subscribe(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED,this.manifestUpdater),this.manifestUpdater.subscribe(MediaPlayer.dependencies.ManifestUpdater.eventList.ENAME_MANIFEST_UPDATED,this),this.manifestUpdater.initialize(this.manifestLoader)},load:function(a){this.manifestLoader.load(a)},loadWithManifest:function(a){this.manifestUpdater.setManifest(a)},reset:function(){a&&j.call(this,a),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.timelineConverter),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this.liveEdgeFinder),this.timeSyncController.unsubscribe(MediaPlayer.dependencies.TimeSyncController.eventList.ENAME_TIME_SYNCHRONIZATION_COMPLETED,this),this.timeSyncController.reset();for(var d=0,e=c.length;d<e;d++){var i=c[d];i.unsubscribe(MediaPlayer.dependencies.Stream.eventList.ENAME_STREAM_UPDATED,this),i.reset(h)}c=[],this.unsubscribe(MediaPlayer.dependencies.StreamController.eventList.ENAME_STREAMS_COMPOSED,this.manifestUpdater),this.playbackController.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_STARTED,this.manifestUpdater),this.playbackController.unsubscribe(MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_PAUSED,this.manifestUpdater),this.manifestUpdater.unsubscribe(MediaPlayer.dependencies.ManifestUpdater.eventList.ENAME_MANIFEST_UPDATED,this),this.manifestUpdater.reset(),this.metricsModel.clearAllCurrentMetrics(),this.manifestModel.setValue(null),this.timelineConverter.reset(),this.adapter.reset(),this.virtualBuffer.reset(),g=!1,a=null,f=!1,h=!1,b&&(this.mediaSourceExt.detachMediaSource(this.videoModel),b=null)}}},MediaPlayer.dependencies.StreamController.prototype={constructor:MediaPlayer.dependencies.StreamController},MediaPlayer.dependencies.StreamController.eventList={ENAME_STREAMS_COMPOSED:"streamsComposed"},MediaPlayer.dependencies.TextController=function(){var a=!1,b=null,c=null,d=null,e=function(){this.notify(MediaPlayer.dependencies.TextController.eventList.ENAME_CLOSED_CAPTIONING_REQUESTED,{CCIndex:0})},f=function(a){var b=this;a.data.fragmentModel===b.streamProcessor.getFragmentModel()&&a.data.chunk.bytes&&b.sourceBufferExt.append(c,a.data.chunk.bytes,b.videoModel)};return{sourceBufferExt:void 0,log:void 0,system:void 0,errHandler:void 0,videoModel:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[Dash.dependencies.RepresentationController.eventList.ENAME_DATA_UPDATE_COMPLETED]=e,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_INIT_FRAGMENT_LOADED]=f},initialize:function(a,b,c){var e=this;d=a,e.setMediaSource(b),e.trackController=c.trackController,e.streamProcessor=c},createBuffer:function(e){try{c=this.sourceBufferExt.createSourceBuffer(b,e),a||(c.hasOwnProperty("initialize")&&c.initialize(d,this),a=!0)}catch(a){this.errHandler.mediaSourceError("Error creating "+d+" source buffer.")}return c},getBuffer:function(){return c},setBuffer:function(a){c=a},setMediaSource:function(a){b=a},reset:function(a){a||(this.sourceBufferExt.abort(b,c),this.sourceBufferExt.removeSourceBuffer(b,c))}}},MediaPlayer.dependencies.TextController.prototype={constructor:MediaPlayer.dependencies.TextController},MediaPlayer.dependencies.TextController.eventList={ENAME_CLOSED_CAPTIONING_REQUESTED:"closedCaptioningRequested"},MediaPlayer.dependencies.XlinkController=function(){"use strict";var a,b,c,d,e="onLoad",f="onActuate",g="Period",h="AdaptationSet",i="EventStream",j="urn:mpeg:dash:resolve-to-zero:2013",k=function(b){var f,h=this;d=new X2JS(a,"",!0),c=b,f=o(c.Period_asArray,c,g,e),l.call(h,f,g,e)},l=function(a,b,c){var d,e,f,g=this,h={};for(h.elements=a,h.type=b,h.resolveType=c,0===h.elements.length&&n.call(g,h),f=0;f<h.elements.length;f+=1)d=h.elements[f],e=d.url.indexOf("http://")!==-1?d.url:d.originalContent.BaseURL+d.url,g.xlinkLoader.load(e,d,h)},m=function(a){var b,c;b=a.data.element,c=a.data.resolveObject,b.resolvedContent&&(b.resolvedContent=d.xml_str2json(b.resolvedContent)),r.call(this,c)&&n.call(this,c)},n=function(a){var b,d,j=[];if(p.call(this,a),a.resolveType===f&&this.notify(MediaPlayer.dependencies.XlinkController.eventList.ENAME_XLINK_READY,{manifest:c}),a.resolveType===e)switch(a.type){case g:for(b=0;b<c[g+"_asArray"].length;b++)d=c[g+"_asArray"][b],d.hasOwnProperty(h+"_asArray")&&(j=j.concat(o.call(this,d[h+"_asArray"],d,h,e))),d.hasOwnProperty(i+"_asArray")&&(j=j.concat(o.call(this,d[i+"_asArray"],d,i,e)));l.call(this,j,h,e);break;case h:this.notify(MediaPlayer.dependencies.XlinkController.eventList.ENAME_XLINK_READY,{manifest:c})}},o=function(a,b,c,d){var e,f,g,h=[];for(f=a.length-1;f>=0;f-=1)e=a[f],e.hasOwnProperty("xlink:href")&&e["xlink:href"]===j&&a.splice(f,1);for(f=0;f<a.length;f++)e=a[f],e.hasOwnProperty("xlink:href")&&e.hasOwnProperty("xlink:actuate")&&e["xlink:actuate"]===d&&(g=q(e["xlink:href"],b,c,f,d,e),h.push(g));return h},p=function(a){var d,e,f,g,h,i,j=[];for(g=a.elements.length-1;g>=0;g--){if(d=a.elements[g],e=d.type+"_asArray",!d.resolvedContent||s())delete d.originalContent["xlink:actuate"],delete d.originalContent["xlink:href"],j.push(d.originalContent);else if(d.resolvedContent)for(h=0;h<d.resolvedContent[e].length;h++)f=d.resolvedContent[e][h],j.push(f);for(d.parentElement[e].splice(d.index,1),i=0;i<j.length;i++)d.parentElement[e].splice(d.index+i,0,j[i]);j=[]}a.elements.length>0&&b.run(c)},q=function(a,b,c,d,e,f){return{url:a,parentElement:b,type:c,index:d,resolveType:e,originalContent:f,resolvedContent:null,resolved:!1}},r=function(a){var b,c;for(b=0;b<a.elements.length;b++)if(c=a.elements[b],c.resolved===!1)return!1;return!0},s=function(){return!1};return{xlinkLoader:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){m=m.bind(this),this.xlinkLoader.subscribe(MediaPlayer.dependencies.XlinkLoader.eventList.ENAME_XLINKELEMENT_LOADED,this,m)},resolveManifestOnLoad:function(a){k.call(this,a)},setMatchers:function(b){a=b},setIron:function(a){b=a}}},MediaPlayer.dependencies.XlinkController.prototype={constructor:MediaPlayer.dependencies.XlinkController},MediaPlayer.dependencies.XlinkController.eventList={ENAME_XLINK_ALLELEMENTSLOADED:"xlinkAllElementsLoaded",
ENAME_XLINK_READY:"xlinkReady"},MediaPlayer.dependencies.MediaSourceExtensions=function(){"use strict"},MediaPlayer.dependencies.MediaSourceExtensions.prototype={constructor:MediaPlayer.dependencies.MediaSourceExtensions,createMediaSource:function(){"use strict";var a="WebKitMediaSource"in window,b="MediaSource"in window;return b?new MediaSource:a?new WebKitMediaSource:null},attachMediaSource:function(a,b){"use strict";var c=window.URL.createObjectURL(a);return b.setSource(c),c},detachMediaSource:function(a){"use strict";a.setSource("")},setDuration:function(a,b){"use strict";return a.duration!=b&&(a.duration=b),a.duration},signalEndOfStream:function(a){"use strict";var b=a.sourceBuffers,c=b.length,d=0;if("open"===a.readyState){for(d;d<c;d+=1)if(b[d].updating)return;a.endOfStream()}}},MediaPlayer.dependencies.ProtectionExtensions=function(){"use strict";this.system=void 0,this.log=void 0,this.keySystems=[],this.clearkeyKeySystem=void 0},MediaPlayer.dependencies.ProtectionExtensions.prototype={constructor:MediaPlayer.dependencies.ProtectionExtensions,setup:function(){var a;a=this.system.getObject("ksPlayReady"),this.keySystems.push(a),a=this.system.getObject("ksWidevine"),this.keySystems.push(a),a=this.system.getObject("ksClearKey"),this.keySystems.push(a),this.clearkeyKeySystem=a},init:function(a){for(var b=(function(b){var c=null;return a&&(c=b in a?a[b]:null),c}),c=0;c<this.keySystems.length;c++){var d=this.keySystems[c];d.init(b(d.systemString))}},getKeySystems:function(){return this.keySystems},getKeySystemBySystemString:function(a){for(var b=0;b<this.keySystems.length;b++)if(this.keySystems[b].systemString===a)return this.keySystems[b];return null},isClearKey:function(a){return a===this.clearkeyKeySystem},initDataEquals:function(a,b){if(a.byteLength===b.byteLength){for(var c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0}return!1},getSupportedKeySystemsFromContentProtection:function(a){var b,c,d,e,f=[];if(a)for(d=0;d<this.keySystems.length;++d)for(c=this.keySystems[d],e=0;e<a.length;++e)if(b=a[e],b.schemeIdUri.toLowerCase()===c.schemeIdURI){var g=c.getInitData(b);g&&f.push({ks:this.keySystems[d],initData:g})}return f},getSupportedKeySystems:function(a){var b,c=[],d=MediaPlayer.dependencies.protection.CommonEncryption.parsePSSHList(a);for(b=0;b<this.keySystems.length;++b)this.keySystems[b].uuid in d&&c.push({ks:this.keySystems[b],initData:d[this.keySystems[b].uuid]});return c},autoSelectKeySystem:function(a,b,c,d,e){if(0===a.length)throw new Error("DRM system for this content not supported by the player!");var f=[],g=[];d&&g.push(new MediaPlayer.vo.protection.MediaCapability(d.codec)),e&&f.push(new MediaPlayer.vo.protection.MediaCapability(e.codec));for(var h=new MediaPlayer.vo.protection.KeySystemConfiguration(f,g),i=[],j=0;j<a.length;j++)i.push({ks:a[j].ks,configs:[h]});var k=this;!function(a,b){var c={};c[MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE]=function(c){if(a.unsubscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,this),c.error)k.log(c.error);else{var d=c.data;k.log("KeySystem Access Granted ("+d.keySystem.systemString+")!"),b.selectKeySystem(d)}},a.subscribe(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,c),b.requestKeySystemAccess(i)}(b,c)}},MediaPlayer.dependencies.RequestModifierExtensions=function(){"use strict";return{modifyRequestURL:function(a){return a},modifyRequestHeader:function(a){return a}}},MediaPlayer.dependencies.SourceBufferExtensions=function(){"use strict";this.system=void 0,this.notify=void 0,this.subscribe=void 0,this.unsubscribe=void 0},MediaPlayer.dependencies.SourceBufferExtensions.prototype={constructor:MediaPlayer.dependencies.SourceBufferExtensions,createSourceBuffer:function(a,b){"use strict";var c=this,d=b.codec,e=null;try{e=a.addSourceBuffer(d)}catch(a){if(!b.isText&&d.indexOf('codecs="stpp"')==-1)throw a;e=c.system.getObject("textSourceBuffer")}return e},removeSourceBuffer:function(a,b){"use strict";try{a.removeSourceBuffer(b)}catch(a){}},getBufferRange:function(a,b,c){"use strict";var d,e,f=null,g=0,h=0,i=null,j=null,k=0,l=c||.15;try{f=a.buffered}catch(a){return null}if(null!==f&&void 0!==f){for(e=0,d=f.length;e<d;e+=1)if(g=f.start(e),h=f.end(e),null===i)k=Math.abs(g-b),b>=g&&b<h?(i=g,j=h):k<=l&&(i=g,j=h);else{if(k=g-j,!(k<=l))break;j=h}if(null!==i)return{start:i,end:j}}return null},getAllRanges:function(a){var b=null;try{return b=a.buffered}catch(a){return null}},getTotalBufferedTime:function(a){var b,c,d=this.getAllRanges(a),e=0;if(!d)return e;for(c=0,b=d.length;c<b;c+=1)e+=d.end(c)-d.start(c);return e},getBufferLength:function(a,b,c){"use strict";var d,e,f=this;return d=f.getBufferRange(a,b,c),e=null===d?0:d.end-b},waitForUpdateEnd:function(a,b){"use strict";var c,d=50,e=function(){a.updating||(clearInterval(c),b())},f=function(){a.updating||(a.removeEventListener("updateend",f,!1),b())};if(!a.updating)return void b();if("function"==typeof a.addEventListener)try{a.addEventListener("updateend",f,!1)}catch(a){c=setInterval(e,d)}else c=setInterval(e,d)},append:function(a,b){var c=this,d="append"in a?"append":"appendBuffer"in a?"appendBuffer":null;if(d)try{c.waitForUpdateEnd(a,function(){a[d](b),c.waitForUpdateEnd(a,function(){c.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,{buffer:a,bytes:b})})})}catch(d){c.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_APPEND_COMPLETED,{buffer:a,bytes:b},new MediaPlayer.vo.Error(d.code,d.message,null))}},remove:function(a,b,c,d){var e=this;try{b>=0&&c>b&&"ended"!==d.readyState&&a.remove(b,c),this.waitForUpdateEnd(a,function(){e.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:b,to:c})})}catch(d){e.notify(MediaPlayer.dependencies.SourceBufferExtensions.eventList.ENAME_SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:b,to:c},new MediaPlayer.vo.Error(d.code,d.message,null))}},abort:function(a,b){"use strict";try{"open"===a.readyState&&b.abort()}catch(a){}}},MediaPlayer.dependencies.SourceBufferExtensions.QUOTA_EXCEEDED_ERROR_CODE=22,MediaPlayer.dependencies.SourceBufferExtensions.eventList={ENAME_SOURCEBUFFER_REMOVE_COMPLETED:"sourceBufferRemoveCompleted",ENAME_SOURCEBUFFER_APPEND_COMPLETED:"sourceBufferAppendCompleted"},MediaPlayer.utils.TextTrackExtensions=function(){"use strict";var a;return{setup:function(){a=window.VTTCue||window.TextTrackCue},addTextTrack:function(a,b,c,d,e){return this.track=a.addTextTrack("captions",c,d),this.track.default=e,this.track.mode="showing",this.video=a,this.addCaptions(0,b),this.track},addCaptions:function(b,c){for(var d in c){var e,f=c[d],g=this.video;"image"==f.type?(e=new a(f.start-b,f.end-b,""),e.image=f.data,e.id=f.id,e.size=0,e.type="image",e.onenter=function(){var a=new Image;a.id="ttmlImage_"+this.id,a.src=this.image,a.className="cue-image",g.parentNode.appendChild(a)},e.onexit=function(){var a,b=g.parentNode.childNodes;for(a=0;a<b.length;a++)b[a].id=="ttmlImage_"+this.id&&g.parentNode.removeChild(b[a])}):(e=new a(f.start,f.end,f.data),f.styles&&(void 0!==f.styles.align&&e.hasOwnProperty("align")&&(e.align=f.styles.align),void 0!==f.styles.line&&e.hasOwnProperty("line")&&(e.line=f.styles.line),void 0!==f.styles.position&&e.hasOwnProperty("position")&&(e.position=f.styles.position),void 0!==f.styles.size&&e.hasOwnProperty("size")&&(e.size=f.styles.size))),this.track.addCue(e)}},deleteCues:function(a){for(var b=0,c=!1;!c;){if(null!==a.textTracks[b].cues){c=!0;break}b++}var d=a.textTracks[b],e=d.cues,f=e.length-1;for(b=f;b>=0;b--)d.removeCue(e[b]);d.mode="disabled",d.default=!1}}},MediaPlayer.dependencies.VideoModelExtensions=function(){"use strict";return{getPlaybackQuality:function(a){var b="webkitDroppedFrameCount"in a,c="getVideoPlaybackQuality"in a,d=null;return c?d=a.getVideoPlaybackQuality():b&&(d={droppedVideoFrames:a.webkitDroppedFrameCount,creationTime:new Date}),d}}},MediaPlayer.dependencies.VideoModelExtensions.prototype={constructor:MediaPlayer.dependencies.VideoModelExtensions},MediaPlayer.dependencies.FragmentModel=function(){"use strict";var a=null,b=[],c=[],d=[],e=[],f=!1,g=function(a){var b=this;b.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_STARTED,{request:a}),b.fragmentLoader.load(a)},h=function(a,b){var c=a.indexOf(b);c!==-1&&a.splice(c,1)},i=function(a,b,c){var d,e=a.length-1,f=NaN,g=NaN,h=null;for(d=e;d>=0;d-=1)if(h=a[d],f=h.startTime,g=f+h.duration,c=c||h.duration/2,!isNaN(f)&&!isNaN(g)&&b+c>=f&&b-c<g||isNaN(f)&&isNaN(b))return h;return null},j=function(a,b){return b?b.hasOwnProperty("time")?[i.call(this,a,b.time,b.threshold)]:a.filter(function(a){for(var c in b)if("state"!==c&&b.hasOwnProperty(c)&&a[c]!=b[c])return!1;return!0}):a},k=function(a){var f;switch(a){case MediaPlayer.dependencies.FragmentModel.states.PENDING:f=c;break;case MediaPlayer.dependencies.FragmentModel.states.LOADING:f=d;break;case MediaPlayer.dependencies.FragmentModel.states.EXECUTED:f=b;break;case MediaPlayer.dependencies.FragmentModel.states.REJECTED:f=e;break;default:f=[]}return f},l=function(a,b){if(a){var c=a.mediaType,d=new Date,e=a.type,f=a.startTime,g=a.availabilityStartTime,h=a.duration,i=a.quality,j=a.range;this.metricsModel.addSchedulingInfo(c,d,e,f,g,h,i,j,b)}},m=function(a){var c=a.data.request,e=a.data.response,f=a.error;d.splice(d.indexOf(c),1),e&&!f&&b.push(c),l.call(this,c,f?MediaPlayer.dependencies.FragmentModel.states.FAILED:MediaPlayer.dependencies.FragmentModel.states.EXECUTED),this.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_FRAGMENT_LOADING_COMPLETED,{request:c,response:e},f)},n=function(a){var c=this.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,quality:a.data.quality,index:a.data.index})[0];c&&(h.call(this,b,c),isNaN(a.data.index)||(e.push(c),l.call(this,c,MediaPlayer.dependencies.FragmentModel.states.REJECTED)))},o=function(){f=!0},p=function(){f=!1};return{system:void 0,log:void 0,metricsModel:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN]=o,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=p,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BYTES_REJECTED]=n,this[MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_LOADING_COMPLETED]=m},setLoader:function(a){this.fragmentLoader=a},setContext:function(b){a=b},getContext:function(){return a},getIsPostponed:function(){return f},addRequest:function(a){return!(!a||this.isFragmentLoadedOrPending(a))&&(c.push(a),l.call(this,a,MediaPlayer.dependencies.FragmentModel.states.PENDING),!0)},isFragmentLoadedOrPending:function(a){var e=function(a,b){return"complete"===a.action&&a.action===b.action},f=function(a,b){return a.url===b.url&&a.startTime===b.startTime},g=function(a,b){return isNaN(a.index)&&isNaN(b.index)&&a.quality===b.quality},h=function(b){var c,d,h=!1,i=b.length;for(d=0;d<i;d+=1)if(c=b[d],f(a,c)||g(a,c)||e(a,c)){h=!0;break}return h};return h(c)||h(d)||h(b)},getRequests:function(a){var b,c=[],d=[],e=1;if(!a||!a.state)return c;a.state instanceof Array?(e=a.state.length,b=a.state):b=[a.state];for(var f=0;f<e;f+=1)c=k.call(this,b[f]),d=d.concat(j.call(this,c,a));return d},getLoadingTime:function(){var a,c,d=0;for(c=b.length-1;c>=0;c-=1)if(a=b[c],a.requestEndDate instanceof Date&&a.firstByteDate instanceof Date){d=a.requestEndDate.getTime()-a.firstByteDate.getTime();break}return d},removeExecutedRequest:function(a){h.call(this,b,a)},removeRejectedRequest:function(a){h.call(this,e,a)},removeExecutedRequestsBeforeTime:function(a){var c,d=b.length-1,e=NaN,f=null;for(c=d;c>=0;c-=1)f=b[c],e=f.startTime,!isNaN(e)&&e<a&&h.call(this,b,f)},cancelPendingRequests:function(a){var b=this,d=c,e=d;return c=[],void 0!==a&&(c=d.filter(function(b){return b.quality!==a&&(e.splice(e.indexOf(b),1),!0)})),e.forEach(function(a){l.call(b,a,MediaPlayer.dependencies.FragmentModel.states.CANCELED)}),e},abortRequests:function(){this.fragmentLoader.abort();for(var a=0,c=d.length;a<c;a+=1)h.call(this,b,d[a]);d=[]},executeRequest:function(a){var e=this,f=c.indexOf(a);if(a&&f!==-1)switch(c.splice(f,1),a.action){case"complete":b.push(a),l.call(e,a,MediaPlayer.dependencies.FragmentModel.states.EXECUTED),e.notify(MediaPlayer.dependencies.FragmentModel.eventList.ENAME_STREAM_COMPLETED,{request:a});break;case"download":d.push(a),l.call(e,a,MediaPlayer.dependencies.FragmentModel.states.LOADING),g.call(e,a);break;default:this.log("Unknown request action.")}},reset:function(){this.abortRequests(),this.cancelPendingRequests(),a=null,b=[],c=[],d=[],e=[],f=!1}}},MediaPlayer.dependencies.FragmentModel.prototype={constructor:MediaPlayer.dependencies.FragmentModel},MediaPlayer.dependencies.FragmentModel.eventList={ENAME_STREAM_COMPLETED:"streamCompleted",ENAME_FRAGMENT_LOADING_STARTED:"fragmentLoadingStarted",ENAME_FRAGMENT_LOADING_COMPLETED:"fragmentLoadingCompleted"},MediaPlayer.dependencies.FragmentModel.states={PENDING:"pending",LOADING:"loading",EXECUTED:"executed",REJECTED:"rejected",CANCELED:"canceled",FAILED:"failed"},MediaPlayer.models.ManifestModel=function(){"use strict";var a;return{system:void 0,eventBus:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,getValue:function(){return a},setValue:function(b){a=b,this.eventBus.dispatchEvent({type:MediaPlayer.events.MANIFEST_LOADED,data:b}),this.notify(MediaPlayer.models.ManifestModel.eventList.ENAME_MANIFEST_UPDATED,{manifest:b})}}},MediaPlayer.models.ManifestModel.prototype={constructor:MediaPlayer.models.ManifestModel},MediaPlayer.models.ManifestModel.eventList={ENAME_MANIFEST_UPDATED:"manifestUpdated"},MediaPlayer.models.MetricsModel=function(){"use strict";return{system:void 0,eventBus:void 0,adapter:void 0,streamMetrics:{},metricsChanged:function(){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRICS_CHANGED,data:{}})},metricChanged:function(a){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_CHANGED,data:{stream:a}}),this.metricsChanged()},metricUpdated:function(a,b,c){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_UPDATED,data:{stream:a,metric:b,value:c}}),this.metricChanged(a)},metricAdded:function(a,b,c){this.eventBus.dispatchEvent({type:MediaPlayer.events.METRIC_ADDED,data:{stream:a,metric:b,value:c}}),this.metricChanged(a)},clearCurrentMetricsForType:function(a){delete this.streamMetrics[a],this.metricChanged(a)},clearAllCurrentMetrics:function(){var a=this;this.streamMetrics={},this.metricsChanged.call(a)},getReadOnlyMetricsFor:function(a){return this.streamMetrics.hasOwnProperty(a)?this.streamMetrics[a]:null},getMetricsFor:function(a){var b;return this.streamMetrics.hasOwnProperty(a)?b=this.streamMetrics[a]:(b=this.system.getObject("metrics"),this.streamMetrics[a]=b),b},addTcpConnection:function(a,b,c,d,e,f){var g=new MediaPlayer.vo.metrics.TCPConnection;return g.tcpid=b,g.dest=c,g.topen=d,g.tclose=e,g.tconnect=f,this.getMetricsFor(a).TcpList.push(g),this.metricAdded(a,this.adapter.metricsList.TCP_CONNECTION,g),g},addHttpRequest:function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=new MediaPlayer.vo.metrics.HTTPRequest;return n.stream=a,n.tcpid=b,n.type=c,n.url=d,n.actualurl=e,n.range=f,n.trequest=g,n.tresponse=h,n.tfinish=i,n.responsecode=j,n.interval=k,n.mediaduration=l,n.responseHeaders=m,this.getMetricsFor(a).HttpList.push(n),this.metricAdded(a,this.adapter.metricsList.HTTP_REQUEST,n),n},appendHttpTrace:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.HTTPRequest.Trace;return e.s=b,e.d=c,e.b=d,a.trace.push(e),this.metricUpdated(a.stream,this.adapter.metricsList.HTTP_REQUEST_TRACE,a),e},addTrackSwitch:function(a,b,c,d,e){var f=new MediaPlayer.vo.metrics.TrackSwitch;return f.t=b,f.mt=c,f.to=d,f.lto=e,this.getMetricsFor(a).RepSwitchList.push(f),this.metricAdded(a,this.adapter.metricsList.TRACK_SWITCH,f),f},addBufferLevel:function(a,b,c){var d=new MediaPlayer.vo.metrics.BufferLevel;return d.t=b,d.level=c,this.getMetricsFor(a).BufferLevel.push(d),this.metricAdded(a,this.adapter.metricsList.BUFFER_LEVEL,d),d},addBufferState:function(a,b,c){var d=new MediaPlayer.vo.metrics.BufferState;return d.target=c,d.state=b,this.getMetricsFor(a).BufferState.push(d),this.metricAdded(a,this.adapter.metricsList.BUFFER_STATE,d),d},addDVRInfo:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.DVRInfo;return e.time=b,e.range=d,e.manifestInfo=c,this.getMetricsFor(a).DVRInfo.push(e),this.metricAdded(a,this.adapter.metricsList.DVR_INFO,e),e},addDroppedFrames:function(a,b){var c=new MediaPlayer.vo.metrics.DroppedFrames,d=this.getMetricsFor(a).DroppedFrames;return c.time=b.creationTime,c.droppedFrames=b.droppedVideoFrames,d.length>0&&d[d.length-1]==c?d[d.length-1]:(d.push(c),this.metricAdded(a,this.adapter.metricsList.DROPPED_FRAMES,c),c)},addSchedulingInfo:function(a,b,c,d,e,f,g,h,i){var j=new MediaPlayer.vo.metrics.SchedulingInfo;return j.mediaType=a,j.t=b,j.type=c,j.startTime=d,j.availabilityStartTime=e,j.duration=f,j.quality=g,j.range=h,j.state=i,this.getMetricsFor(a).SchedulingInfo.push(j),this.metricAdded(a,this.adapter.metricsList.SCHEDULING_INFO,j),j},addManifestUpdate:function(a,b,c,d,e,f,g,h,i,j){var k=new MediaPlayer.vo.metrics.ManifestUpdate,l=this.getMetricsFor("stream");return k.mediaType=a,k.type=b,k.requestTime=c,k.fetchTime=d,k.availabilityStartTime=e,k.presentationStartTime=f,k.clientTimeOffset=g,k.currentTime=h,k.buffered=i,k.latency=j,l.ManifestUpdate.push(k),this.metricAdded(a,this.adapter.metricsList.MANIFEST_UPDATE,k),k},updateManifestUpdateInfo:function(a,b){for(var c in b)a[c]=b[c];this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE,a)},addManifestUpdateStreamInfo:function(a,b,c,d,e){var f=new MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo;return f.id=b,f.index=c,f.start=d,f.duration=e,a.streamInfo.push(f),this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE_STREAM_INFO,a),f},addManifestUpdateTrackInfo:function(a,b,c,d,e,f,g,h){var i=new MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo;return i.id=b,i.index=c,i.streamIndex=d,i.mediaType=e,i.startNumber=g,i.fragmentInfoType=h,i.presentationTimeOffset=f,a.trackInfo.push(i),this.metricUpdated(a.mediaType,this.adapter.metricsList.MANIFEST_UPDATE_TRACK_INFO,a),i},addPlayList:function(a,b,c,d){var e=new MediaPlayer.vo.metrics.PlayList;return e.stream=a,e.start=b,e.mstart=c,e.starttype=d,this.getMetricsFor(a).PlayList.push(e),this.metricAdded(a,this.adapter.metricsList.PLAY_LIST,e),e},appendPlayListTrace:function(a,b,c,d,e,f,g,h){var i=new MediaPlayer.vo.metrics.PlayList.Trace;return i.representationid=b,i.subreplevel=c,i.start=d,i.mstart=e,i.duration=f,i.playbackspeed=g,i.stopreason=h,a.trace.push(i),this.metricUpdated(a.stream,this.adapter.metricsList.PLAY_LIST_TRACE,a),i}}},MediaPlayer.models.MetricsModel.prototype={constructor:MediaPlayer.models.MetricsModel},MediaPlayer.models.ProtectionModel={},MediaPlayer.models.ProtectionModel.eventList={ENAME_NEED_KEY:"needkey",ENAME_KEY_SYSTEM_ACCESS_COMPLETE:"keySystemAccessComplete",ENAME_KEY_SYSTEM_SELECTED:"keySystemSelected",ENAME_VIDEO_ELEMENT_SELECTED:"videoElementSelected",ENAME_SERVER_CERTIFICATE_UPDATED:"serverCertificateUpdated",ENAME_KEY_MESSAGE:"keyMessage",ENAME_KEY_ADDED:"keyAdded",ENAME_KEY_ERROR:"keyError",ENAME_KEY_SESSION_CREATED:"keySessionCreated",ENAME_KEY_SESSION_REMOVED:"keySessionRemoved",ENAME_KEY_SESSION_CLOSED:"keySessionClosed",ENAME_KEY_STATUSES_CHANGED:"keyStatusesChanged"},MediaPlayer.models.ProtectionModel_01b=function(){var a,b=null,c=null,d=[],e=[],f=function(){var b=this;return{handleEvent:function(f){var g=null;switch(f.type){case c.needkey:b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(f.initData,"cenc"));break;case c.keyerror:if(g=h(e,f.sessionId),g||(g=h(d,f.sessionId)),g){var i="";switch(f.errorCode.code){case 1:i+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:i+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:i+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:i+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:i+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:i+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}i+="  System Code = "+f.systemCode,b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(g,i))}else b.log("No session token found for key error");break;case c.keyadded:g=h(e,f.sessionId),g||(g=h(d,f.sessionId)),g?b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,g):b.log("No session token found for key added");break;case c.keymessage:a=null!==f.sessionId&&void 0!==f.sessionId,a?(g=h(e,f.sessionId),!g&&d.length>0&&(g=d.shift(),e.push(g),g.sessionID=f.sessionId)):d.length>0&&(g=d.shift(),e.push(g),0!==d.length&&b.errHandler.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),g?(g.keyMessage=f.message,b.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(g,f.message,f.defaultURL))):b.log("No session token found for key message")}}}},g=null,h=function(a,b){if(b&&a){for(var c=a.length,d=0;d<c;d++)if(a[d].sessionID==b)return a[d];return null}return null},i=function(){b.removeEventListener(c.keyerror,g),b.removeEventListener(c.needkey,g),b.removeEventListener(c.keymessage,g),b.removeEventListener(c.keyadded,g)};return{system:void 0,log:void 0,errHandler:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){g=f.call(this)},init:function(){var a=document.createElement("video");c=MediaPlayer.models.ProtectionModel_01b.detect(a)},teardown:function(){b&&i();for(var a=0;a<e.length;a++)this.closeKeySession(e[a])},requestKeySystemAccess:function(a){var c=b;c||(c=document.createElement("video"));for(var d=!1,e=0;e<a.length;e++)for(var f=a[e].ks.systemString,g=a[e].configs,h=null,i=null,j=0;j<g.length;j++){var k=g[j].videoCapabilities;if(k&&0!==k.length){i=[];for(var l=0;l<k.length;l++)""!==c.canPlayType(k[l].contentType,f)&&i.push(k[l])}if(!(!h&&!i||h&&0===h.length||i&&0===i.length)){d=!0;var m=new MediaPlayer.vo.protection.KeySystemConfiguration(h,i),n=this.protectionExt.getKeySystemBySystemString(f),o=new MediaPlayer.vo.protection.KeySystemAccess(n,m);this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,o);break}}d||this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(a){this.keySystem=a.keySystem,this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)},setMediaElement:function(a){b&&i(),b=a,b.addEventListener(c.keyerror,g),b.addEventListener(c.needkey,g),b.addEventListener(c.keymessage,g),b.addEventListener(c.keyadded,g),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)},createKeySession:function(f){if(!this.keySystem)throw new Error("Can not create sessions until you have selected a key system");var g;for(g=0;g<e.length;g++)if(this.protectionExt.initDataEquals(f,e[g].initData))return;for(g=0;g<d.length;g++)if(this.protectionExt.initDataEquals(f,d[g].initData))return;if(a||0===e.length){var h={prototype:(new MediaPlayer.models.SessionToken).prototype,sessionID:null,initData:f,getSessionID:function(){return this.sessionID}};return d.push(h),b[c.generateKeyRequest](this.keySystem.systemString,new Uint8Array(f)),h}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(a,d){var e=a.sessionID;if(this.protectionExt.isClearKey(this.keySystem))for(var f=0;f<d.keyPairs.length;f++)b[c.addKey](this.keySystem.systemString,d.keyPairs[f].key,d.keyPairs[f].keyID,e);else b[c.addKey](this.keySystem.systemString,d,a.initData,e)},closeKeySession:function(a){b[c.cancelKeyRequest](this.keySystem.systemString,a.sessionID)},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){}}},MediaPlayer.models.ProtectionModel_01b.prototype={constructor:MediaPlayer.models.ProtectionModel_01b},MediaPlayer.models.ProtectionModel_01b.APIs=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],MediaPlayer.models.ProtectionModel_01b.detect=function(a){for(var b=MediaPlayer.models.ProtectionModel_01b.APIs,c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d.generateKeyRequest]&&"function"==typeof a[d.addKey]&&"function"==typeof a[d.cancelKeyRequest])return d}return null},MediaPlayer.models.ProtectionModel_21Jan2015=function(){var a=null,b=null,c=[],d=function(a,b){var c=this;!function(b){var e=a[b].ks,f=a[b].configs;navigator.requestMediaKeySystemAccess(e.systemString,f).then(function(a){var b="function"==typeof a.getConfiguration?a.getConfiguration():null,d=new MediaPlayer.vo.protection.KeySystemAccess(e,b);d.mksa=a,c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,d)}).catch(function(){++b<a.length?d.call(c,a,b):c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied!")})}(b)},e=function(){var a=this;return{handleEvent:function(b){switch(b.type){case"encrypted":a.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(b.initData,b.initDataType))}}}},f=null,g=function(a){for(var b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}},h=function(a,b){var d=this,e={prototype:(new MediaPlayer.models.SessionToken).prototype,session:a,initData:b,handleEvent:function(a){switch(a.type){case"keystatuseschange":d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_STATUSES_CHANGED,this);break;case"message":d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(this,a.message,void 0,a.messageType))}},getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return this.session.expiration},getKeyStatuses:function(){return this.session.keyStatuses}};return a.addEventListener("keystatuseschange",e),a.addEventListener("message",e),a.closed.then(function(){g(e),d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,e.getSessionID())}),c.push(e),e};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){f=e.call(this)},init:function(){},teardown:function(){a&&a.removeEventListener("encrypted",f);for(var b=0;b<c.length;b++)this.closeKeySession(c[b])},requestKeySystemAccess:function(a){d.call(this,a,0)},selectKeySystem:function(c){var d=this;c.mksa.createMediaKeys().then(function(e){d.keySystem=c.keySystem,b=e,a&&a.setMediaKeys(b),d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}).catch(function(){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+c.keySystem.systemString+")! Could not create MediaKeys -- TODO")})},setMediaElement:function(c){a&&a.removeEventListener("encrypted",f().bind(this)),a=c,a.addEventListener("encrypted",f),b&&a.setMediaKeys(b)},setServerCertificate:function(a){if(!this.keySystem||!b)throw new Error("Can not set server certificate until you have selected a key system");var c=this;b.setServerCertificate(a).then(function(){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED)}).catch(function(a){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_SERVER_CERTIFICATE_UPDATED,null,"Error updating server certificate -- "+a.name)})},createKeySession:function(a,d){if(!this.keySystem||!b)throw new Error("Can not create sessions until you have selected a key system");for(var e=0;e<c.length;e++)if(this.protectionExt.initDataEquals(a,c[e].initData))return;var f=b.createSession(d),i=h.call(this,f,a),j=this;f.generateRequest("cenc",a).then(function(){j.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,i)}).catch(function(a){g(i),j.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Error generating key request -- "+a.name)})},updateKeySession:function(a,b){var c=a.session,d=this;this.protectionExt.isClearKey(this.keySystem)&&(b=b.toJWK()),c.update(b).catch(function(b){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(a,"Error sending update() message! "+b.name))})},loadKeySession:function(a){if(!this.keySystem||!b)throw new Error("Can not load sessions until you have selected a key system");var c=b.createSession(),d=this;c.load(a).then(function(b){if(b){var e=h.call(this,c);d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,e)}else d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Could not load session! Invalid Session ID ("+a+")")}).catch(function(b){d.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,null,"Could not load session ("+a+")! "+b.name)})},removeKeySession:function(a){var b=a.session,c=this;b.remove().then(function(){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,a.getSessionID())}).catch(function(b){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_REMOVED,null,"Error removing session ("+a.getSessionID()+"). "+b.name)})},closeKeySession:function(a){var b=a.session;b.removeEventListener("keystatuseschange",a),b.removeEventListener("message",a);var c=this;b.close().catch(function(b){c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,null,"Error closing session ("+a.getSessionID()+") "+b.name)})}}},MediaPlayer.models.ProtectionModel_21Jan2015.detect=function(a){return void 0!==a.onencrypted&&void 0!==a.mediaKeys&&(void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess)},MediaPlayer.models.ProtectionModel_21Jan2015.prototype={constructor:MediaPlayer.models.ProtectionModel_21Jan2015},MediaPlayer.models.ProtectionModel_3Feb2014=function(){var a=null,b=null,c=null,d=null,e=[],f=function(){var a=this;return{handleEvent:function(b){switch(b.type){case d.needkey:a.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_NEED_KEY,new MediaPlayer.vo.protection.NeedKey(b.initData,"cenc"))}}}},g=null,h=function(){var c=function(){a[d.setMediaKeys](b),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_VIDEO_ELEMENT_SELECTED)};a.readyState>=1?c.call(this):a.addEventListener("loadedmetadata",c.bind(this))},i=function(a,b){var c=this;return{prototype:(new MediaPlayer.models.SessionToken).prototype,session:a,initData:b,handleEvent:function(a){switch(a.type){case d.error:var b="KeyError";c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ERROR,new MediaPlayer.vo.protection.KeyError(this,b));break;case d.message:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_MESSAGE,new MediaPlayer.vo.protection.KeyMessage(this,a.message,a.destinationURL));break;case d.ready:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_ADDED,this);
break;case d.close:c.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CLOSED,this.getSessionID())}},getSessionID:function(){return this.session.sessionId}}};return{system:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,protectionExt:void 0,keySystem:null,setup:function(){g=f.call(this)},init:function(){var a=document.createElement("video");d=MediaPlayer.models.ProtectionModel_3Feb2014.detect(a)},teardown:function(){a&&a.removeEventListener(d.needkey,g);for(var b=0;b<e.length;b++)this.closeKeySession(e[b])},requestKeySystemAccess:function(a){for(var b=!1,c=0;c<a.length;c++)for(var e=a[c].ks.systemString,f=a[c].configs,g=null,h=null,i=0;i<f.length;i++){var j=f[i].audioCapabilities,k=f[i].videoCapabilities;if(j&&0!==j.length){g=[];for(var l=0;l<j.length;l++)window[d.MediaKeys].isTypeSupported(e,j[l].contentType)&&g.push(j[l])}if(k&&0!==k.length){h=[];for(var m=0;m<k.length;m++)window[d.MediaKeys].isTypeSupported(e,k[m].contentType)&&h.push(k[m])}if(!(!g&&!h||g&&0===g.length||h&&0===h.length)){b=!0;var n=new MediaPlayer.vo.protection.KeySystemConfiguration(g,h),o=this.protectionExt.getKeySystemBySystemString(e),p=new MediaPlayer.vo.protection.KeySystemAccess(o,n);this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,p);break}}b||this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_ACCESS_COMPLETE,null,"Key system access denied! -- No valid audio/video content configurations detected!")},selectKeySystem:function(e){try{b=e.mediaKeys=new window[d.MediaKeys](e.keySystem.systemString),this.keySystem=e.keySystem,c=e,a&&h.call(this),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED)}catch(a){this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SYSTEM_SELECTED,null,"Error selecting keys system ("+this.keySystem.systemString+")! Could not create MediaKeys -- TODO")}},setMediaElement:function(c){a&&a.removeEventListener(d.needkey,g().bind(this)),a=c,a.addEventListener(d.needkey,g),b&&h.call(this)},createKeySession:function(a){if(!this.keySystem||!b||!c)throw new Error("Can not create sessions until you have selected a key system");for(var f=0;f<e.length;f++)if(this.protectionExt.initDataEquals(a,e[f].initData))return;var g=c.ksConfiguration.videoCapabilities[0].contentType,h=b.createSession(g,new Uint8Array(a)),j=i.call(this,h,a);h.addEventListener(d.error,j),h.addEventListener(d.message,j),h.addEventListener(d.ready,j),h.addEventListener(d.close,j),e.push(j),this.notify(MediaPlayer.models.ProtectionModel.eventList.ENAME_KEY_SESSION_CREATED,j)},updateKeySession:function(a,b){var c=a.session;this.protectionExt.isClearKey(this.keySystem)?c.update(new Uint8Array(b.toJWK())):c.update(b)},closeKeySession:function(a){var b=a.session;b.removeEventListener(d.error,a),b.removeEventListener(d.message,a),b.removeEventListener(d.ready,a),b.removeEventListener(d.close,a);for(var c=0;c<e.length;c++)if(e[c]===a){e.splice(c,1);break}b[d.release]()},setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){}}},MediaPlayer.models.ProtectionModel_3Feb2014.APIs=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}],MediaPlayer.models.ProtectionModel_3Feb2014.detect=function(a){for(var b=MediaPlayer.models.ProtectionModel_3Feb2014.APIs,c=0;c<b.length;c++){var d=b[c];if("function"==typeof a[d.setMediaKeys]&&"function"==typeof window[d.MediaKeys])return d}return null},MediaPlayer.models.ProtectionModel_3Feb2014.prototype={constructor:MediaPlayer.models.ProtectionModel_3Feb2014},MediaPlayer.models.URIQueryAndFragmentModel=function(){"use strict";var a=new MediaPlayer.vo.URIFragmentData,b=[],c=function(c){function d(a,b,c,d){var e=d[0].split(/[=]/);return d.push({key:e[0],value:e[1]}),d.shift(),d}if(!c)return null;var e=[];return b.length>0&&(b=b.reduce(d,null)),e.length>0&&(e=e.reduce(d,null),e.forEach(function(b){a[b.key]=b.value})),c};return{parseURI:c,getURIFragmentData:function(){return a},getURIQueryData:function(){return b},reset:function(){a=new MediaPlayer.vo.URIFragmentData,b=[]}}},MediaPlayer.models.URIQueryAndFragmentModel.prototype={constructor:MediaPlayer.models.URIQueryAndFragmentModel},MediaPlayer.models.VideoModel=function(){"use strict";var a,b=[],c=function(){return b.length>0},d=function(c){null===c||a.seeking||(this.setPlaybackRate(0),b[c]!==!0&&(b.push(c),b[c]=!0))},e=function(a){if(null!==a){b[a]=!1;var d=b.indexOf(a);d!==-1&&b.splice(d,1),c()===!1&&this.setPlaybackRate(1)}},f=function(a,b){b?d.call(this,a):e.call(this,a)};return{system:void 0,play:function(){a.play()},pause:function(){a.pause()},isPaused:function(){return a.paused},getPlaybackRate:function(){return a.playbackRate},setPlaybackRate:function(b){!a||a.readyState<2||(a.playbackRate=b)},getCurrentTime:function(){return a.currentTime},setCurrentTime:function(b){if(a.currentTime!=b)try{a.currentTime=b}catch(c){0===a.readyState&&c.code===c.INVALID_STATE_ERR&&setTimeout(function(){a.currentTime=b},400)}},setStallState:function(a,b){f.call(this,a,b)},listen:function(b,c){a.addEventListener(b,c,!1)},unlisten:function(b,c){a.removeEventListener(b,c,!1)},getElement:function(){return a},setElement:function(b){a=b},setSource:function(b){a.src=b}}},MediaPlayer.models.VideoModel.prototype={constructor:MediaPlayer.models.VideoModel},MediaPlayer.dependencies.protection.CommonEncryption={findCencContentProtection:function(a){for(var b=null,c=0;c<a.length;++c){var d=a[c];"urn:mpeg:dash:mp4protection:2011"===d.schemeIdUri.toLowerCase()&&"cenc"===d.value.toLowerCase()&&(b=d)}return b},getPSSHData:function(a){return a.slice(32)},getPSSHForKeySystem:function(a,b){var c=MediaPlayer.dependencies.protection.CommonEncryption.parsePSSHList(b);return c.hasOwnProperty(a.uuid.toLowerCase())?c[a.uuid.toLowerCase()]:null},parseInitDataFromContentProtection:function(a){return"pssh"in a?BASE64.decodeArray(a.pssh.__text).buffer:null},parsePSSHList:function(a){if(null===a)return[];for(var b=new DataView(a),c=!1,d={},e=0;!c;){var f,g,h,i,j,k=e;if(e>=b.buffer.byteLength)break;if(f=b.getUint32(e),g=e+f,e+=4,1886614376===b.getUint32(e))if(e+=4,h=b.getUint8(e),0===h||1===h){e+=1,e+=3,i="";var l,m;for(l=0;l<4;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=4,i+="-",l=0;l<2;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;l<2;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;l<2;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;for(e+=2,i+="-",l=0;l<6;l++)m=b.getUint8(e+l).toString(16),i+=1===m.length?"0"+m:m;e+=6,i=i.toLowerCase(),j=b.getUint32(e),e+=4,d[i]=b.buffer.slice(k,g),e=g}else e=g;else e=g}return d}},MediaPlayer.dependencies.protection.KeySystem={eventList:{ENAME_LICENSE_REQUEST_COMPLETE:"licenseRequestComplete"}},MediaPlayer.dependencies.protection.KeySystem_Access=function(){"use strict"},MediaPlayer.dependencies.protection.KeySystem_Access.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_Access},MediaPlayer.dependencies.protection.KeySystem_ClearKey=function(){"use strict";var a,b="org.w3.clearkey",c="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",d=function(b,c){var d,e=this,f=a&&a.laURL&&""!==a.laURL?a.laURL:null,g=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(b)));if(f){for(f+="/?",d=0;d<g.kids.length;d++)f+=g.kids[d]+"&";f=f.substring(0,f.length-1);var h=new XMLHttpRequest;h.onload=function(){if(200==h.status){for(h.response.hasOwnProperty("keys")||e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey Remote update, Illegal response JSON")),d=0;d<h.response.keys.length;d++){var a=h.response.keys[d],b=a.kid.replace(/=/g,"");k=a.k.replace(/=/g,""),i.push(new MediaPlayer.vo.protection.KeyPair(b,k))}var f=new MediaPlayer.vo.protection.LicenseRequestComplete(new MediaPlayer.vo.protection.ClearKeyKeySet(i),c);e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,f)}else e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey Remote update, XHR aborted. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.onabort=function(){e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey update, XHR aborted. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.onerror=function(){e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: ClearKey update, XHR error. status is "'+h.statusText+'" ('+h.status+"), readyState is "+h.readyState))},h.open("GET",f),h.responseType="json",h.send()}else if(a.clearkeys){var i=[];for(d=0;d<g.kids.length;d++){var j=g.kids[d],k=a.clearkeys.hasOwnProperty(j)?a.clearkeys[j]:null;k||this.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey keyID ("+j+") is not known!")),i.push(new MediaPlayer.vo.protection.KeyPair(j,k))}var l=new MediaPlayer.vo.protection.LicenseRequestComplete(new MediaPlayer.vo.protection.ClearKeyKeySet(i),c);this.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,l)}else e.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: ClearKey has no way (URL or protection data) to retrieve keys"))};return{system:void 0,schemeIdURI:"urn:uuid:"+c,systemString:b,uuid:c,notify:void 0,subscribe:void 0,unsubscribe:void 0,init:function(b){a=b},doLicenseRequest:function(a,b,c){d.call(this,a,c)},getInitData:MediaPlayer.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection}},MediaPlayer.dependencies.protection.KeySystem_ClearKey.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_ClearKey},MediaPlayer.dependencies.protection.KeySystem_PlayReady=function(){"use strict";var a,b="com.microsoft.playready",c="9a04f079-9840-4286-ab92-e65be0885f95",d=function(b,c,d){var e,f,g,h,i,j,k=null,l={},m=new DOMParser,n=this;if(j=new Uint16Array(b.buffer),i=String.fromCharCode.apply(null,j),h=m.parseFromString(i,"application/xml"),h.getElementsByTagName("Challenge")[0]){var o=h.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;o&&(k=BASE64.decode(o))}else n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,"DRM: playready update, can not find Challenge in keyMessage",null));var p=h.getElementsByTagName("name"),q=h.getElementsByTagName("value");p.length!=q.length&&n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,"DRM: playready update, invalid header name/value pair in keyMessage",null));for(var r=0;r<p.length;r++)l[p[r].childNodes[0].nodeValue]=q[r].childNodes[0].nodeValue;a&&a.bearerToken&&(l.Authorization=a.bearerToken);var s=new XMLHttpRequest;if(s.onload=function(){if(200==s.status){var a=new MediaPlayer.vo.protection.LicenseRequestComplete(new Uint8Array(s.response),d);n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,a)}else n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,'DRM: playready update, XHR status is "'+s.statusText+'" ('+s.status+"), expected to be 200. readyState is "+s.readyState,null))},s.onabort=function(){n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,'DRM: playready update, XHR aborted. status is "'+s.statusText+'" ('+s.status+"), readyState is "+s.readyState,null))},s.onerror=function(){n.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new MediaPlayer.vo.Error(null,'DRM: playready update, XHR error. status is "'+s.statusText+'" ('+s.status+"), readyState is "+s.readyState,null))},s.open("POST",a&&a.laURL&&""!==a.laURL?a.laURL:c),s.responseType="arraybuffer",g=a?a.httpRequestHeaders:null)for(f in g)l[f]=g[f];for(e in l)"authorization"===e.toLowerCase()&&(s.withCredentials=!0),s.setRequestHeader(e,l[e]);a&&a.withCredentials&&(s.withCredentials=!0),s.send(k)},e=function(a){var b,c,d,e,f,g=0,h=new Uint8Array([112,115,115,104,0,0,0,0]),i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),j=null;if("pro"in a)j=BASE64.decodeArray(a.pro.__text);else{if(!("prheader"in a))return null;j=BASE64.decodeArray(a.prheader.__text)}return b=j.length,c=4+h.length+i.length+4+b,d=new ArrayBuffer(c),e=new Uint8Array(d),f=new DataView(d),f.setUint32(g,c),g+=4,e.set(h,g),g+=h.length,e.set(i,g),g+=i.length,f.setUint32(g,b),g+=4,e.set(j,g),g+=b,e.buffer},f=function(){return!1};return{schemeIdURI:"urn:uuid:"+c,systemString:b,uuid:c,notify:void 0,subscribe:void 0,unsubscribe:void 0,init:function(b){a=b},doLicenseRequest:d,getInitData:e,initDataEquals:f}},MediaPlayer.dependencies.protection.KeySystem_PlayReady.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_PlayReady},MediaPlayer.dependencies.protection.KeySystem_Widevine=function(){"use strict";var a,b="com.widevine.alpha",c="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",d=function(b,c,d){var e,f,g,h,i=new XMLHttpRequest,j={},k=this;if(h=a&&a.laURL&&""!==a.laURL?a.laURL:c){if(i.open("POST",h,!0),i.responseType="arraybuffer",i.onload=function(){if(200==this.status){var a=new MediaPlayer.vo.protection.LicenseRequestComplete(new Uint8Array(this.response),d);k.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,a)}else k.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: widevine update, XHR status is "'+i.statusText+'" ('+i.status+"), expected to be 200. readyState is "+i.readyState)+".  Response is "+(this.response?String.fromCharCode.apply(null,new Uint8Array(this.response)):"NONE")),k.errHandler.licenseRequestError("License request failed")},i.onabort=function(){k.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: widevine update, XHR aborted. status is "'+i.statusText+'" ('+i.status+"), readyState is "+i.readyState))},i.onerror=function(){k.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error('DRM: widevine update, XHR error. status is "'+i.statusText+'" ('+i.status+"), readyState is "+i.readyState)),k.errHandler.licenseRequestError("License request failed")},f=a?a.httpRequestHeaders:null)for(e in f)j[e]=f[e];for(g in j)"authorization"===g.toLowerCase()&&(i.withCredentials=!0),i.setRequestHeader(g,j[g]);i.send(b)}else k.notify(MediaPlayer.dependencies.protection.KeySystem.eventList.ENAME_LICENSE_REQUEST_COMPLETE,null,new Error("DRM: No valid Widevine Proxy Server URL specified!"))};return{schemeIdURI:"urn:uuid:"+c,systemString:b,uuid:c,notify:void 0,subscribe:void 0,unsubscribe:void 0,errHandler:void 0,init:function(b){a=b},doLicenseRequest:d,getInitData:MediaPlayer.dependencies.protection.CommonEncryption.parseInitDataFromContentProtection}},MediaPlayer.dependencies.protection.KeySystem_Widevine.prototype={constructor:MediaPlayer.dependencies.protection.KeySystem_Widevine},MediaPlayer.rules.ABRRulesCollection=function(){"use strict";var a=[];return{insufficientBufferRule:void 0,bufferOccupancyRule:void 0,throughputRule:void 0,getRules:function(b){switch(b){case MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES:return a;default:return null}},setup:function(){a.push(this.insufficientBufferRule),a.push(this.throughputRule),a.push(this.bufferOccupancyRule)}}},MediaPlayer.rules.ABRRulesCollection.prototype={constructor:MediaPlayer.rules.ABRRulesCollection,QUALITY_SWITCH_RULES:"qualitySwitchRules"},MediaPlayer.rules.BufferOccupancyRule=function(){"use strict";var a=0;return{log:void 0,metricsModel:void 0,execute:function(b,c){var d=this,e=(new Date).getTime()/1e3,f=b.getMediaInfo(),g=b.getTrackInfo(),h=f.type,i=isNaN(g.fragmentDuration)?2:g.fragmentDuration/2,j=b.getCurrentValue(),k=this.metricsModel.getReadOnlyMetricsFor(h),l=k.BufferLevel.length>0?k.BufferLevel[k.BufferLevel.length-1]:null,m=k.BufferState.length>0?k.BufferState[k.BufferState.length-1]:null,n=!1,o=f.trackCount-1,p=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);return e-a<i?void c(p):(null!==l&&null!==m&&l.level>m.target&&(n=l.level-m.target>MediaPlayer.dependencies.BufferController.RICH_BUFFER_THRESHOLD,n&&f.trackCount>1&&(p=new MediaPlayer.rules.SwitchRequest(o,MediaPlayer.rules.SwitchRequest.prototype.STRONG))),p.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&p.value!==j&&d.log("BufferOccupancyRule requesting switch to index: ",p.value,"type: ",h," Priority: ",p.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":p.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak"),void c(p))},reset:function(){a=0}}},MediaPlayer.rules.BufferOccupancyRule.prototype={constructor:MediaPlayer.rules.BufferOccupancyRule},MediaPlayer.rules.InsufficientBufferRule=function(){"use strict";var a={},b=0,c=1e3,d=function(b,c){a[b]=a[b]||{},a[b].state=c,c!==MediaPlayer.dependencies.BufferController.BUFFER_LOADED||a[b].firstBufferLoadedEvent||(a[b].firstBufferLoadedEvent=!0)},e=function(){a={}};return{log:void 0,metricsModel:void 0,playbackController:void 0,setup:function(){this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=e},execute:function(e,f){var g=this,h=(new Date).getTime(),i=e.getMediaInfo().type,j=e.getCurrentValue(),k=g.metricsModel.getReadOnlyMetricsFor(i),l=e.getStreamInfo(),m=e.getTrackInfo(),n=l.duration,o=g.playbackController.getTime(),p=e.getStreamProcessor(),q=p.isDynamic(),r=k.BufferLevel.length>0?k.BufferLevel[k.BufferLevel.length-1]:null,s=k.BufferState.length>0?k.BufferState[k.BufferState.length-1]:null,t=Math.min(m.fragmentDuration,MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD),u=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);if(h-b<c||null===s)return void f(u);if(d(i,s.state),s.state===MediaPlayer.dependencies.BufferController.BUFFER_EMPTY&&void 0!==a[i].firstBufferLoadedEvent)u=new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.STRONG);else if(!q&&a[i].state===MediaPlayer.dependencies.BufferController.BUFFER_LOADED&&r.level<2*t&&o<n-2*t){var v=r.level>t?MediaPlayer.rules.SwitchRequest.prototype.DEFAULT:MediaPlayer.rules.SwitchRequest.prototype.STRONG;u=new MediaPlayer.rules.SwitchRequest(Math.max(j-1,0),v)}u.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&u.value!==j&&g.log("InsufficientBufferRule requesting switch to index: ",u.value,"type: ",i," Priority: ",u.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":u.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak"),b=h,f(u)},reset:function(){a={},b=0}}},MediaPlayer.rules.InsufficientBufferRule.prototype={constructor:MediaPlayer.rules.InsufficientBufferRule},MediaPlayer.rules.ThroughputRule=function(){"use strict";var a=[],b=0,c=2,d=3,e=function(b,c){a[b]=a[b]||[],c!==1/0&&c!==a[b][a[b].length-1]&&a[b].push(c)},f=function(b,e){var f=0,g=e?c:d,h=a[b],i=h.length;if(g=i<g?i:g,i>0){for(var j=i-g,k=0,l=j;l<i;l++)k+=h[l];f=k/g}return h.length>g&&h.shift(),f};return{log:void 0,metricsExt:void 0,metricsModel:void 0,manifestExt:void 0,manifestModel:void 0,execute:function(a,c){var d,g,h,i=this,j=(new Date).getTime()/1e3,k=a.getMediaInfo(),l=k.type,m=a.getCurrentValue(),n=a.getTrackInfo(),o=this.manifestModel.getValue(),p=i.metricsModel.getReadOnlyMetricsFor(l),q=a.getStreamProcessor().isDynamic(),r=i.metricsExt.getCurrentHttpRequest(p),s=isNaN(n.fragmentDuration)?2:n.fragmentDuration/2,t=p.BufferState.length>0?p.BufferState[p.BufferState.length-1]:null,u=p.BufferLevel.length>0?p.BufferLevel[p.BufferLevel.length-1]:null,v=new MediaPlayer.rules.SwitchRequest(MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,MediaPlayer.rules.SwitchRequest.prototype.WEAK);if(j-b<s||!p||null===r||r.type!==MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE||null===t||null===u)return void c(v);d=(r.tfinish.getTime()-r.tresponse.getTime())/1e3,h=Math.round(8*r.trace[r.trace.length-1].b/d),e(l,h),g=Math.round(f(l,q));var w=this.manifestExt.getAdaptationForType(o,k.streamInfo.index,l),x=k.trackCount-1;if(t.state===MediaPlayer.dependencies.BufferController.BUFFER_LOADED&&(u.level>=2*MediaPlayer.dependencies.BufferController.LOW_BUFFER_THRESHOLD||q))for(var y=x;y>0;y--){var z=this.manifestExt.getRepresentationFor(y,w).bandwidth;if(g>=z){v=new MediaPlayer.rules.SwitchRequest(y,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT),b=j;break}}v.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&v.value!==m&&i.log("ThroughputRule requesting switch to index: ",v.value,"type: ",l," Priority: ",v.priority===MediaPlayer.rules.SwitchRequest.prototype.DEFAULT?"Default":v.priority===MediaPlayer.rules.SwitchRequest.prototype.STRONG?"Strong":"Weak","Average throughput",Math.round(g/1024),"kbps"),c(v)},reset:function(){a=[],b=0}}},MediaPlayer.rules.ThroughputRule.prototype={constructor:MediaPlayer.rules.ThroughputRule},MediaPlayer.rules.RulesContext=function(a,b){"use strict";var c=a.getCurrentTrack(),d=a;return{getStreamInfo:function(){return c.mediaInfo.streamInfo},getMediaInfo:function(){return c.mediaInfo},getTrackInfo:function(){return c},getCurrentValue:function(){return b},getManifestInfo:function(){return c.mediaInfo.streamInfo.manifestInfo},getStreamProcessor:function(){return d}}},MediaPlayer.rules.RulesContext.prototype={constructor:MediaPlayer.rules.RulesContext},MediaPlayer.rules.RulesController=function(){"use strict";var a={},b=["execute"],c=function(a){return a===this.SCHEDULING_RULE||a===this.ABR_RULE},d=function(a){var c=b.length,d=0;for(d;d<c;d+=1)if(!a.hasOwnProperty(b[d]))return!1;return!0},e=function(a,b){return new MediaPlayer.rules.RulesContext(a,b)},f=function(a){var b=a.execute.bind(a);return a.execute=function(c,d){var e=function(b){d.call(a,new MediaPlayer.rules.SwitchRequest(b.value,b.priority))};b(c,e)},"function"!=typeof a.reset&&(a.reset=function(){}),a},g=function(a,b,c){var e,g,h,i,j,k;for(g in b)if(i=b[g],j=i.length)for(k=0;k<j;k+=1)e=i[k],d.call(this,e)&&(e=f.call(this,e),h=a.getRules(g),c&&(c=!1,h.length=0),this.system.injectInto(e),h.push(e))};return{system:void 0,log:void 0,SCHEDULING_RULE:0,ABR_RULE:1,SYNC_RULE:2,initialize:function(){a[this.ABR_RULE]=this.system.getObject("abrRulesCollection"),a[this.SCHEDULING_RULE]=this.system.getObject("scheduleRulesCollection"),a[this.SYNC_RULE]=this.system.getObject("synchronizationRulesCollection")},setRules:function(b,d){c.call(this,b)&&d&&g.call(this,a[b],d,!0)},addRules:function(b,d){c.call(this,b)&&d&&g.call(this,a[b],d,!1)},applyRules:function(a,b,c,f,g){var h,i,j=a.length,k=j,l={},m=e.call(this,b,f),n=function(a){var b,d;a.value!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(l[a.priority]=g(l[a.priority],a.value)),--j||(l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.WEAK,b=l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]),l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,b=l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]),l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]!==MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE&&(d=MediaPlayer.rules.SwitchRequest.prototype.STRONG,b=l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]),d!=MediaPlayer.rules.SwitchRequest.prototype.STRONG&&d!=MediaPlayer.rules.SwitchRequest.prototype.WEAK&&(d=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT),c({value:void 0!==b?b:f,confidence:d}))};for(l[MediaPlayer.rules.SwitchRequest.prototype.STRONG]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,l[MediaPlayer.rules.SwitchRequest.prototype.WEAK]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,l[MediaPlayer.rules.SwitchRequest.prototype.DEFAULT]=MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE,i=0;i<k;i+=1)h=a[i],d.call(this,h)?h.execute(m,n):j--},reset:function(){var b,c,d=a[this.ABR_RULE],e=a[this.SCHEDULING_RULE],f=a[this.SYNC_RULE],g=(d.getRules(MediaPlayer.rules.ABRRulesCollection.prototype.QUALITY_SWITCH_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES)||[]).concat(e.getRules(MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES)||[]).concat(f.getRules(MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES)||[]).concat(f.getRules(MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES)||[]),h=g.length;for(c=0;c<h;c+=1)b=g[c],"function"==typeof b.reset&&b.reset();a={}}}},MediaPlayer.rules.RulesController.prototype={constructor:MediaPlayer.rules.RulesController},MediaPlayer.rules.BufferLevelRule=function(){"use strict";var a={},b={},c={},d=function(a){var b=this.metricsExt.getCurrentHttpRequest(a);return null!==b?(b.tresponse.getTime()-b.trequest.getTime())/1e3:0},e=function(a,b){var c;return c=isNaN(b)||MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME<b&&a<b?Math.max(MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME,a):a>=b?Math.min(b,MediaPlayer.dependencies.BufferController.DEFAULT_MIN_BUFFER_TIME):Math.min(b,a)},f=function(a,b,c){var f=this,g=c.bufferController.getCriticalBufferLevel(),h=f.metricsModel.getReadOnlyMetricsFor("video"),i=f.metricsModel.getReadOnlyMetricsFor("audio"),j=e.call(this,c.bufferController.getMinBufferTime(),b),k=j,l=c.bufferController.bufferMax,m=0;return l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_MIN?m=j:l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_INFINITY?m=b:l===MediaPlayer.dependencies.BufferController.BUFFER_SIZE_REQUIRED&&(!a&&f.abrController.isPlayingAtTopQuality(c.streamProcessor.getStreamInfo())&&(k=MediaPlayer.dependencies.BufferController.BUFFER_TIME_AT_TOP_QUALITY),m=k+Math.max(d.call(f,h),d.call(f,i))),m=Math.min(m,g)},g=function(a,c){return b[a]&&b[a][c]},h=function(b,c){return a[b]&&a[b][c]},i=function(a){var c=a.data.fragmentModel.getContext().streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.data.request.mediaType]=!0},j=function(b){var c=b.sender.streamProcessor.getStreamInfo().id;a[c]=a[c]||{},a[c][b.sender.streamProcessor.getType()]=!0},k=function(b){var c=b.sender.streamProcessor.getStreamInfo().id;a[c]=a[c]||{},a[c][b.sender.streamProcessor.getType()]=!1};return{metricsExt:void 0,metricsModel:void 0,abrController:void 0,playbackController:void 0,setup:function(){this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_OUTRUN]=j,this[MediaPlayer.dependencies.BufferController.eventList.ENAME_BUFFER_LEVEL_BALANCED]=k,this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=i},setScheduleController:function(a){var b=a.streamProcessor.getStreamInfo().id;c[b]=c[b]||{},c[b][a.streamProcessor.getType()]=a},execute:function(a,b){var d=a.getStreamInfo(),e=d.id,i=a.getMediaInfo().type;if(h(e,i))return void b(new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.STRONG));var j,k=this.metricsModel.getReadOnlyMetricsFor(i),l=this.metricsExt.getCurrentBufferLevel(k)?this.metricsExt.getCurrentBufferLevel(k).level:0,m=c[e][i],n=m.streamProcessor.getCurrentTrack(),o=m.streamProcessor.isDynamic(),p=this.metricsExt.getCurrentPlaybackRate(k),q=d.manifestInfo.duration,r=l/Math.max(p,1),s=n.fragmentDuration,t=this.playbackController.getTime(),u=o?Number.POSITIVE_INFINITY:q-t,v=Math.min(f.call(this,o,q,m),u),w=Math.max(v-r,0);j=Math.ceil(w/s),r>=u&&!g(e,i)&&(j=j||1),b(new MediaPlayer.rules.SwitchRequest(j,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))},reset:function(){a={},b={},c={}}}},MediaPlayer.rules.BufferLevelRule.prototype={constructor:MediaPlayer.rules.BufferLevelRule},MediaPlayer.rules.PendingRequestsRule=function(){"use strict";var a=3,b={};return{metricsExt:void 0,setScheduleController:function(a){var c=a.streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.streamProcessor.getType()]=a},execute:function(c,d){var e=c.getMediaInfo().type,f=c.getStreamInfo().id,g=c.getCurrentValue(),h=b[f][e],i=h.getFragmentModel(),j=i.getRequests({state:[MediaPlayer.dependencies.FragmentModel.states.PENDING,MediaPlayer.dependencies.FragmentModel.states.LOADING]}),k=i.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.REJECTED}),l=k.length,m=j.length,n=Math.max(g-m,0);return l>0?void d(new MediaPlayer.rules.SwitchRequest(l,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)):m>a?void d(new MediaPlayer.rules.SwitchRequest(0,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT)):0===g?void d(new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.NO_CHANGE)):void d(new MediaPlayer.rules.SwitchRequest(n,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))},reset:function(){b={}}}},MediaPlayer.rules.PendingRequestsRule.prototype={constructor:MediaPlayer.rules.PendingRequestsRule},MediaPlayer.rules.PlaybackTimeRule=function(){"use strict";var a={},b={},c=function(b){setTimeout(function(){var c=b.data.seekTime;a.audio=c,a.video=c,a.fragmentedText=c},0)};return{adapter:void 0,sourceBufferExt:void 0,playbackController:void 0,setup:function(){this[MediaPlayer.dependencies.PlaybackController.eventList.ENAME_PLAYBACK_SEEKING]=c},setScheduleController:function(a){var c=a.streamProcessor.getStreamInfo().id;b[c]=b[c]||{},b[c][a.streamProcessor.getType()]=a},execute:function(c,d){var e,f,g=c.getMediaInfo().type,h=c.getStreamInfo().id,i=b[h][g],j=.1,k=b[h][g].streamProcessor,l=k.getCurrentTrack(),m=a?a[g]:null,n=void 0!==m&&null!==m,o=n?MediaPlayer.rules.SwitchRequest.prototype.STRONG:MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,p=i.getFragmentModel().getRequests({state:MediaPlayer.dependencies.FragmentModel.states.REJECTED})[0],q=!!p&&!n,r=this.adapter.getIndexHandlerTime(k),s=this.playbackController.getTime(),t=p?p.startTime+p.duration:null,u=!n&&p&&(t>s&&p.startTime<=r||isNaN(r)),v=k.bufferController.getBuffer(),w=null;if(e=n?m:u?p.startTime:r,p&&i.getFragmentModel().removeRejectedRequest(p),isNaN(e))return void d(new MediaPlayer.rules.SwitchRequest(null,o));for(n&&(a[g]=null),v&&(w=this.sourceBufferExt.getBufferRange(k.bufferController.getBuffer(),e),null!==w&&(e=w.end)),f=this.adapter.getFragmentRequestForTime(k,l,e,{keepIdx:q}),u&&f&&f.index!==p.index&&(f=this.adapter.getFragmentRequestForTime(k,l,p.startTime+p.duration/2+j,{keepIdx:q,timeThreshold:0}));f&&k.getFragmentModel().isFragmentLoadedOrPending(f);){if("complete"===f.action){f=null,this.adapter.setIndexHandlerTime(k,NaN);break}f=this.adapter.getNextFragmentRequest(k,l)}f&&!u&&this.adapter.setIndexHandlerTime(k,f.startTime+f.duration),d(new MediaPlayer.rules.SwitchRequest(f,o))},reset:function(){a={},b={}}}},MediaPlayer.rules.PlaybackTimeRule.prototype={constructor:MediaPlayer.rules.PlaybackTimeRule};MediaPlayer.rules.SameTimeRequestRule=function(){"use strict";var a=4,b={},c=function(a,b){var c,d,f,g,h,i=0,j=a.length;for(i;i<j;i+=1)for(f=a[i].getRequests({
state:MediaPlayer.dependencies.FragmentModel.states.PENDING}),e.call(this,f,"index"),g=0,h=f.length;g<h;g++){if(c=f[g],isNaN(c.startTime)&&"complete"!==c.action){d=c;break}c.startTime>b&&(!d||c.startTime<d.startTime)&&(d=c)}return d||c},d=function(a,b){var c,d,e=a.length,f=null;for(d=0;d<e;d+=1)c=a[d].getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:b})[0],c&&(!f||c.startTime>f.startTime)&&(f=c);return f},e=function(a,b){var c=function(a,c){return a[b]<c[b]||isNaN(a[b])&&"complete"!==a.action?-1:a[b]>c[b]?1:0};a.sort(c)},f=function(a,c){return b[a]&&b[a][c]?b[a][c]:NaN},g=function(a){var c=a.data.fragmentModel,d=a.data.request,e=c.getContext().streamProcessor.getStreamInfo().id,f=d.mediaType;b[e]=b[e]||{},b[e][f]=d.index-1};return{playbackController:void 0,setup:function(){this[MediaPlayer.dependencies.FragmentController.eventList.ENAME_STREAM_COMPLETED]=g},setFragmentModels:function(a,b){this.fragmentModels=this.fragmentModels||{},this.fragmentModels[b]=a},execute:function(b,e){var g,h,i,j,k,l,m,n,o,p=b.getStreamInfo().id,q=b.getCurrentValue(),r=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,s=this.fragmentModels[p],t=new Date,u=null,v=s?s.length:null,w=!1,x=[];if(!s||!v)return void e(new MediaPlayer.rules.SwitchRequest([],r));if(l=this.playbackController.getTime(),m=d(s,l),k=m||c(s,l)||q,!k)return void e(new MediaPlayer.rules.SwitchRequest([],r));for(j=0;j<v;j+=1)if(h=s[j],g=h.getContext().streamProcessor.getType(),("video"===g||"audio"===g||"fragmentedText"===g)&&(n=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING}),o=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING}).length,!h.getIsPostponed()||isNaN(k.startTime))){if(o>a)return void e(new MediaPlayer.rules.SwitchRequest([],r));if(u=u||(k===m?l:k.startTime),n.indexOf(k)===-1){if(i=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.PENDING,time:u})[0],i||0!==k.index||(i=n.filter(function(a){return a.index===k.index})[0]),i)x.push(i);else if(i=h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.LOADING,time:u})[0]||h.getRequests({state:MediaPlayer.dependencies.FragmentModel.states.EXECUTED,time:u})[0],!i&&k.index!==f.call(this,p,k.mediaType)){w=!0;break}}else x.push(k)}return x=x.filter(function(a){return"complete"===a.action||t.getTime()>=a.availabilityStartTime.getTime()}),w?void e(new MediaPlayer.rules.SwitchRequest([],r)):void e(new MediaPlayer.rules.SwitchRequest(x,r))},reset:function(){b={}}}};MediaPlayer.rules.SameTimeRequestRule.prototype={constructor:MediaPlayer.rules.SameTimeRequestRule},MediaPlayer.rules.ScheduleRulesCollection=function(){"use strict";var a=[],b=[],c=[];return{bufferLevelRule:void 0,pendingRequestsRule:void 0,playbackTimeRule:void 0,sameTimeRequestRule:void 0,getRules:function(d){switch(d){case MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_SCHEDULE_RULES:return a;case MediaPlayer.rules.ScheduleRulesCollection.prototype.NEXT_FRAGMENT_RULES:return c;case MediaPlayer.rules.ScheduleRulesCollection.prototype.FRAGMENTS_TO_EXECUTE_RULES:return b;default:return null}},setup:function(){a.push(this.bufferLevelRule),a.push(this.pendingRequestsRule),c.push(this.playbackTimeRule),b.push(this.sameTimeRequestRule)}}},MediaPlayer.rules.ScheduleRulesCollection.prototype={constructor:MediaPlayer.rules.ScheduleRulesCollection,FRAGMENTS_TO_SCHEDULE_RULES:"fragmentsToScheduleRules",NEXT_FRAGMENT_RULES:"nextFragmentRules",FRAGMENTS_TO_EXECUTE_RULES:"fragmentsToExecuteRules"},MediaPlayer.rules.SwitchRequest=function(a,b){"use strict";this.value=a,this.priority=b,void 0===this.value&&(this.value=999),void 0===this.priority&&(this.priority=.5)},MediaPlayer.rules.SwitchRequest.prototype={constructor:MediaPlayer.rules.SwitchRequest,NO_CHANGE:999,DEFAULT:.5,STRONG:1,WEAK:0},MediaPlayer.rules.LiveEdgeBinarySearchRule=function(){"use strict";var a,b,c,d=43200,e=NaN,f=null,g=NaN,h=null,i=!1,j=NaN,k=MediaPlayer.rules.SwitchRequest.prototype.DEFAULT,l=function(a,d,e,f){var g,i=this;if(null===f)g=i.adapter.generateFragmentRequestForTime(c,h,a),l.call(i,a,d,e,g);else{var j=function(c){b.unsubscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,i,j),c.data.exists?d.call(i,c.data.request,a):e.call(i,c.data.request,a)};b.subscribe(MediaPlayer.dependencies.FragmentLoader.eventList.ENAME_CHECK_FOR_EXISTENCE_COMPLETED,i,j),b.checkForExistence(f)}},m=function(b,d){var j,p,q;return i?void o.call(this,!1,d):(q=d-e,j=q>0?e-q:e+Math.abs(q)+g,void(j<f.start&&j>f.end?a(new MediaPlayer.rules.SwitchRequest(null,k)):(p=this.adapter.getFragmentRequestForTime(c,h,j),l.call(this,j,n,m,p))))},n=function(b,d){var m,n,p=b.startTime,q=this;if(!i){if(!h.fragmentDuration)return void a(new MediaPlayer.rules.SwitchRequest(p,k));if(i=!0,f.end=p+2*g,d===e)return n=d+j,m=q.adapter.getFragmentRequestForTime(c,h,n),void l.call(q,n,function(){o.call(q,!0,n)},function(){a(new MediaPlayer.rules.SwitchRequest(n,k))},m)}o.call(this,!0,d)},o=function(b,d){var e,g,i;b?f.start=d:f.end=d,e=Math.floor(f.end-f.start)<=j,e?a(new MediaPlayer.rules.SwitchRequest(b?d:d-j,k)):(i=(f.start+f.end)/2,g=this.adapter.getFragmentRequestForTime(c,h,i),l.call(this,i,n,m,g))};return{metricsExt:void 0,adapter:void 0,timelineConverter:void 0,execute:function(i,o){var p,q,r=this;if(a=o,c=i.getStreamProcessor(),b=c.getFragmentLoader(),h=i.getTrackInfo(),j=h.fragmentDuration,q=h.DVRWindow,e=q.end,h.useCalculatedLiveEdgeTime){var s=r.timelineConverter.getExpectedLiveEdge();return r.timelineConverter.setExpectedLiveEdge(e),void a(new MediaPlayer.rules.SwitchRequest(s,k))}f={start:Math.max(0,e-d),end:e+d},g=Math.floor((q.end-q.start)/2),p=r.adapter.getFragmentRequestForTime(c,h,e),l.call(r,e,n,m,p)},reset:function(){e=NaN,f=null,g=NaN,h=null,i=!1,j=NaN,c=null,b=null}}},MediaPlayer.rules.LiveEdgeBinarySearchRule.prototype={constructor:MediaPlayer.rules.LiveEdgeBinarySearchRule},MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule=function(){"use strict";return{execute:function(a,b){b(new MediaPlayer.rules.SwitchRequest(a.getTrackInfo().DVRWindow.end,MediaPlayer.rules.SwitchRequest.prototype.DEFAULT))}}},MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule.prototype={constructor:MediaPlayer.rules.LiveEdgeWithTimeSynchronizationRule},MediaPlayer.rules.SynchronizationRulesCollection=function(){"use strict";var a=[],b=[];return{liveEdgeBinarySearchRule:void 0,liveEdgeWithTimeSynchronizationRule:void 0,getRules:function(c){switch(c){case MediaPlayer.rules.SynchronizationRulesCollection.prototype.TIME_SYNCHRONIZED_RULES:return a;case MediaPlayer.rules.SynchronizationRulesCollection.prototype.BEST_GUESS_RULES:return b;default:return null}},setup:function(){a.push(this.liveEdgeWithTimeSynchronizationRule),b.push(this.liveEdgeBinarySearchRule)}}},MediaPlayer.rules.SynchronizationRulesCollection.prototype={constructor:MediaPlayer.rules.SynchronizationRulesCollection,TIME_SYNCHRONIZED_RULES:"withAccurateTimeSourceRules",BEST_GUESS_RULES:"bestGuestRules"},MediaPlayer.utils.Capabilities=function(){"use strict"},MediaPlayer.utils.Capabilities.prototype={constructor:MediaPlayer.utils.Capabilities,system:void 0,log:void 0,supportsMediaSource:function(){"use strict";var a="WebKitMediaSource"in window,b="MediaSource"in window;return a||b},supportsEncryptedMedia:function(){return this.system.hasMapping("protectionModel")},supportsCodec:function(a,b){"use strict";if(!(a instanceof HTMLMediaElement))throw"element must be of type HTMLMediaElement.";var c=a.canPlayType(b);return"probably"===c||"maybe"===c}},MediaPlayer.utils.CustomTimeRanges=function(){return{customTimeRangeArray:[],length:0,add:function(a,b){var c=0;for(c=0;c<this.customTimeRangeArray.length&&a>this.customTimeRangeArray[c].start;c++);for(this.customTimeRangeArray.splice(c,0,{start:a,end:b}),c=0;c<this.customTimeRangeArray.length-1;c++)this.mergeRanges(c,c+1)&&c--;this.length=this.customTimeRangeArray.length},remove:function(a,b){for(var c=0;c<this.customTimeRangeArray.length;c++)if(a<=this.customTimeRangeArray[c].start&&b>=this.customTimeRangeArray[c].end)this.customTimeRangeArray.splice(c,1),c--;else{if(a>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end){this.customTimeRangeArray.splice(c+1,0,{start:b,end:this.customTimeRangeArray[c].end}),this.customTimeRangeArray[c].end=a;break}a>this.customTimeRangeArray[c].start&&a<this.customTimeRangeArray[c].end?this.customTimeRangeArray[c].end=a:b>this.customTimeRangeArray[c].start&&b<this.customTimeRangeArray[c].end&&(this.customTimeRangeArray[c].start=b)}this.length=this.customTimeRangeArray.length},mergeRanges:function(a,b){var c=this.customTimeRangeArray[a],d=this.customTimeRangeArray[b];return c.start<=d.start&&d.start<=c.end&&c.end<=d.end?(c.end=d.end,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&d.end<=c.end?(c.start=d.start,this.customTimeRangeArray.splice(b,1),!0):d.start<=c.start&&c.start<=d.end&&c.end<=d.end?(this.customTimeRangeArray.splice(a,1),!0):c.start<=d.start&&d.start<=c.end&&d.end<=c.end&&(this.customTimeRangeArray.splice(b,1),!0)},start:function(a){return this.customTimeRangeArray[a].start},end:function(a){return this.customTimeRangeArray[a].end}}},MediaPlayer.utils.CustomTimeRanges.prototype={constructor:MediaPlayer.utils.CustomTimeRanges},MediaPlayer.utils.DOMStorage=function(){var a=!0,b=function(){["video","audio"].forEach(function(b){if(void 0===this.abrController.getInitialBitrateFor(b)){if(this.isSupported(MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL)&&a){var c=MediaPlayer.utils.DOMStorage["LOCAL_STORAGE_"+b.toUpperCase()+"_BITRATE_KEY"],d=JSON.parse(localStorage.getItem(c))||{},e=(new Date).getTime()-parseInt(d.timestamp)>=MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION||!1,f=parseInt(d.bitrate);isNaN(f)||e?e&&localStorage.removeItem(c):(this.abrController.setInitialBitrateFor(b,f),this.log("Last bitrate played for "+b+" was "+f))}void 0===this.abrController.getInitialBitrateFor(b)&&this.abrController.setInitialBitrateFor(b,MediaPlayer.dependencies.AbrController["DEFAULT_"+b.toUpperCase()+"_BITRATE"])}},this)};return{system:void 0,log:void 0,abrController:void 0,checkInitialBitrate:b,enableLastBitrateCaching:function(b,c){a=b,void 0===c||isNaN(c)||"number"!=typeof c||(MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION=c)},isSupported:function(a){return a===MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL?window.localStorage||!1:a===MediaPlayer.utils.DOMStorage.STORAGE_TYPE_SESSION&&(window.sessionStorage||!1)}}},MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_VIDEO_BITRATE_KEY="dashjs_vbitrate",MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_AUDIO_BITRATE_KEY="dashjs_abitrate",MediaPlayer.utils.DOMStorage.LOCAL_STORAGE_BITRATE_EXPIRATION=36e4,MediaPlayer.utils.DOMStorage.STORAGE_TYPE_LOCAL="local",MediaPlayer.utils.DOMStorage.STORAGE_TYPE_SESSION="session",MediaPlayer.utils.DOMStorage.prototype={constructor:MediaPlayer.utils.DOMStorage},MediaPlayer.utils.Debug=function(){"use strict";var a,b=!0,c=!1,d=!1,e=(new Date).getTime();return{system:void 0,eventBus:void 0,setup:function(){this.system.mapValue("log",this.log),a=this.eventBus},setLogTimestampVisible:function(a){c=a},showCalleeName:function(a){d=a},setLogToBrowserConsole:function(a){b=a},getLogToBrowserConsole:function(){return b},log:function(){var f="",g=null;c&&(g=(new Date).getTime(),f+="["+(g-e)+"]"),d&&this.getName&&(f+="["+this.getName()+"]"),this.getMediaType&&this.getMediaType()&&(f+="["+this.getMediaType()+"]"),f.length>0&&(f+=" "),Array.apply(null,arguments).forEach(function(a){f+=a+" "}),b&&console.log(f),a.dispatchEvent({type:"log",message:f})}}},MediaPlayer.utils.EventBus=function(){"use strict";var a,b=function(b,c){var d=(c?"1":"0")+b;return d in a||(a[d]=[]),a[d]},c=function(){a={}};return c(),{addEventListener:function(a,c,d){var e=b(a,d),f=e.indexOf(c);f===-1&&e.push(c)},removeEventListener:function(a,c,d){var e=b(a,d),f=e.indexOf(c);f!==-1&&e.splice(f,1)},dispatchEvent:function(a){for(var c=b(a.type,!1).slice(),d=0;d<c.length;d++)c[d].call(this,a);return!a.defaultPrevented}}},MediaPlayer.utils.VirtualBuffer=function(){var a={},b=function(a,b){var c=function(a,c){return a[b]<c[b]?-1:a[b]>c[b]?1:0};a.sort(c)},c=function(b){var c=b.streamId,d=b.mediaType;return a[c]?a[c][d]:null},d=function(){var a={};return a.audio={buffered:new MediaPlayer.utils.CustomTimeRanges},a.audio[MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE]=[],a.audio[MediaPlayer.vo.metrics.HTTPRequest.INIT_SEGMENT_TYPE]=[],a.video={buffered:new MediaPlayer.utils.CustomTimeRanges},a.video[MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE]=[],a.video[MediaPlayer.vo.metrics.HTTPRequest.INIT_SEGMENT_TYPE]=[],a};return{system:void 0,sourceBufferExt:void 0,notify:void 0,subscribe:void 0,unsubscribe:void 0,append:function(c){var e=c.streamId,f=c.mediaType,g=c.segmentType,h=c.start,i=c.end;a[e]=a[e]||d(),a[e][f][g].push(c),b(a[e][f][g],"index"),isNaN(h)||isNaN(i)||(a[e][f].buffered.add(h,i),this.notify(MediaPlayer.utils.VirtualBuffer.eventList.CHUNK_APPENDED,{chunk:c}))},getChunks:function(a){var b=c.call(this,a),d=a.segmentType,e=a.removeOrigin,f=a.limit||Number.POSITIVE_INFINITY,g=0,h=[];return b?(delete a.streamId,delete a.mediaType,delete a.segmentType,delete a.removeOrigin,delete a.limit,h=b[d].filter(function(c,d,h){if(g>=f)return!1;for(var i in a)if(a.hasOwnProperty(i)&&c[i]!=a[i])return!1;return e&&(b.buffered.remove(c.start,c.end),h.splice(d,1)),g+=1,!0})):h},extract:function(a){return a.removeOrigin=!0,this.getChunks(a)},getTotalBufferLevel:function(b){var c=b.type,d=0;for(var e in a)a.hasOwnProperty(e)&&(d+=this.sourceBufferExt.getTotalBufferedTime(a[e][c]));return d},reset:function(){a={}}}},MediaPlayer.utils.VirtualBuffer.prototype={constructor:MediaPlayer.utils.VirtualBuffer},MediaPlayer.utils.VirtualBuffer.eventList={CHUNK_APPENDED:"chunkAppended"},MediaPlayer.vo.BitrateInfo=function(){"use strict";this.mediaType=null,this.bitrate=null,this.qualityIndex=NaN},MediaPlayer.vo.BitrateInfo.prototype={constructor:MediaPlayer.vo.BitrateInfo},MediaPlayer.vo.DataChunk=function(){"use strict";this.streamId=null,this.mediaType=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN},MediaPlayer.vo.DataChunk.prototype={constructor:MediaPlayer.vo.DataChunk},MediaPlayer.vo.Error=function(a,b,c){"use strict";this.code=a||null,this.message=b||null,this.data=c||null},MediaPlayer.vo.Error.prototype={constructor:MediaPlayer.vo.Error},MediaPlayer.vo.Event=function(){"use strict";this.type=null,this.sender=null,this.data=null,this.error=null,this.timestamp=NaN},MediaPlayer.vo.Event.prototype={constructor:MediaPlayer.vo.Event},MediaPlayer.vo.FragmentRequest=function(){"use strict";this.action="download",this.startTime=NaN,this.mediaType=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null},MediaPlayer.vo.FragmentRequest.prototype={constructor:MediaPlayer.vo.FragmentRequest,ACTION_DOWNLOAD:"download",ACTION_COMPLETE:"complete"},MediaPlayer.vo.ManifestInfo=function(){"use strict";this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null},MediaPlayer.vo.ManifestInfo.prototype={constructor:MediaPlayer.vo.ManifestInfo},MediaPlayer.vo.MediaInfo=function(){"use strict";this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.trackCount=0,this.lang=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null},MediaPlayer.vo.MediaInfo.prototype={constructor:MediaPlayer.vo.MediaInfo},MediaPlayer.models.MetricsList=function(){"use strict";return{TcpList:[],HttpList:[],RepSwitchList:[],BufferLevel:[],BufferState:[],PlayList:[],DroppedFrames:[],SchedulingInfo:[],DVRInfo:[],ManifestUpdate:[]}},MediaPlayer.models.MetricsList.prototype={constructor:MediaPlayer.models.MetricsList},MediaPlayer.vo.StreamInfo=function(){"use strict";this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},MediaPlayer.vo.StreamInfo.prototype={constructor:MediaPlayer.vo.StreamInfo},MediaPlayer.vo.TrackInfo=function(){"use strict";this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},MediaPlayer.vo.TrackInfo.prototype={constructor:MediaPlayer.vo.TrackInfo},MediaPlayer.vo.URIFragmentData=function(){"use strict";this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null},MediaPlayer.vo.URIFragmentData.prototype={constructor:MediaPlayer.vo.URIFragmentData},MediaPlayer.vo.metrics.BufferLevel=function(){"use strict";this.t=null,this.level=null},MediaPlayer.vo.metrics.BufferLevel.prototype={constructor:MediaPlayer.vo.metrics.BufferLevel},MediaPlayer.vo.metrics.BufferState=function(){"use strict";this.target=null,this.state=MediaPlayer.dependencies.BufferController.BUFFER_EMPTY},MediaPlayer.vo.metrics.BufferState.prototype={constructor:MediaPlayer.vo.metrics.BufferState},MediaPlayer.vo.metrics.DVRInfo=function(){"use strict";this.time=null,this.range=null,this.manifestInfo=null},MediaPlayer.vo.metrics.DVRInfo.prototype={constructor:MediaPlayer.vo.metrics.DVRInfo},MediaPlayer.vo.metrics.DroppedFrames=function(){"use strict";this.time=null,this.droppedFrames=null},MediaPlayer.vo.metrics.DroppedFrames.prototype={constructor:MediaPlayer.vo.metrics.DroppedFrames},MediaPlayer.vo.metrics.HTTPRequest=function(){"use strict";this.stream=null,this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.tfinish=null,this.responsecode=null,this.interval=null,this.mediaduration=null,this.responseHeaders=null,this.trace=[]},MediaPlayer.vo.metrics.HTTPRequest.prototype={constructor:MediaPlayer.vo.metrics.HTTPRequest},MediaPlayer.vo.metrics.HTTPRequest.Trace=function(){"use strict";this.s=null,this.d=null,this.b=[]},MediaPlayer.vo.metrics.HTTPRequest.Trace.prototype={constructor:MediaPlayer.vo.metrics.HTTPRequest.Trace},MediaPlayer.vo.metrics.HTTPRequest.MEDIA_SEGMENT_TYPE="Media Segment",MediaPlayer.vo.metrics.HTTPRequest.INIT_SEGMENT_TYPE="Initialization Segment",MediaPlayer.vo.metrics.HTTPRequest.MPD_TYPE="MPD",MediaPlayer.vo.metrics.ManifestUpdate=function(){"use strict";this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo=function(){"use strict";this.id=null,this.index=null,this.start=null,this.duration=null},MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo=function(){"use strict";this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null},MediaPlayer.vo.metrics.ManifestUpdate.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate},MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate.StreamInfo},MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo.prototype={constructor:MediaPlayer.vo.metrics.ManifestUpdate.TrackInfo},MediaPlayer.vo.metrics.PlayList=function(){"use strict";this.stream=null,this.start=null,this.mstart=null,this.starttype=null,this.trace=[]},MediaPlayer.vo.metrics.PlayList.Trace=function(){"use strict";this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null},MediaPlayer.vo.metrics.PlayList.prototype={constructor:MediaPlayer.vo.metrics.PlayList},MediaPlayer.vo.metrics.PlayList.INITIAL_PLAY_START_REASON="initial_start",MediaPlayer.vo.metrics.PlayList.SEEK_START_REASON="seek",MediaPlayer.vo.metrics.PlayList.Trace.prototype={constructor:MediaPlayer.vo.metrics.PlayList.Trace()},MediaPlayer.vo.metrics.PlayList.Trace.USER_REQUEST_STOP_REASON="user_request",MediaPlayer.vo.metrics.PlayList.Trace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",MediaPlayer.vo.metrics.PlayList.Trace.END_OF_CONTENT_STOP_REASON="end_of_content",MediaPlayer.vo.metrics.PlayList.Trace.REBUFFERING_REASON="rebuffering",MediaPlayer.vo.metrics.TrackSwitch=function(){"use strict";this.t=null,this.mt=null,this.to=null,this.lto=null},MediaPlayer.vo.metrics.TrackSwitch.prototype={constructor:MediaPlayer.vo.metrics.TrackSwitch},MediaPlayer.vo.metrics.SchedulingInfo=function(){"use strict";this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},MediaPlayer.vo.metrics.SchedulingInfo.prototype={constructor:MediaPlayer.vo.metrics.SchedulingInfo},MediaPlayer.vo.metrics.TCPConnection=function(){"use strict";this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null},MediaPlayer.vo.metrics.TCPConnection.prototype={constructor:MediaPlayer.vo.metrics.TCPConnection},MediaPlayer.vo.protection.ClearKeyKeySet=function(a,b){if(b&&"persistent"!==b&&"temporary"!==b)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=a,this.type=b,this.toJWK=function(){var a,b=this.keyPairs.length,c={};for(c.keys=[],a=0;a<b;a++){var d={kty:"oct",alg:"A128KW",kid:this.keyPairs[a].keyID,k:this.keyPairs[a].key};c.keys.push(d)}this.type&&(c.type=this.type);var e=JSON.stringify(c),f=e.length,g=new ArrayBuffer(f),h=new Uint8Array(g);for(a=0;a<f;a++)h[a]=e.charCodeAt(a);return g}},MediaPlayer.vo.protection.ClearKeyKeySet.prototype={constructor:MediaPlayer.vo.protection.ClearKeyKeySet},MediaPlayer.vo.protection.KeyError=function(a,b){"use strict";this.sessionToken=a,this.error=b},MediaPlayer.vo.protection.KeyError.prototype={constructor:MediaPlayer.vo.protection.KeyError},MediaPlayer.vo.protection.KeyMessage=function(a,b,c,d){"use strict";this.sessionToken=a,this.message=b,this.defaultURL=c,this.messageType=d},MediaPlayer.vo.protection.KeyMessage.prototype={constructor:MediaPlayer.vo.protection.KeyMessage},MediaPlayer.vo.protection.KeyPair=function(a,b){"use strict";this.keyID=a,this.key=b},MediaPlayer.vo.protection.KeyPair.prototype={constructor:MediaPlayer.vo.protection.KeyPair},MediaPlayer.vo.protection.KeySystemAccess=function(a,b){this.keySystem=a,this.ksConfiguration=b},MediaPlayer.vo.protection.KeySystemAccess.prototype={constructor:MediaPlayer.vo.protection.KeySystemAccess},MediaPlayer.vo.protection.KeySystemConfiguration=function(a,b,c,d){this.initDataTypes=["cenc"],this.audioCapabilities=a,this.videoCapabilities=b,this.distinctiveIdentifier=c,this.persistentState=d},MediaPlayer.vo.protection.KeySystemConfiguration.prototype={constructor:MediaPlayer.vo.protection.KeySystemConfiguration},MediaPlayer.vo.protection.LicenseRequestComplete=function(a,b){"use strict";this.message=a,this.requestData=b},MediaPlayer.vo.protection.LicenseRequestComplete.prototype={constructor:MediaPlayer.vo.protection.LicenseRequestComplete},MediaPlayer.vo.protection.MediaCapability=function(a,b){this.contentType=a,this.robustness=b},MediaPlayer.vo.protection.MediaCapability.prototype={constructor:MediaPlayer.vo.protection.MediaCapability},MediaPlayer.vo.protection.NeedKey=function(a,b){this.initData=a,this.initDataType=b},MediaPlayer.vo.protection.NeedKey.prototype={constructor:MediaPlayer.vo.protection.NeedKey},MediaPlayer.vo.protection.ProtectionData=function(a,b,c,d){this.laURL=a,this.httpRequestHeaders=b,this.bearerToken=c,this.clearkeys=d},MediaPlayer.vo.protection.ProtectionData.prototype={constructor:MediaPlayer.vo.protection.ProtectionData},MediaPlayer.models.SessionToken=function(){"use strict"},MediaPlayer.models.SessionToken.prototype={initData:null,getSessionID:function(){return""},getExpirationTime:function(){return NaN},getKeyStatuses:function(){return null}};